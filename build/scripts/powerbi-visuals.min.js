var jsCommon;!function(e){var t;!function(e){e.escKeyCode=27,e.enterKeyCode=13,e.tabKeyCode=9,e.upArrowKeyCode=38,e.downArrowKeyCode=40,e.leftArrowKeyCode=37,e.rightArrowKeyCode=39,e.homeKeyCode=36,e.endKeyCode=35,e.backSpaceKeyCode=8,e.deleteKeyCode=46,e.spaceKeyCode=32,e.shiftKeyCode=16,e.ctrlKeyCode=17,e.altKeyCode=18,e.aKeyCode=65,e.cKeyCode=67,e.sKeyCode=83,e.vKeyCode=86,e.xKeyCode=88,e.yKeyCode=89,e.zKeyCode=90,e.DocumentBody="body",e.Anchor="a",e.EditableTextElements=":text, textarea",e.disabledAttributeOrValue="disabled",e.readonlyAttributeOrValue="readonly",e.styleAttribute="style",e.hrefAttribute="href",e.targetAttribute="target",e.blankValue="_blank",e.classAttribute="class",e.titleAttribute="title",e.srcAttribute="src",e.contextmenuEventName="contextmenu",e.blurEventName="blur",e.keyUpEventName="keyup",e.inputEventName="input",e.changeEventName="change",e.cutEventName="cut",e.keyDownEventName="keydown",e.mouseMoveEventName="mousemove",e.mouseDownEventName="mousedown",e.mouseEnterEventName="mouseenter",e.mouseLeaveEventName="mouseleave",e.mouseOverEventName="mouseover",e.mouseOutEventName="mouseout",e.mouseClickEventName="click",e.pasteEventName="paste",e.scrollEventName="scroll",e.dropEventName="drop",e.focusInEventName="focusin",e.focusOutEventName="focusout",e.selectEventName="select",e.messageEventName="message",e.loadEventName="load",e.beforeUnload="beforeunload",e.inputAndSelectEventNames="input, select"}(t=e.DOMConstants||(e.DOMConstants={}))}(jsCommon||(jsCommon={}));var powerbi;!function(e){!function(e){e[e.ResourceCodeReference=0]="ResourceCodeReference",e[e.EmbeddedString=1]="EmbeddedString"}(e.PowerBIErrorResourceType||(e.PowerBIErrorResourceType={}));var t=e.PowerBIErrorResourceType;!function(e){e[e.GeneralError=0]="GeneralError",e[e.CsdlFetching=1]="CsdlFetching",e[e.CsdlConvertXmlToConceptualSchema=2]="CsdlConvertXmlToConceptualSchema",e[e.CsdlCreateClientSchema=3]="CsdlCreateClientSchema",e[e.ExecuteSemanticQueryError=4]="ExecuteSemanticQueryError",e[e.ExecuteSemanticQueryInvalidStreamFormat=5]="ExecuteSemanticQueryInvalidStreamFormat"}(e.ServiceErrorStatusCode||(e.ServiceErrorStatusCode={}));var i=e.ServiceErrorStatusCode,a=function(){function e(e){this.m_serviceError=e}return Object.defineProperty(e.prototype,"code",{get:function(){return e.codeName},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ignorable",{get:function(){return!1},enumerable:!0,configurable:!0}),e.prototype.getDetails=function(e){var t=r.GetDetailsFromServerErrorStatusCode(e,this.m_serviceError.statusCode);return r.addAdditionalInfo(t,this.m_serviceError.errorDetails,e),r.addMessageAndStackTrace(t,this.m_serviceError.message||null,this.m_serviceError.stackTrace||null,e),t},e.codeName="ServiceErrorToClientError",e}();e.ServiceErrorToClientError=a;var r=function(){function e(){}return e.addAdditionalInfo=function(i,a,r){if(a)for(var n=0;n<a.length;n++){var o=a[n],s={errorInfoKey:r.get(e.serverErrorPrefix+o.code),errorInfoValue:o.detail.type===t.ResourceCodeReference?r.get(e.serverErrorPrefix+o.detail.value):o.detail.value};i.additionalErrorInfo.push(s)}return i},e.addMessageAndStackTrace=function(e,t,i,a){if(t){var r={errorInfoKey:a.get("AdditionalErrorInfo_ErrorDetailsText"),errorInfoValue:t};e.additionalErrorInfo.push(r)}if(i){var r={errorInfoKey:a.get("AdditionalErrorInfo_StackTraceText"),errorInfoValue:i};e.additionalErrorInfo.push(r)}return e},e.GetDetailsFromServerErrorStatusCode=function(e,t){var a="",r="",n="";switch(t){case i.CsdlConvertXmlToConceptualSchema:a=e.get("ServiceError_ModelCannotLoad"),r=e.get("ServiceError_ModelConvertFailureKey"),n=e.get("ServiceError_ModelConvertFailureValue");break;case i.CsdlCreateClientSchema:a=e.get("ServiceError_ModelCannotLoad"),r=e.get("ServiceError_ModelCreationFailureKey"),n=e.get("ServiceError_ModelCreationFailureValue");break;case i.CsdlFetching:a=e.get("ServiceError_ModelCannotLoad"),r=e.get("ServiceError_ModelFetchingFailureKey"),n=e.get("ServiceError_ModelFetchingFailureValue");break;case i.ExecuteSemanticQueryError:a=e.get("ServiceError_CannotLoadVisual"),r=e.get("ServiceError_ExecuteSemanticQueryErrorKey"),n=e.get("ServiceError_ExecuteSemanticQueryErrorValue");break;case i.ExecuteSemanticQueryInvalidStreamFormat:a=e.get("ServiceError_CannotLoadVisual"),r=e.get("ServiceError_ExecuteSemanticQueryInvalidStreamFormatKey"),n=e.get("ServiceError_ExecuteSemanticQueryInvalidStreamFormatValue");break;case i.GeneralError:default:a=e.get("ServiceError_GeneralError"),r=e.get("ServiceError_GeneralErrorKey"),n=e.get("ServiceError_GeneralErrorValue")}var o=[];o.push({errorInfoKey:r,errorInfoValue:n});var s={message:a,additionalErrorInfo:o};return s},e.serverErrorPrefix="ServerError_",e}();e.PowerBIErrorDetailHelper=r}(powerbi||(powerbi={}));var powerbi;!function(e){}(powerbi||(powerbi={}));var powerbi;!function(e){function t(e){return new a(e)}e.CategoryTypes={Address:"Address",City:"City",Continent:"Continent",CountryRegion:"Country",County:"County",Longitude:"Longitude",Latitude:"Latitude",Place:"Place",PostalCode:"PostalCode",StateOrProvince:"StateOrProvince"},e.createGeoTaggingAnalyzerService=t;var i={GeotaggingString_Continent:"continent",GeotaggingString_Continents:"continents",GeotaggingString_Country:"country",GeotaggingString_Countries:"countries",GeotaggingString_State:"state",GeotaggingString_States:"states",GeotaggingString_City:"city",GeotaggingString_Cities:"cities",GeotaggingString_Town:"town",GeotaggingString_Towns:"towns",GeotaggingString_Province:"province",GeotaggingString_Provinces:"provinces",GeotaggingString_County:"county",GeotaggingString_Counties:"counties",GeotaggingString_Village:"village",GeotaggingString_Villages:"villages",GeotaggingString_Post:"post",GeotaggingString_Zip:"zip",GeotaggingString_Code:"code",GeotaggingString_Place:"place",GeotaggingString_Places:"places",GeotaggingString_Address:"address",GeotaggingString_Addresses:"addresses",GeotaggingString_Street:"street",GeotaggingString_Streets:"streets",GeotaggingString_Longitude:"longitude",GeotaggingString_Longitude_Short:"lon",GeotaggingString_Latitude:"latitude",GeotaggingString_Latitude_Short:"lat",GeotaggingString_PostalCode:"postal code",GeotaggingString_PostalCodes:"postal codes",GeotaggingString_ZipCode:"zip code",GeotaggingString_ZipCodes:"zip codes",GeotaggingString_Territory:"territory",GeotaggingString_Territories:"territories",GeotaggingString_VRMBackCompat_CountryRegion:"CountryRegion",GeotaggingString_VRMBackCompat_StateOrProvince:"StateOrProvince"},a=function(){function t(e){this.GeotaggingString_VRMBackCompat_CountryRegion="CountryRegion",this.GeotaggingString_VRMBackCompat_StateOrProvince="StateOrProvince",this.GeotaggingString_Continent=e("GeotaggingString_Continent").toLowerCase(),this.GeotaggingString_Continents=e("GeotaggingString_Continents").toLowerCase(),this.GeotaggingString_Country=e("GeotaggingString_Country").toLowerCase(),this.GeotaggingString_Countries=e("GeotaggingString_Countries").toLowerCase(),this.GeotaggingString_State=e("GeotaggingString_State").toLowerCase(),this.GeotaggingString_States=e("GeotaggingString_States").toLowerCase(),this.GeotaggingString_City=e("GeotaggingString_City").toLowerCase(),this.GeotaggingString_Cities=e("GeotaggingString_Cities").toLowerCase(),this.GeotaggingString_Town=e("GeotaggingString_Town").toLowerCase(),this.GeotaggingString_Towns=e("GeotaggingString_Towns").toLowerCase(),this.GeotaggingString_Province=e("GeotaggingString_Province").toLowerCase(),this.GeotaggingString_Provinces=e("GeotaggingString_Provinces").toLowerCase(),this.GeotaggingString_County=e("GeotaggingString_County").toLowerCase(),this.GeotaggingString_Counties=e("GeotaggingString_Counties").toLowerCase(),this.GeotaggingString_Village=e("GeotaggingString_Village").toLowerCase(),this.GeotaggingString_Villages=e("GeotaggingString_Villages").toLowerCase(),this.GeotaggingString_Post=e("GeotaggingString_Post").toLowerCase(),this.GeotaggingString_Zip=e("GeotaggingString_Zip").toLowerCase(),this.GeotaggingString_Code=e("GeotaggingString_Code").toLowerCase(),this.GeotaggingString_Place=e("GeotaggingString_Place").toLowerCase(),this.GeotaggingString_Places=e("GeotaggingString_Places").toLowerCase(),this.GeotaggingString_Address=e("GeotaggingString_Address").toLowerCase(),this.GeotaggingString_Addresses=e("GeotaggingString_Addresses").toLowerCase(),this.GeotaggingString_Street=e("GeotaggingString_Street").toLowerCase(),this.GeotaggingString_Streets=e("GeotaggingString_Streets").toLowerCase(),this.GeotaggingString_Longitude=e("GeotaggingString_Longitude").toLowerCase(),this.GeotaggingString_Longitude_Short=e("GeotaggingString_Longitude_Short").toLowerCase(),this.GeotaggingString_Latitude=e("GeotaggingString_Latitude").toLowerCase(),this.GeotaggingString_Latitude_Short=e("GeotaggingString_Latitude_Short").toLowerCase(),this.GeotaggingString_PostalCode=e("GeotaggingString_PostalCode").toLowerCase(),this.GeotaggingString_PostalCodes=e("GeotaggingString_PostalCodes").toLowerCase(),this.GeotaggingString_ZipCode=e("GeotaggingString_ZipCode").toLowerCase(),this.GeotaggingString_ZipCodes=e("GeotaggingString_ZipCodes").toLowerCase(),this.GeotaggingString_Territory=e("GeotaggingString_Territory").toLowerCase(),this.GeotaggingString_Territories=e("GeotaggingString_Territories").toLowerCase()}return t.prototype.isLongitudeOrLatitude=function(e){return this.isLongitude(e)||this.isLatitude(e)},t.prototype.isGeographic=function(e){return this.isLongitudeOrLatitude(e)||this.isGeocodable(e)},t.prototype.isGeocodable=function(e){return this.isAddress(e)||this.isCity(e)||this.isContinent(e)||this.isCountry(e)||this.isCounty(e)||this.isStateOrProvince(e)||this.isPlace(e)||this.isPostalCode(e)||this.isTerritory(e)},t.prototype.isAddress=function(e){return t.hasMatches(e,[this.GeotaggingString_Address,this.GeotaggingString_Addresses,this.GeotaggingString_Street,this.GeotaggingString_Streets])},t.prototype.isPlace=function(e){return t.hasMatches(e,[this.GeotaggingString_Place,this.GeotaggingString_Places])},t.prototype.isCity=function(e){return t.hasMatches(e,[this.GeotaggingString_City,this.GeotaggingString_Cities,this.GeotaggingString_Town,this.GeotaggingString_Towns,this.GeotaggingString_Village,this.GeotaggingString_Villages])},t.prototype.isStateOrProvince=function(e){return t.hasMatches(e,[this.GeotaggingString_State,this.GeotaggingString_States,this.GeotaggingString_Province,this.GeotaggingString_Provinces,this.GeotaggingString_VRMBackCompat_StateOrProvince])},t.prototype.isCountry=function(e){return t.hasMatches(e,[this.GeotaggingString_Country,this.GeotaggingString_Countries,this.GeotaggingString_VRMBackCompat_CountryRegion])},t.prototype.isCounty=function(e){return t.hasMatches(e,[this.GeotaggingString_County,this.GeotaggingString_Counties])},t.prototype.isContinent=function(e){return t.hasMatches(e,[this.GeotaggingString_Continent,this.GeotaggingString_Continents])},t.prototype.isPostalCode=function(e){var i=t.hasMatches(e,[this.GeotaggingString_Post,this.GeotaggingString_Zip])&&t.hasMatches(e,[this.GeotaggingString_Code])||t.hasMatches(e,[this.GeotaggingString_PostalCode,this.GeotaggingString_PostalCodes,this.GeotaggingString_ZipCode,this.GeotaggingString_ZipCodes]);if(!i){var a=new RegExp("s");i=t.hasMatches(e,[this.GeotaggingString_PostalCode.replace(a,""),this.GeotaggingString_PostalCodes.replace(a,""),this.GeotaggingString_ZipCode.replace(a,""),this.GeotaggingString_ZipCodes.replace(a,"")])}return i},t.prototype.isLongitude=function(e){return t.hasMatches(e,[this.GeotaggingString_Longitude,this.GeotaggingString_Longitude_Short])},t.prototype.isLatitude=function(e){return t.hasMatches(e,[this.GeotaggingString_Latitude,this.GeotaggingString_Latitude_Short])},t.prototype.isTerritory=function(e){return t.hasMatches(e,[this.GeotaggingString_Territory,this.GeotaggingString_Territories])},t.hasMatches=function(e,t){for(var i=e.toLowerCase(),a=0,r=t.length;r>a;a++){var n=t[a];if(i.indexOf(n)>-1)return!0}return!1},t.prototype.getFieldType=function(t){return null==t?void 0:this.isLatitude(t)?e.CategoryTypes.Latitude:this.isLongitude(t)?e.CategoryTypes.Longitude:this.isPostalCode(t)?e.CategoryTypes.PostalCode:this.isAddress(t)?e.CategoryTypes.Address:this.isPlace(t)?e.CategoryTypes.Place:this.isCity(t)?e.CategoryTypes.City:this.isCountry(t)?e.CategoryTypes.CountryRegion:this.isCounty(t)?e.CategoryTypes.County:this.isStateOrProvince(t)?e.CategoryTypes.StateOrProvince:this.isContinent(t)?e.CategoryTypes.Continent:this.getEnglishFieldType(t)},t.prototype.isEnglishAddress=function(e){return t.hasMatches(e,[i.GeotaggingString_Address,i.GeotaggingString_Addresses,i.GeotaggingString_Street,i.GeotaggingString_Streets])},t.prototype.isEnglishPlace=function(e){return t.hasMatches(e,[i.GeotaggingString_Place,i.GeotaggingString_Places])},t.prototype.isEnglishCity=function(e){return t.hasMatches(e,[i.GeotaggingString_City,i.GeotaggingString_Cities,i.GeotaggingString_Town,i.GeotaggingString_Towns,i.GeotaggingString_Village,i.GeotaggingString_Villages])},t.prototype.isEnglishStateOrProvince=function(e){return t.hasMatches(e,[i.GeotaggingString_State,i.GeotaggingString_States,i.GeotaggingString_Province,i.GeotaggingString_Provinces,i.GeotaggingString_VRMBackCompat_StateOrProvince])},t.prototype.isEnglishCountry=function(e){return t.hasMatches(e,[i.GeotaggingString_Country,i.GeotaggingString_Countries,i.GeotaggingString_VRMBackCompat_CountryRegion])},t.prototype.isEnglishCounty=function(e){return t.hasMatches(e,[i.GeotaggingString_County,i.GeotaggingString_Counties])},t.prototype.isEnglishContinent=function(e){return t.hasMatches(e,[i.GeotaggingString_Continent,i.GeotaggingString_Continents])},t.prototype.isEnglishPostalCode=function(e){var a=t.hasMatches(e,[i.GeotaggingString_Post,i.GeotaggingString_Zip])&&t.hasMatches(e,[this.GeotaggingString_Code])||t.hasMatches(e,[i.GeotaggingString_PostalCode,i.GeotaggingString_PostalCodes,i.GeotaggingString_ZipCode,i.GeotaggingString_ZipCodes]);if(!a){var r=new RegExp("s");a=t.hasMatches(e,[i.GeotaggingString_PostalCode.replace(r,""),i.GeotaggingString_PostalCodes.replace(r,""),i.GeotaggingString_ZipCode.replace(r,""),i.GeotaggingString_ZipCodes.replace(r,"")])}return a},t.prototype.isEnglishLongitude=function(e){return t.hasMatches(e,[i.GeotaggingString_Longitude,i.GeotaggingString_Longitude_Short])},t.prototype.isEnglishLatitude=function(e){return t.hasMatches(e,[i.GeotaggingString_Latitude,i.GeotaggingString_Latitude_Short])},t.prototype.getEnglishFieldType=function(t){return null==t?void 0:this.isEnglishLatitude(t)?e.CategoryTypes.Latitude:this.isEnglishLongitude(t)?e.CategoryTypes.Longitude:this.isEnglishPostalCode(t)?e.CategoryTypes.PostalCode:this.isEnglishAddress(t)?e.CategoryTypes.Address:this.isEnglishPlace(t)?e.CategoryTypes.Place:this.isEnglishCity(t)?e.CategoryTypes.City:this.isEnglishCountry(t)?e.CategoryTypes.CountryRegion:this.isEnglishCounty(t)?e.CategoryTypes.County:this.isEnglishStateOrProvince(t)?e.CategoryTypes.StateOrProvince:this.isEnglishContinent(t)?e.CategoryTypes.Continent:void 0},t}();e.GeoTaggingAnalyzerService=a}(powerbi||(powerbi={}));var powerbi;!function(e){var t=function(){function e(){}return Object.defineProperty(e.prototype,"code",{get:function(){return"UnknownClientError"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ignorable",{get:function(){return!1},enumerable:!0,configurable:!0}),e.prototype.getDetails=function(e){var t={message:e.get("ClientError_UnknownClientErrorValue"),additionalErrorInfo:[{errorInfoKey:e.get("ClientError_UnknownClientErrorKey"),errorInfoValue:e.get("ClientError_UnknownClientErrorValue")}]};return t},e}();e.UnknownClientError=t;var i=function(){function e(){}return Object.defineProperty(e.prototype,"code",{get:function(){return"IgnorableClientError"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ignorable",{get:function(){return!0},enumerable:!0,configurable:!0}),e.prototype.getDetails=function(e){var t={message:"",additionalErrorInfo:[]};return t},e}();e.IgnorableClientError=i}(powerbi||(powerbi={}));var InJs;!function(e){var t;!function(e){function t(){return $("<div/>")}function i(){return $("<span/>")}function a(){return $('<input type="checkbox"/>')}function r(){return $("<ul/>")}function n(){return $("<li/>")}function o(){return $('<input type="button"/>')}function s(){return $("<select/>")}function l(){return $('<input type="text"/>')}function u(){return $("<img/>")}function c(){return $("<iframe/>")}e.div=t,e.span=i,e.checkbox=a,e.ul=r,e.li=n,e.button=o,e.select=s,e.textBox=l,e.img=u,e.iframe=c}(t=e.DomFactory||(e.DomFactory={}))}(InJs||(InJs={}));var jsCommon;!function(e){var t;!function(t){function i(e,t){if(0===t)return e;var i=a(e),o=r(i),u=l(o,t),c=s(u);return n(c)}function a(t){e.Utility.throwIfNullOrEmpty(t,"RgbColor","parse","rgbString"),e.Utility.throwIfNotTrue(7===t.length,"RgbColor","parse","rgbString");var i=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e.Utility.throwIfNullOrUndefined(i,"RgbColor","parse","rgbString"),{R:parseInt(i[1],16),G:parseInt(i[2],16),B:parseInt(i[3],16)}}function r(e){var t,i,a=e.R/255,r=e.G/255,n=e.B/255,o=Math.min(a,Math.min(r,n)),s=Math.max(a,Math.max(r,n)),l=s,u=s-o;return 0===s||0===u?(t=0,i=0):(t=u/s,i=a===s?(r-n)/u:r===s?2+(n-a)/u:4+(a-r)/u),i/=6,0>i&&(i+=1),{H:i,S:t,V:l}}function n(e){return"#"+o(e.R)+o(e.G)+o(e.B)}function o(e){var t=e.toString(16).toUpperCase();return 1===t.length?"0"+t:t}function s(e){var t,i,a,r=e.H,n=e.S,o=e.V;if(0===n)t=o,i=o,a=o;else{var s,l,u,c,h,d;switch(d=6*r,h=Math.floor(d),c=d-h,s=o*(1-n),l=o*(1-n*c),u=o*(1-n*(1-c)),h){case 0:t=o,i=u,a=s;break;case 1:t=l,i=o,a=s;break;case 2:t=s,i=o,a=u;break;case 3:t=s,i=l,a=o;break;case 4:t=u,i=s,a=o;break;case 5:t=o,i=s,a=l}}return{R:Math.floor(255*t),G:Math.floor(255*i),B:Math.floor(255*a)}}function l(e,t){var i=e.H+t;return{H:i>1?i-1:i,S:e.S,V:e.V}}function u(e,t){var i=Math.floor(t);return{R:Math.max(0,e.R-i),G:Math.max(0,e.G-i),B:Math.max(0,e.B-i)}}function c(e,t){return d(e.R,e.G,e.B,t)}function h(e){return"rgb("+e.R+","+e.G+","+e.B+")"}function d(e,t,i,a){return"rgba("+e+","+t+","+i+","+a+")"}function p(e){var t=/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/,i=t.exec(e);return i?f(i[1],i[2],i[3]):""}function g(e){var t=/^rgba\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3}),\s*(\d*(?:\.\d+)?)\)$/,i=t.exec(e);return i?f(i[1],i[2],i[3]):""}function f(e,t,i){var a=parseInt(e,10).toString(16),r=parseInt(t,10).toString(16),n=parseInt(i,10).toString(16);return"#"+(1===a.length?"0"+a:a)+(1===r.length?"0"+r:r)+(1===n.length?"0"+n:n)}t.rotate=i,t.parseRgb=a,t.rgbToHexString=n,t.darken=u,t.rgbWithAlphaString=c,t.rgbString=h,t.rgbaString=d,t.rgbStringToHexString=p,t.rgbaStringToHexString=g}(t=e.color||(e.color={}))}(jsCommon||(jsCommon={}));var jsCommon;!function(e){var t;!function(e){e.styleAttribute="style",e.pixelUnits="px",e.heightProperty="height",e.widthProperty="width",e.topProperty="top",e.bottomProperty="bottom",e.leftProperty="left",e.rightProperty="right",e.marginTopProperty="margin-top",e.marginLeftProperty="margin-left",e.displayProperty="display",e.backgroundProperty="background",e.backgroundColorProperty="background-color",e.backgroundRepeatProperty="background-repeat",e.backgroundSizeProperty="background-size",e.backgroundImageProperty="background-image",e.textShadowProperty="text-shadow",e.borderTopWidthProperty="border-top-width",e.borderBottomWidthProperty="border-bottom-width",e.borderLeftWidthProperty="border-left-width",e.borderRightWidthProperty="border-right-width",e.fontWeightProperty="font-weight",e.colorProperty="color",e.opacityProperty="opacity",e.paddingLeftProperty="padding-left",e.paddingRightProperty="padding-right",e.positionProperty="position",e.maxWidthProperty="max-width",e.minWidthProperty="min-width",e.overflowProperty="overflow",e.cursorProperty="cursor",e.visibilityProperty="visibility",e.absoluteValue="absolute",e.zeroPixelValue="0px",e.autoValue="auto",e.hiddenValue="hidden",e.noneValue="none",e.blockValue="block",e.inlineBlockValue="inline-block",e.transparentValue="transparent",e.boldValue="bold",e.visibleValue="visible",e.tableRowValue="table-row",e.coverValue="cover",e.pointerValue="pointer"}(t=e.CssConstants||(e.CssConstants={}))}(jsCommon||(jsCommon={}));var debug;!function(e){function t(e,t){e!==!0&&r(t||"condition: "+e)}function i(e,t){(null===e||void 0===e)&&r(t||"condition: "+e)}function a(e,t){}function r(t){(e.assertFailFunction||alert)("Debug Assert failed: "+t)}e.assertFailFunction,e.assert=t,e.assertValue=i,e.assertAnyValue=a,e.assertFail=r}(debug||(debug={}));var powerbi;!function(e){function t(e,t){return void 0!==e?e:t}var i;!function(e){function i(t){return t>=0?t<e.POSITIVE_POWERS.length?e.POSITIVE_POWERS[t]:1/0:(t=-t,t>0&&t<e.NEGATIVE_POWERS.length?e.NEGATIVE_POWERS[t]:0)}function a(t){if(t>1&&1e16>t)return 1e8>t?1e4>t?100>t?10>t?0:1:1e3>t?2:3:1e6>t?1e5>t?4:5:1e7>t?6:7:1e12>t?1e10>t?1e9>t?8:9:1e11>t?10:11:1e14>t?1e13>t?12:13:1e15>t?14:15;if(t>1e-16&&1>t)return 1e-8>t?1e-12>t?1e-14>t?1e-15>t?-16:-15:1e-13>t?-14:-13:1e-10>t?1e-11>t?-12:-11:1e-9>t?-10:-9:1e-4>t?1e-6>t?1e-7>t?-8:-7:1e-5>t?-6:-5:.01>t?.001>t?-4:-3:.1>t?-2:-1;var i=Math.log(t)/e.LOG_E_10;return e.floorWithPrecision(i)}function r(t,i){if(void 0===i&&(i=e.DEFAULT_PRECISION_IN_DECIMAL_DIGITS),!t)return void 0;var a=e.log10(Math.abs(t));if(a<e.MIN_EXP)return 0;var r=Math.max(a-i,-e.NEGATIVE_POWERS.length+1);return e.pow10(r)}function n(i,a,r){return r=t(r,e.DEFAULT_PRECISION),i===a||Math.abs(i-a)<r}function o(i,a,r){return r=t(r,e.DEFAULT_PRECISION),a>i&&Math.abs(i-a)>r}function s(i,a,r){return r=t(r,e.DEFAULT_PRECISION),a>i||Math.abs(i-a)<r}function l(i,a,r){return r=t(r,e.DEFAULT_PRECISION),i>a&&Math.abs(i-a)>r}function u(i,a,r){return r=t(r,e.DEFAULT_PRECISION),i>a||Math.abs(i-a)<r}function c(i,a){a=t(a,e.DEFAULT_PRECISION);var r=Math.round(i);return Math.abs(i-r)<a?r:Math.floor(i)}function h(i,a){a=t(a,e.DEFAULT_PRECISION);var r=Math.round(i);return Math.abs(i-r)<a?r:Math.ceil(i)}function d(i,a){return a=t(a,e.DEFAULT_PRECISION),0===a||0===i?i:Math.floor(i/a)*a}function p(i,a){return a=t(a,e.DEFAULT_PRECISION),0===a||0===i?i:Math.ceil(i/a)*a}function g(i,a){if(a=t(a,e.DEFAULT_PRECISION),0===a||0===i)return i;var r=Math.round(i/a)*a,n=Math.round(e.log10(Math.abs(i))-e.log10(a))+1;return n>0&&16>n&&(r=parseFloat(r.toPrecision(n))),r}function f(e,t,i){return void 0===e||null===e?e:t>e?t:e>i?i:e}function m(e){return.5+e<<0}function y(e,t,i,a,r){if(0===i||0===r)return e>=t&&t+i>=e?a:NaN;var n=(e-t)/i,o=a+n*r;return o}function v(e){return g(e,r(e))}function C(e){return null!==e&&e%1===0}e.MIN_VALUE=-Number.MAX_VALUE,e.MAX_VALUE=Number.MAX_VALUE,e.MIN_EXP=-308,e.MAX_EXP=308,e.EPSILON=1e-323,e.DEFAULT_PRECISION=1e-4,e.DEFAULT_PRECISION_IN_DECIMAL_DIGITS=12,e.LOG_E_10=Math.log(10),e.POSITIVE_POWERS=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13,1e14,1e15,1e16,1e17,1e18,1e19,1e20,1e21,1e22,1e23,1e24,1e25,1e26,1e27,1e28,1e29,1e30,1e31,1e32,1e33,1e34,1e35,1e36,1e37,1e38,1e39,1e40,1e41,1e42,1e43,1e44,1e45,1e46,1e47,1e48,1e49,1e50,1e51,1e52,1e53,1e54,1e55,1e56,1e57,1e58,1e59,1e60,1e61,1e62,1e63,1e64,1e65,1e66,1e67,1e68,1e69,1e70,1e71,1e72,1e73,1e74,1e75,1e76,1e77,1e78,1e79,1e80,1e81,1e82,1e83,1e84,1e85,1e86,1e87,1e88,1e89,1e90,1e91,1e92,1e93,1e94,1e95,1e96,1e97,1e98,1e99,1e100,1e101,1e102,1e103,1e104,1e105,1e106,1e107,1e108,1e109,1e110,1e111,1e112,1e113,1e114,1e115,1e116,1e117,1e118,1e119,1e120,1e121,1e122,1e123,1e124,1e125,1e126,1e127,1e128,1e129,1e130,1e131,1e132,1e133,1e134,1e135,1e136,1e137,1e138,1e139,1e140,1e141,1e142,1e143,1e144,1e145,1e146,1e147,1e148,1e149,1e150,1e151,1e152,1e153,1e154,1e155,1e156,1e157,1e158,1e159,1e160,1e161,1e162,1e163,1e164,1e165,1e166,1e167,1e168,1e169,1e170,1e171,1e172,1e173,1e174,1e175,1e176,1e177,1e178,1e179,1e180,1e181,1e182,1e183,1e184,1e185,1e186,1e187,1e188,1e189,1e190,1e191,1e192,1e193,1e194,1e195,1e196,1e197,1e198,1e199,1e200,1e201,1e202,1e203,1e204,1e205,1e206,1e207,1e208,1e209,1e210,1e211,1e212,1e213,1e214,1e215,1e216,1e217,1e218,1e219,1e220,1e221,1e222,1e223,1e224,1e225,1e226,1e227,1e228,1e229,1e230,1e231,1e232,1e233,1e234,1e235,1e236,1e237,1e238,1e239,1e240,1e241,1e242,1e243,1e244,1e245,1e246,1e247,1e248,1e249,1e250,1e251,1e252,1e253,1e254,1e255,1e256,1e257,1e258,1e259,1e260,1e261,1e262,1e263,1e264,1e265,1e266,1e267,1e268,1e269,1e270,1e271,1e272,1e273,1e274,1e275,1e276,1e277,1e278,1e279,1e280,1e281,1e282,1e283,1e284,1e285,1e286,1e287,1e288,1e289,1e290,1e291,1e292,1e293,1e294,1e295,1e296,1e297,1e298,1e299,1e300,1e301,1e302,1e303,1e304,1e305,1e306,1e307,1e308],e.NEGATIVE_POWERS=[1,.1,.01,.001,1e-4,1e-5,1e-6,1e-7,1e-8,1e-9,1e-10,1e-11,1e-12,1e-13,1e-14,1e-15,1e-16,1e-17,1e-18,1e-19,1e-20,1e-21,1e-22,1e-23,1e-24,1e-25,1e-26,1e-27,1e-28,1e-29,1e-30,1e-31,1e-32,1e-33,1e-34,1e-35,1e-36,1e-37,1e-38,1e-39,1e-40,1e-41,1e-42,1e-43,1e-44,1e-45,1e-46,1e-47,1e-48,1e-49,1e-50,1e-51,1e-52,1e-53,1e-54,1e-55,1e-56,1e-57,1e-58,1e-59,1e-60,1e-61,1e-62,1e-63,1e-64,1e-65,1e-66,1e-67,1e-68,1e-69,1e-70,1e-71,1e-72,1e-73,1e-74,1e-75,1e-76,1e-77,1e-78,1e-79,1e-80,1e-81,1e-82,1e-83,1e-84,1e-85,1e-86,1e-87,1e-88,1e-89,1e-90,1e-91,1e-92,1e-93,1e-94,1e-95,1e-96,1e-97,1e-98,1e-99,1e-100,1e-101,1e-102,1e-103,1e-104,1e-105,1e-106,1e-107,1e-108,1e-109,1e-110,1e-111,1e-112,1e-113,1e-114,1e-115,1e-116,1e-117,1e-118,1e-119,1e-120,1e-121,1e-122,1e-123,1e-124,1e-125,1e-126,1e-127,1e-128,1e-129,1e-130,1e-131,1e-132,1e-133,1e-134,1e-135,1e-136,1e-137,1e-138,1e-139,1e-140,1e-141,1e-142,1e-143,1e-144,1e-145,1e-146,1e-147,1e-148,1e-149,1e-150,1e-151,1e-152,1e-153,1e-154,1e-155,1e-156,1e-157,1e-158,1e-159,1e-160,1e-161,1e-162,1e-163,1e-164,1e-165,1e-166,1e-167,1e-168,1e-169,1e-170,1e-171,1e-172,1e-173,1e-174,1e-175,1e-176,1e-177,1e-178,1e-179,1e-180,1e-181,1e-182,1e-183,1e-184,1e-185,1e-186,1e-187,1e-188,1e-189,1e-190,1e-191,1e-192,1e-193,1e-194,1e-195,1e-196,1e-197,1e-198,1e-199,1e-200,1e-201,1e-202,1e-203,1e-204,1e-205,1e-206,1e-207,1e-208,1e-209,1e-210,1e-211,1e-212,1e-213,1e-214,1e-215,1e-216,1e-217,1e-218,1e-219,1e-220,1e-221,1e-222,1e-223,1e-224,1e-225,1e-226,1e-227,1e-228,1e-229,1e-230,1e-231,1e-232,1e-233,1e-234,1e-235,1e-236,1e-237,1e-238,1e-239,1e-240,1e-241,1e-242,1e-243,1e-244,1e-245,1e-246,1e-247,1e-248,1e-249,1e-250,1e-251,1e-252,1e-253,1e-254,1e-255,1e-256,1e-257,1e-258,1e-259,1e-260,1e-261,1e-262,1e-263,1e-264,1e-265,1e-266,1e-267,1e-268,1e-269,1e-270,1e-271,1e-272,1e-273,1e-274,1e-275,1e-276,1e-277,1e-278,1e-279,1e-280,1e-281,1e-282,1e-283,1e-284,1e-285,1e-286,1e-287,1e-288,1e-289,1e-290,1e-291,1e-292,1e-293,1e-294,1e-295,1e-296,1e-297,1e-298,1e-299,1e-300,1e-301,1e-302,1e-303,1e-304,1e-305,1e-306,1e-307,1e-308,1e-309,1e-310,1e-311,1e-312,1e-313,1e-314,1e-315,1e-316,1e-317,1e-318,1e-319,1e-320,1e-321,1e-322,1e-323,0],e.pow10=i,e.log10=a,e.getPrecision=r,e.equalWithPrecision=n,e.lessWithPrecision=o,e.lessOrEqualWithPrecision=s,e.greaterWithPrecision=l,e.greaterOrEqualWithPrecision=u,e.floorWithPrecision=c,e.ceilWithPrecision=h,e.floorToPrecision=d,e.ceilToPrecision=p,e.roundToPrecision=g,e.ensureInRange=f,e.round=m,e.project=y,e.removeDecimalNoise=v,e.isInteger=C}(i=e.Double||(e.Double={}))}(powerbi||(powerbi={}));var jsCommon;!function(e){function t(e){void 0===e&&(e=1);var t,i;try{throw new Error}catch(a){t=a.stack,null!=t&&(i=t.split("\n"),i.splice(1,e),t=i.join("\n"))}return t}var i;!function(e){function i(){return{name:"infoNavAppAlreadyPresent",message:"Cannot initialize embedded scenario when the InfoNav App is already present in this context",stack:c()}}function a(e){return{name:"invalidOperation",message:e,stack:c()}}function r(e,t){return{name:"invalidArgumentError",argument:e,message:t,stack:c()}}function n(e){return{name:"argumentNull",argument:e,message:"Argument was null",stack:c()}}function o(e){return{name:"argumentUndefined",argument:e,message:"Argument was undefined",stack:c()}}function s(e){return{name:"argumentOutOfRange",argument:e,message:"Argument was out of range",stack:c()}}function l(e,t){return{name:"pureVirtualMethodException",message:"This method must be overriden by the derived class:"+e+"."+t,stack:c()}}function u(e){return{name:"notImplementedException",message:e,stack:c()}}function c(){return t(2)}e.infoNavAppAlreadyPresent=i,e.invalidOperation=a,e.argument=r,e.argumentNull=n,e.argumentUndefined=o,e.argumentOutOfRange=s,e.pureVirtualMethodException=l,e.notImplementedException=u}(i=e.Errors||(e.Errors={})),e.getStackTrace=t}(jsCommon||(jsCommon={})),$.fn.multiline=function(e){return this.text(e),this.html(this.html().replace(/\n/g,"<br/>")),this},$.fn.togglePanelControl=function(){return this.each(function(){$(this).addClass("ui-accordion ui-accordion-icons ui-widget ui-helper-reset").find(".accordionHeader").addClass("ui-accordion-header ui-helper-reset ui-state-default ui-corner-top ui-corner-bottom").hover(function(){$(this).toggleClass("ui-state-hover")}).prepend('<span class="ui-icon ui-icon-triangle-1-e"></span>').click(function(){return $(this).toggleClass("ui-accordion-header-active ui-state-active ui-state-default ui-corner-bottom").find("> .ui-icon").toggleClass("ui-icon-triangle-1-e ui-icon-triangle-1-s").end().next().slideToggle(),!1}).next().addClass("ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom").hide()})};var jsCommon;!function(e){var t;!function(e){e.VisibleSelector=":visible"}(t=e.JQueryConstants||(e.JQueryConstants={}))}(jsCommon||(jsCommon={}));var jsCommon;!function(e){var t=function(){function t(t){e.Utility.throwIfNullOrUndefined(t,this,"constructor","factoryMethod"),this._factoryMethod=t}return t.prototype.getValue=function(){return null!==this._factoryMethod&&(this._value=this._factoryMethod(),this._factoryMethod=null),this._value},t}();e.Lazy=t}(jsCommon||(jsCommon={}));var powerbi;!function(e){var t;!function(e){function t(e,t){function i(){}i.prototype=e;var a=new i;return t&&t(a),a}function i(e,i){if(e){for(var a,r=0,n=e.length;n>r;r++){var o=i(e[r]);o&&(a||(a=t(e)),a[r]=o)}return a}}e.inherit=t,e.overrideArray=i}(t=e.Prototype||(e.Prototype={}))}(powerbi||(powerbi={}));var jsCommon;!function(e){var t;!function(e){function t(e,t,i){switch(t){case"m":t="M";break;case"O":case"o":t="yyyy'-'MM'-'dd'T'HH':'mm':'ss'.'fff'0000'";break;case"R":case"r":e=new Date(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds()),t="ddd, dd MMM yyyy HH':'mm':'ss 'GMT'";break;case"s":t="S";break;case"u":e=new Date(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds()),t="yyyy'-'MM'-'dd HH':'mm':'ss'Z'";break;case"U":e=new Date(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds()),t="F";break;case"y":case"Y":switch(i){case"default":case"en":case"en-US":t="MMMM, yyyy";break;default:t="Y"}}return{value:e,format:t}}function i(e){if(e=e.replace(/%K/g,"zzz"),e=e.replace(/K/g,"zzz"),e=e.replace(/fffffff/g,"fff0000"),e=e.replace(/ffffff/g,"fff000"),e=e.replace(/fffff/g,"fff00"),e=e.replace(/ffff/g,"fff0"),e=e.replace(/yyyyy/g,"0yyyy"),e=e.replace(/(^y|^)yyy(^y|$)/g,"yyyy"),a||(a=["d","f","F","g","h","H","K","m","M","s","t","y","z",":","/"].map(function(e){return{r:new RegExp("%"+e+"(?!"+e+")","g"),s:e}})),-1!==e.indexOf("%")&&e.length>2)for(var t=0;t<a.length;t++)e=e.replace(a[t].r,a[t].s);return e}var a;e.findDateFormat=t,e.fixDateTimeFormat=i}(t=e.Formatting||(e.Formatting={}))}(jsCommon||(jsCommon={}));var jsCommon;!function(e){function t(e,t){void 0===t&&(t=function(){}),i(e.cssFiles||[]);var r=e.javaScriptFilesWithCallback||[];if(e.javaScriptFiles)for(var n=0,o=e.javaScriptFiles.length;o>n;++n)r.push({javascriptFile:e.javaScriptFiles[n]});a(r,t)}function i(e){e.forEach(function(e){-1===b.indexOf(e)&&(b.push(e),r(e))})}function a(e,t){function i(){--r||u(e,s)}function a(){--o||t()}var r=e.length,o=r,s=[];e.forEach(function(e,t){var r=e.javascriptFile;-1===x.indexOf(r)?r in S?S[r].push(function(){i(),a();
}):(S[r]=[function(){a()}],h(r)?(s[t]=e,i()):n(r,function(e){s[t]={javascriptFile:e},i()})):(i(),a())})}function r(e){var t=v.cloneNode();t.href=e,y?m.insertBefore(t,y):m.appendChild(t)}function n(e,t){c(e,function(){t(this.responseText)})}function o(e,t){if(void 0===t&&(t=function(){}),!e)return void t();var i=e.javascriptFile,a=t;if(e.onLoadCallback){var r=function(){e.onLoadCallback().then(t)};a=r}h(i)?l(i,a):s(i,a)}function s(e,t){void 0===t&&(t=function(){});var i;e&&(i=C.cloneNode(),i.setAttribute("type","text/javascript"),i.innerHTML=e,m.appendChild(i)),setTimeout(t,0)}function l(e,t){var i;e&&(i=C.cloneNode(),i.setAttribute("src",e),i.setAttribute("charset","utf-8"),i.onload=t,m.appendChild(i))}function u(e,t){g(t,o,function(){e.forEach(function(e){var t=e.javascriptFile,i=S[t];i&&i.forEach(function(e){e()}),delete S[t],-1===x.indexOf(t)&&x.push(t)})})}function c(e,t,i){var a=new XMLHttpRequest;try{a.open("GET",e,!0),a.onload=t,a.onerror=i,a.send(null)}catch(r){}}function h(e){var t=location.protocol+"//"+location.host+"/";return/^http[s]?:\/\/.+/i.test(e)&&0!==e.indexOf(t)}function d(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t]}function p(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t];if(0!==e.length){for(var i=[],a=e.length;a--;)!function(t){i[t]=function(){e[t](i[t+1]||d)}}(a);i[0]()}}function g(e,t,i){for(var a=[],r=0,n=e.length;n-1>r;r++)!function(i){a[i]=function(a){t(e[i],a)}}(r);a[n-1]=function(a){t(e[n-1],i)},p.apply(null,a)}var f=document,m=f.head,y=m.getElementsByTagName("script")[0],v=f.createElement("link"),C=f.createElement("script"),b=[],x=[],S=[];v.setAttribute("rel","stylesheet"),e.requires=t}(jsCommon||(jsCommon={}));var powerbi;!function(e){function t(){return new i}e.createJQueryPromiseFactory=t;var i=function(){function e(){}return e.prototype.defer=function(){return new a($.Deferred())},e.prototype.reject=function(e){var t=this.defer();return t.reject(e),t.promise},e.prototype.resolve=function(e){var t=this.defer();return t.resolve(e),t.promise},e}(),a=function(){function e(e){this.deferred=e,this.promise=new r(e.promise())}return e.prototype.resolve=function(e){this.deferred.resolve(e)},e.prototype.reject=function(e){this.deferred.reject(e)},e}(),r=function(){function e(e){this.promise=e}return e.prototype.then=function(t,i){return new e(this.promise.then(e.wrapCallback(t),e.wrapCallback(i)))},e.prototype["catch"]=function(e){return this.then(null,e)},e.prototype["finally"]=function(t){return this.promise.always(e.wrapCallback(t)),this},e.wrapCallback=function(t){return t?function(i){var a=t(i);return a instanceof e?a.promise:a}:t},e}()}(powerbi||(powerbi={}));var powerbi;!function(e){var t=function(){function e(){}return e.prototype.getData=function(e){try{if(localStorage)return JSON.parse(localStorage[e])}catch(t){}return null},e.prototype.setData=function(e,t){try{localStorage&&(localStorage[e]=JSON.stringify(t))}catch(i){}},e}();e.localStorageService=new t}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){function t(){h||(h=$("<span/>"),$("body").append(h),d=d3.select($("body").get(0)).append("svg").style({height:"0px",width:"0px",position:"absolute"}).append("text"),p=$("<canvas/>").get(0).getContext("2d"))}function i(e){t(),h.removeAttr("style").empty().css("visibility","hidden"),h.text(e.text).css({fontFamily:e.fontFamily,fontSize:e.fontSize,fontWeight:e.fontWeight,fontStyle:e.fontStyle,whiteSpace:e.whiteSpace||"nowrap"});var i=parseInt(getComputedStyle(h[0]).width,10);return i}function a(e){return t(),p.font=e.fontSize+" "+e.fontFamily,p.measureText(e.text).width}function r(e){return t(),d.style(null),d.text(e.text).attr({visibility:"hidden","font-family":e.fontFamily,"font-size":e.fontSize,"font-weight":e.fontWeight,"font-style":e.fontStyle,"white-space":e.whiteSpace||"nowrap"}),d.node().getBBox().height}function n(e){return a(s(e))}function o(e){return{text:e.val()||e.text(),fontFamily:e.css("font-family"),fontSize:e.css("font-size"),fontWeight:e.css("font-weight"),fontStyle:e.css("font-style"),whiteSpace:e.css("white-space")}}function s(e){var t=window.getComputedStyle(e,null);return{text:e.textContent,fontFamily:t.fontFamily,fontSize:t.fontSize,fontWeight:t.fontWeight,fontStyle:t.fontStyle,whiteSpace:t.whiteSpace}}function l(e){return getComputedStyle(e[0]).width}function u(e,i){t();var r="...",n=e.text.length;if(0===n)return e.text;var o=a(e);if(i>o)return e.text;for(var s=e.text=r+e.text,l=1,u=s.length,c=3;u>=l;)if(c=(l+u)/2|0,e.text=s.substr(0,c),o=a(e),i>o)l=c+1;else{if(!(o>i))break;u=c-1}return e.text=s.substr(0,c),o=a(e),o>i&&c--,s.substr(3,c-3)+r}function c(e,t){var i=s(e),a=i.text,r=u(i,t);a!==r&&(e.textContent=r)}var h,d,p;e.measureTextWidth=i,e.measureSvgTextWidth=a,e.measureSvgTextHeight=r,e.measureSvgTextElementWidth=n,e.getMeasurementProperties=o,e.getSvgMeasurementProperties=s,e.getDivElementWidth=l,e.getTailoredTextOrDefault=u,e.svgEllipsis=c}(t=e.TextMeasurementService||(e.TextMeasurementService={}))}(powerbi||(powerbi={}));var jsCommon;!function(e){var t=function(){function t(t){this.timerFactory=e.TimerPromiseFactory.instance,this.delay=0,t&&(this.delay=t)}return t.prototype.run=function(e){var t=this;this.fn?this.fn=e:(this.fn=e,this.timerFactory.create(this.delay).done(function(){return t.timerComplete(t.fn)}))},t.prototype.timerComplete=function(e){e(),this.fn=null},t}();e.ThrottleUtility=t}(jsCommon||(jsCommon={}));var jsCommon;!function(e){var t=function(){function e(){}return e.prototype.create=function(e){var t=$.Deferred();return window.setTimeout(function(){return t.resolve()},e),t},e.instance=new e,e}();e.TimerPromiseFactory=t}(jsCommon||(jsCommon={}));var jsCommon;!function(e){!function(e){e[e.OK=200]="OK",e[e.BadRequest=400]="BadRequest",e[e.Unauthorized=401]="Unauthorized",e[e.Forbidden=403]="Forbidden",e[e.RequestEntityTooLarge=413]="RequestEntityTooLarge"}(e.HttpStatusCode||(e.HttpStatusCode={}));var t;e.HttpStatusCode;!function(e){e.ApplicationOctetStream="application/octet-stream",e.MultiPartFormData="multipart/form-data"}(t=e.HttpConstants||(e.HttpConstants={}));var i;!function(e){function t(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t];var i=e[0];if(s(i))return i;for(var a=0;a<e.length-1;a++){var r=new RegExp("\\{"+a+"\\}","gm");i=i.replace(r,e[a+1])}return i}function i(t,i){return e.normalizeCase(t)===e.normalizeCase(i)}function r(t,i){var a=e.normalizeCase(i);return 0===e.normalizeCase(t).indexOf(a)}function n(t){return a.throwIfNullOrUndefined(t,e,"normalizeCase","value"),t.toUpperCase()}function o(e){return null==e||0===e.length}function s(t){return e.isNullOrEmpty(t)||e.isNullOrEmpty(t.trim())}function l(e){a.throwIfNullOrUndefined(e,this,"containsWhitespace","str");var t=/\s/;return t.test(e)}function u(e){return a.throwIfNullOrUndefined(e,this,"isWhitespace","str"),""===e.trim()}function c(e){return a.throwIfNullOrUndefined(e,this,"trimTrailingWhitespace","str"),e.replace(/\s+$/,"")}function h(e){return a.throwIfNullOrUndefined(e,this,"trimWhitespace","str"),e.replace(/^\s+/,"").replace(/\s+$/,"")}function d(e,t){return a.throwIfNullOrUndefined(e,this,"getLengthDifference","left"),a.throwIfNullOrUndefined(t,this,"getLengthDifference","right"),Math.abs(e.length-t.length)}function p(e,t){for(var i="",a=0;t>a;a++)i+=e;return i}function g(e,t,i){if(!t)return e;var a=t.replace(/([-()\[\]{}+?*.$\^|,:#<!\\])/g,"\\$1");return e.replace(new RegExp(a,"g"),i)}function f(e,t){for(var i=0,a=t;e[a];)a=t+ ++i;return a}function m(t,i,a){if(!t||0===t.length)return"";(null===a||void 0===a)&&(a=Number.MAX_VALUE);for(var r=Math.min(a,t.length),n=[],o=0;2>o;o++)for(var s="{"+o+"}",l="_|_<"+o+">_|_",u=0;r>u;u++)t[u].indexOf(s)>-1&&(t[u]=t[u].replace(s,l),n.push({targetValue:s,replaceValue:l}));for(var c="",u=0;r>u;u++)c=0===u?t[u]:e.format(i.get("FilterRestatement_Comma"),c,t[u]);for(var u=0;u<n.length;u++)c=c.replace(n[u].replaceValue,n[u].targetValue);return c}e.format=t,e.equalIgnoreCase=i,e.startsWithIgnoreCase=r,e.normalizeCase=n,e.isNullOrEmpty=o,e.isNullOrUndefinedOrWhiteSpaceString=s,e.containsWhitespace=l,e.isWhitespace=u,e.trimTrailingWhitespace=c,e.trimWhitespace=h,e.getLengthDifference=d,e.repeat=p,e.replaceAll=g,e.findUniqueName=f,e.constructCommaSeparatedList=m}(i=e.StringExtensions||(e.StringExtensions={}));var a=function(){function a(){}return a.throwIfNullOrUndefined=function(t,i,r,n){null===t?a.throwException(e.Errors.argumentNull(a.getComponentName(i)+r+"."+n)):typeof t===a.Undefined&&a.throwException(e.Errors.argumentUndefined(a.getComponentName(i)+r+"."+n))},a.throwIfNullOrEmpty=function(t,i,r,n){a.throwIfNullOrUndefined(t,i,r,n),t.length||a.throwException(e.Errors.argumentOutOfRange(a.getComponentName(i)+r+"."+n))},a.throwIfNullOrEmptyString=function(t,i,r,n){a.throwIfNullOrUndefined(t,i,r,n),t.length<1&&a.throwException(e.Errors.argumentOutOfRange(a.getComponentName(i)+r+"."+n))},a.throwIfNullEmptyOrWhitespaceString=function(t,r,n,o){a.throwIfNullOrUndefined(t,r,n,o),i.isNullOrUndefinedOrWhiteSpaceString(t)&&a.throwException(e.Errors.argumentOutOfRange(a.getComponentName(r)+n+"."+o))},a.throwIfNotTrue=function(t,i,r,n){t||a.throwException(e.Errors.argument(n,a.getComponentName(i)+r+"."+n))},a.isString=function(e){return"string"==typeof e},a.isBoolean=function(e){return"boolean"==typeof e},a.isNumber=function(e){return"number"==typeof e},a.isDate=function(e){return a.isObject(e)&&e instanceof Date},a.isObject=function(e){return null!=e&&"object"==typeof e},a.isNullOrUndefined=function(e){return null===e||typeof e===a.Undefined},a.urlCombine=function(e,t){if(a.throwIfNullOrUndefined(e,null,"urlCombine","baseUrl"),a.throwIfNullOrUndefined(t,null,"urlCombine","path"),i.isNullOrUndefinedOrWhiteSpaceString(t))return e;if(i.isNullOrUndefinedOrWhiteSpaceString(e))return t;var r=e;return"/"===r.charAt(r.length-1)?"/"===t.charAt(0)&&(t=t.slice(1)):"/"!==t.charAt(0)&&(t="/"+t),r+t},a.getAbsoluteUri=function(e){a.throwIfNullOrUndefined(e,null,"getAbsoluteUri","path");var t=e;return t&&-1===t.indexOf("http")&&(t=a.urlCombine(clusterUri,t)),t},a.getStaticResourceUri=function(t){a.throwIfNullOrUndefined(t,null,"getStaticResourceUri","path");var i=t;return i&&-1===i.indexOf("http")&&(i=e.Utility.urlCombine(a.staticContentLocation,i)),i},a.getComponentName=function(e){return e?(typeof e).toString()+".":""},a.throwException=function(t){throw e.Trace.error(i.format("Throwing exception: {0}",JSON.stringify(t)),null!=t.stack?!1:!0),t},a.createClassSelector=function(e){return a.throwIfNullOrEmptyString(e,null,"CreateClassSelector","className"),"."+e},a.createIdSelector=function(e){return a.throwIfNullOrEmptyString(e,null,"CreateIdSelector","id"),"#"+e},a.generateGuid=function(){var e="",t=0;for(t=0;32>t;t+=1){var i=16*Math.random()|0;switch(t){case 8:case 12:case 16:case 20:e+="-"}e+=i.toString(16)}return e},a.generateConnectionGroupName=function(){for(var e="",t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",i=0;7>i;i++)e+=t.charAt(Math.floor(Math.random()*t.length));return e},a.getCookieValue=function(e){for(var t=document.cookie.split(";"),i=0;i<t.length;i++){var a=t[i],r=a.split("=");if(r.length>0&&r[0].trim()===e)return a.substr(a.indexOf("=")+1)}return null},a.getDomainForUrl=function(e){var t=a.getHrefObjectFromUrl(e);return t.prop("protocol")+"//"+t.prop("hostname")},a.getHostNameForUrl=function(e){var t=a.getHrefObjectFromUrl(e);return a.urlCombine(t.prop("hostname"),t.prop("pathname"))},a.getUrlWithoutQueryString=function(e){var t=a.getHrefObjectFromUrl(e);return t.prop("protocol")+"//"+a.urlCombine(t.prop("host"),t.prop("pathname"))},a.getProtocolFromUrl=function(e){return a.getHrefObjectFromUrl(e).prop("protocol").replace(":","")},a.getHrefObjectFromUrl=function(e){var t=$("<a>");return t=t.prop("href",e)},a.convertWcfToJsDictionary=function(e){for(var t={},i=0;i<e.length;i++){var a=e[i];t[a.Key]=a.Value}return t},a.getDateFromWcfJsonString=function(e,t){if(i.isNullOrEmpty(e))return null;var a=e.indexOf("("),r=e.indexOf(")");if(-1!==a&&-1!==r){var n=parseInt(e.substring(a+1,r),10);if(t)return new Date(n);var o=new Date(0);return o.setUTCMilliseconds(n),o}return null},a.getOuterHtml=function(e){return $("<div>").append(e).html()},a.compareInt=function(e,t){return e-t},a.getIndexOfMinValue=function(e){for(var t=0,i=e[0],a=0;a<e.length;a++)e[a]<i&&(i=e[a],t=a);return t},a.isValidUrl=function(e){return!i.isNullOrEmpty(e)&&(i.startsWithIgnoreCase(e,"http://")||i.startsWithIgnoreCase(e,"https://"))},a.extractUrlFromCssBackgroundImage=function(e){return e.replace(/"/g,"").replace(/url\(|\)$/gi,"")},a.isValidImageDataUrl=function(e){var t=new RegExp("data:(image/(png|jpg|jpeg|gif|svg))");return t.test(e)},a.saveAsFile=function(e,i){var a=new Blob([e],{type:t.ApplicationOctetStream}),r=window.webkitURL||URL,n=r.createObjectURL(a),o=i||n;if(window.navigator.msSaveOrOpenBlob)return void window.navigator.msSaveOrOpenBlob(a,o);var s=document.createElement("a");s.href=n,s.target="_blank",s.download=o,document.body.appendChild(s),s.click(),document.body.removeChild(s)},a.getType=function(t){a.throwIfNullEmptyOrWhitespaceString(t.__type,this,"getType","obj");var i=t.__type.split(":");return 2!==i.length&&e.Errors.argument("obj.__type","Type String not in expected format [Type]#[Namespace]: "+t.__type),i[1]!==a.TypeNamespace&&e.Errors.argument("obj.__type","Type Namespace not expected: "+i[1]),i[0]},a.isEventSupported=function(e,t){e="on"+e;var i=e in t;return i||(t.setAttribute||(t=document.createElement("div")),t.setAttribute&&t.removeAttribute&&(t.setAttribute(e,""),i="function"==typeof t[e],"undefined"!=typeof t[e]&&(t[e]=null),t.removeAttribute(e))),t=null,i},a.toPixel=function(t){return a.throwIfNullOrUndefined(t,this,"toPixel","pixelAmount"),t.toString()+e.CssConstants.pixelUnits},a.getPropertyCount=function(e){return a.throwIfNullOrUndefined(e,this,"getPropertyCount","object"),Object.getOwnPropertyNames(e).length},a.getFileExtension=function(e){if(e){var t=e.lastIndexOf(".");if(t>=0)return e.substr(t+1)}return""},a.extractFileNameFromPath=function(e){return e.replace(/^.*[\\\/]/,"")},a.canUseClipboard=function(){return"undefined"==typeof MSApp},a.is64BitOperatingSystem=function(){return-1!==navigator.userAgent.indexOf("WOW64")||-1!==navigator.userAgent.indexOf("Win64")},a.parseNumber=function(e,t){if(null===e)return null;if(void 0===e)return t;var i=Number(e);return isFinite(i)?i:isNaN(i)&&"number"!=typeof e&&"NaN"!==e?t:i},a.getURLParamValue=function(e){var t=new RegExp("[?&]"+e+"=([^&#]*)").exec(window.location.href);return null==t?null:t[1]||0},a.getLocalTimeZoneString=function(){var e,t=new Date(Date.UTC(2005,6,30,0,0,0,0)),i=-1*t.getTimezoneOffset(),a=new Date(Date.UTC(2005,12,30,0,0,0,0)),r=-1*a.getTimezoneOffset();return e=-720===i&&-720===r?"Dateline Standard Time":-660===i&&-660===r?"UTC-11":-660===i&&-660===r?"Samoa Standard Time":-600===i&&-600===r?"Hawaiian Standard Time":-480===i&&-540===r?"Alaskan Standard Time":-420===i&&-480===r?"Pacific Standard Time":-420===i&&-420===r?"US Mountain Standard Time":-360===i&&-420===r?"Mountain Standard Time":-360===i&&-360===r?"Central America Standard Time":-300===i&&-360===r?"Central Standard Time":-300===i&&-300===r?"SA Pacific Standard Time":-240===i&&-300===r?"Eastern Standard Time":-270===i&&-270===r?"Venezuela Standard Time":-240===i&&-240===r?"SA Western Standard Time":-240===i&&-180===r?"Central Brazilian Standard Time":-180===i&&-240===r?"Atlantic Standard Time":-180===i&&-180===r?"Montevideo Standard Time":-180===i&&-120===r?"E. South America Standard Time":-150===i&&-210===r?"Mid-Atlantic Standard Time":-120===i&&-120===r?"SA Eastern Standard Time":0===i&&0===r?"UTC":60===i&&0===r?"GMT Standard Time":60===i&&120===r?"Namibia Standard Time":120===i&&60===r?"Romance Standard Time":120===i&&120===r?"South Africa Standard Time":180===i&&120===r?"GTB Standard Time":180===i&&180===r?"E. Africa Standard Time":240===i&&180===r?"Russian Standard Time":240===i&&240===r?"Arabian Standard Time":270===i&&210===r?"Iran Standard Time":270===i&&270===r?"Afghanistan Standard Time":300===i&&240===r?"Pakistan Standard Time":300===i&&300===r?"West Asia Standard Time":330===i&&330===r?"India Standard Time":345===i&&345===r?"Nepal Standard Time":360===i&&300===r?"N. Central Asia Standard Time":360===i&&360===r?"Central Asia Standard Time":390===i&&390===r?"Myanmar Standard Time":420===i&&360===r?"North Asia Standard Time":420===i&&420===r?"SE Asia Standard Time":480===i&&420===r?"North Asia East Standard Time":480===i&&480===r?"China Standard Time":540===i&&480===r?"Yakutsk Standard Time":540===i&&540===r?"Tokyo Standard Time":570===i&&570===r?"Cen. Australia Standard Time":600===i&&600===r?"E. Australia Standard Time":600===i&&660===r?"AUS Eastern Standard Time":660===i&&600===r?"Tasmania Standard Time":660===i&&660===r?"West Pacific Standard Time":690===i&&690===r?"Central Pacific Standard Time":720===i&&660===r?"Magadan Standard Time":720===i&&720===r?"Fiji Standard Time":720===i&&780===r?"New Zealand Standard Time":780===i&&780===r?"Tonga Standard Time":"UTC"},a.TypeNamespace="http://schemas.microsoft.com/sqlbi/2013/01/NLRuntimeService",a.JsonContentType="application/json",a.JpegContentType="image/jpeg",a.XJavascriptContentType="application/x-javascript",a.JsonDataType="json",a.BlobDataType="blob",a.HttpGetMethod="GET",a.HttpPostMethod="POST",a.HttpPutMethod="PUT",a.HttpDeleteMethod="DELETE",a.HttpContentTypeHeader="Content-Type",a.HttpAcceptHeader="Accept",a.Undefined="undefined",a.staticContentLocation=window.location.protocol+"//"+window.location.host,a}();e.Utility=a;var r=function(){function e(){}return e.compareVersions=function(e,t){for(var i=e.split(".").map(parseFloat),a=t.split(".").map(parseFloat),r=Math.max(i.length,a.length),n=0;r>n;n++){var o=i[n]||0,s=a[n]||0;if(o>s)return 1;if(s>o)return-1}return 0},e}();e.VersionUtility=r;var n;!function(e){function t(e){return new i(e)}var i=function(){function e(t){this._name=t,this._start=e.begin(t)}return e.begin=function(e){return void 0!==window.performance&&void 0!==performance.mark?(console.time,e="Begin "+e,performance.mark(e),e):void 0},e.prototype.end=function(){if(void 0!==window.performance&&void 0!==performance.mark&&void 0!==performance.measure){var e=this._name,t="End "+e;performance.mark(t),performance.measure(e,this._start,t),console.timeEnd}},e}();e.PerfMarker=i,e.create=t}(n=e.PerformanceUtil||(e.PerformanceUtil={}));var o;!function(e){function t(e){var t,i,a;return window.requestAnimationFrame||(window.requestAnimationFrame=function(e){return setTimeout(e,20)}),function(){t||(t=!0,i=arguments,a=this,window.requestAnimationFrame(function(){t=!1,e.apply(a,i)}))}}e.deferUntilNextFrame=t}(o=e.DeferUtility||(e.DeferUtility={}))}(jsCommon||(jsCommon={}));var jsCommon;!function(e){var t=function(){function t(e,t,i,a){this.text=e,this.type=t,this.sessionId=i,this.requestId=a,this.timeStamp=new Date}return t.prototype.toString=function(){var i="";return i+=e.StringExtensions.format("{0} ({1}): {2}",t.traceTypeStrings[this.type],this.timeStamp.toUTCString(),this.text),this.requestId&&(i+="\n(Request id: "+this.requestId+")"),i},t.traceTypeStrings=["INFORMATION","VERBOSE","WARNING","ERROR","EXPECTEDERROR","UNEXPECTEDERROR","FATAL"],t}();e.TraceItem=t}(jsCommon||(jsCommon={}));var jsCommon;!function(e){var t;!function(e){function t(e,t){return(e&t)===t}function i(e,t){return e[t]}e.hasFlag=t,e.toString=i}(t=e.EnumExtensions||(e.EnumExtensions={}));var i;!function(e){function t(e,t){return-1!==e.indexOf(t,e.length-t.length)}e.endsWith=t}(i=e.StringExtensions||(e.StringExtensions={}));var a;!function(e){function t(e,t){return(e||t)&&!(e&&t)}e.XOR=t}(a=e.LogicExtensions||(e.LogicExtensions={}));var r;!function(e){function t(e,t){return e===t?!0:JSON.stringify(e)===JSON.stringify(t)}e.equals=t}(r=e.JsonComparer||(e.JsonComparer={}))}(jsCommon||(jsCommon={}));var jsCommon;!function(e){var t=function(){function e(){}return e.prototype.logTrace=function(e){},e}();e.ConsoleTracer=t;var i;!function(i){function a(t,i){p(new e.TraceItem(t,e.TraceType.Warning,i))}function r(t,i,a){i&&(t=e.StringExtensions.format("{0}.\nStack:\n{1}",t,e.getStackTrace())),p(new e.TraceItem(t,e.TraceType.Error,a))}function n(t,i){p(new e.TraceItem(t,e.TraceType.Verbose,i))}function o(e){v.push(e)}function s(e){var t=v.indexOf(e);t>=0&&v.splice(t,1)}function l(){v=new Array(y)}function u(){m=-1}function c(){if(!(0>m)){for(var e=new Array(m+1),t=0;m>=t;t++)e[t]=f[t];return e}}function h(){s(y)}function d(){o(y)}function p(e){m+1>=g&&u(),f[++m]=e;for(var t=0,i=v.length;i>t;t++)v[t].logTrace(e)}var g=1e3,f=new Array(g),m=-1,y=new t,v=new Array(y);i.warning=a,i.error=r,i.verbose=n,i.addListener=o,i.removeListener=s,i.resetListeners=l,i.reset=u,i.getTraces=c,i.disableDefaultListener=h,i.enableDefaultListener=d}(i=e.Trace||(e.Trace={}))}(jsCommon||(jsCommon={}));var jsCommon;!function(e){!function(e){e[e.Information=0]="Information",e[e.Verbose=1]="Verbose",e[e.Warning=2]="Warning",e[e.Error=3]="Error",e[e.ExpectedError=4]="ExpectedError",e[e.UnexpectedError=5]="UnexpectedError",e[e.Fatal=6]="Fatal"}(e.TraceType||(e.TraceType={}));e.TraceType}(jsCommon||(jsCommon={}));var jsCommon;!function(e){function t(t){void 0===t&&(t=function(){}),e.requires(l,t)}function i(t){e.requires(u,t)}function a(){o=!0,s&&(s.resolve(),s=void 0)}function r(){var e;return o?(e=$.Deferred(),e.resolve()):e=s=$.Deferred(),e.promise()}var n="https://ecn.dev.virtualearth.net/mapcontrol/mapcontrol.ashx?v=7.0&s=1&onscriptload=globalMapControlLoaded",o=!1,s=null,l={javaScriptFiles:[powerbi.build+"/externals/pv/webclient.js"],cssFiles:[powerbi.build+"/externals/pv/Styles/_all.css"],javaScriptFilesWithCallback:[{javascriptFile:n,onLoadCallback:r}]};e.ensurePowerView=t;var u={javaScriptFilesWithCallback:[{javascriptFile:n,onLoadCallback:r}]};e.ensureMap=i,e.mapControlLoaded=a,e.waitForMapControlLoaded=r}(jsCommon||(jsCommon={}));var globalMapControlLoaded=function(){jsCommon.mapControlLoaded()},jsCommon;!function(e){var t;!function(e){function t(e,t){for(var i=[],a=e.length-1;a>=0;--a)-1!==t.indexOf(e[a])&&i.push(e[a]);return i}function i(e,t){for(var i=[],a=e.length-1;a>=0;--a){var r=e[a];-1===t.indexOf(r)&&i.push(r)}return i}function a(e){for(var t=[],i=0,a=e.length;a>i;i++){var r=e[i];-1===t.indexOf(r)&&t.push(r)}return t}function r(e,t){for(var i=0,a=t.length;a>i;++i)n(e,t[i])}function n(e,t){e.indexOf(t)<0&&e.push(t)}function o(e,t,i){for(var a=[],r=t;i>=r;++r)a.push(e[r]);return a}function s(e,t){for(var i=[],a=0;t>a;++a)i.push(e[a]);return i}function l(e){return s(e,e.length)}function u(e,t,i){if(e===t)return!0;if(!!e!=!!t)return!1;var a=e.length;if(a!==t.length)return!1;for(var r=0;a>r&&i(e[r],t[r]);)++r;return r===a}function c(e){return e&&0===e.length?null:e}function h(e,t){for(var i=0,a=e.length;a>i;++i)if(t(e[i]))return i;return-1}function d(e,t){if(0===t)return e.slice();var i=e.slice(t);return Array.prototype.push.apply(i,e.slice(0,t)),i}function p(){return g([])}function g(e){var t=e;return t.withId=m,t}function f(e,t){for(var i=0,a=e.length;a>i;i++){var r=e[i];if(r.id===t)return r}}function m(t){return e.findWithId(this,t)}function y(){return v([])}function v(e){var t=e;return t.withName=x,t}function C(e,t){var i=b(e,t);return i>=0?e[i]:void 0}function b(e,t){for(var i=0,a=e.length;a>i;i++){var r=e[i];if(r.name===t)return i}return-1}function x(e){var t=this;return C(t,e)}function S(e){e.length=0}function w(e){return e&&0!==e.length?!1:!0}function _(e){return"[object Array]"===Object.prototype.toString.call(e)}e.intersect=t,e.diff=i,e.distinct=a,e.union=r,e.unionSingle=n,e.range=o,e.take=s,e.copy=l,e.sequenceEqual=u,e.emptyToNull=c,e.indexOf=h,e.rotate=d,e.createWithId=p,e.extendWithId=g,e.findWithId=f,e.createWithName=y,e.extendWithName=v,e.findItemWithName=C,e.indexWithName=b,e.clear=S,e.isUndefinedOrEmpty=w,e.isArray=_}(t=e.ArrayExtensions||(e.ArrayExtensions={}))}(jsCommon||(jsCommon={}));var InJs;!function(e){!function(e){e[e.information=0]="information",e[e.verbose=1]="verbose",e[e.warning=2]="warning",e[e.error=3]="error",e[e.expectedError=4]="expectedError",e[e.unexpectedError=5]="unexpectedError",e[e.fatal=6]="fatal"}(e.TraceType||(e.TraceType={}));e.TraceType}(InJs||(InJs={}));var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a]);i.prototype=t.prototype,e.prototype=new i},powerbi;!function(e){var t;!function(e){var t=function(){function e(){}return e.prototype.visitEntity=function(e,t){return this.visitDefault(e,t)},e.prototype.visitColumnRef=function(e,t){return this.visitDefault(e,t)},e.prototype.visitMeasureRef=function(e,t){return this.visitDefault(e,t)},e.prototype.visitAggr=function(e,t){return this.visitDefault(e,t)},e.prototype.visitBetween=function(e,t){return this.visitDefault(e,t)},e.prototype.visitIn=function(e,t){return this.visitDefault(e,t)},e.prototype.visitAnd=function(e,t){return this.visitDefault(e,t)},e.prototype.visitOr=function(e,t){return this.visitDefault(e,t)},e.prototype.visitCompare=function(e,t){return this.visitDefault(e,t)},e.prototype.visitContains=function(e,t){return this.visitDefault(e,t)},e.prototype.visitExists=function(e,t){return this.visitDefault(e,t)},e.prototype.visitNot=function(e,t){return this.visitDefault(e,t)},e.prototype.visitStartsWith=function(e,t){return this.visitDefault(e,t)},e.prototype.visitConstant=function(e,t){return this.visitDefault(e,t)},e.prototype.visitDateSpan=function(e,t){return this.visitDefault(e,t)},e.prototype.visitDateAdd=function(e,t){return this.visitDefault(e,t)},e.prototype.visitNow=function(e,t){return this.visitDefault(e,t)},e.prototype.visitDefault=function(e,t){},e}();e.DefaultSQExprVisitorWithArg=t;var i=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t}(t);e.DefaultSQExprVisitor=i;var a=function(){function e(){}return e.prototype.visitEntity=function(e){this.visitDefault(e)},e.prototype.visitColumnRef=function(e){e.source.accept(this)},e.prototype.visitMeasureRef=function(e){e.source.accept(this)},e.prototype.visitAggr=function(e){e.arg.accept(this)},e.prototype.visitBetween=function(e){e.arg.accept(this),e.lower.accept(this),e.upper.accept(this)},e.prototype.visitIn=function(e){for(var t=e.args,i=0,a=t.length;a>i;i++)t[i].accept(this);for(var r=e.values,i=0,a=r.length;a>i;i++)for(var n=r[i],o=0,s=r.length;s>o;o++)n[o].accept(this)},e.prototype.visitAnd=function(e){e.left.accept(this),e.right.accept(this)},e.prototype.visitOr=function(e){e.left.accept(this),e.right.accept(this)},e.prototype.visitCompare=function(e){e.left.accept(this),e.right.accept(this)},e.prototype.visitContains=function(e){e.left.accept(this),e.right.accept(this)},e.prototype.visitExists=function(e){e.arg.accept(this)},e.prototype.visitNot=function(e){e.arg.accept(this)},e.prototype.visitStartsWith=function(e){e.left.accept(this),e.right.accept(this)},e.prototype.visitConstant=function(e){this.visitDefault(e)},e.prototype.visitDateSpan=function(e){e.arg.accept(this)},e.prototype.visitDateAdd=function(e){e.arg.accept(this)},e.prototype.visitNow=function(e){this.visitDefault(e)},e.prototype.visitDefault=function(e){},e}();e.DefaultSQExprVisitorWithTraversal=a}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){function t(e){return new i(e)}e.createEnumType=t;var i=function(){function e(e){this.allMembers=e}return e.prototype.members=function(e){var t=this.allMembers;if(!e)return t;for(var i=[],a=0;a<t.length;a++){var r=t[a];_.contains(e,r.value)&&i.push(r)}return i},e}()}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){t.showBoth="showBoth",t.showTitleOnly="showTitleOnly",t.showUnitOnly="showUnitOnly",t.type=e.createEnumType([{value:t.showTitleOnly,displayName:function(e){return e.get("Visual_Axis_ShowTitleOnly")}},{value:t.showUnitOnly,displayName:function(e){return e.get("Visual_Axis_ShowUnitOnly")}},{value:t.showBoth,displayName:function(e){return e.get("Visual_Axis_ShowBoth")}}])}(t=e.axisStyle||(e.axisStyle={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){t.scalar="Scalar",t.categorical="Categorical",t.both="Both",t.type=e.createEnumType([{value:t.scalar,displayName:function(e){return e.get("Visual_Axis_Scalar")}},{value:t.categorical,displayName:function(e){return e.get("Visual_Axis_Categorical")}}])}(t=e.axisType||(e.axisType={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){t.insideEnd="InsideEnd",t.insideCenter="InsideCenter",t.outsideEnd="OutsideEnd",t.insideBase="InsideBase",t.type=e.createEnumType([{value:t.insideEnd,displayName:function(e){return e.get("Visual_LabelPosition_InsideEnd")}},{value:t.outsideEnd,displayName:function(e){return e.get("Visual_LabelPosition_OutsideEnd")}},{value:t.insideCenter,displayName:function(e){return e.get("Visual_LabelPosition_InsideCenter")}},{value:t.insideBase,displayName:function(e){return e.get("Visual_LabelPosition_InsideBase")}}])}(t=e.labelPosition||(e.labelPosition={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){t.top="Top",t.bottom="Bottom",t.left="Left",t.right="Right",t.type=e.createEnumType([{value:t.top,displayName:function(e){return e.get("Visual_LegendPosition_Top")}},{value:t.bottom,displayName:function(e){return e.get("Visual_LegendPosition_Bottom")}},{value:t.left,displayName:function(e){return e.get("Visual_LegendPosition_Left")}},{value:t.right,displayName:function(e){return e.get("Visual_LegendPosition_Right")}}])}(t=e.legendPosition||(e.legendPosition={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){function t(e){return e.fill||e.fillRule||e.filter?!0:!1}e.isValid=t}(t=e.StructuralTypeDescriptor||(e.StructuralTypeDescriptor={}))}(powerbi||(powerbi={}));var powerbi;!function(e){function t(e){return e&g}function i(e){return(e&f)===e}function a(e){if(i(e))return null;var t=p[e];if(t){var a=t.lastIndexOf("_");if(a>0){var r=t.slice(0,a);p[r]&&(t=r)}}return t||null}function r(e,i){var a=d[e],r=p[a];if(null==r&&(r=p.Null),e&&i){var n=p[i];if(n){var o=t(n);o===d.Null?(n=r|n,p[n]&&(r=n)):o===e&&(r=n)}}return r}function n(e,t){return(e&m)===(t&m)}var o=jsCommon.EnumExtensions,s=function(){function e(e,t){this.underlyingType=e,this.category=t,o.hasFlag(e,p.Temporal)&&(this.temporalType=new l(e)),o.hasFlag(e,p.Geography)&&(this.geographyType=new u(e)),o.hasFlag(e,p.Miscellaneous)&&(this.miscType=new c(e)),o.hasFlag(e,p.Formatting)&&(this.formattingType=new h(e))}return e.fromDescriptor=function(t){if(t=t||{},t.text)return e.fromExtendedType(p.Text);if(t.integer)return e.fromExtendedType(p.Integer);if(t.numeric)return e.fromExtendedType(p.Double);if(t.bool)return e.fromExtendedType(p.Boolean);if(t.dateTime)return e.fromExtendedType(p.DateTime);if(t.duration)return e.fromExtendedType(p.Duration);if(t.binary)return e.fromExtendedType(p.Binary);if(t.none)return e.fromExtendedType(p.None);if(t.temporal){if(t.temporal.year)return e.fromExtendedType(p.Year_Integer);if(t.temporal.month)return e.fromExtendedType(p.Month_Integer)}if(t.geography){if(t.geography.address)return e.fromExtendedType(p.Address);if(t.geography.city)return e.fromExtendedType(p.City);if(t.geography.continent)return e.fromExtendedType(p.Continent);if(t.geography.country)return e.fromExtendedType(p.Country);if(t.geography.county)return e.fromExtendedType(p.County);if(t.geography.region)return e.fromExtendedType(p.Region);if(t.geography.postalCode)return e.fromExtendedType(p.PostalCode_Text);if(t.geography.stateOrProvince)return e.fromExtendedType(p.StateOrProvince);if(t.geography.place)return e.fromExtendedType(p.Place);if(t.geography.latitude)return e.fromExtendedType(p.Latitude_Double);if(t.geography.longitude)return e.fromExtendedType(p.Longitude_Double)}if(t.misc){if(t.misc.image)return e.fromExtendedType(p.Image);if(t.misc.imageUrl)return e.fromExtendedType(p.ImageUrl);if(t.misc.webUrl)return e.fromExtendedType(p.WebUrl)}if(t.formatting){if(t.formatting.color)return e.fromExtendedType(p.Color);
if(t.formatting.formatString)return e.fromExtendedType(p.FormatString);if(t.formatting.legendPosition)return e.fromExtendedType(p.LegendPosition);if(t.formatting.axisType)return e.fromExtendedType(p.AxisType);if(t.formatting.yAxisPosition)return e.fromExtendedType(p.YAxisPosition);if(t.formatting.axisStyle)return e.fromExtendedType(p.AxisStyle);if(t.formatting.alignment)return e.fromExtendedType(p.Alignment);if(t.formatting.labelDisplayUnits)return e.fromExtendedType(p.LabelDisplayUnits);if(t.formatting.labelPosition)return e.fromExtendedType(p.LabelPosition)}return t.extendedType?e.fromExtendedType(t.extendedType):e.fromExtendedType(p.Null)},e.fromExtendedType=function(i){i=i||p.Null;var r=t(i),n=a(i);return e.fromPrimitiveTypeAndCategory(r,n)},e.fromPrimitiveTypeAndCategory=function(t,i){t=t||d.Null,i=i||null;var a=t.toString();return i&&(a+="|"+i),e.typeCache[a]||(e.typeCache[a]=new e(r(t,i),i))},Object.defineProperty(e.prototype,"primitiveType",{get:function(){return t(this.underlyingType)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"extendedType",{get:function(){return this.underlyingType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"categoryString",{get:function(){return this.category},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"text",{get:function(){return this.primitiveType===d.Text},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"numeric",{get:function(){return o.hasFlag(this.underlyingType,p.Numeric)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"integer",{get:function(){return this.primitiveType===d.Integer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bool",{get:function(){return this.primitiveType===d.Boolean},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dateTime",{get:function(){return this.primitiveType===d.DateTime||this.primitiveType===d.Date||this.primitiveType===d.Time},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"duration",{get:function(){return this.primitiveType===d.Duration},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"binary",{get:function(){return this.primitiveType===d.Binary},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"none",{get:function(){return this.primitiveType===d.None},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"temporal",{get:function(){return this.temporalType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"geography",{get:function(){return this.geographyType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"misc",{get:function(){return this.miscType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"formatting",{get:function(){return this.formattingType},enumerable:!0,configurable:!0}),e.typeCache={},e}();e.ValueType=s;var l=function(){function e(e){this.underlyingType=e}return Object.defineProperty(e.prototype,"year",{get:function(){return n(this.underlyingType,p.Year)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"month",{get:function(){return n(this.underlyingType,p.Month)},enumerable:!0,configurable:!0}),e}();e.TemporalType=l;var u=function(){function e(e){this.underlyingType=e}return Object.defineProperty(e.prototype,"address",{get:function(){return n(this.underlyingType,p.Address)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"city",{get:function(){return n(this.underlyingType,p.City)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"continent",{get:function(){return n(this.underlyingType,p.Continent)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"country",{get:function(){return n(this.underlyingType,p.Country)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"county",{get:function(){return n(this.underlyingType,p.County)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"region",{get:function(){return n(this.underlyingType,p.Region)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"postalCode",{get:function(){return n(this.underlyingType,p.PostalCode)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"stateOrProvince",{get:function(){return n(this.underlyingType,p.StateOrProvince)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"place",{get:function(){return n(this.underlyingType,p.Place)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"latitude",{get:function(){return n(this.underlyingType,p.Latitude)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"longitude",{get:function(){return n(this.underlyingType,p.Longitude)},enumerable:!0,configurable:!0}),e}();e.GeographyType=u;var c=function(){function e(e){this.underlyingType=e}return Object.defineProperty(e.prototype,"image",{get:function(){return n(this.underlyingType,p.Image)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imageUrl",{get:function(){return n(this.underlyingType,p.ImageUrl)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"webUrl",{get:function(){return n(this.underlyingType,p.WebUrl)},enumerable:!0,configurable:!0}),e}();e.MiscellaneousType=c;var h=function(){function e(e){this.underlyingType=e}return Object.defineProperty(e.prototype,"color",{get:function(){return n(this.underlyingType,p.Color)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"formatString",{get:function(){return n(this.underlyingType,p.FormatString)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"legendPosition",{get:function(){return n(this.underlyingType,p.LegendPosition)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"axisType",{get:function(){return n(this.underlyingType,p.AxisType)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"yAxisPosition",{get:function(){return n(this.underlyingType,p.YAxisPosition)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"axisStyle",{get:function(){return n(this.underlyingType,p.AxisStyle)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"alignment",{get:function(){return n(this.underlyingType,p.Alignment)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"labelDisplayUnits",{get:function(){return n(this.underlyingType,p.LabelDisplayUnits)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"labelPosition",{get:function(){return n(this.underlyingType,p.LabelPosition)},enumerable:!0,configurable:!0}),e}();e.FormattingType=h,function(e){e[e.Null=0]="Null",e[e.Text=1]="Text",e[e.Decimal=2]="Decimal",e[e.Double=3]="Double",e[e.Integer=4]="Integer",e[e.Boolean=5]="Boolean",e[e.Date=6]="Date",e[e.DateTime=7]="DateTime",e[e.DateTimeZone=8]="DateTimeZone",e[e.Time=9]="Time",e[e.Duration=10]="Duration",e[e.Binary=11]="Binary",e[e.None=12]="None"}(e.PrimitiveType||(e.PrimitiveType={}));var d=e.PrimitiveType;!function(e){e[e.Numeric=256]="Numeric",e[e.Temporal=512]="Temporal",e[e.Geography=1024]="Geography",e[e.Miscellaneous=2048]="Miscellaneous",e[e.Formatting=4096]="Formatting",e[e.Null=0]="Null",e[e.Text=1]="Text",e[e.Decimal=258]="Decimal",e[e.Double=259]="Double",e[e.Integer=260]="Integer",e[e.Boolean=5]="Boolean",e[e.Date=518]="Date",e[e.DateTime=519]="DateTime",e[e.DateTimeZone=520]="DateTimeZone",e[e.Time=521]="Time",e[e.Duration=10]="Duration",e[e.Binary=11]="Binary",e[e.None=12]="None",e[e.Year=66048]="Year",e[e.Year_Text=66049]="Year_Text",e[e.Year_Integer=66308]="Year_Integer",e[e.Year_Date=66054]="Year_Date",e[e.Year_DateTime=66055]="Year_DateTime",e[e.Month=131584]="Month",e[e.Month_Text=131585]="Month_Text",e[e.Month_Integer=131844]="Month_Integer",e[e.Month_Date=131590]="Month_Date",e[e.Month_DateTime=131591]="Month_DateTime",e[e.Address=6554625]="Address",e[e.City=6620161]="City",e[e.Continent=6685697]="Continent",e[e.Country=6751233]="Country",e[e.County=6816769]="County",e[e.Region=6882305]="Region",e[e.PostalCode=6947840]="PostalCode",e[e.PostalCode_Text=6947841]="PostalCode_Text",e[e.PostalCode_Integer=6948100]="PostalCode_Integer",e[e.StateOrProvince=7013377]="StateOrProvince",e[e.Place=7078913]="Place",e[e.Latitude=7144448]="Latitude",e[e.Latitude_Decimal=7144706]="Latitude_Decimal",e[e.Latitude_Double=7144707]="Latitude_Double",e[e.Longitude=7209984]="Longitude",e[e.Longitude_Decimal=7210242]="Longitude_Decimal",e[e.Longitude_Double=7210243]="Longitude_Double",e[e.Image=13109259]="Image",e[e.ImageUrl=13174785]="ImageUrl",e[e.WebUrl=13240321]="WebUrl",e[e.Color=19664897]="Color",e[e.FormatString=19730433]="FormatString",e[e.LegendPosition=19795969]="LegendPosition",e[e.AxisType=19861505]="AxisType",e[e.YAxisPosition=19927041]="YAxisPosition",e[e.AxisStyle=19992577]="AxisStyle",e[e.Alignment=20058113]="Alignment",e[e.LabelDisplayUnits=20123649]="LabelDisplayUnits",e[e.LabelPosition=20189185]="LabelPosition"}(e.ExtendedType||(e.ExtendedType={}));var p=e.ExtendedType,g=255,f=65535,m=4294901760}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t=function(){function e(){}return e.prototype.findProperty=function(e,t){var i=this.entities.withName(e);return i?i.properties.withName(t):void 0},e}();e.ConceptualSchema=t,function(e){e[e.Queryable=0]="Queryable",e[e.Error=1]="Error"}(e.ConceptualQueryableState||(e.ConceptualQueryableState={}));e.ConceptualQueryableState;!function(e){e[e.Column=0]="Column",e[e.Measure=1]="Measure",e[e.Kpi=2]="Kpi"}(e.ConceptualPropertyKind||(e.ConceptualPropertyKind={}));e.ConceptualPropertyKind;!function(e){e[e.Default=0]="Default",e[e.None=1]="None",e[e.Sum=2]="Sum",e[e.Count=3]="Count",e[e.Min=4]="Min",e[e.Max=5]="Max",e[e.Average=6]="Average",e[e.DistinctCount=7]="DistinctCount"}(e.ConceptualDefaultAggregate||(e.ConceptualDefaultAggregate={}));e.ConceptualDefaultAggregate;!function(e){e[e.None=0]="None",e[e.Address=1]="Address",e[e.City=2]="City",e[e.Company=3]="Company",e[e.Continent=4]="Continent",e[e.Country=5]="Country",e[e.County=6]="County",e[e.Date=7]="Date",e[e.Image=8]="Image",e[e.ImageUrl=9]="ImageUrl",e[e.Latitude=10]="Latitude",e[e.Longitude=11]="Longitude",e[e.Organization=12]="Organization",e[e.Place=13]="Place",e[e.PostalCode=14]="PostalCode",e[e.Product=15]="Product",e[e.StateOrProvince=16]="StateOrProvince",e[e.WebUrl=17]="WebUrl"}(e.ConceptualDataCategory||(e.ConceptualDataCategory={}));e.ConceptualDataCategory}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){!function(e){e[e.Version0=0]="Version0",e[e.Version1=1]="Version1"}(e.DataShapeBindingVersions||(e.DataShapeBindingVersions={}));e.DataShapeBindingVersions;!function(e){e[e.Top=0]="Top",e[e.First=1]="First",e[e.Last=2]="Last",e[e.Sample=3]="Sample",e[e.Bottom=4]="Bottom"}(e.DataShapeBindingLimitType||(e.DataShapeBindingLimitType={}));e.DataShapeBindingLimitType;!function(e){e[e.None=0]="None",e[e.Before=1]="Before",e[e.After=2]="After"}(e.SubtotalType||(e.SubtotalType={}));e.SubtotalType}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t=function(){function e(e){this.schemas=e.schemas,e.links&&(this.links=e.links)}return e.prototype.schema=function(e){return this.schemas[e]},e}();e.FederatedConceptualSchema=t}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var i;!function(i){function a(e,i){if(!h.isUndefinedOrEmpty(e)){for(var a,r=0,n=e.length;n>r;r++){var o=e[r],s=o.data,l=void 0;if(s&&s.length)for(var u=0,c=s.length;c>u;u++)l=t.SQExprBuilder.and(l,o.data[u].expr);a=t.SQExprBuilder.or(a,l)}return a&&i&&(a=t.SQExprBuilder.not(a)),t.SemanticFilter.fromSQExpr(a)}}function r(i,a){var r=i.data;if(r.length!==a.length)return!1;for(var n=0,o=r.length;o>n;n++){var s=i.data[n],l=s;if(l.expr){if(!e.DataViewScopeIdentity.equals(l,a[n]))return!1}else if(!t.DataViewScopeWildcard.matches(s,a[n]))return!1}return!0}function n(e,i){var a=e.data,r=a.length;if(r!==i.length)return!1;for(var n=0;r>n;n++){var o,s=e.data[n];if(o=s.expr?t.ScopeIdentityKeyExtractor.run(s.expr):s.exprs,o&&!t.SQExprUtils.sequenceEqual(i[n],o))return!1}return!0}function o(e,t){return e=e||null,t=t||null,e===t?!0:!e!=!t?!1:e.id!==t.id?!1:e.metadata!==t.metadata?!1:s(e.data,t.data)?!0:!1}function s(e,t){if(e=e||null,t=t||null,e===t)return!0;if(!e!=!t)return!1;if(e.length!==t.length)return!1;for(var i=0,a=e.length;a>i;i++)if(!l(e[i],t[i]))return!1;return!0}function l(t,i){return!t.expr&&i.expr?!1:e.DataViewScopeIdentity.equals(t,i)}function u(e){var t={};if(e.data){for(var i=[],a=0,r=e.data.length;r>a;a++)i.push(e.data[a].key);t.data=i}return e.metadata&&(t.metadata=e.metadata),e.id&&(t.id=e.id),JSON.stringify(t)}function c(e){var t=e.data;if(!t)return!1;for(var i=0,a=t.length;a>i;i++){var r=t[i];if(r.exprs)return!0}return!1}var h=jsCommon.ArrayExtensions;i.filterFromSelector=a,i.matchesData=r,i.matchesKeys=n,i.equals=o,i.getKey=u,i.containsWildcard=c}(i=t.Selector||(t.Selector={}))}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){!function(e){e[e.Day=0]="Day",e[e.Week=1]="Week",e[e.Month=2]="Month",e[e.Year=3]="Year",e[e.Decade=4]="Decade",e[e.Second=5]="Second",e[e.Minute=6]="Minute",e[e.Hour=7]="Hour"}(e.TimeUnit||(e.TimeUnit={}));e.TimeUnit;!function(e){e[e.Sum=0]="Sum",e[e.Avg=1]="Avg",e[e.Count=2]="Count",e[e.Min=3]="Min",e[e.Max=4]="Max",e[e.CountNonNull=5]="CountNonNull"}(e.QueryAggregateFunction||(e.QueryAggregateFunction={}));e.QueryAggregateFunction;!function(e){e[e.Ascending=1]="Ascending",e[e.Descending=2]="Descending"}(e.QuerySortDirection||(e.QuerySortDirection={}));e.QuerySortDirection;!function(e){e[e.Equal=0]="Equal",e[e.GreaterThan=1]="GreaterThan",e[e.GreaterThanOrEqual=2]="GreaterThanOrEqual",e[e.LessThan=3]="LessThan",e[e.LessThanOrEqual=4]="LessThanOrEqual"}(e.QueryComparisonKind||(e.QueryComparisonKind={}));e.QueryComparisonKind;!function(e){e[e.None=0]="None",e[e.Number=1]="Number",e[e.Integer=3]="Integer",e[e.DateTime=4]="DateTime",e[e.Time=8]="Time",e[e.Date=20]="Date",e[e.Month=35]="Month",e[e.Year=67]="Year",e[e.YearAndMonth=128]="YearAndMonth",e[e.MonthAndDay=256]="MonthAndDay",e[e.Decade=515]="Decade",e[e.YearAndWeek=1024]="YearAndWeek",e[e.String=2048]="String",e[e.Boolean=4096]="Boolean",e[e.Table=8192]="Table",e[e.Range=16384]="Range"}(e.SemanticType||(e.SemanticType={}));e.SemanticType;!function(e){e[e.None=0]="None",e[e.Group=1]="Group",e[e.Measure=2]="Measure"}(e.SelectKind||(e.SelectKind={}));e.SelectKind;!function(e){e[e.Default=0]="Default",e[e.Period=1]="Period"}(e.FilterKind||(e.FilterKind={}));e.FilterKind}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t=function(){function e(e,t){this.items=e,this._activeProjectionRef=t}return e.prototype.all=function(){return this.items},Object.defineProperty(e.prototype,"activeProjectionQueryRef",{get:function(){return this._activeProjectionRef},set:function(e){var t=this.items.map(function(e){return e.queryRef});_.contains(t,e)&&(this._activeProjectionRef=e)},enumerable:!0,configurable:!0}),e.prototype.clone=function(){return new e(_.clone(this.items),this._activeProjectionRef)},e}();e.QueryProjectionCollection=t;var i;!function(e){function t(e){var t={};for(var i in e)t[i]=e[i].clone();return t}function i(e,t){return e?e[t]:void 0}e.clone=t,e.getRole=i}(i=e.QueryProjectionsByRole||(e.QueryProjectionsByRole={}))}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){!function(e){e[e.Default=0]="Default",e[e.Verbose=1]="Verbose",e[e.WholeUnits=2]="WholeUnits"}(e.DisplayUnitSystemType||(e.DisplayUnitSystemType={}));e.DisplayUnitSystemType}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){!function(e){e[e.None=0]="None",e[e.Before=1]="Before",e[e.After=2]="After"}(e.CompiledSubtotalType||(e.CompiledSubtotalType={}));e.CompiledSubtotalType}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t;!function(t){function i(t,i,a){var r=t[i];r||(t[i]=r=[]);for(var n=0,o=r.length;o>n;n++){var s=r[n];if(e.Selector.equals(s.selector,a))return s}var l={selector:a,properties:{}};return r.push(l),l}function a(t,i,a,r){var n=t[i];if(n)for(var o=0,s=n.length;s>o;o++){var l=n[o];if(e.Selector.equals(l.selector,a))return void delete l.properties[r]}}function r(t,i,a){var r=t[i.objectName];if(r)for(var n=0,o=r.length;o>n;n++){var s=r[n];if(e.Selector.equals(s.selector,a))return s.properties[i.propertyName]}}function n(e,t){return jsCommon.JsonComparer.equals(e,t)}t.ensure=i,t.deleteProperty=a,t.getValue=r,t.propertiesAreEqual=n}(t=e.DataViewObjectDefinitions||(e.DataViewObjectDefinitions={}))}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var i;!function(t){function i(t){return r(t,function(t){var i=e.ValueType.fromDescriptor(t.type).formatting;return i&&i.formatString})}function a(e){return r(e,function(e){var t=e.type;return t&&!!t.filter})}function r(e,t){if(e)for(var i in e){var a=e[i].properties;for(var r in a)if(t(a[r]))return{objectName:i,propertyName:r}}}t.findFormatString=i,t.findFilterOutput=a}(i=t.DataViewObjectDescriptors||(t.DataViewObjectDescriptors={}))}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t;!function(t){function i(t,i){for(var a,r=0,n=i.length;n>r;r++){var o=i[r],s=o.name,l=e.DataViewObjectEvaluator.run(t[s],o.properties);l&&(a||(a={}),a[s]=l)}return a}function a(e){var t={data:[]};if(e)for(var i in e)for(var a=e[i],n=0,o=a.length;o>n;n++){var s=a[n];r(t,s.selector).objects.push({name:i,properties:s.properties})}return t}function r(t,i){if(!i)return t.metadataOnce||(t.metadataOnce={objects:[]}),t.metadataOnce;var a;i.data?a=t.data:i.metadata?(t.metadata||(t.metadata=[]),a=t.metadata):i.id&&(t.userDefined||(t.userDefined=[]),a=t.userDefined);for(var r=0,n=a.length;n>r;r++){var o=a[r];if(e.Selector.equals(i,o.selector))return o}var o={selector:i,objects:[]};return a.push(o),o}function n(t,i,a,r){var n=e.DataViewObjectDescriptors.findFormatString(i);if(n)for(var l=0,u=r.length;u>l;l++){var c=r[l];c&&s(t,n,c.queryName,c.format||o(a,l))}}function o(e,t){for(var i=0,a=e.length;a>i;i++){var r=e[i];if(r&&r.index===t)return r.format}}function s(t,i,a,r){if(r){var n=t.metadata;n||(n=t.metadata=[]);var o,s={metadata:a},c=l(n,s);if(c){if(o=c.objects,u(o,i))return}else o=[],c={selector:s,objects:o},n.push(c);var h={name:i.objectName,properties:{}};h.properties[i.propertyName]=e.SQExprBuilder.text(r),o.push(h)}}function l(t,i){for(var a=0,r=t.length;r>a;a++){var n=t[a];if(e.Selector.equals(n.selector,i))return n}}function u(e,t){for(var i=0,a=e.length;a>i;i++){var r=e[i];if(r.name===t.objectName&&r.properties[t.propertyName])return!0}return!1}t.evaluateDataViewObjects=i,t.groupObjectsBySelector=a,t.addDefaultFormatString=n}(t=e.DataViewObjectEvaluationUtils||(e.DataViewObjectEvaluationUtils={}))}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var i;!function(i){function a(e,t){if(e){var i,a=e.properties;for(var n in t){var o=t[n],s=a[n];if(s){var l=r(s,o);void 0!==l&&(i||(i={}),i[n]=l)}}return i}}function r(i,a){var r=l(a,e.ValueType.fromDescriptor(i.type));if(void 0!==r||a instanceof t.RuleEvaluation)return r;var s=i.type,u=n(a,s);if(u)return u;var c=o(a,s);return c?c:a}function n(t,i){var a=i.fill;if(a)return a&&a.solid&&a.solid.color&&t.solid?{solid:{color:l(t.solid.color,e.ValueType.fromExtendedType(e.ExtendedType.Color))}}:void 0}function o(e,t){if(t.fillRule){if(e.linearGradient2){var i=e.linearGradient2;return{linearGradient2:{min:s(i.min),max:s(i.max)}}}if(e.linearGradient3){var a=e.linearGradient3;return{linearGradient3:{min:s(a.min),mid:s(a.mid),max:s(a.max)}}}}}function s(e){var t={color:l(e.color,u)},i=l(e.value,c);return i&&(t.value=i),t}function l(e,i){return e instanceof t.SQExpr?h.evaluate(e,i):e instanceof t.RuleEvaluation?e.evaluate():void 0}var u=e.ValueType.fromDescriptor({formatting:{color:!0}}),c=e.ValueType.fromDescriptor({numeric:!0});i.run=a,i.evaluateProperty=r;var h=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.evaluate=function(e,i){return null!=e?e.accept(t.instance,i):void 0},t.prototype.visitConstant=function(e,t){return e.value},t.instance=new t,t}(t.DefaultSQExprVisitorWithArg)}(i=t.DataViewObjectEvaluator||(t.DataViewObjectEvaluator={}))}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){function t(e,t,a){return e?i.getValue(e[t.objectName],t.propertyName,a):a}function a(e,t,i){return e&&e[t]?e[t]:i}function r(e,i,a){var r=t(e,i);return r&&r.solid?r.solid.color:a}e.getValue=t,e.getObject=a,e.getFillColor=r}(t=e.DataViewObjects||(e.DataViewObjects={}));var i;!function(e){function t(e,t,i){if(!e)return i;var a=e[t];return void 0===a?i:a}e.getValue=t}(i=e.DataViewObject||(e.DataViewObject={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var i,a=e.Prototype.inherit,r=jsCommon.ArrayExtensions;!function(e){function i(e){var i=e.categorical;if(!i)return null;var n=i.categories;if(!n||1!==n.length)return null;var o=i.values;if(r.isUndefinedOrEmpty(o)||o.source)return null;for(var s=n[0],l=s.identity,u=s.values,c=[],h=[],d=0,p=u.length;p>d;d++)for(var g=u[d],f=l[d],m=0,y=o.length;y>m;m++){var v=o[m],C=a(v.source);if(v.identity)return null;C.groupName=g;var b={source:C,values:[v.values[d]],identity:f,min:v.min,max:v.max,subtotal:v.subtotal},x=v.highlights;x&&(b.highlights=[x[d]]),c.push(C),h.push(b)}var S=a(e.metadata);S.columns=c;var o=t.DataViewTransform.createValueColumns(h,s.identityFields,s.source);return{metadata:S,categorical:{values:o},matrix:e.matrix}}e.apply=i}(i=t.DataViewPivotCategorical||(t.DataViewPivotCategorical={}))}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var i;!function(t){function i(t,i){i.columnHierarchyRewritten||(t.columns=e.Prototype.inherit(t.columns));var o=t.columns;i.rowHierarchyRewritten||(t.rows=e.Prototype.inherit(t.rows));var s=t.rows;if(!(o.levels.length>1)){var l={level:0},u=o.root.children,c=u.length;if(c>0){var h=0,d=function(e){if(e.values){l.values||(l.values={});for(var t=0;c>t;t++)l.values[h++]=e.values[t];delete e.values}if(c>1){var i=e.level+1;e.children||(e.children=[]);for(var a=0;c>a;a++){var r={level:i},n=u[a];r.levelSourceIndex=n.levelSourceIndex,e.isSubtotal&&(r.isSubtotal=!0),e.children.push(r)}}};i.hierarchyTreesRewritten?a(s.root,d):t.columns.root=n(s.root,d)}else i.hierarchyTreesRewritten||(t.columns.root=r(s.root));if(c>1){var p={sources:o.levels[0].sources};s.levels.push(p),o.levels.length=0}if(i.hierarchyTreesRewritten)t.columns.root=s.root,t.rows.root={children:[l]};else{var g=e.Prototype.inherit(t.rows.root);g.children=[l],t.rows.root=g}t.columns.levels=s.levels,t.rows.levels=[]}}function a(e,t){var i=e.children;if(i&&i.length>0)for(var r=0,n=i.length;n>r;r++)a(i[r],t);else t(e)}function r(e){return n(e)}function n(t,i){var a=e.Prototype.inherit(t),r=t.children;if(r&&r.length>0){for(var o=[],s=0,l=r.length;l>s;s++){var u=n(r[s],i);o.push(u)}a.children=o}else i&&i(a);return a}t.apply=i,t.cloneTree=r,t.cloneTreeExecuteOnLeaf=n}(i=t.DataViewPivotMatrix||(t.DataViewPivotMatrix={}))}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var i;!function(i){function a(e){if(e.categorical){var t=e.categorical;if(t.categories&&1===t.categories.length&&(!t.values||!t.values.source))return r(e.metadata,t)}}function r(i,a){i=e.Prototype.inherit(i),i.columns=[];var r=a.values?a.values.grouped()[0].values:[],s=a.categories[0],l=s.values,u=l.length;if(0!==u){var c=s.identity,h=[],d=n(u);i.columns.push(s.source);for(var p=0;u>p;p++)for(var g=c[p],f=l[p],m=0,y=r.length;y>m;m++){var v=r[m],C=v.highlights,b=e.Prototype.inherit(v.source);b.groupName=f,i.columns.push(b);var x={source:b,identity:g,values:o(d,v.values,p)};C&&(x.highlights=o(d,C,p)),h.push(x)}var S=t.DataViewTransform.createValueColumns(h,s.identityFields,s.source);return{metadata:i,categorical:{categories:a.categories,values:S}}}}function n(e){for(var t=new Array(e),i=0;e>i;i++)t[i]=null;return t}function o(t,i,a){var r=e.Prototype.inherit(t);return r[a]=i[a],r}i.apply=a}(i=t.DataViewSelfCrossJoin||(t.DataViewSelfCrossJoin={}))}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){!function(e){e[e.Year=0]="Year",e[e.Month=1]="Month",e[e.Week=2]="Week",e[e.Day=3]="Day",e[e.Hour=4]="Hour",e[e.Minute=5]="Minute",e[e.Second=6]="Second",e[e.Millisecond=7]="Millisecond"}(e.DateTimeUnit||(e.DateTimeUnit={}));e.DateTimeUnit}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){function i(e,t){if(!t||0===t.length)return{dataView:e,isValid:!0};if(e){var i=t[0];if(u(e,i))return{dataView:e,isValid:!0};if(i.categorical)return a(e,i);if(i.tree)return n(e,i.tree);if(i.single)return r(e,i.single);if(i.table)return o(e,i.table)}return{isValid:!1}}function a(t,i){var a=i.categorical,r=t.categorical;if(!r)return{isValid:!1};var n;if(a.rowCount&&(n=a.rowCount.supported,n&&n.max)){var o,s=r.categories,l=n.max;if(s)for(var u=0,h=s.length;h>u;u++){var d=s[u],p=d.values.length;if(void 0!==l&&p>l){var g=S.range(d.values,0,l-1);o=o||{categories:[]},o.categories.push({source:d.source,values:g})}}if(r.values&&r.values.length>0&&l&&(p||(p=r.values[0].values.length),void 0!==l&&p>l)){o=o||{},o.values=e.data.DataViewTransform.createValueColumns();for(var u=0,h=r.values.length;h>u;u++){var f=r.values[u],m={source:f.source,values:S.range(f.values,0,l-1)};void 0!==f.min&&(m.min=f.min),void 0!==f.max&&(m.max=f.max),void 0!==f.subtotal&&(m.subtotal=f.subtotal),o.values.push(m)}}o&&(t={metadata:t.metadata,categorical:o})}return c(t,i)?{dataView:t,isValid:!0}:null}function r(e,t){return e.single?{dataView:e,isValid:!0}:{isValid:!1}}function n(e,t){var i=e.metadata;return g(s(i.columns),t.depth)?{dataView:e,isValid:!0}:{isValid:!1}}function o(e,t){return e.table?{dataView:e,isValid:!0}:{isValid:!1}}function s(e){for(var t=0,i=0,a=e.length;a>i;i++)e[i].isMeasure||++t;return t}function l(e){for(var t=0,i=0,a=e.length;a>i;i++)e[i].isMeasure&&++t;return t}function u(e,t,i){return t&&e?t.categorical&&!c(e,t.categorical,i)?!1:t.tree&&!d(e,t.tree)?!1:t.single&&!h(e.single,t.single)?!1:t.table&&!p(e.table,t.table,i)?!1:!0:!1}function c(e,t,i){var a=e.categorical;if(!a)return!1;if(t.rowCount){var r=t.rowCount.supported;if(i&&t.rowCount.preferred&&(r=t.rowCount.preferred),r){var n=0;if(a.values&&a.values.length?n=a.values[0].values.length:a.categories&&a.categories.length&&(n=a.categories[0].values.length),!g(n,r))return!1}}return!0}function h(e,t){return e?!0:!1}function d(e,t){var i=e.metadata;return g(s(i.columns),t.depth)}function p(e,t,i){if(!e)return!1;if(t.rowCount){var a=t.rowCount.supported;if(i&&t.rowCount.preferred&&(a=t.rowCount.preferred),a){var r=0;if(e.rows&&e.rows.length&&(r=e.rows.length),!g(r,a))return!1}}return!0}function g(e,t){return t?void 0!==t.min&&t.min>e?!1:void 0!==t.max&&t.max<e?!1:!0:0===e}function f(e,t){for(var i=[],a=0,r=t.length;r>a;a++){var n=t[a],o=n.conditions;if(o&&o.length)for(var s=0,l=o.length;l>s;s++){var u=o[s];if(m(e,u)){i.push(n);break}}else i.push(n)}return S.emptyToNull(i)}function m(e,t){for(var i=Object.keys(t),a=0,r=i.length;r>a;a++){var n=i[a],o=t[n],s=y(n,e);if(!g(s,o))return!1}return!0}function y(e,t){var i=t[e];return i?i.all().length:0}function v(t,i){if(t&&i&&t.categorical&&i.categorical){var a=t.categorical.categories,r=i.categorical.categories;if(a&&r&&a.length===r.length){for(var n=0,o=a.length;o>n;n++){var s=a[n].identity,l=r[n].identity,u=C(s);if(u!==C(l))return!1;for(var c=0;u>c;c++)if(!e.DataViewScopeIdentity.equals(s[c],l[c]))return!1}return!0}}return!1}function C(e){return e?e.length:0}function b(e,t){return e||t?e&&t?e.displayName!==t.displayName?!1:e.queryName!==t.queryName?!1:e.isMeasure!==t.isMeasure?!1:e.type!==t.type?!1:!0:!1:!0}function x(e,i){if(!e&&!i)return!0;if(!e||!i)return!1;var a=e.columns.length,r=i.columns.length;if(a!==r)return!1;for(var n=0;r>n;n++)if(!t.areMetadataColumnsEquivalent(e.columns[n],i.columns[n]))return!1;return!0}var S=jsCommon.ArrayExtensions;t.validateAndReshape=i,t.countGroups=s,t.countMeasures=l,t.supports=u,t.conforms=g,t.chooseDataViewMappings=f,t.getPropertyCount=y,t.hasSameCategoryIdentity=v,t.areMetadataColumnsEquivalent=b,t.isMetadataEquivalent=x}(t=e.DataViewAnalysis||(e.DataViewAnalysis={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t,i=jsCommon.ArrayExtensions;!function(t){function r(e,t,i){return e=e||null,t=t||null,e===t?!0:!e!=!t?!1:a.SQExpr.equals(e.expr,t.expr,i)}function n(t,a){if(!i.isUndefinedOrEmpty(t)){for(var r,n=0,o=t.length;o>n;n++){var s=t[n];r=r?e.data.SQExprBuilder.or(r,s.expr):s.expr}return r&&a&&(r=e.data.SQExprBuilder.not(r)),e.data.SemanticFilter.fromSQExpr(r)}}t.equals=r,t.filterFromIdentity=n}(t=e.DataViewScopeIdentity||(e.DataViewScopeIdentity={}));var a;!function(e){function t(e){return new a(e)}var i=jsCommon.Lazy;e.createDataViewScopeIdentity=t;var a=function(){function t(t){this._expr=t,this._key=new i(function(){return e.SQExprShortSerializer.serialize(t)})}return Object.defineProperty(t.prototype,"expr",{get:function(){return this._expr},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"key",{get:function(){return this._key.getValue()},enumerable:!0,configurable:!0}),t}()}(a=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t,i=jsCommon.Lazy;!function(t){function a(t,i){var a=e.ScopeIdentityKeyExtractor.run(i.expr);return a?e.SQExprUtils.sequenceEqual(t.exprs,a):!1}function r(e){return new n(e)}t.matches=a,t.fromExprs=r;var n=function(){function t(t){this._exprs=t,this._key=new i(function(){return e.SQExprShortSerializer.serializeArray(t)})}return Object.defineProperty(t.prototype,"exprs",{get:function(){return this._exprs},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"key",{get:function(){return this._key.getValue()},enumerable:!0,configurable:!0}),t}()}(t=e.DataViewScopeWildcard||(e.DataViewScopeWildcard={}))}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var i,a=e.Prototype.inherit,r=jsCommon.ArrayExtensions;!function(e){e[e.None=0]="None",e[e.Pivot=1]="Pivot",e[e.SelfCrossJoin=2]="SelfCrossJoin"}(i||(i={}));var n;!function(n){function o(e){var t=e.prototype,i=e.objectDescriptors,a=e.dataViewMappings,n=e.transforms,o=e.colorAllocatorFactory;if(!t)return s(i,n,o);if(!n)return[t];var u=n.splits;if(r.isUndefinedOrEmpty(u))return[l(t,i,a,n,o)];for(var c=[],h=0;h<u.length;h++){var d=u[h],p=l(t,i,a,n,o,d.selects);c.push(p)}return c}function s(e,t,i){if(t&&t.objects){var a={metadata:{columns:[]}};return T(a,e,t.objects,t.selects,i),[a]}return[]}function l(e,t,i,r,n,o){var s=a(e);return s.metadata=a(e.metadata),s=u(s,i,r.selects,r.projectionOrdering,o),T(s,t,r.objects,r.selects,n),s}function u(e,i,a,r,n){var o=[];if(a&&(e.metadata.columns=c(e.metadata.columns,a,o)),e.categorical&&(e.categorical=g(e.categorical,o,n),e=$(e,i)),e.matrix){var s={rowHierarchyRewritten:!1,columnHierarchyRewritten:!1,hierarchyTreesRewritten:!1};e.matrix=y(e.matrix,o,i,r,s),J(e.matrix,i)&&t.DataViewPivotMatrix.apply(e.matrix,s)}return e.table&&(e.table=f(e.table,o,i,r)),e}function c(e,t,i){if(!t)return e;for(var r=a(e),n=0,o=e.length;o>n;n++){var s=e[n],l=t[s.index];if(l){var u=r[n]=a(s);l.roles&&(u.roles=l.roles),l.type&&(u.type=l.type),u.format=h(l,u),l.displayName&&(u.displayName=l.displayName),l.queryName&&(u.queryName=l.queryName),i.push({from:s,to:u})}}return r}function h(e,t){if(e.format)return e.format;if(t.format)return t.format;var i=t.type;if(i){if(i.dateTime)return"d";if(i.integer)return"g";if(i.numeric)return"#,0.00"}return void 0}function d(i,a){if(i){a||(a={});for(var r in i){var n=i[r],o=r,s=n,l="general";switch(r){case"hasScalarCategoryAxis":l="categoryAxis",o="axisType",
s=t.SQExprBuilder.text(n?e.axisType.scalar:e.axisType.categorical);break;case"Totals":o="totals",s=t.SQExprBuilder["boolean"](!!n);break;case"textboxSettings":o="paragraphs",n&&n.paragraphs&&(s=n.paragraphs);break;case"VisualType1":o="visualType1",s=t.SQExprBuilder.text(n);break;case"VisualType2":o="visualType2",s=t.SQExprBuilder.text(n);break;case"imageVisualSettings":o="imageUrl",n&&n.imageUrl&&(s=t.SQExprBuilder.text(n.imageUrl));break;default:continue}p(a,l,o,s)}return a}}function p(e,t,i,a){var r=e[t];void 0===r&&(r=e[t]=[]);var n=r[0];void 0===n&&(n=r[0]={properties:{}}),n.properties[i]=a}function g(t,i,r){function n(e){var t=S(e.source,i);if(t){var r=a(e);return r.source=t,r}}var o=a(t),s=e.Prototype.overrideArray(t.categories,n);s&&(o.categories=s);var l=e.Prototype.overrideArray(t.values,n);if(l){if(r)for(var u=l.length-1;u>=0;u--)r[l[u].source.index]||l.splice(u,1);if(l.source)if(r&&!r[l.source.index])l.source=void 0;else{var c=S(l.source,i);c&&(l.source=c)}o.values=l,X(l)}return o}function f(t,i,r,n){if(!r||1!==r.length||!r[0].table)return t;var o=a(t),s=function(e){return S(e,i)},l=e.Prototype.overrideArray(t.columns,s);if(l&&(o.columns=l),!n)return o;var u=m(n,i);if(!u)return o;for(var c=l.slice(0),h=Object.keys(u),d=0,p=h.length;p>d;d++){var g=c[u[h[d]]];d===l.length?l.push(g):l[d]=g}var f=e.Prototype.overrideArray(o.rows,function(e){for(var t=[],i=0,a=h.length;a>i;++i)t[i]=e[u[h[i]]];return t});return f&&(o.rows=f),o}function m(e,t){var i=Object.keys(e),a=i[0],n=_.map(t,function(e){return e.from.index}),o=e[a];return r.sequenceEqual(n,o,function(e,t){return e===t})?void 0:b(n,o)}function y(i,r,n,o,s){function l(e){return S(e,r)}function u(t){var i=null,a=e.Prototype.overrideArray(t.levels,function(t){var i=null,a=e.Prototype.overrideArray(t.sources,l);return a&&(i=w(i,t,function(e){return e.sources=a})),i});return a&&(i=w(i,t,function(e){return e.levels=a})),i}if(!n||1!==n.length||!n[0].matrix)return i;var c=a(i),h=u(c.rows);h&&(c.rows=h,s.rowHierarchyRewritten=!0);var d=u(c.columns);d&&(c.columns=d,s.columnHierarchyRewritten=!0);var p=e.Prototype.overrideArray(c.valueSources,l);if(p&&(c.valueSources=p,o&&p.length>1)){var g=d.levels.length;if(g>0){var f=C(n[0].matrix,o,p,r);if(f){var m=Object.keys(f),y=m.length;d.root=t.DataViewPivotMatrix.cloneTree(d.root),1===g?v(d.root,f):x(d.root,g-2,function(e){return v(e,f)}),c.rows.root=t.DataViewPivotMatrix.cloneTreeExecuteOnLeaf(c.rows.root,function(e){for(var t={},i=Object.keys(e.values).length/y,a=0,r=i;r>a;a++)for(var n=a*y,o=0;y>o;o++)t[n+o]=e.values[n+f[m[o]]];e.values=t}),s.hierarchyTreesRewritten=!0}}}return c}function v(e,t){for(var i=Object.keys(t),a=i.length,r=e.children,n=r.slice(0),o=0,s=a;s>o;o++){var l=n[t[i[o]]];o===r.length?r.push(l):r[o]=l}}function C(e,t,i,a){function n(e){for(var t=0,a=i.length;a>t;t++){var r=i[t];if(r===e.to)return e}}for(var o=e.values["for"]["in"],s=[],l=0,u=a.length;u>l;l++){var c=a[l];n(c)&&s.push(c)}var h=t[o],d=_.map(s,function(e){return e.from.index});return r.sequenceEqual(d,h,function(e,t){return e===t})?void 0:b(d,h)}function b(e,t){for(var i={},a=0,r=t.length;r>a;++a){var n=t[a];i[a]=e.indexOf(n)}return i}function x(e,t,i){if(e.level===t)return void i(e);var a=e.children;if(a&&a.length>0)for(var r=0,n=a.length;n>r;r++)x(a[r],t,i)}function S(e,t){for(var i=0,a=t.length;a>i;i++){var r=t[i];if(r.from===e)return r.to}}function w(e,t,i){return e||(e=a(t)),i&&i(e),e}function T(e,i,a,r,n){if(i){var o=t.DataViewObjectEvaluationUtils.groupObjectsBySelector(a);r&&t.DataViewObjectEvaluationUtils.addDefaultFormatString(o,i,e.metadata.columns,r);var s=o.metadataOnce,l=o.data;s&&D(e,i,s.objects,l,n);var u=o.metadata;if(u)for(var c=0,h=u.length;h>c;c++){var d=u[c];E(e,i,d.selector,d.objects)}for(var c=0,h=l.length;h>c;c++){var p=l[c];V(e,i,p.selector,p.rules,p.objects)}o.userDefined}}function D(e,i,a,r,n){var o=t.DataViewObjectEvaluationUtils.evaluateDataViewObjects(i,a);if(o){e.metadata.objects=o;for(var s in o){var l=o[s],u=i[s];for(var c in l){var h=u.properties[c],d=h.rule;if(d){var p=P(e,n,d,s,l[c],h.type);p&&r.push(p)}}}}}function P(e,t,i,a,r,n){var o=i.output;if(o){var s=F(e,o.selector);if(s)return n.fillRule?M(e,t,i,s,a,r):n.filter?N(e,i,s,a,r):void 0}}function M(e,i,a,r,n,o){var s;if(o.linearGradient2?s=L(e,i,a,o,o.linearGradient2):o.linearGradient3&&(s=A(e,i,a,o,o.linearGradient3)),s){var l=new t.ColorRuleEvaluation(a.inputRole,s),u={};return u[a.output.property]={solid:{color:l}},{selector:r,rules:[l],objects:[{name:n,properties:u}]}}}function L(e,t,i,a,r){var r=a.linearGradient2;if(void 0===r.min.value||void 0===r.max.value){var n=W(e,i.inputRole);if(!n)return;void 0===r.min.value&&(r.min.value=n.min),void 0===r.max.value&&(r.max.value=n.max)}return t.linearGradient2(a.linearGradient2)}function A(e,t,i,a,r){var r=a.linearGradient3;if(void 0===r.min.value||void 0===r.mid.value||void 0===r.max.value){var n=W(e,i.inputRole);if(!n)return;var o=void 0===r.min.value&&void 0===r.max.value&&void 0!==r.mid.value;if(void 0===r.min.value&&(r.min.value=n.min),void 0===r.max.value&&(r.max.value=n.max),void 0===r.mid.value){var s=(r.max.value+r.min.value)/2;r.mid.value=s}}return t.linearGradient3(a.linearGradient3,o)}function N(e,i,a,r,n){if(e.categorical&&e.categorical.categories&&1===e.categorical.categories.length){var o=e.categorical.categories[0].identityFields;if(o){var s=t.SQExprConverter.asScopeIdsContainer(n,o);if(s){var l=new t.FilterRuleEvaluation(s),u={};return u[i.output.property]=l,{selector:a,rules:[l],objects:[{name:r,properties:u}]}}}}}function V(e,i,a,r,n){var o=t.Selector.containsWildcard(a),s=e.categorical;if(s){var l=!1;if(l=I(s,i,a,r,o,n)||l,l=H(s,i,a,r,o,n)||l)return}}function I(e,i,a,r,n,o){if(e.categories&&0!==e.categories.length){var s=O(e,a);if(s){var l,u,c=s.identities;if(c){for(var h=0,d=c.length;d>h;h++){var p=c[h];if(n||t.Selector.matchesData(a,[p])){if(r){u||(u=R(r,e));for(var g=0,f=u.length;f>g;g++){var m=u[g];m.rule.setContext(p,m.inputValues?m.inputValues[h]:void 0)}}var y=t.DataViewObjectEvaluationUtils.evaluateDataViewObjects(i,o);if(y&&(s.column.objects||(s.column.objects=[],s.column.objects.length=d),s.column.objects[h]=y),!n)return!0;l=!0}}return l}}}}function R(e,t){for(var i=[],a=0,r=e.length;r>a;a++){var n,o=e[a],s=G(t,o.inputRole);s&&(n=s.values),i.push({rule:o,inputValues:n})}return i}function H(e,i,a,r,n,o){var s=e.values;if(s&&s.identityFields&&t.Selector.matchesKeys(a,[s.identityFields])){var l=s.grouped();if(l){for(var u,c=0,h=l.length;h>c;c++){var d=l[c];if(n||t.Selector.matchesData(a,[d.identity])){var p=t.DataViewObjectEvaluationUtils.evaluateDataViewObjects(i,o);if(p&&(d.objects=p,X(s,l)),!n)return!0;u=!0}}return u}}}function E(e,i,a,r){for(var n=e.metadata.columns,o=a.metadata,s=0,l=n.length;l>s;s++){var u=n[s];if(u.queryName===o){var c=t.DataViewObjectEvaluationUtils.evaluateDataViewObjects(i,r);c&&(u.objects=c)}}}function O(e,i){var a=e.categories[0];if(a.identityFields&&t.Selector.matchesKeys(i,[a.identityFields])){var r=a.identity,n=a,o=i.metadata;if(o){var s=e.values;if(s)for(var l=0,u=s.length;u>l;l++){var c=s[l];if(c.source.queryName===o){n=c;break}}}return{column:n,identities:r}}}function F(e,i){if(1===i.length){var a=e.categorical;if(a){var r=a.categories;if(r&&1===r.length){var n=r[0],o=n.source.roles,s=n.identityFields;if(o&&s&&o[i[0]])return{data:[t.DataViewScopeWildcard.fromExprs(s)]}}}}}function G(e,t){return z(e.values,t)||z(e.categories,t)}function z(e,t){if(e)for(var i=0,a=e.length;a>i;i++){var r=e[i],n=r.source.roles;if(n&&n[t])return r}}function W(e,t){var i=e.categorical;if(i){var a=i.values;if(a)for(var r=0,n=a.length;n>r;r++){var o=a[r],s=o.source.roles;if(s&&s[t]){var l=o.min;if(void 0===l&&(l=o.minLocal),void 0!==l){var u=o.max;if(void 0===u&&(u=o.maxLocal),void 0!==u)return{min:l,max:u}}}}}}function U(e,i,a,n){if(e&&!r.isUndefinedOrEmpty(e.Select)||!r.isUndefinedOrEmpty(i)||n){var o={};if(e){var s=e.Select;if(s)for(var l=o.selects=[],u=0,c=s.length;c>u;u++){var h=s[u],p=B(h,u);if(l.push(p),p.format&&a){var g=t.DataViewObjectDescriptors.findFormatString(a);g&&(n||(n={}),t.DataViewObjectDefinitions.ensure(n,g.objectName,{metadata:p.queryName}).properties[g.propertyName]=t.SQExprBuilder.text(p.format))}}}if(i){var f=i.length;f>1&&(o.splits=[]);for(var u=0;f>u;u++){var m=i[u];m.Settings&&0===u&&(n=d(m.Settings,n)),m.DataRoles&&(o.selects||(o.selects=[]),o.projectionOrdering||(o.projectionOrdering={}),j(m.DataRoles,o.selects,o.projectionOrdering)),o.splits&&o.splits.push(Y(m.DataRoles))}}return n&&(o.objects=n),o}}function B(e,i){var a={};return e.Restatement&&(a.displayName=e.Restatement),e.Name?a.queryName=e.Name:a.queryName||(a.queryName="$select"+i),e.Format&&(a.format=e.Format),e.Type&&(a.type=k(e.Type,t.ConceptualDataCategory[e.DataCategory])),a}function k(i,a){i=i||t.SemanticType.None;var r=e.PrimitiveType.Null;switch(i){case t.SemanticType.String:r=e.PrimitiveType.Text;break;case t.SemanticType.Number:r=e.PrimitiveType.Double;break;case t.SemanticType.Integer:r=e.PrimitiveType.Integer;break;case t.SemanticType.Boolean:r=e.PrimitiveType.Boolean;break;case t.SemanticType.Date:r=e.PrimitiveType.Date;break;case t.SemanticType.DateTime:r=e.PrimitiveType.DateTime;break;case t.SemanticType.Time:r=e.PrimitiveType.Time;break;case t.SemanticType.Year:r=e.PrimitiveType.Integer,a="Year";break;case t.SemanticType.Month:r=e.PrimitiveType.Integer,a="Month"}return e.ValueType.fromPrimitiveTypeAndCategory(r,a)}function j(e,t,i){for(var a=0,r=e.length;r>a;a++){var n=e[a],o=n.Projection,s=n.Name,l=t[o];void 0===l&&(q(t,o),l=t[o]={});var u=l.roles;void 0===l.roles&&(u=l.roles={}),u[s]=!0;var c=i[s];void 0===c&&(c=i[s]=[]),c.push(o)}}function q(e,t){for(var i=e.length;t>i;i++)e[i]={}}function Y(e){var t={},i={selects:t};if(e)for(var a=0,r=e.length;r>a;a++){var n=e[a];t[n.Projection]=!0}return i}function Q(e,t,i){void 0===e&&(e=[]);var a=e;return X(e),t&&(a.identityFields=t),i&&(a.source=i),a}function X(e,t){e.grouped=t?function(){return t}:function(){return K(e)}}function K(e){for(var t,i=[],a=0,r=e.length;r>a;a++){var n=e[a];if(!t||t.identity!==n.identity){if(t={values:[]},n.identity){t.identity=n.identity;var o=n.source;void 0!==o.groupName?t.name=o.groupName:o.displayName&&(t.name=o.displayName)}i.push(t)}t.values.push(n)}return i}function $(e,a){var r;switch(Z(e.categorical,a)){case i.Pivot:r=t.DataViewPivotCategorical.apply(e);break;case i.SelfCrossJoin:r=t.DataViewSelfCrossJoin.apply(e)}return r||e}function Z(e,t){if(e&&!r.isUndefinedOrEmpty(t)){var a=e.categories;if(a&&1===a.length){var n=e.values;if(!r.isUndefinedOrEmpty(n)&&!n.grouped().some(function(e){return!!e.identity}))for(var o=a[0].source.roles,s=0,l=t.length;l>s;s++){var u=t[s].categorical;if(u&&ie(o,u.values)){var c=u.categories,h=ee(o,c)||te(o,c);return h?i.SelfCrossJoin:i.Pivot}}}}}function J(e,t){if(e&&!r.isUndefinedOrEmpty(t)){var i=e.rows.levels;if(!(i.length<1)){var a=e.rows.root.children;if(a&&0!==a.length)for(var n=i[0].sources[0].roles,o=0,s=t.length;s>o;o++){var l=t[o].matrix;if(l&&!te(n,l.rows)&&te(n,l.columns))return!0}}}}function ee(e,t){return e&&t&&t.bind?e[t.bind.to]:void 0}function te(e,t){return e&&t&&t["for"]?e[t["for"]["in"]]:void 0}function ie(e,t){return e&&t&&t.group?e[t.group.by]:void 0}n.apply=o,n.upgradeSettingsToObjects=d,n.createTransformActions=U,n.createValueColumns=Q}(n=t.DataViewTransform||(t.DataViewTransform={}))}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t=function(){function e(e){e&&(this.inputRole=e)}return e.prototype.setContext=function(e,t){this.scopeId=e,this.value=t},e.prototype.evaluate=function(){},e}();e.RuleEvaluation=t}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t=function(e){function t(t,i){e.call(this,t),this.allocator=i}return __extends(t,e),t.prototype.evaluate=function(){return this.allocator.color(this.value)},t}(e.RuleEvaluation);e.ColorRuleEvaluation=t}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var i=function(t){function i(e){t.call(this),this.selection=e}return __extends(i,t),i.prototype.evaluate=function(){for(var t=this.scopeId,i=this.selection.scopeIds,a=0,r=i.length;r>a;a++)if(e.DataViewScopeIdentity.equals(t,i[a]))return!this.selection.isNot},i}(t.RuleEvaluation);t.FilterRuleEvaluation=i}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var i;!function(t){var i;!function(t){function i(t,i){!e.DataViewAnalysis.isMetadataEquivalent(t.metadata,i.metadata),i.metadata.segment||delete t.metadata.segment,t.table&&i.table&&a(t.table,i.table),t.categorical&&i.categorical&&r(t.categorical,i.categorical),t.tree&&i.tree&&o(t.tree.root,i.tree.root,!0),t.matrix&&i.matrix&&o(t.matrix.rows.root,i.matrix.rows.root,!1)}function a(e,t){0!==t.rows.length&&n(e.rows,t.rows,t.lastMergeIndex+1)}function r(e,t){if(e.categories&&t.categories)for(var i=t.categories.length,a=0;i>a;a++){var r=t.categories[a],o=e.categories[a];!o.values&&r.values&&(o.values=[]),r.values&&n(o.values,r.values,t.lastMergeIndex+1),!o.identity&&r.identity&&(o.identity=[]),r.identity&&n(o.identity,r.identity,t.lastMergeIndex+1)}if(e.values&&t.values)for(var s=t.values.length,l=0;s>l;l++){var u=t.values[l],c=e.values[l];!c.values&&u.values&&(c.values=[]),u.values&&n(c.values,u.values,t.lastMergeIndex+1),u.highlights&&n(c.highlights,u.highlights,t.lastMergeIndex+1)}}function n(e,t,i){if(i>=t.length)return t;var a=[];return void 0!==i&&(a=t.splice(0,i)),Array.prototype.push.apply(e,t),a}function o(e,t,i){if(t.children&&0!==t.children.length){if(i&&(!e.children||0===e.children.length))return void(e.children=t.children);var a=s(t.children),r=e.children[e.children.length-1],l=n(e.children,t.children,a);l.length>0&&o(r,l[l.length-1],i)}}function s(e){if(0===e.length)return 0;for(var t=0;t<e.length;t++){var i=e[t];if(!i.isMerge)break}return t}t.mergeDataViews=i,t.mergeTables=a,t.mergeCategorical=r,t.mergeTreeNodes=o}(i=t.DataViewMerger||(t.DataViewMerger={}))}(i=t.segmentation||(t.segmentation={}))}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var i;!function(e){function t(e,t){var i=e.conditions(),r=i[0];if(r){var n=new a(t[0]);if(r.accept(n))return n.getResult()}}function i(e){var t=e.expr.accept(new r);return t?t.value:void 0}e.asScopeIdsContainer=t,e.getFirstComparandValue=i}(i=t.SQExprConverter||(t.SQExprConverter={}));var a=function(i){function a(e){i.call(this),this.isRoot=!0,this.isNot=!1,this.valueExprs=[],this.fieldExpr=t.SQExprBuilder.removeEntityVariables(e)}return __extends(a,i),a.prototype.getResult=function(){for(var e=this.valueExprs,t=[],i=0,r=e.length;r>i;i++)t.push(a.getScopeIdentity(this.fieldExpr,e[i]));return{isNot:this.isNot,scopeIds:t}},a.getScopeIdentity=function(e,i){return t.createDataViewScopeIdentity(t.SQExprBuilder.equal(e,i))},a.prototype.visitOr=function(e){return this.isRoot=!1,e.left.accept(this)&&e.right.accept(this)},a.prototype.visitNot=function(e){return this.isRoot?(this.isNot=!0,e.arg.accept(this)):this.unsupportedSQExpr()},a.prototype.visitConstant=function(t){return this.isRoot&&t.type.primitiveType===e.PrimitiveType.Null?this.unsupportedSQExpr():(this.valueExprs.push(t),!0)},a.prototype.visitCompare=function(e){return this.isRoot=!1,e.kind!==t.QueryComparisonKind.Equal?this.unsupportedSQExpr():e.left.accept(this)&&e.right.accept(this)},a.prototype.visitColumnRef=function(e){if(this.isRoot)return this.unsupportedSQExpr();var i=t.SQExprBuilder.removeEntityVariables(e);return t.SQExpr.equals(this.fieldExpr,i)},a.prototype.visitDefault=function(e){return this.unsupportedSQExpr()},a.prototype.unsupportedSQExpr=function(){return!1},a}(t.DefaultSQExprVisitor),r=function(e){function i(){e.apply(this,arguments)}return __extends(i,e),i.prototype.visitAnd=function(e){return e.left.accept(this)||e.right.accept(this)},i.prototype.visitCompare=function(e){if(e.kind===t.QueryComparisonKind.Equal){if(e.right instanceof t.SQConstantExpr)return e.right;if(e.left instanceof t.SQConstantExpr)return e.left}},i}(t.DefaultSQExprVisitor)}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t,i=jsCommon.ArrayExtensions;!function(t){function a(e){var t=new r;return e.accept(t),t.malformed?null:i.emptyToNull(t.keys)}t.run=a;var r=function(t){function i(){t.apply(this,arguments),this.keys=[]}return __extends(i,t),i.prototype.visitAnd=function(e){e.left.accept(this),e.right.accept(this)},i.prototype.visitCompare=function(t){return t.kind!==e.QueryComparisonKind.Equal?void this.visitDefault(t):(t.left.accept(this),void t.right.accept(this))},i.prototype.visitColumnRef=function(e){this.keys.push(e)},i.prototype.visitConstant=function(e){},i.prototype.visitDefault=function(e){this.malformed=!0},i}(e.DefaultSQExprVisitor)}(t=e.ScopeIdentityKeyExtractor||(e.ScopeIdentityKeyExtractor={}))}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t;!function(e){function t(e){return e.accept(a.instance)}e.asSQFieldDef=t}(t=e.SQExprConverter||(e.SQExprConverter={}));var i;!function(e){function t(e){return i(e)||a(e)||r(e)||n(e)}function i(t){var i=t.aggregate;if(void 0!==i){var r=a(t)||n(t);if(r)return e.aggregate(r,i)}}function a(t){var i=t.column;if(i){var a=n(t);if(a)return e.columnRef(a,i)}}function r(t){var i=t.measure;if(i){var a=n(t);if(a)return e.measureRef(a,i)}}function n(t){return e.entity(t.schema,t.entity,t.entityVar)}e.fieldDef=t}(i=e.SQExprBuilder||(e.SQExprBuilder={}));var a=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.visitColumnRef=function(e){var t=e.source.accept(this);return t?(t.column=e.ref,t):void 0},t.prototype.visitMeasureRef=function(e){var t=e.source.accept(this);return t?(t.measure=e.ref,t):void 0},t.prototype.visitAggr=function(e){var t=e.arg.accept(this);return t?(t.aggregate=e.func,t):void 0},t.prototype.visitEntity=function(e){var t={schema:e.schema,entity:e.entity};return e.variable&&(t.entityVar=e.variable),t},t.instance=new t,t}(e.DefaultSQExprVisitor)}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t;!function(e){function t(e){return e+"M"}function i(e){return e+"D"}function a(e){return e+"L"}function r(e){var t=new Date(e.getTime()-6e4*e.getTimezoneOffset()),i=t.toISOString();return jsCommon.StringExtensions.endsWith(i,"Z")&&(i=i.substr(0,i.length-1)),"datetime'"+i+"'"}function n(e){return"'"+e.replace("'","''")+"'"}function o(){return"null"}function s(e){return e?"true":"false"}e.decimal=t,e["double"]=i,e.integer=a,e.dateTime=r,e.text=n,e.nullEncoding=o,e["boolean"]=s}(t=e.PrimitiveValueEncoding||(e.PrimitiveValueEncoding={}))}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t=jsCommon.ArrayExtensions,i=function(){function i(){}return i.prototype.visitColumnRef=function(t){var i=t.source,a=i.accept(this);return i===a?t:new e.SQColumnRefExpr(a,t.ref)},i.prototype.visitMeasureRef=function(t){var i=t.source,a=i.accept(this);return i===a?t:new e.SQMeasureRefExpr(a,t.ref)},i.prototype.visitAggr=function(t){var i=t.arg,a=i.accept(this);return i===a?t:new e.SQAggregationExpr(a,t.func)},i.prototype.visitEntity=function(e){return e},i.prototype.visitAnd=function(t){var i=t.left,a=i.accept(this),r=t.right,n=r.accept(this);return i===a&&r===n?t:new e.SQAndExpr(a,n)},i.prototype.visitBetween=function(t){var i=t.arg,a=i.accept(this),r=t.lower,n=r.accept(this),o=t.upper,s=o.accept(this);return i===a&&r===n&&o===s?t:new e.SQBetweenExpr(a,n,s)},i.prototype.visitIn=function(i){for(var a,r=i.args,n=this.rewriteAll(r),o=i.values,s=0,l=o.length;l>s;s++){var u=o[s],c=this.rewriteAll(u);u===c||a||(a=t.take(o,s)),a&&a.push(c)}return r!==n||a?new e.SQInExpr(n,a||o):i},i.prototype.rewriteAll=function(e){for(var i,a=0,r=e.length;r>a;a++){var n=e[a],o=n.accept(this);n===o||i||(i=t.take(e,a)),i&&i.push(o)}return i||e},i.prototype.visitOr=function(t){var i=t.left,a=i.accept(this),r=t.right,n=r.accept(this);return i===a&&r===n?t:new e.SQOrExpr(a,n)},i.prototype.visitCompare=function(t){var i=t.left,a=i.accept(this),r=t.right,n=r.accept(this);return i===a&&r===n?t:new e.SQCompareExpr(t.kind,a,n)},i.prototype.visitContains=function(t){var i=t.left,a=i.accept(this),r=t.right,n=r.accept(this);return i===a&&r===n?t:new e.SQContainsExpr(a,n)},i.prototype.visitExists=function(t){var i=t.arg,a=i.accept(this);return i===a?t:new e.SQExistsExpr(a)},i.prototype.visitNot=function(t){var i=t.arg,a=i.accept(this);return i===a?t:new e.SQNotExpr(a)},i.prototype.visitStartsWith=function(t){var i=t.left,a=i.accept(this),r=t.right,n=r.accept(this);return i===a&&r===n?t:new e.SQStartsWithExpr(a,n)},i.prototype.visitConstant=function(e){return e},i.prototype.visitDateSpan=function(t){var i=t.arg,a=i.accept(this);return i===a?t:new e.SQDateSpanExpr(t.unit,a)},i.prototype.visitDateAdd=function(t){var i=t.arg,a=i.accept(this);return i===a?t:new e.SQDateAddExpr(t.unit,t.amount,a)},i.prototype.visitNow=function(e){return e},i}();e.SQExprRewriter=i}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){function i(e){return e.integer||e.numeric?t.QueryAggregateFunction.Sum:t.QueryAggregateFunction.Count}function a(e){switch(e){case t.ConceptualDefaultAggregate.Average:return t.QueryAggregateFunction.Avg;case t.ConceptualDefaultAggregate.Count:return t.QueryAggregateFunction.CountNonNull;case t.ConceptualDefaultAggregate.DistinctCount:return t.QueryAggregateFunction.Count;case t.ConceptualDefaultAggregate.Max:return t.QueryAggregateFunction.Max;case t.ConceptualDefaultAggregate.Min:return t.QueryAggregateFunction.Min;case t.ConceptualDefaultAggregate.Sum:return t.QueryAggregateFunction.Sum;default:return}}var r=jsCommon.StringExtensions,n=function(){function r(){}return r.equals=function(e,t,i){return D.run(e,t,i)},r.prototype.validate=function(e,t){var i=new M(e,t);return this.accept(i),i.errors},r.prototype.accept=function(e,t){},r.prototype.getMetadata=function(e){var i=t.SQExprConverter.asSQFieldDef(this);if(i)return i.column||i.measure?this.getMetadataForProperty(i,e):r.getMetadataForEntity(i,e)},r.prototype.getDefaultAggregate=function(e,r){void 0===r&&(r=!1);var n=this.getConceptualProperty(e);if(n){var o;if(n&&n.kind===t.ConceptualPropertyKind.Column){var s=n.column?n.column.defaultAggregate:null;(n.type.integer||n.type.numeric)&&s!==t.ConceptualDefaultAggregate.None&&(o=a(s),void 0===o&&(o=i(n.type))),void 0===o&&r&&(o=t.QueryAggregateFunction.CountNonNull)}return o}},r.prototype.getKeyColumns=function(e){var t=A.getColumnRefSQExpr(this);if(t){var i=[],a=this.getPropertyKeys(e);if(a&&a.length>0)for(var r=0,n=a.length;n>r;r++)i.push(_.columnRef(t.source,a[r].name));else i.push(t);return i}},r.prototype.hasGroupOnKeys=function(e){var t=A.getColumnRefSQExpr(this);if(t){var i=this.getPropertyKeys(e);if(!i||i.length<1)return!1;if(i.length>1)return!0;var a=_.columnRef(t.source,i[0].name);return!r.equals(a,this)}},r.prototype.getPropertyKeys=function(e){var t=this.getConceptualProperty(e);if(t)return t.column?t.column.keys:void 0},r.prototype.getConceptualProperty=function(e){var i=t.SQExprConverter.asSQFieldDef(this);if(i)return e.schema(i.schema).findProperty(i.entity,i.column||i.measure)},r.prototype.getMetadataForProperty=function(i,a){var r=this.getConceptualProperty(a);if(r){var n=r.format,o=r.type;switch(i.aggregate){case t.QueryAggregateFunction.Count:case t.QueryAggregateFunction.CountNonNull:o=e.ValueType.fromExtendedType(e.ExtendedType.Integer),n=void 0;break;case t.QueryAggregateFunction.Avg:o.integer&&(o=e.ValueType.fromExtendedType(e.ExtendedType.Double))}return{kind:r.kind===t.ConceptualPropertyKind.Measure||void 0!==i.aggregate?1:0,type:o,format:n,idOnEntityKey:r.column?r.column.idOnEntityKey:!1,aggregate:i.aggregate,defaultAggregate:r.column?r.column.defaultAggregate:null}}},r.getMetadataForEntity=function(i,a){var r=a.schema(i.schema).entities.withName(i.entity);if(r)return i.aggregate===t.QueryAggregateFunction.Count||i.aggregate===t.QueryAggregateFunction.CountNonNull?{kind:1,type:e.ValueType.fromExtendedType(e.ExtendedType.Integer),format:void 0,idOnEntityKey:!1,aggregate:i.aggregate}:void 0},r}();t.SQExpr=n,t.defaultAggregateForDataType=i,t.defaultAggregateToQueryAggregateFunction=a;var o=function(e){function t(t,i,a){e.call(this),this.schema=t,this.entity=i,a&&(this.variable=a)}return __extends(t,e),t.prototype.accept=function(e,t){return e.visitEntity(this,t)},t}(n);t.SQEntityExpr=o;var s=function(e){function t(t,i){e.call(this),this.source=t,this.ref=i}return __extends(t,e),t}(n);t.SQPropRefExpr=s;var l=function(e){function t(t,i){e.call(this,t,i)}return __extends(t,e),t.prototype.accept=function(e,t){return e.visitColumnRef(this,t)},t}(s);t.SQColumnRefExpr=l;var u=function(e){function t(t,i){e.call(this,t,i)}return __extends(t,e),t.prototype.accept=function(e,t){return e.visitMeasureRef(this,t)},t}(s);t.SQMeasureRefExpr=u;var c=function(e){function t(t,i){e.call(this),this.arg=t,this.func=i}return __extends(t,e),t.prototype.accept=function(e,t){return e.visitAggr(this,t)},t}(n);t.SQAggregationExpr=c;var h=function(e){function t(t,i){e.call(this),this.left=t,this.right=i}return __extends(t,e),t.prototype.accept=function(e,t){return e.visitAnd(this,t)},t}(n);t.SQAndExpr=h;var d=function(e){function t(t,i,a){e.call(this),this.arg=t,this.lower=i,this.upper=a}return __extends(t,e),t.prototype.accept=function(e,t){return e.visitBetween(this,t)},t}(n);t.SQBetweenExpr=d;var p=function(e){function t(t,i){e.call(this),this.args=t,this.values=i}return __extends(t,e),t.prototype.accept=function(e,t){return e.visitIn(this,t)},t}(n);t.SQInExpr=p;var g=function(e){function t(t,i){e.call(this),this.left=t,this.right=i}return __extends(t,e),t.prototype.accept=function(e,t){return e.visitOr(this,t)},t}(n);t.SQOrExpr=g;var f=function(e){function t(t,i,a){e.call(this),this.kind=t,this.left=i,this.right=a}return __extends(t,e),t.prototype.accept=function(e,t){return e.visitCompare(this,t)},t}(n);t.SQCompareExpr=f;var m=function(e){function t(t,i){e.call(this),this.left=t,this.right=i}return __extends(t,e),t.prototype.accept=function(e,t){return e.visitContains(this,t)},t}(n);t.SQContainsExpr=m;var y=function(e){function t(t,i){e.call(this),this.left=t,this.right=i}return __extends(t,e),t.prototype.accept=function(e,t){return e.visitStartsWith(this,t)},t}(n);t.SQStartsWithExpr=y;var v=function(e){function t(t){e.call(this),this.arg=t}return __extends(t,e),t.prototype.accept=function(e,t){return e.visitExists(this,t)},t}(n);t.SQExistsExpr=v;var C=function(e){function t(t){e.call(this),this.arg=t}return __extends(t,e),t.prototype.accept=function(e,t){return e.visitNot(this,t)},t}(n);t.SQNotExpr=C;var b=function(e){function t(t,i,a){e.call(this),this.type=t,this.value=i,this.valueEncoded=a}return __extends(t,e),t.prototype.accept=function(e,t){return e.visitConstant(this,t)},t}(n);t.SQConstantExpr=b;var x=function(e){function t(t,i){e.call(this),this.unit=t,this.arg=i}return __extends(t,e),t.prototype.accept=function(e,t){return e.visitDateSpan(this,t)},t}(n);t.SQDateSpanExpr=x;var S=function(e){function t(t,i,a){e.call(this),this.unit=t,this.arg=a,this.amount=i}return __extends(t,e),t.prototype.accept=function(e,t){return e.visitDateAdd(this,t)},t}(n);t.SQDateAddExpr=S;var w=function(e){function t(){e.call(this)}return __extends(t,e),t.prototype.accept=function(e,t){return e.visitNow(this,t)},t}(n);t.SQNowExpr=w;var _;!function(i){function a(e,t,i){return new o(e,t,i)}function r(e,t){return new l(e,t)}function n(e,t){return new u(e,t)}function s(e,t){return new c(e,t)}function _(e,t){return e?t?new h(e,t):e:t}function T(e,t,i){return new d(e,t,i)}function D(e,t){return new p(e,t)}function P(e,t){return e?t?new g(e,t):e:t}function M(e,t,i){return new f(e,t,i)}function L(e,t){return new m(e,t)}function A(e){return new v(e)}function R(e,i){return M(t.QueryComparisonKind.Equal,e,i)}function H(e){return new C(e)}function E(e,t){return new y(e,t)}function O(){return new b(e.ValueType.fromExtendedType(e.ExtendedType.Null),null,t.PrimitiveValueEncoding.nullEncoding())}function F(){return new w}function G(i){return new b(e.ValueType.fromExtendedType(e.ExtendedType.Boolean),i,t.PrimitiveValueEncoding["boolean"](i))}function z(e,t,i){return new S(e,t,i)}function W(i,a){return void 0===a&&(a=t.PrimitiveValueEncoding.dateTime(i)),new b(e.ValueType.fromExtendedType(e.ExtendedType.DateTime),i,a)}function U(e,t){return new x(e,t)}function B(i,a){return void 0===a&&(a=t.PrimitiveValueEncoding.decimal(i)),new b(e.ValueType.fromExtendedType(e.ExtendedType.Decimal),i,a)}function k(i,a){return void 0===a&&(a=t.PrimitiveValueEncoding["double"](i)),new b(e.ValueType.fromExtendedType(e.ExtendedType.Double),i,a)}function j(i,a){return void 0===a&&(a=t.PrimitiveValueEncoding.integer(i)),new b(e.ValueType.fromExtendedType(e.ExtendedType.Integer),i,a)}function q(i,a){return new b(e.ValueType.fromExtendedType(e.ExtendedType.Text),i,a||t.PrimitiveValueEncoding.text(i))}function Y(e,t){return N.rewrite(e,t)}function Q(e){return V.rewrite(e)}function X(e){return I.rewrite(e)}function K(e,t,a){var r=e.getDefaultAggregate(t,a);return void 0!==r&&(e=i.aggregate(e,r)),e}i.entity=a,i.columnRef=r,i.measureRef=n,i.aggregate=s,i.and=_,i.between=T,i.inExpr=D,i.or=P,i.compare=M,i.contains=L,i.exists=A,i.equal=R,i.not=H,i.startsWith=E,i.nullConstant=O,i.now=F,i["boolean"]=G,i.dateAdd=z,i.dateTime=W,i.dateSpan=U,i.decimal=B,i["double"]=k,i.integer=j,i.text=q,i.setAggregate=Y,i.removeAggregate=Q,i.removeEntityVariables=X,i.createExprWithAggregate=K}(_=t.SQExprBuilder||(t.SQExprBuilder={}));var T;!function(e){function t(e){return L.getAggregate(e)}e.getAggregate=t}(T=t.SQExprInfo||(t.SQExprInfo={}));var D=function(){function e(e){this.ignoreCase=e}return e.run=function(t,i,a){return t=t||null,i=i||null,t===i?!0:!t!=!i?!1:a?t.accept(e.ignoreCaseInstance,i):t.accept(e.instance,i)},e.prototype.visitColumnRef=function(e,t){return t instanceof l&&e.ref===t.ref&&this.equals(e.source,t.source)},e.prototype.visitMeasureRef=function(e,t){return t instanceof u&&e.ref===t.ref&&this.equals(e.source,t.source)},e.prototype.visitAggr=function(e,t){return t instanceof c&&e.func===t.func&&this.equals(e.arg,t.arg)},e.prototype.visitBetween=function(e,t){return t instanceof d&&this.equals(e.arg,t.arg)&&this.equals(e.lower,t.lower)&&this.equals(e.upper,t.upper)},e.prototype.visitIn=function(e,t){if(!(t instanceof p&&this.equalsAll(e.args,t.args)))return!1;var i=e.values,a=t.values;if(i.length!==a.length)return!1;for(var r=0,n=i.length;n>r;r++)if(!this.equalsAll(i[r],a[r]))return!1;return!0},e.prototype.visitEntity=function(e,t){return t instanceof o&&e.schema===t.schema&&e.entity===t.entity&&this.optionalEqual(e.variable,t.variable)},e.prototype.visitAnd=function(e,t){return t instanceof h&&this.equals(e.left,t.left)&&this.equals(e.right,t.right)},e.prototype.visitOr=function(e,t){return t instanceof g&&this.equals(e.left,t.left)&&this.equals(e.right,t.right)},e.prototype.visitCompare=function(e,t){return t instanceof f&&e.kind===t.kind&&this.equals(e.left,t.left)&&this.equals(e.right,t.right)},e.prototype.visitContains=function(e,t){return t instanceof m&&this.equals(e.left,t.left)&&this.equals(e.right,t.right)},e.prototype.visitDateSpan=function(e,t){return t instanceof x&&e.unit===t.unit&&this.equals(e.arg,t.arg)},e.prototype.visitDateAdd=function(e,t){return t instanceof S&&e.unit===t.unit&&e.amount===t.amount&&this.equals(e.arg,t.arg)},e.prototype.visitExists=function(e,t){return t instanceof v&&this.equals(e.arg,t.arg)},e.prototype.visitNot=function(e,t){return t instanceof C&&this.equals(e.arg,t.arg)},e.prototype.visitNow=function(e,t){return t instanceof w},e.prototype.visitStartsWith=function(e,t){return t instanceof y&&this.equals(e.left,t.left)&&this.equals(e.right,t.right)},e.prototype.visitConstant=function(e,t){return t instanceof b&&e.type===t.type?e.type.text&&this.ignoreCase?r.equalIgnoreCase(e.valueEncoded,t.valueEncoded):e.valueEncoded===t.valueEncoded:!1;
},e.prototype.optionalEqual=function(e,t){return e&&t?e===t:!0},e.prototype.equals=function(e,t){return e.accept(this,t)},e.prototype.equalsAll=function(e,t){var i=e.length;if(i!==t.length)return!1;for(var a=0;i>a;a++)if(!this.equals(e[a],t[a]))return!1;return!0},e.instance=new e(!1),e.ignoreCaseInstance=new e(!0),e}(),P=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.visitDefault=function(e){return e},t}(t.DefaultSQExprVisitor),M=function(e){function i(t,i){e.call(this),this.schema=t,i&&(this.errors=i)}return __extends(i,e),i.prototype.visitColumnRef=function(e){var i=t.SQExprConverter.asSQFieldDef(e);if(i){var a=this.validateEntity(i.schema,i.entity);if(a){var r=a.properties.withName(i.column);r&&r.kind===t.ConceptualPropertyKind.Column&&this.isQueryable(i)||this.register(3)}}return e},i.prototype.visitMeasureRef=function(e){var i=t.SQExprConverter.asSQFieldDef(e);if(i){var a=this.validateEntity(i.schema,i.entity);if(a){var r=a.properties.withName(i.measure);r&&r.kind===t.ConceptualPropertyKind.Measure&&this.isQueryable(i)||this.register(4)}}return e},i.prototype.visitAggr=function(i){var a=e.prototype.visitAggr.call(this,i),r=A.getColumnRefSQExpr(a.arg);if(r){var n=t.SQExprUtils.getSupportedAggregates(r,!1,this.schema);n.indexOf(i.func)<0&&this.register(0)}return a},i.prototype.visitEntity=function(e){return this.validateEntity(e.schema,e.entity),e},i.prototype.visitContains=function(e){var t=e.left,i=e.right;return t instanceof l?(this.visitColumnRef(t),i instanceof b&&i.type.text||this.register(6)):this.register(5),e},i.prototype.visitStartsWith=function(e){var t=e.left,i=e.right;return t instanceof l?(this.visitColumnRef(t),i instanceof b&&i.type.text||this.register(6)):this.register(5),e},i.prototype.validateEntity=function(e,t){var i=this.schema.schema(e);if(i){var a=i.entities.withName(t);if(a)return a;this.register(2)}else this.register(1)},i.prototype.register=function(e){this.errors||(this.errors=[]),this.errors.push(e)},i.prototype.isQueryable=function(e){return this.schema.schema(e.schema).findProperty(e.entity,e.column||e.measure).queryable!==t.ConceptualQueryableState.Error},i}(t.SQExprRewriter);t.SQExprValidationVisitor=M;var L=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.visitAggr=function(e){return e.func},t.prototype.visitDefault=function(e){},t.getAggregate=function(e){var i=new t;return e.accept(i)},t}(t.DefaultSQExprVisitor),A=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.visitColumnRef=function(e){return e},t.prototype.visitDefault=function(e){},t.getColumnRefSQExpr=function(e){var i=new t;return e.accept(i)},t}(t.DefaultSQExprVisitor),N=function(e){function t(t){e.call(this),this.func=t}return __extends(t,e),t.prototype.visitAggr=function(e){return e.func===this.func?e:new c(e.arg,this.func)},t.prototype.visitColumnRef=function(e){return new c(e,this.func)},t.rewrite=function(e,i){var a=new t(i);return e.accept(a)},t}(P),V=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.visitAggr=function(e){return e.arg},t.rewrite=function(e){return e.accept(t.instance)},t.instance=new t,t}(P),I=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.visitEntity=function(e){return e.variable?_.entity(e.schema,e.entity):e},t.rewrite=function(e){return e.accept(t.instance)},t.instance=new t,t}(t.SQExprRewriter)}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t,i=jsCommon.StringExtensions;!function(t){function a(t,i,a){var r=[],n=u(t,a);if(!n)return r;var o=n.type,s=n.kind,l=n.idOnEntityKey,c=e.QueryAggregateFunction;return o?1===s?r:i?r:o.numeric||o.integer?[c.Sum,c.Avg,c.Min,c.Max,c.Count,c.CountNonNull]:o.text||o.bool||o.dateTime?l?[c.CountNonNull]:[c.Count,c.CountNonNull]:r:r}function r(t,i){for(var a=0,r=t.length;r>a;a++)if(e.SQExpr.equals(t[a],i))return a;return-1}function n(t,i){var a=t.length;if(a!==i.length)return!1;for(var r=0;a>r;r++)if(!e.SQExpr.equals(t[r],i[r]))return!1;return!0}function o(e,t){for(var a={},r=0,n=e.length;n>r;r++)a[e[r].name]=!0;return i.findUniqueName(a,s(t))}function s(e,t){return void 0===t&&(t="select"),e?e.accept(c.instance,t):t}function l(e){return e.accept(h.instance)}function u(t,i){var a=e.SQExprBuilder.removeAggregate(t).getMetadata(i);return a||(a=t.getMetadata(i)),a}t.getSupportedAggregates=a,t.indexOfExpr=r,t.sequenceEqual=n,t.uniqueName=o,t.defaultName=s,t.isMeasure=l;var c=function(t){function i(){t.apply(this,arguments)}return __extends(i,t),i.prototype.visitEntity=function(e){return e.entity},i.prototype.visitColumnRef=function(e){return e.source.accept(this)+"."+e.ref},i.prototype.visitMeasureRef=function(e,t){return e.source.accept(this)+"."+e.ref},i.prototype.visitAggr=function(t,i){return e.QueryAggregateFunction[t.func]+"("+t.arg.accept(this)+")"},i.prototype.visitDefault=function(e,t){return t||"expr"},i.instance=new i,i}(e.DefaultSQExprVisitorWithArg),h=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.visitMeasureRef=function(e){return!0},t.prototype.visitAggr=function(e){return!0},t.prototype.visitDefault=function(e){return!1},t.instance=new t,t}(e.DefaultSQExprVisitor)}(t=e.SQExprUtils||(e.SQExprUtils={}))}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t=function(){function t(e){this.exprRewriter=e}return t.prototype.rewriteFrom=function(t){for(var i={},a=t,r=a.keys(),n=0,o=r.length;o>n;n++){var s=r[n],l=a.entity(s),u=e.SQExprBuilder.entity(l.schema,l.entity,s),c=u.accept(this.exprRewriter);i[s]={schema:c.schema,entity:c.entity}}return new e.SQFrom(i)},t.prototype.rewriteSelect=function(t,i){if(t&&0!==t.length){for(var a=[],r=0,n=t.length;n>r;r++){var o=t[r];a.push({name:o.name,expr:e.SQExprRewriterWithSourceRenames.rewrite(o.expr.accept(this.exprRewriter),i)})}return a}},t.prototype.rewriteOrderBy=function(t,i){if(t&&0!==t.length){for(var a=[],r=0,n=t.length;n>r;r++){var o=t[r],s=e.SQExprRewriterWithSourceRenames.rewrite(o.expr.accept(this.exprRewriter),i);a.push({direction:o.direction,expr:s})}return a}},t.prototype.rewriteWhere=function(t,i){var a=this;if(t&&0!==t.length){for(var r=[],n=0,o=t.length;o>n;n++){var s=t[n],l={condition:e.SQExprRewriterWithSourceRenames.rewrite(s.condition.accept(this.exprRewriter),i)};s.target&&(l.target=_.map(s.target,function(t){return e.SQExprRewriterWithSourceRenames.rewrite(t.accept(a.exprRewriter),i)})),r.push(l)}return r}},t}();e.SemanticQueryRewriter=t}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t=jsCommon.ArrayExtensions,i=function(){function i(e,t,i,a){this.fromValue=e,this.whereItems=t,this.orderByItems=i,this.selectItems=a}return i.create=function(){return i.empty||(i.empty=new i(new r,null,null,[])),i.empty},i.createWithTrimmedFrom=function(e,t,a,r){var n=new s(e.keys());if(t)for(var o=0,l=t.length;l>o;o++){var u=t[o];u.condition.accept(n);var c=u.target;if(c)for(var h=0,d=c.length;d>h;h++)c[h]&&c[h].accept(n)}if(a)for(var o=0,l=a.length;l>o;o++)a[o].expr.accept(n);for(var o=0,l=r.length;l>o;o++)r[o].expr.accept(n);for(var p=n.result(),o=0,l=p.length;l>o;o++)e.remove(p[o]);return new i(e,t,a,r)},i.prototype.from=function(){return this.fromValue.clone()},i.prototype.select=function(e){return 0===arguments.length?this.getSelect():this.setSelect(e)},i.prototype.getSelect=function(){return t.extendWithName(_.map(this.selectItems,function(e){return{name:e.name,expr:e.expr}}))},i.prototype.setSelect=function(e){for(var t=[],a=this.fromValue.clone(),r=0,o=e.length;o>r;r++){var s=e[r];t.push({name:s.name,expr:n.rewrite(s.expr,a)})}return i.createWithTrimmedFrom(a,this.whereItems,this.orderByItems,t)},i.prototype.removeSelect=function(t){for(var a=this.selectItems,r=[],n=0,o=a.length;o>n;n++){var s=a[n];e.SQExpr.equals(s.expr,t)||r.push(s)}return i.createWithTrimmedFrom(this.fromValue.clone(),this.whereItems,this.orderByItems,r)},i.prototype.removeOrderBy=function(t){for(var a=this.orderBy(),r=a.length-1;r>=0;r--)e.SQExpr.equals(a[r].expr,t)&&a.splice(r,1);return i.createWithTrimmedFrom(this.fromValue.clone(),this.whereItems,a,this.selectItems)},i.prototype.selectNameOf=function(t){var i=e.SQExprUtils.indexOfExpr(_.map(this.selectItems,function(e){return e.expr}),t);return i>=0?this.selectItems[i].name:void 0},i.prototype.setSelectAt=function(e,t){if(!(e>=this.selectItems.length)){var a=this.select(),r=this.fromValue.clone(),o=a[e].name;return a[e]={name:o,expr:n.rewrite(t,r)},i.createWithTrimmedFrom(r,this.whereItems,this.orderByItems,a)}},i.prototype.addSelect=function(t){var a=this.select(),r=this.fromValue.clone();return a.push({name:e.SQExprUtils.uniqueName(a,t),expr:n.rewrite(t,r)}),i.createWithTrimmedFrom(r,this.whereItems,this.orderByItems,a)},i.prototype.orderBy=function(e){return 0===arguments.length?this.getOrderBy():this.setOrderBy(e)},i.prototype.getOrderBy=function(){var e=[],t=this.orderByItems;if(t)for(var i=0,a=t.length;a>i;i++){var r=t[i];e.push({expr:r.expr,direction:r.direction})}return e},i.prototype.setOrderBy=function(e){for(var t=[],a=this.fromValue.clone(),r=0,o=e.length;o>r;r++){var s=e[r];t.push({expr:n.rewrite(s.expr,a),direction:s.direction})}return i.createWithTrimmedFrom(a,this.whereItems,t,this.selectItems)},i.prototype.where=function(e){return 0===arguments.length?this.getWhere():this.setWhere(e)},i.prototype.getWhere=function(){var e=[],t=this.whereItems;if(t)for(var i=0,a=t.length;a>i;i++)e.push(t[i]);return e},i.prototype.setWhere=function(e){for(var t=[],a=this.fromValue.clone(),r=0,o=e.length;o>r;r++){var s=e[r],l={condition:n.rewrite(s.condition,a)},u=s.target;if(u){l.target=[];for(var c=0,h=u.length;h>c;c++)if(u[c]){var d=n.rewrite(u[c],a);l.target.push(d)}}t.push(l)}return i.createWithTrimmedFrom(a,t,this.orderByItems,this.selectItems)},i.prototype.addWhere=function(e){for(var t=this.where(),a=e.where(),r=this.fromValue.clone(),o=0,s=a.length;s>o;o++){var l=a[o],u={condition:n.rewrite(l.condition,r)};l.target&&(u.target=_.map(l.target,function(e){return n.rewrite(e,r)})),t.push(u)}return i.createWithTrimmedFrom(r,t,this.orderByItems,this.selectItems)},i.prototype.rewrite=function(t){var a=new e.SemanticQueryRewriter(t),r=a.rewriteFrom(this.fromValue),n=a.rewriteWhere(this.whereItems,r),o=a.rewriteOrderBy(this.orderByItems,r),s=a.rewriteSelect(this.selectItems,r);return i.createWithTrimmedFrom(r,n,o,s)},i}();e.SemanticQuery=i;var a=function(){function i(e,t){this.fromValue=e,this.whereItems=t}return i.fromSQExpr=function(e){var t=new r,a=n.rewrite(e,t),o=[{condition:a}];return new i(t,o)},i.prototype.from=function(){return this.fromValue.clone()},i.prototype.conditions=function(){for(var e=[],t=this.whereItems,i=0,a=t.length;a>i;i++){var r=t[i];e.push(r.condition)}return e},i.prototype.where=function(){for(var e=[],t=this.whereItems,i=0,a=t.length;a>i;i++)e.push(t[i]);return e},i.prototype.rewrite=function(t){var a=new e.SemanticQueryRewriter(t),r=a.rewriteFrom(this.fromValue),n=a.rewriteWhere(this.whereItems,r);return new i(r,n)},i.prototype.validate=function(t,i){var a=new e.SQExprValidationVisitor(t,i);return this.rewrite(a),a.errors},i.merge=function(e){if(t.isUndefinedOrEmpty(e))return null;if(1===e.length)return e[0];for(var a=e[0],r=a.from(),n=t.take(a.whereItems,a.whereItems.length),o=1,s=e.length;s>o;o++)i.applyFilter(e[o],r,n);return new i(r,n)},i.applyFilter=function(e,t,i){for(var a=e.whereItems,r=0;r<a.length;r++){var o=a[r],s={condition:n.rewrite(o.condition,t)};o.target&&(s.target=_.map(o.target,function(e){return n.rewrite(e,t)})),i.push(s)}},i}();e.SemanticFilter=a;var r=function(){function e(e){this.items=e||{}}return e.prototype.keys=function(){return Object.keys(this.items)},e.prototype.entity=function(e){return this.items[e]},e.prototype.ensureEntity=function(e,t){for(var i=this.keys(),a=0,r=i.length;r>a;a++){var n=i[a],o=this.items[n];if(o&&e.entity===o.entity&&e.schema===o.schema)return{name:n}}for(var s=t||this.candidateName(e.entity),l=s,a=2;this.items[l];)l=s+a++;return this.items[l]=e,{name:l,"new":!0}},e.prototype.remove=function(e){delete this.items[e]},e.prototype.candidateName=function(e){var t=e.lastIndexOf(".");return t>=0&&t!==e.length-1&&(e=e.substr(t+1)),e.substring(0,1).toLowerCase()},e.prototype.clone=function(){var t=new e;return $.extend(t.items,this.items),t},e}();e.SQFrom=r;var n=function(i){function a(e){i.call(this),this.renames=e}return __extends(a,i),a.prototype.visitEntity=function(t){var a=this.renames[t.entity];return a?new e.SQEntityExpr(t.schema,t.entity,a):i.prototype.visitEntity.call(this,t)},a.prototype.rewriteFilter=function(e){var t=void 0;e.target&&(t=this.rewriteArray(e.target));var i=e.condition.accept(this);if(e.condition===i&&e.target===t)return e;var a={condition:i};return t&&(a.target=t),a},a.prototype.rewriteArray=function(e){for(var i,a=0,r=e.length;r>a;a++){var n=e[a],o=n.accept(this);n===o||i||(i=t.take(e,a)),i&&i.push(o)}return i||e},a.rewrite=function(e,t){var i=o.run(e,t),r=new a(i);return e.accept(r)},a}(e.SQExprRewriter);e.SQExprRewriterWithSourceRenames=n;var o=function(e){function t(t){e.call(this),this.from=t,this.renames={}}return __extends(t,e),t.run=function(e,i){var a=new t(i);return e.accept(a),a.renames},t.prototype.visitEntity=function(e){var t=this.from.entity(e.variable);if(!t||t.schema!==e.schema||t.entity!==e.entity){var i=this.from.ensureEntity({schema:e.schema,entity:e.entity},e.variable);this.renames[e.entity]=i.name}},t}(e.DefaultSQExprVisitorWithTraversal),s=function(e){function t(t){e.call(this),this.keys=t}return __extends(t,e),t.prototype.visitEntity=function(e){var t=this.keys.indexOf(e.variable);t>=0&&this.keys.splice(t,1)},t.prototype.result=function(){return this.keys},t}(e.DefaultSQExprVisitorWithTraversal)}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t,i=jsCommon.StringExtensions,a=jsCommon.Formatting;!function(e){function t(e,t){for(var a=t.length,r=0;a>r;r++){var n="\\"+t[r],o=String.fromCharCode(57344+r);e=i.replaceAll(e,n,o)}return e}function a(e,t){for(var a=t.length,r=0;a>r;r++){var n=String.fromCharCode(57344+r),o=t[r];e=i.replaceAll(e,n,o)}return i.replaceAll(e,"\\","")}function r(e,t){e=i.replaceAll(e,'"',"'");for(var a=0;;a++){var r=e.indexOf("'");if(0>r)break;var n=e.indexOf("'",r+1);if(0>n)break;var o=e.substring(r,n+1);t.push(o.substring(1,n-r));var s=String.fromCharCode(57600+a);e=e.replace(o,s)}return e}function n(e,t){for(var i=t.length,a=0;i>a;a++){var r=String.fromCharCode(57600+a),n=t[a];e=e.replace(r,n)}return e}e.preserveEscaped=t,e.restoreEscaped=a,e.preserveLiterals=r,e.restoreLiterals=n}(t||(t={}));var r,n=function(){function e(){}return e.prototype.formatValue=function(e,t,i){if(void 0===e||null===e)return"";var a=this.getCulture(i);return r.canFormat(e)?r.format(e,t,a):o.canFormat(e)?o.format(e,t,a):e.toString()},e.prototype.format=function(e,t,i){var a=this;if(!e)return"";var r=e.replace(/({{)|(}})|{(\d+[^}]*)}/g,function(e,r,n,o){if(r)return"{";if(n)return"}";var s=o.split(":"),l=parseInt(s[0],10),u=s[1];return a.formatValue(t[l],u,i)});return r},e.prototype.isStandardNumberFormat=function(e){return o.isStandardFormat(e)},e.prototype.formatNumberWithCustomOverride=function(e,t,i,a){var r=this.getCulture(a);return o.formatWithCustomOverride(e,t,i,r)},e.prototype.dateFormatString=function(e){return this._dateTimeScaleFormatInfo.getFormatString(e)},e.prototype.setCurrentCulture=function(e){this._currentCultureSelector!==e&&(this._currentCulture=this.getCulture(e),this._currentCultureSelector=e,this._dateTimeScaleFormatInfo=new s(this._currentCulture))},e.prototype.getCulture=function(e){if(null==e)return null==this._currentCulture&&this.initialize(),this._currentCulture;var t=Globalize.findClosestCulture(e);return t||(t=Globalize.culture("en-US")),t},e.prototype.initialize=function(){var e=this.getUrlParam("language")||window.cultureInfo||window.navigator.userLanguage||window.navigator.language||Globalize.culture().name;this.setCurrentCulture(e);var t=this.getUrlParam("calendar");if(t){var i=this._currentCulture,a=i.calendars[t];a&&(i.calendar=a)}},e.prototype.getUrlParam=function(e){var t=window.location.search.match(RegExp("[?&]"+e+"=([^&]*)"));return t?t[1]:void 0},e}();!function(e){function r(e){var t=e instanceof Date;return t}function n(e,t,i){t=t||"G";var a=1===t.length;try{return a?o(e,t,i):s(e,t,i)}catch(r){return o(e,"G",i)}}function o(e,t,i){var r=i.calendar.patterns;c(i.calendar);var n=a.findDateFormat(e,t,i.name);return t=1===n.format.length?r[n.format]:n.format,i=Globalize.culture("en-US"),Globalize.format(n.value,t,i)}function s(e,a,r){var n,o=[];if(a=t.preserveEscaped(a,"\\dfFghHKmstyz:/%'\""),a=t.preserveLiterals(a,o),a=i.replaceAll(a,'"',"'"),a.indexOf("F")>-1){a=i.replaceAll(a,"FFFF","FFF");var s=e.getMilliseconds();if(s%10>=1&&(a=i.replaceAll(a,"FFF","fff")),a=i.replaceAll(a,"FFF","FF"),s%100/10>=1&&(a=i.replaceAll(a,"FF","ff")),a=i.replaceAll(a,"FF","F"),s%1e3/100>=1&&(a=i.replaceAll(a,"F","f")),a=i.replaceAll(a,"F",""),""===a||"%"===a)return""}return a=l(a),n=Globalize.format(e,a,r),n=u(n,r.calendar),n=t.restoreLiterals(n,o),n=t.restoreEscaped(n,"\\dfFghHKmstyz:/%'\"")}function l(e){return e===h?d:(h=e,e=a.fixDateTimeFormat(e),d=e,e)}function u(e,t){var i=t[":"];if(":"===i)return e;for(var a="",r=e.length,n=0;r>n;n++){var o=e.charAt(n);switch(o){case":":a+=i;break;default:a+=o}}return a}function c(e){var t=e.patterns;void 0===t.g&&(t.g=t.f.replace(t.D,t.d),t.G=t.F.replace(t.D,t.d))}var h,d;e.canFormat=r,e.format=n}(r||(r={}));var o;!function(a){function r(e){var t="number"==typeof e;return t}function n(e){var t=/^[a-z]\d{0,2}$/gi;return t.test(e)}function o(e,t,i){t=t||"G";try{return n(t)?l(e,t,i):u(e,t,i)}catch(a){return Globalize.format(e,void 0,i)}}function s(e,t,i,a){return u(e,t,a,i)}function l(e,t,a){var r,n=t.length>1?parseInt(t.substr(1,t.length-1),10):void 0,o=a.numberFormat,s=t.charAt(0);switch(s){case"e":case"E":void 0===n&&(n=6);var l=i.repeat("0",n);t="0."+l+s+"+000",r=u(e,t,a);break;case"f":case"F":r=void 0!==n?e.toFixed(n):e.toFixed(o.decimals),r=y(r,o);break;case"g":case"G":var c=Math.abs(e);0===c||c>=1e-4&&1e15>c?r=void 0!==n?e.toPrecision(n):e.toString():(r=void 0!==n?e.toExponential(n):e.toExponential(),r=r.replace("e","E")),r=y(r,o);break;case"r":case"R":r=e.toString(),r=y(r,o);break;case"x":case"X":if(r=e.toString(16),"X"===s&&(r=r.toUpperCase()),void 0!==n){var h=r.length,d=0>e;d&&h--;var p=n-h;if(p>0)var g=i.repeat("0",p);r=d?"-"+g+r.substr(1):g+r}r=y(r,o);break;default:r=Globalize.format(e,t,a)}return r}function u(i,a,r,n){var o,s=r.numberFormat;if(!isFinite(i))return Globalize.format(i,void 0);var l=a.split(";");if(l.length>1){var u=a,f=a,m=a;2===l.length?(f=m=l[0],u=l[1]):(f=l[0],u=l[1],m=l[2]),a=i>0?f:0===i?m:u,i=Math.abs(i)}var y=h(a);y.hasEscapes&&(a=t.preserveEscaped(a,"\\0#.,%"));var C=[];if(y.hasQuotes&&(a=t.preserveLiterals(a,C)),y.hasE&&!n){var b=/e[+-]*0+/gi.exec(a);if(b){var x=a.substr(0,b.index),S=a.substr(b.index+b[0].indexOf("0")),w=d(x,y),_=p(x,y);1!==_&&(i*=_);var T=i.toExponential(w),D=T.indexOf("e"),P=T.substr(0,D),M=T.substr(D+1),L=g(P,x,s),A=g(M,S,s);"+"===A.charAt(0)&&"+"!==b[0].charAt(1)&&(A=A.substr(1));var N=b[0].charAt(0);o=L+N+A}}if(void 0===o){var V;if(n)V=e.formattingService.format(n,[i],r.name);else{var w=d(a,y),_=p(a,y);1!==_&&(i*=_),V=c(i,w)}o=g(V,a,s,!!n)}return y.hasQuotes&&(o=t.restoreLiterals(o,C)),y.hasEscapes&&(o=t.restoreEscaped(o,"\\0#.,%")),v=y,o}function c(t,a){var r="",n=0;a>16&&(n=a-16,a=16);var o=e.Double.log10(Math.abs(t));if(16>o){if(o>0){var s=16-o;a>s&&(n+=a-s,a=s)}r=t.toFixed(a)}else if(16===o)r=t.toFixed(0),n+=a,n>0&&(r+=".");else{r=t.toExponential(15);var l=r.indexOf("e");if(l>0){var u=r.indexOf("."),c=r.substr(0,l),h=r.substr(l+1),d=parseInt(h,10)-(c.length-u-1);r=c.replace(".","")+i.repeat("0",d),a>0&&(r=r+"."+i.repeat("0",a))}}return n>0&&(r+=i.repeat("0",n)),r}function h(e,t,i){if(void 0!==v&&e===v.format)return v;for(var a={format:e,hasEscapes:!1,hasQuotes:!1,hasE:!1,hasCommas:!1,hasDots:!1,hasPercent:!1,hasPermile:!1,precision:-1,scale:-1},r=e.length,n=0;r>n;n++){var o=e.charAt(n);switch(o){case"\\":a.hasEscapes=!0;break;case"'":case'"':a.hasQuotes=!0;break;case"e":case"E":a.hasE=!0;break;case",":a.hasCommas=!0;break;case".":a.hasDots=!0;break;case"%":a.hasPercent=!0;break;case"":a.hasPermile=!0}}return t&&(a.precision=d(e,a)),i&&(a.scale=p(e,a)),a}function d(e,t){if(t.precision>-1)return t.precision;var i=0;if(t.hasDots){var a=e.indexOf(".");if(a>-1){for(var r=e.length,n=a;r>n;n++){var o=e.charAt(n);("#"===o||"0"===o)&&i++}i=Math.min(19,i)}}return t.precision=i,i}function p(e,t){if(t.scale>-1)return t.scale;var i=1;if(t.hasPercent&&e.indexOf("%")>-1&&(i=100*i),t.hasPermile&&e.indexOf("")>-1&&(i=1e3*i),t.hasCommas){var a=e.indexOf(".");-1===a&&(a=e.length);for(var r=a-1;r>-1;r--){var n=e.charAt(r);if(","!==n)break;i/=1e3}}return t.scale=i,i}function g(e,t,i,a){var r=t.split(".",2);if(2===r.length){var n=r[0],o=r[1],s=e.split(".",2),l=s[0],u=2===s.length?s[1].replace(/0+$/,""):"",c=f(l,n,i,a),h=m(u,o,a);return h.fmtOnly||""===h.value?c+h.value:c+i["."]+h.value}return f(e,t,i,a)}function f(e,t,i,a){var r=t.indexOf(","),n=r>-1&&r<Math.max(t.lastIndexOf("0"),t.lastIndexOf("#"))&&i[","],o=0,s=0,l=i.groupSizes||[3],u=l[0],c=i[","],h="",d=e.charAt(0);("+"===d||"-"===d)&&(h=i[d],e=e.substr(1));for(var p="0"===e,g="",f="",m=e.length-1,y=!0,v=t.length-1;v>-1;v--){var C=t.charAt(v);switch(C){case"0":case"#":y=!1,""!==f&&(g=f+g,f=""),a||((m>-1||"0"===C)&&n&&(o===u?(g=c+g,s++,s<l.length&&(u=l[s]),o=1):o++),m>-1?(p&&"#"===C||(g=e.charAt(m)+g),m--):"#"!==C&&(g=C+g));break;case",":break;default:f=C+f}}if(!a){if(m>-1&&""!==g)if(n)for(;m>-1;)o===u?(g=c+g,s++,s<l.length&&(u=l[s]),o=1):o++,g=e.charAt(m)+g,m--;else g=e.substr(0,m+1)+g;return h+f+g}return y?h+f+g:h+f+e+g}function m(e,t,i){var a=0,r=t.length,n=e.length;if(i)return"0"!==t.charAt(r-1)&&"#"!==t.charAt(r-1)?{value:e+t.charAt(r-1),fmtOnly:""===e}:{value:e,fmtOnly:""===e};for(var o="",s=!0,l=0;r>l;l++){var u=t.charAt(l);if(n>a)switch(u){case"0":case"#":o+=e[a++],s=!1;break;default:o+=u}else"#"!==u&&(o+=u,s=s&&"0"!==u)}return{value:o,fmtOnly:s}}function y(e,t){var i=t["+"],a=t["-"],r=t["."],n=t[","];if("+"===i&&"-"===a&&"."===r&&","===n)return e;for(var o=e.length,s="",l=0;o>l;l++){var u=e.charAt(l);switch(u){case"+":s+=i;break;case"-":s+=a;break;case".":s+=r;break;case",":s+=n;break;default:s+=u}}return s}var v;a.canFormat=r,a.isStandardFormat=n,a.format=o,a.formatWithCustomOverride=s,a.getCustomFormatMetadata=h}(o=e.NumberFormat||(e.NumberFormat={}));var s=function(){function t(e){var t=e.calendar,i=t.patterns,a=t.months.namesAbbr,r=a&&a[0],n=i.Y,o=i.M,s=i.f,l=i.T,u=i.t,c=s.indexOf(",")>-1?", ":" ",h=0===n.indexOf("yyyy'")&&n.length>6&&"'"===n[6];this.YearPattern=h?n.substr(0,7):"yyyy";var d=s.indexOf("yy"),p=s.indexOf("MMMM");this.MonthPattern=r&&p>-1?d>p?"MMM yyyy":"yyyy MMM":n,this.DayPattern=r?o.replace("MMMM","MMM"):o;var g=s.indexOf("mm"),f=s.indexOf("tt"),m=f>-1?u.replace(":mm ",""):u;switch(this.HourPattern=g>d?this.DayPattern+c+m:m+c+this.DayPattern,this.MinutePattern=u,this.SecondPattern=l,this.MillisecondPattern=l.replace("ss","ss.fff"),e.name){case"fi-FI":this.DayPattern=this.DayPattern.replace("'ta'",""),this.HourPattern=this.HourPattern.replace("'ta'","")}}return t.prototype.getFormatString=function(t){switch(t){case e.DateTimeUnit.Year:return this.YearPattern;case e.DateTimeUnit.Month:return this.MonthPattern;case e.DateTimeUnit.Week:case e.DateTimeUnit.Day:return this.DayPattern;case e.DateTimeUnit.Hour:return this.HourPattern;case e.DateTimeUnit.Minute:return this.MinutePattern;case e.DateTimeUnit.Second:return this.SecondPattern;case e.DateTimeUnit.Millisecond:return this.MillisecondPattern}},t}();e.formattingService=new n}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t;!function(t){function i(e){return JSON.stringify(e.accept(r.instance))}function a(e){for(var i="[",a=0,r=e.length;r>a;a++)a>0&&(i+=","),i+=t.serialize(e[a]);return i+"]"}t.serialize=i,t.serializeArray=a;var r=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.visitColumnRef=function(e){return{col:{s:e.source.accept(this),r:e.ref}}},t.prototype.visitMeasureRef=function(e){return{measure:{s:e.source.accept(this),r:e.ref}}},t.prototype.visitAggr=function(e){return{agg:{a:e.arg.accept(this),f:e.func}}},t.prototype.visitEntity=function(e){return{e:e.entity}},t.prototype.visitAnd=function(e){return{and:{l:e.left.accept(this),r:e.right.accept(this)}}},t.prototype.visitCompare=function(e){return{comp:{k:e.kind,l:e.left.accept(this),r:e.right.accept(this)}}},t.prototype.visitConstant=function(e){return{"const":{t:e.type.primitiveType,v:e.value}}},t.prototype.visitDefault=function(e){},t.instance=new t,t}(e.DefaultSQExprVisitor)}(t=e.SQExprShortSerializer||(e.SQExprShortSerializer={}))}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){t.left="Left",t.right="Right",t.type=e.createEnumType([{value:t.left,displayName:function(e){return e.get("Visual_yAxis_Left")}},{value:t.right,displayName:function(e){return e.get("Visual_yAxis_Right")}}])}(t=e.yAxisPosition||(e.yAxisPosition={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){function t(e){return function(t){return t.get(e)}}function i(e,t){return"function"==typeof e?e(t):"string"==typeof e?e:void 0}e.createDisplayNameGetter=t,e.getDisplayName=i}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t;!function(e){function t(e,t){return t||!e?0:e.getDuration()}e.MinervaAnimationDuration=250,e.GetAnimationDuration=t}(t=e.AnimatorCommon||(e.AnimatorCommon={}));var i=function(){function e(e){e&&e.duration&&(this.animationDuration=e.duration),this.animationDuration=this.animationDuration>=0?this.animationDuration:t.MinervaAnimationDuration}return e.prototype.getDuration=function(){return this.animationDuration},e.prototype.animate=function(e){return null},e}();e.Animator=i}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a]);i.prototype=t.prototype,e.prototype=new i},powerbi;!function(e){var t;!function(e){var t=function(t){function i(e){t.call(this,e)}return __extends(i,t),i.prototype.animate=function(e){var t={failed:!0,shapes:null,dataLabels:null},i=e.viewModel,a=this.previousViewModel;return a&&(i.hasHighlights&&!a.hasHighlights?t=this.animateNormalToHighlighted(e):i.hasHighlights&&a.hasHighlights?t=this.animateHighlightedToHighlighted(e):!i.hasHighlights&&a.hasHighlights&&(t=this.animateHighlightedToNormal(e))),this.previousViewModel=i,t},i.prototype.animateNormalToHighlighted=function(t){var i=t.viewModel,a=t.itemCS,r=t.series.selectAll(a.selector),n=r.data(function(e){return e.data},function(e){return e.key}),o=i.hasHighlights;n.enter().append("rect").attr("class",function(e){return a["class"].concat(e.highlight?" highlight":"")}).attr(t.layout.shapeLayoutWithoutHighlights),n.style("fill",function(e){return e.color}).style("fill-opacity",function(t){return e.ColumnUtil.getFillOpacity(t.selected,t.highlight,!1,o)}).transition().duration(this.animationDuration).attr(t.layout.shapeLayout),n.exit().remove();var s=this.animateDefaultDataLabels(t);return{failed:!1,shapes:n,dataLabels:s}},i.prototype.animateHighlightedToHighlighted=function(e){var t=this.animateDefaultShapes(e.viewModel,e.series,e.layout,e.itemCS),i=this.animateDefaultDataLabels(e);return{failed:!1,shapes:t,dataLabels:i}},i.prototype.animateHighlightedToNormal=function(t){var i=t.itemCS,a=t.series.selectAll(i.selector),r=a.data(function(e){return e.data},function(e){return e.key}),n=t.interactivityService&&t.interactivityService.hasSelection();r.enter().append("rect").attr("class",function(e){return i["class"].concat(e.highlight?" highlight":"")}),r.style("fill",function(e){return e.color}).style("fill-opacity",function(t){return e.ColumnUtil.getFillOpacity(t.selected,t.highlight,t.selected,!t.selected)}).transition().duration(this.animationDuration).attr(t.layout.shapeLayout).transition().duration(0).delay(this.animationDuration).style("fill-opacity",function(t){return e.ColumnUtil.getFillOpacity(t.selected,t.highlight,n,!1)}),r.exit().transition().duration(this.animationDuration).attr(n?t.layout.zeroShapeLayout:t.layout.shapeLayoutWithoutHighlights).remove();var o=this.animateDefaultDataLabels(t);return{failed:!1,shapes:r,dataLabels:o}},i.prototype.animateDefaultShapes=function(t,i,a,r){var n=i.selectAll(r.selector),o=n.data(function(e){return e.data},function(e){return e.key});return o.enter().append("rect").attr("class",function(e){return r["class"].concat(e.highlight?" highlight":"")}),o.style("fill",function(e){return e.color}).style("fill-opacity",function(i){return e.ColumnUtil.getFillOpacity(i.selected,i.highlight,!1,t.hasHighlights)}).transition().duration(this.animationDuration).attr(a.shapeLayout),o.exit().remove(),o},i.prototype.animateDefaultDataLabels=function(t){var i;return t.viewModel.labelSettings.show?i=e.ColumnUtil.drawDefaultLabels(t.series,t.mainGraphicsContext,t.labelLayout,t.viewPort,!0,this.animationDuration):e.dataLabelUtils.cleanDataLabels(t.mainGraphicsContext),i},i}(e.Animator);e.WebColumnChartAnimator=t}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t=function(t){function i(e){t.call(this,e)}return __extends(i,t),i.prototype.animate=function(e){var t={failed:!0,shapes:null,highlightShapes:null},i=e.viewModel,a=this.previousViewModel;return a&&(i.hasHighlights&&!a.hasHighlights?t=this.animateNormalToHighlighted(e):i.hasHighlights&&a.hasHighlights?t=this.animateHighlightedToHighlighted(e):!i.hasHighlights&&a.hasHighlights&&(t=this.animateHighlightedToNormal(e))),this.previousViewModel=i,t},i.prototype.animateNormalToHighlighted=function(t){var i=this.animateDefaultShapes(t),a=t.graphicsContext.select(".slices").selectAll("path.slice-highlight").data(t.viewModel.dataPoints.filter(function(e){return null!=e.data.highlightRatio}),function(e){return e.data.identity.getKey()});return a.enter().insert("path").classed("slice-highlight",!0).each(function(e){this._current=e}),a.style("fill",function(e){return e.data.color?e.data.color:t.colors.getNewColorScale().getColor(e.data.identity.getKey()).value}).style("fill-opacity",function(i){return e.ColumnUtil.getFillOpacity(i.data.selected,!0,!1,t.viewModel.hasHighlights)}).attr(t.layout.shapeLayout).transition().duration(this.animationDuration).attr(t.layout.highlightShapeLayout),a.exit().remove(),e.DonutChart.drawDefaultCategoryLabels(t.graphicsContext,t.viewModel,t.layout,t.sliceWidthRatio,t.radius,t.viewport),{failed:!1,shapes:i,highlightShapes:a}},i.prototype.animateHighlightedToHighlighted=function(t){var i=this.animateDefaultShapes(t),a=this.animateDefaultHighlightShapes(t);return e.DonutChart.drawDefaultCategoryLabels(t.graphicsContext,t.viewModel,t.layout,t.sliceWidthRatio,t.radius,t.viewport),{failed:!1,shapes:i,highlightShapes:a}},i.prototype.animateHighlightedToNormal=function(t){var i=t.interactivityService&&t.interactivityService.hasSelection(),a=this.animationDuration,r=t.graphicsContext.select(".slices").selectAll("path.slice").data(t.viewModel.dataPoints,function(e){return e.data.identity.getKey()});r.enter().insert("path").classed("slice",!0).each(function(e){this._current=e}),r.style("fill",function(e){return e.data.color?e.data.color:t.colors.getNewColorScale().getColor(e.data.identity.getKey()).value}).style("fill-opacity",function(t){return e.ColumnUtil.getFillOpacity(t.data.selected,!1,t.data.selected,!t.data.selected)}).transition().duration(a).attr(t.layout.shapeLayout).transition().duration(0).delay(a).style("fill-opacity",function(t){return e.ColumnUtil.getFillOpacity(t.data.selected,!1,i,!1);
}),r.exit().remove();var n=t.graphicsContext.select(".slices").selectAll("path.slice-highlight").data(t.viewModel.dataPoints.filter(function(e){return null!=e.data.highlightRatio}),function(e){return e.data.identity.getKey()});return n.enter().insert("path").classed("slice-highlight",!0).each(function(e){this._current=e}),n.style("fill",function(e){return e.data.color?e.data.color:t.colors.getNewColorScale().getColor(e.data.identity.getKey()).value}).style("fill-opacity",function(t){return e.ColumnUtil.getFillOpacity(!1,!0,!1,!0)}).transition().duration(a).attr(i?t.layout.zeroShapeLayout:t.layout.shapeLayout).remove(),n.exit().remove(),e.DonutChart.drawDefaultCategoryLabels(t.graphicsContext,t.viewModel,t.layout,t.sliceWidthRatio,t.radius,t.viewport),{failed:!1,shapes:r,highlightShapes:n}},i.prototype.animateDefaultShapes=function(t){var i=t.graphicsContext.select(".slices").selectAll("path.slice").data(t.viewModel.dataPoints,function(e){return e.data.identity.getKey()});return i.enter().insert("path").classed("slice",!0).each(function(e){this._current=e}),i.style("fill",function(e){return e.data.color?e.data.color:t.colors.getNewColorScale().getColor(e.data.identity.getKey()).value}).style("fill-opacity",function(i){return e.ColumnUtil.getFillOpacity(i.data.selected,!1,!1,t.viewModel.hasHighlights)}).transition().duration(this.animationDuration).attr(t.layout.shapeLayout),i.exit().remove(),i},i.prototype.animateDefaultHighlightShapes=function(t){var i=t.graphicsContext.select(".slices").selectAll("path.slice-highlight").data(t.viewModel.dataPoints.filter(function(e){return null!=e.data.highlightRatio}),function(e){return e.data.identity.getKey()});return i.enter().insert("path").classed("slice-highlight",!0).each(function(e){this._current=e}),i.style("fill",function(e){return e.data.color?e.data.color:t.colors.getNewColorScale().getColor(e.data.identity.getKey()).value}).style("fill-opacity",function(i){return e.ColumnUtil.getFillOpacity(i.data.selected,!0,!1,t.viewModel.hasHighlights)}).transition().duration(this.animationDuration).attr(t.layout.highlightShapeLayout),i.exit().remove(),i},i}(e.Animator);e.WebDonutChartAnimator=t}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var i=function(i){function a(e){i.call(this,e)}return __extends(a,i),a.prototype.animate=function(e){var t={failed:!0,shapes:null,dataLabels:null},i=e.viewModel,a=this.previousViewModel;return a&&(i.hasHighlights&&!a.hasHighlights?t=this.animateNormalToHighlighted(e):i.hasHighlights&&a.hasHighlights?t=this.animateHighlightedToHighlighted(e):!i.hasHighlights&&a.hasHighlights&&(t=this.animateHighlightedToNormal(e))),this.previousViewModel=i,t},a.prototype.animateNormalToHighlighted=function(e){var i=e.viewModel,a=e.layout,r=!0,n=!1;this.animateDefaultAxis(e.axisGraphicsContext,e.axisOptions,e.isHidingPercentBars);var o=e.shapeGraphicsContext.selectAll("rect").data(i.slices,function(e){return e.key});o.enter().append("rect").attr("class",function(e){return e.highlight?"funnelBar highlight":"funnelBar"}).attr(a.shapeLayoutWithoutHighlights),o.style("fill",function(e){return e.color}).style("fill-opacity",function(e){return t.ColumnUtil.getFillOpacity(e.selected,e.highlight,n,r)}).transition().duration(this.animationDuration).attr(a.shapeLayout),o.exit().remove(),this.animatePercentBars(e);var s=this.animateDefaultDataLabels(e);return{failed:!1,shapes:o,dataLabels:s}},a.prototype.animateHighlightedToHighlighted=function(e){var t=e.viewModel,i=e.layout;this.animateDefaultAxis(e.axisGraphicsContext,e.axisOptions,e.isHidingPercentBars);var a=this.animateDefaultShapes(t,t.slices,e.shapeGraphicsContext,i);this.animatePercentBars(e);var r=this.animateDefaultDataLabels(e);return{failed:!1,shapes:a,dataLabels:r}},a.prototype.animateHighlightedToNormal=function(e){var i=e.viewModel,a=e.layout,r=e.interactivityService?e.interactivityService.hasSelection():!1;this.animateDefaultAxis(e.axisGraphicsContext,e.axisOptions,e.isHidingPercentBars);var n=e.shapeGraphicsContext.selectAll("rect").data(i.slices,function(e){return e.key});n.enter().append("rect").attr("class",function(e){return e.highlight?"funnelBar highlight":"funnelBar"}),n.style("fill",function(e){return e.color}).style("fill-opacity",function(e){return t.ColumnUtil.getFillOpacity(e.selected,e.highlight,r,!e.selected)}).transition().duration(this.animationDuration).attr(a.shapeLayoutWithoutHighlights).transition().duration(0).delay(this.animationDuration).style("fill-opacity",function(e){return t.ColumnUtil.getFillOpacity(e.selected,e.highlight,r,!1)});var o=n.exit();o.transition().duration(this.animationDuration).attr(r?a.zeroShapeLayout:a.shapeLayoutWithoutHighlights).remove(),this.animatePercentBars(e);var s=this.animateDefaultDataLabels(e);return{failed:!1,shapes:n,dataLabels:s}},a.prototype.animateDefaultAxis=function(e,i,a){var r=d3.scale.ordinal().domain(i.categoryLabels).rangeBands([i.rangeStart,i.rangeEnd],i.barToSpaceRatio,a?i.barToSpaceRatio:t.FunnelChart.PercentBarToBarRatio),n=d3.svg.axis().scale(r).orient("right").tickPadding(t.FunnelChart.TickPadding).innerTickSize(t.FunnelChart.InnerTickSize);e.classed("axis",!0).transition().duration(this.animationDuration).attr("transform",t.SVGUtil.translate(0,i.margin.top)).call(n)},a.prototype.animateDefaultShapes=function(e,i,a,r){var n=e.hasHighlights,o=a.selectAll("rect").data(i,function(e){return e.key});return o.enter().append("rect").attr("class",function(e){return e.highlight?"funnelBar highlight":"funnelBar"}),o.style("fill",function(e){return e.color}).style("fill-opacity",function(e){return function(e){return t.ColumnUtil.getFillOpacity(e.selected,e.highlight,!1,n)}}).transition().duration(this.animationDuration).attr(r.shapeLayout),o.exit().remove(),o},a.prototype.animateDefaultDataLabels=function(e){var i;return e.viewModel.dataLabelsSettings.show&&e.viewModel.canShowDataLabels?i=t.dataLabelUtils.drawDefaultLabelsForFunnelChart(e.slicesWithoutHighlights,e.labelGraphicsContext,e.labelLayout,!0,this.animationDuration):t.dataLabelUtils.cleanDataLabels(e.labelGraphicsContext),i},a.prototype.animatePercentBars=function(e){var i=e.viewModel,a=e.isHidingPercentBars;if(a||!i.slices||(i.hasHighlights?i.slices.length/2:i.slices.length)<2)return void this.animatePercentBarComponents([],e);var r=[i.slices[i.hasHighlights?1:0],i.slices[i.slices.length-1]],n=t.FunnelChart.getFunnelSliceValue(r[0]);if(0>=n)return void this.animatePercentBarComponents([],e);var o=r.map(function(e,i){return{value:t.FunnelChart.getFunnelSliceValue(e),percent:0===i?1:t.FunnelChart.getFunnelSliceValue(e)/n,isTop:0===i}});this.animatePercentBarComponents(o,e)},a.prototype.animateToFunnelPercent=function(e,t,i){return e.data(t).transition().duration(this.animationDuration).attr(i)},a.prototype.animatePercentBarComponents=function(i,a){var r=a.percentGraphicsContext,n=a.layout,o=[{percent:0,value:0,isTop:!0},{percent:0,value:0,isTop:!1}],s=r.selectAll(t.FunnelChart.Selectors.percentBar.mainLine.selector).data(i);this.animateToFunnelPercent(s.exit(),o,n.percentBarLayout.mainLine).remove(),s.enter().append("line").classed(t.FunnelChart.Selectors.percentBar.mainLine["class"],!0).data(o).attr(n.percentBarLayout.mainLine),this.animateToFunnelPercent(s,i,n.percentBarLayout.mainLine);var l=r.selectAll(t.FunnelChart.Selectors.percentBar.leftTick.selector).data(i);this.animateToFunnelPercent(l.exit(),o,n.percentBarLayout.leftTick).remove(),l.enter().append("line").classed(t.FunnelChart.Selectors.percentBar.leftTick["class"],!0).data(o).attr(n.percentBarLayout.leftTick),this.animateToFunnelPercent(l,i,n.percentBarLayout.leftTick);var u=r.selectAll(t.FunnelChart.Selectors.percentBar.rightTick.selector).data(i);this.animateToFunnelPercent(u.exit(),o,n.percentBarLayout.rightTick).remove(),u.enter().append("line").classed(t.FunnelChart.Selectors.percentBar.rightTick["class"],!0).data(o).attr(n.percentBarLayout.rightTick),this.animateToFunnelPercent(u,i,n.percentBarLayout.rightTick);var c=r.selectAll(t.FunnelChart.Selectors.percentBar.text.selector).data(i);this.animateToFunnelPercent(c.exit(),o,n.percentBarLayout.text).remove(),c.enter().append("text").classed(t.FunnelChart.Selectors.percentBar.text["class"],!0).data(o).attr(n.percentBarLayout.text),this.animateToFunnelPercent(c,i,n.percentBarLayout.text).text(function(i){return e.formattingService.formatValue(i.percent,t.valueFormatter.getLocalizedString("Percentage1"))}),t.SVGUtil.flushAllD3TransitionsIfNeeded(a.visualInitOptions)},a}(t.Animator);t.WebFunnelAnimator=i}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t=function(t){function i(e){t.call(this,e)}return __extends(i,t),i.prototype.animate=function(e){var t={failed:!0,shapes:null,highlightShapes:null,labels:null},i=e.viewModel,a=this.previousViewModel;return a&&(i.hasHighlights&&!a.hasHighlights?t=this.animateNormalToHighlighted(e):i.hasHighlights&&a.hasHighlights?t=this.animateHighlightedToHighlighted(e):!i.hasHighlights&&a.hasHighlights&&(t=this.animateHighlightedToNormal(e))),this.previousViewModel=i,t},i.prototype.animateNormalToHighlighted=function(t){var i=!1,a=!0,r=this.animateDefaultShapes(t.shapeGraphicsContext,t.nodes,i,a),n=t.shapeGraphicsContext.selectAll("."+e.Treemap.HighlightNodeClassName).data(t.highlightNodes,function(e){return e.key+"highlight"});n.enter().append("rect").attr("class",e.Treemap.layout.highlightShapeClass).attr(e.Treemap.layout.shapeLayout),n.style("fill",function(t){return e.Treemap.getFill(t,!0)}).style("fill-opacity",function(t){return e.Treemap.getFillOpacity(t,i,a,!0)}).transition().duration(this.animationDuration).attr(e.Treemap.layout.highlightShapeLayout),n.exit().remove();var o=t.viewModel.dataLabelsSettings.show||t.viewModel.dataLabelsSettings.showCategory?t.labeledNodes:[],s=this.animateDefaultLabels(t.labelGraphicsContext,o);return{failed:!1,labels:s,shapes:r,highlightShapes:n}},i.prototype.animateHighlightedToHighlighted=function(t){var i=!1,a=!0,r=this.animateDefaultShapes(t.shapeGraphicsContext,t.nodes,i,a);t.shapeGraphicsContext.selectAll("."+e.Treemap.HighlightNodeClassName).data(t.highlightNodes,function(e){return e.key+"highlight"});var n=this.animateDefaultHighlightShapes(t.shapeGraphicsContext,t.highlightNodes,i,a),o=t.viewModel.dataLabelsSettings.show||t.viewModel.dataLabelsSettings.showCategory?t.labeledNodes:[],s=this.animateDefaultLabels(t.labelGraphicsContext,o);return{failed:!1,labels:s,shapes:r,highlightShapes:n}},i.prototype.animateHighlightedToNormal=function(t){var i=t.interactivityService?t.interactivityService.hasSelection():!1,a=t.shapeGraphicsContext.selectAll("."+e.Treemap.TreemapNodeClassName).data(t.nodes,function(e){return e.key});a.enter().append("rect").attr("class",e.Treemap.layout.shapeClass),a.transition().duration(this.animationDuration).style("fill",function(t){return e.Treemap.getFill(t,!1)}).style("fill-opacity",function(t){return e.ColumnUtil.getFillOpacity(t.selected,!1,t.selected,!t.selected)}).attr(e.Treemap.layout.shapeLayout).transition().duration(0).delay(this.animationDuration).style("fill-opacity",function(t){return e.ColumnUtil.getFillOpacity(t.selected,!1,i,!1)}),a.exit().remove();var r=t.shapeGraphicsContext.selectAll("."+e.Treemap.HighlightNodeClassName).data(t.nodes,function(e){return e.key+"highlight"});r.enter().append("rect").attr("class",e.Treemap.layout.highlightShapeClass),r.style("fill",function(t){return e.Treemap.getFill(t,!0)}).style("fill-opacity",function(t){return e.ColumnUtil.getFillOpacity(t.selected,!0,t.selected,!t.selected)}).transition().duration(this.animationDuration).attr(i?e.Treemap.layout.zeroShapeLayout:e.Treemap.layout.shapeLayout).remove(),r.exit().remove();var n=t.viewModel.dataLabelsSettings.show||t.viewModel.dataLabelsSettings.showCategory?t.labeledNodes:[],o=this.animateDefaultLabels(t.labelGraphicsContext,n);return{failed:!1,labels:o,shapes:a,highlightShapes:r}},i.prototype.animateDefaultShapes=function(t,i,a,r){var n=!1,o=t.selectAll("."+e.Treemap.TreemapNodeClassName).data(i,function(e){return e.key});return o.enter().append("rect").attr("class",e.Treemap.layout.shapeClass),o.transition().duration(this.animationDuration).style("fill",function(t){return e.Treemap.getFill(t,n)}).style("fill-opacity",function(t){return e.Treemap.getFillOpacity(t,a,r,n)}).attr(e.Treemap.layout.shapeLayout),o.exit().remove(),o},i.prototype.animateDefaultHighlightShapes=function(t,i,a,r){var n=!0,o=t.selectAll("."+e.Treemap.HighlightNodeClassName).data(i,function(e){return e.key+"highlight"});return o.enter().append("rect").attr("class",e.Treemap.layout.highlightShapeClass),o.transition().duration(this.animationDuration).style("fill",function(t){return e.Treemap.getFill(t,n)}).style("fill-opacity",function(t){return e.Treemap.getFillOpacity(t,a,r,n)}).attr(e.Treemap.layout.highlightShapeLayout),o.exit().remove(),o},i.prototype.animateDefaultLabels=function(t,i){var a=t.selectAll("text").data(i,function(e){return e.key});return a.enter().append("text").attr("class",e.Treemap.layout.labelClass),a.transition().duration(this.animationDuration).attr(e.Treemap.layout.labelLayout).text(e.Treemap.layout.labelText),a.exit().remove(),a},i}(e.Animator);e.WebTreemapAnimator=t}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t=function(){function t(){}return t.prototype.select=function(t,i){i.bars.style("fill-opacity",function(a){return e.ColumnUtil.getFillOpacity(a.selected,a.highlight,!a.highlight&&t,!a.selected&&i.hasHighlights)}),i.showLabel?(i.labelLayout.filter=function(a){return e.dataLabelUtils.getColumnChartLabelFilter(a,t,i.hasHighlights,i.axisOptions,i.viewport.width)},e.dataLabelUtils.drawDefaultLabelsForDataPointChart(i.datapoints,i.mainGraphicsContext,i.labelLayout,i.viewport)):e.dataLabelUtils.cleanDataLabels(i.mainGraphicsContext)},t}();e.ColumnChartWebBehavior=t}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t=function(){function t(){}return t.prototype.select=function(t,i){i.style("fill-opacity",function(i){return e.ColumnUtil.getFillOpacity(i.selected,i.highlight,t,!1)})},t}();e.DataDotChartWebBehavior=t}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t=function(){function t(e){this.allowDrilldown=e.allowDrilldown,this.visual=e.visual,this.svg=e.clearCatcher,this.isDrilled=!1}return t.prototype.select=function(t,i,a,r,n){if(t&&this.allowDrilldown){var o=this.isDrilled?void 0:n;this.visual.setDrilldown(o),this.isDrilled=!this.isDrilled}else i.style("fill-opacity",function(i){return e.ColumnUtil.getFillOpacity(i.data.selected,a,!a&&t,!i.data.selected&&r)})},t}();e.DonutChartWebBehavior=t}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t=function(){function t(){}return t.prototype.select=function(t,i,a){i.style("fill-opacity",function(i){return e.ColumnUtil.getFillOpacity(i.selected,i.highlight,!i.highlight&&t,!i.selected&&a)})},t}();e.FunnelWebBehavior=t}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t=function(){function t(){}return t.prototype.select=function(t,i,a,r){i.style("stroke-opacity",function(i){return e.ColumnUtil.getFillOpacity(i.selected,!1,t,!1)}),a.style("fill-opacity",function(i){return e.ColumnUtil.getFillOpacity(i.selected,!1,t,!1)}),r&&r.style("fill-opacity",function(i){return t&&!i.selected?e.LineChart.DimmedAreaFillOpacity:e.LineChart.AreaFillOpacity})},t}();e.LineChartWebBehavior=t}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t=function(){function t(){}return t.prototype.select=function(t,i,a,r){i&&i.style({"fill-opacity":function(i){return e.ColumnUtil.getFillOpacity(i.selected,!1,t,!1)},"stroke-opacity":function(i){return e.ColumnUtil.getFillOpacity(i.selected,!1,t,!1)}}),a&&a.style({"fill-opacity":function(i){return e.ColumnUtil.getFillOpacity(i.data.selected,!1,t,!1)},"stroke-opacity":function(i){return e.ColumnUtil.getFillOpacity(i.data.selected,!1,t,!1)}}),r&&r.style({"fill-opacity":function(i){return e.ColumnUtil.getFillOpacity(i.selected,!1,t,!1)},"stroke-opacity":function(i){return e.ColumnUtil.getFillOpacity(i.selected,!1,t,!1)}})},t}();e.MapBehavior=t}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t=function(){function t(){}return t.prototype.select=function(t,i){i.style("fill-opacity",function(i){return null!=i.size?e.ScatterChart.getBubbleOpacity(i,t):0}),i.style("stroke-opacity",function(i){return e.ScatterChart.getBubbleOpacity(i,t)})},t}();e.ScatterChartWebBehavior=t;var i=function(){function t(){}return t.prototype.setOptions=function(e){this.data=e.data,this.mainGraphicsContext=e.mainContext,this.xAxisProperties=e.xAxisProperties,this.yAxisProperties=e.yAxisProperties,this.host=e.host},t.prototype.select=function(e,t,i,a){this.selectDotByIndex(a)},t.prototype.selectRoot=function(){var e=jsCommon.PerformanceUtil.create("selectRoot");this.onClick(),e.end()},t.prototype.drag=function(e){switch(e){case 0:this.onDrag();break;case 1:this.onClick()}},t.prototype.onDrag=function(){var e=this.getMouseCoordinates();this.moveCrosshairToXY(e.x,e.y);var t=this.findClosestDotIndex(e.x,e.y);this.selectDot(t),this.updateLegend(t)},t.prototype.onClick=function(){var e=this.getMouseCoordinates(),t=this.findClosestDotIndex(e.x,e.y);this.selectDotByIndex(t)},t.prototype.getMouseCoordinates=function(){var e=this.mainGraphicsContext,t=0,i=parseInt(e.attr("height"),10);i=i||0;try{var a=d3.mouse(e.node());t=a[0],i=a[1]}catch(r){}return{x:t,y:i}},t.prototype.selectDotByIndex=function(e){this.selectDot(e),this.moveCrosshairToIndexDot(e),this.updateLegend(e)},t.prototype.selectDot=function(e){var i=this,a=this.mainGraphicsContext;a.selectAll(t.ScatterChartCircleTagName+t.DotClassSelector).classed({selected:!1,notSelected:!0}),a.selectAll(t.ScatterChartCircleTagName+t.DotClassSelector).filter(function(t,a){var r=i.data.dataPoints,n=r[e];return t.x===n.x&&t.y===n.y}).classed({selected:!0,notSelected:!1})},t.prototype.moveCrosshairToIndexDot=function(e){var i=this.data.dataPoints,a=this.mainGraphicsContext,r=this.xAxisProperties.scale(i[e].x),n=this.yAxisProperties.scale(i[e].y);if(null==this.crosshair){var o=+a.attr("width"),s=+a.attr("height");this.crosshair=this.drawCrosshair(a,r,n,o,s),this.crosshairHorizontal=this.crosshair.select(t.Horizontal.selector),this.crosshairVertical=this.crosshair.select(t.Vertical.selector)}else this.moveCrosshairToXY(r,n)},t.prototype.moveCrosshairToXY=function(e,t){this.crosshairHorizontal.attr({y1:t,y2:t}),this.crosshairVertical.attr({x1:e,x2:e})},t.prototype.drawCrosshair=function(e,i,a,r,n){var o=e.append("g");return o.classed(t.CrosshairClassName,!0),o.append("line").classed(t.Horizontal["class"],!0).attr({x1:0,x2:r,y1:a,y2:a}),o.append("line").classed(t.Vertical["class"],!0).attr({x1:i,x2:i,y1:n,y2:0}),o},t.prototype.findClosestDotIndex=function(e,t){var i=-1,a=Number.MAX_VALUE,r=this.data.dataPoints,n=this.xAxisProperties.scale,o=this.yAxisProperties.scale;for(var s in r){var l=r[s],u=n(l.x),c=o(l.y),h=u-e,d=c-t,p=h*h+d*d;a===Number.MAX_VALUE?(i=s,a=p):a&&a>p&&(i=s,a=p)}return i},t.prototype.updateLegend=function(e){if(null==this.lastDotIndex||this.lastDotIndex!==e){var t=this.createLegendDataPoints(e);this.host.updateLegend(t),this.lastDotIndex=e}},t.prototype.createLegendDataPoints=function(t){var i=e.scatterChartProps.general.formatString,a=[],r=this.data,n=r.dataPoints[t],o=e.valueFormatter.format(null),s=o,l=r.legendData,u=l.dataPoints;return n.category!==o?s=n.category:null!=n.radius.sizeMeasure?s=e.valueFormatter.format(n.radius.sizeMeasure.source.groupName):u.length>=t&&u[t].label!==o&&(s=u[t].label),null!=r.xCol&&a.push({category:s,color:n.fill,icon:e.LegendIcon.Box,label:e.valueFormatter.format(this.data.axesLabels.x),measure:e.valueFormatter.format(n.x,e.valueFormatter.getFormatString(r.xCol,i)),iconOnlyOnLabel:!0}),void 0!==r.yCol&&null!==r.yCol&&a.push({category:s,color:n.fill,icon:e.LegendIcon.Box,label:e.valueFormatter.format(r.axesLabels.y),measure:e.valueFormatter.format(n.y,e.valueFormatter.getFormatString(r.yCol,i)),iconOnlyOnLabel:!0}),void 0!==r.size&&null!==r.size&&a.push({category:s,color:n.fill,icon:e.LegendIcon.Box,label:e.valueFormatter.format(r.size.displayName),measure:e.valueFormatter.format(n.radius.sizeMeasure.values[n.radius.index],e.valueFormatter.getFormatString(r.size,i)),iconOnlyOnLabel:!0}),{dataPoints:a}},t.CrosshairClassName="crosshair",t.ScatterChartCircleTagName="circle",t.DotClassName="dot",t.DotClassSelector="."+t.DotClassName,t.Horizontal={"class":"horizontal",selector:".horizontal"},t.Vertical={"class":"vertical",selector:".vertical"},t}();e.ScatterChartMobileBehavior=i}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t=function(){function t(){}return t.prototype.select=function(t){t.style({color:function(t){return t.selected?e.Slicer.DefaultStyleProperties.slicerText.selectionColor:e.Slicer.DefaultStyleProperties.slicerText.color}})},t.prototype.mouseInteractions=function(t){t.style({color:function(t){return t.mouseOver?e.Slicer.DefaultStyleProperties.slicerText.hoverColor:t.mouseOut?t.selected?e.Slicer.DefaultStyleProperties.slicerText.selectionColor:e.Slicer.DefaultStyleProperties.slicerText.color:void 0}})},t.prototype.clearSlicers=function(t,i){i.selectAll("input").property("checked",!1),t.style("color",e.Slicer.DefaultStyleProperties.slicerText.color)},t}();e.SlicerWebBehavior=t}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t=function(){function e(){}return e.prototype.select=function(t,i){t?i.style({fill:function(t){return t.selected?t.color:e.selectedLegendColor}}):i.style({fill:function(e){return e.color}})},e.selectedLegendColor="#A6A6A6",e}();e.LegendWebBehavior=t}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t=function(){function t(){}return t.prototype.select=function(t,i,a){i.style("fill",function(t){return e.Treemap.getFill(t,!1)}).style("fill-opacity",function(i){return e.Treemap.getFillOpacity(i,t,!i.selected&&a,!1)})},t}();e.TreemapWebBehavior=t}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t=function(){function t(){}return t.prototype.select=function(t,i){i.style("fill-opacity",function(i){return e.ColumnUtil.getFillOpacity(i.selected,i.highlight,t,!1)})},t}();e.WaterfallChartWebBehavior=t}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var i=jsCommon.ArrayExtensions;t.fallBackDomain=[0,10],t.fallbackDateDomain=[new Date(2014,1,1).getTime(),new Date(2015,1,1).getTime()];var a;!function(a){function r(e){return 250>e?3:500>e?5:8}function n(e){return 150>e?3:300>e?5:8}function o(e,t,i,a,r){return isNaN(e)||isNaN(t)?X:1>=a||1>=t&&e>=-1?a:e===t?r?1:X:s(i)?a:Math.min(t-e+1,a)}function s(e){for(var t=0,i=e.length;i>t;t++){var a=e[t];if(a&&a.type&&!a.type.integer)return!0}return!1}function l(e,t,i,a,r){return!a||C(t)?u(e,t.domain()):b(i)?d(e,t.domain()):c(e,t,r)}function u(e,t){var i=[];if(0>=e)return i;var a=t.length;if(e>a)return t;for(var r=0,n=Math.floor(a/e);a>r;r+=n)i.push(t[r]);return i}function c(e,t,i){var a=[];if(0===e)return a;var r=t;if(r.ticks){if(a=r.ticks(e),a.length>e&&e>1&&(a=r.ticks(e-1)),a.length<Q&&(a=r.ticks(e+1)),a=h(a),i&&a.length>1){for(var n=a[1]-a[0];n>0&&i>n;){for(var o=1;o<a.length;o++)a.splice(o,1);n=2*n}1===a.length&&a.push(a[0]+i)}return a}return a}function h(e,t){if(void 0===t&&(t=1e-5),!e||e.length<2)return e;var i=t*Math.abs(e[1]-e[0]);return e.map(function(e){return Math.abs(e)<=i?0:e})}function d(t,i){var a=[],r=e.DateTimeSequence.calculate(new Date(i[0]),new Date(i[1]),t).sequence;return a=r.map(function(e){return e.getTime()}),a=P(a,i[0],i[1])}function p(e){return isNaN(e.min)||isNaN(e.max)?(e.min=t.fallBackDomain[0],e.max=t.fallBackDomain[1]):0===e.min&&0===e.max?e.max=t.fallBackDomain[1]:e.min===e.max?(e.min=e.min<0?1.2*e.min:.8*e.min,e.max=e.max<0?.8*e.max:1.2*e.max):Math.abs(e.min)<1e-4&&e.min/(e.max-e.min)<1e-4&&(e.min=0),e}function g(e,t,i,a){return 0===r(e-i)||0===n(t-a)?{top:0,right:i,bottom:a,left:0}:{top:20,right:30,bottom:40,left:30}}function f(e,t,i,a,o,s,l,u,c,h,d,p,g,f){var m=a.values,y=o.values,C=a.axisType,b=0,x=0,S=0,w=v(C)?j:q,_=0;if(void 0!==a.xLabelMaxWidth&&(_=Math.max(0,(e.width-a.xLabelMaxWidth*m.length)/2)),0!==r(e.width)||0!==n(e.height)){var T;T=h?Z.DefaultRotationWithScrollbar:Z.DefaultRotation;for(var D=0,P=y.length;P>D;D++)u.text=y[D],b=Math.max(b,i(u));if(c)for(var M=c.values,D=0,P=M.length;P>D;D++)u.text=M[D],x=Math.max(x,i(u));for(var D=0,P=m.length;P>D;D++){var L;u.text=m[D];var A=i(u);if(s)L=A*T.sine;else if(L=Y,0===D){var N=A/2-w-_;b=Math.max(b,N)}else if(D===P-1){var N=A/2;x=Math.max(x,N)}S=Math.max(S,L)}}if(d){var V=b;b=x,x=V}var I={xMax:Math.min(l,Math.ceil(S)),yLeft:Math.min(Math.ceil(b),t),yRight:Math.ceil(x)};return g||(I.yLeft=0,I.yRight=0),!f&&d&&(I.yLeft=0),f||d||(I.yRight=0),p||(I.xMax=0),I}function m(e){return e&&(e.bool||e.numeric||e.text||e.dateTime)}function y(){return e.ValueType.fromDescriptor({text:!0})}function v(e){return!(!e||!e.text&&!e.bool)}function C(e){return"undefined"==typeof e.invert}function b(e){return!(!e||!e.dateTime)}function x(e,t){return C(e)?w(e,t):e.invert(t)}function S(e){return C(e)?e.rangeExtent():e.range()}function w(e,t){var i,a=e.range(),r=e.rangeBand();for(i=0;t>a[i]+r&&a.length-1>i;i++);return e.domain()[i]}function _(e,t){for(var i=0,a=e.range(),r=Math.abs(t-a[0]),n=1;n<a.length;n++){var o=Math.abs(t-a[n]);r>o&&(r=o,i=n)}return i}function T(e,t,i){var a=e(t)-e(i);return 0===a?0:0>a?Math.min(a,-1):Math.max(a,1)}function D(e,t,i,a){if(i&&!v(t)){var r,n;return a&&2===a.length&&(r=a[0],n=a[1]),R(e,r,n,t)}return E(e)}function P(e,t,i){var a=e.filter(function(e){return e>=t&&i>=e});return a.length<2&&(a=[t,i]),a}function M(t,i){return t&&m(t.type)?t.type:i?e.ValueType.fromDescriptor({numeric:!0}):e.ValueType.fromDescriptor({text:!0})}function L(e){var i=e.pixelSpan,a=e.dataDomain,r=e.metaDataColumn,n=e.formatStringProp,o=e.outerPadding||0,s=!!e.isCategoryAxis,u=!!e.isScalar,c=!!e.isVertical,h=!!e.useTickIntervalForDisplayUnits,d=e.getValueFn,p=e.categoryThickness,g=t.valueFormatter.getFormatString(r,n),f=this.getCategoryValueType(r,u),m=this.createScale(e),y=m.scale,v=m.bestTickCount,C=y.domain();if(p&&u&&a&&2===a.length){var b=a[1]-a[0],x=C[1]-C[0];b>0&&x>0&&(p=p*b/x)}var S;if(u&&1===v)S=[a[0]];else{var w=u?I(g,f):void 0;S=l(v,y,f,u,w)}var _=N(C,a,f,u,g,v,S,d,h),T=d3.svg.axis().scale(y).tickSize(6,0).orient(c?"left":"bottom").ticks(v).tickValues(S),D=[];r&&(D=V(T,S,_,f,u,d));var P;if(!u&&p)P=Math.max(1,p-2*t.CartesianChart.TickLabelPadding);else{var M=S.length>1?S.length+1:S.length;P=M>1?i/M:i,P=Math.max(1,P-2*t.CartesianChart.TickLabelPadding)}return{scale:y,axis:T,formatter:_,values:D,axisType:f,axisLabel:null,isCategoryAxis:s,xLabelMaxWidth:P,categoryThickness:p,outerPadding:o,usingDefaultDomain:m.usingDefaultDomain}}function A(e){var i,o=e.pixelSpan,s=e.dataDomain,l=e.metaDataColumn,u=e.outerPadding||0,c=!!e.isScalar,h=!!e.isVertical,d=e.forcedTickCount,p=e.categoryThickness,g=this.getCategoryValueType(l,c),f=h?n(o):r(o),m=s?s.slice():null,y=f,C=!1;if(null==s||2===s.length&&null==s[0]&&null==s[1]||2!==s.length&&c)C=!0,s=g.dateTime?t.fallbackDateDomain:v(g)?[]:t.fallBackDomain,i=v(g)?O(o,s,p?u/p:0):F(o,s,u,y);else{if(c&&s.length>0){y=void 0!==d?0!==f?d:0:a.getBestNumberOfTicks(s[0],s[s.length-1],[l],f,g.dateTime);var b=a.normalizeLinearDomain({min:s[0],max:s[s.length-1]});m=[b.min,b.max]}c&&g.numeric&&!g.dateTime?i=F(o,m,u,y):c&&g.dateTime?i=F(o,m,u,null):(g.text||g.dateTime||g.numeric||g.bool)&&(i=O(o,m,p?u/p:0),y=0===f?0:Math.min(m.length,(o-2*u)/t.CartesianChart.MinOrdinalRectThickness))}return h&&c&&i.range(i.range().reverse()),t.ColumnUtil.normalizeInfinityInScale(i),{scale:i,bestTickCount:y,usingDefaultDomain:C}}function N(e,i,a,r,n,o,s,l,u){void 0===u&&(u=!1);var c;if(a.dateTime)if(r){var h=new Date(e[0]),d=new Date(e[1]);1===o&&(h=d=new Date(i[0])),c=t.valueFormatter.create({format:n,value:h,value2:d,tickCount:o})}else{var p=l(0,a),g=l(e.length-1,a);c=t.valueFormatter.create({format:n,value:p,value2:g,tickCount:o})}else if(u&&r&&s.length>1){var f=s[1]-s[0],m=0;c=t.valueFormatter.create({format:n,value:f,value2:m,allowFormatBeautification:!0})}else c=t.valueFormatter.createDefaultFormatter(n,!0);return c}function V(e,t,i,a,r,n){var o=[];return i?!n||a.numeric&&r?(e.tickFormat(function(e){return i.format(e)}),o=t.map(function(e){return i.format(e)})):(e.tickFormat(function(e){return i.format(n(e,a))}),o=t.map(function(e){return i.format(n(e,a))})):o=t.map(function(e){return n(e,a)}),o}function I(t,i){var a=t&&!e.NumberFormat.isStandardFormat(t);if(a){var r=e.NumberFormat.getCustomFormatMetadata(t,a).precision;return t.indexOf("%")>-1&&(r+=2),Math.pow(10,-r)}return i.integer?1:0}function R(e,t,i,a){if(0===e.length)return null;var r=d3.min(e,function(e){return d3.min(e.data,function(e){return e.categoryValue})}),n=d3.max(e,function(e){return d3.max(e.data,function(e){return e.categoryValue})});return W([t,i],[r,n])}function H(e,t){if(0===e.length)return null;var i=d3.min(e,function(e){return d3.min(e.data,function(e){return e.value})}),a=d3.max(e,function(e){return d3.max(e.data,function(e){return e.value})});return t?[Math.min(i,0),Math.max(a,0)]:[i,a]}function E(e){return i.isUndefinedOrEmpty(e)?[]:e[0].data.map(function(e){return e.categoryIndex})}function O(e,i,a){void 0===a&&(a=0);var r=d3.scale.ordinal().rangeBands([0,e],t.CartesianChart.InnerPaddingRatio,a).domain(i);return r}function F(e,t,i,a){void 0===i&&(i=0);var r=d3.scale.linear().range([i,e-i]).domain([t[0],t[1]]);return a&&r.nice(a),r}function G(e){var t={};return e&&(t.min=null==e.min?null==e.minLocal?d3.min(e.values):e.minLocal:e.min,t.max=null==e.max?null==e.maxLocal?d3.max(e.values):e.maxLocal:e.max),t}function z(e,t){var i=[void 0,void 0];return t&&2===t.length&&(i=[t[0],t[1]]),e&&2===e.length&&(null!=e[0]&&(i[0]=e[0]),null!=e[1]&&(i[1]=e[1])),null==i[0]&&null==i[1]?t:null!=i[0]&&null!=i[1]&&i[0]>i[1]?t:i}function W(e,t){var i=t?[t[0],t[1]]:[];return e&&2===e.length&&(null!=e[0]&&(i[0]=e[0]),null!=e[1]&&(i[1]=e[1]),i[0]>i[1]&&(i=t)),i}function U(t,i,a){if(!t||!t.axisStyle)return i;var r;return r=t.axisStyle===e.axisStyle.showBoth?i+" ("+a+")":t.axisStyle===e.axisStyle.showUnitOnly?a:i}function B(e,t){return!e||!t||e.length<2||t.length<2?!1:e[0]!==t[0]||e[1]!==t[1]}function k(e){return isNaN(e)?null:e===Number.POSITIVE_INFINITY?Number.MAX_VALUE:e===Number.NEGATIVE_INFINITY?-Number.MAX_VALUE:e}var j=25,q=10,Y=10,Q=2,X=3,K=10;a.getRecommendedNumberOfTicksForXAxis=r,a.getRecommendedNumberOfTicksForYAxis=n,a.getBestNumberOfTicks=o,a.hasNonIntegerData=s,a.getRecommendedTickValues=l,a.getRecommendedTickValuesForAnOrdinalRange=u,a.getRecommendedTickValuesForALinearRange=c,a.normalizeLinearDomain=p,a.getMargin=g,a.getTickLabelMargins=f,a.columnDataTypeHasValue=m,a.createOrdinalType=y,a.isOrdinal=v,a.isOrdinalScale=C,a.isDateTime=b,a.invertScale=x,a.extent=S,a.invertOrdinalScale=w,a.getOrdinalScaleClosestDataPointIndex=_,a.diffScaled=T,a.createDomain=D,a.ensureValuesInRange=P,a.getCategoryValueType=M,a.createAxis=L,a.createScale=A,a.formatAxisTickValues=V,a.getMinTickValueInterval=I,a.createValueDomain=H;var Z;!function(e){function t(e,t,i,a){var r=e.values;if(0===r.length)return!1;var n=void 0!==e.xLabelMaxWidth?e.xLabelMaxWidth:t/r.length;return r.some(function(e){return a.text=e,i(a)>n})}function i(t,i,a,r,n,o,s,l,u){var c,h;h=u?e.DefaultRotationWithScrollbar:e.DefaultRotation,n&&(c=a/h.sine),t.each(function(){var e=d3.select(this);if(n){var t=s.values.indexOf(this.textContent),i=l.left+s.outerPadding+s.categoryThickness*(t+.5);
u||(i-=K);var a=i/h.cosine;(o||c>a)&&r(e[0][0],Math.min(a,c)),e.style("text-anchor","end").attr({dx:"-0.5em",dy:h.dy,transform:h.transform})}else e.style("text-anchor","middle").attr({dx:"0em",dy:"1em",transform:"rotate(0)"})})}function a(e,t,i){0!==e.size()&&e.each(function(){var e=d3.select(this);i(e[0][0],t)})}e.willRotate=t,e.DefaultRotation={sine:Math.sin(Math.PI*(35/180)),cosine:Math.cos(Math.PI*(35/180)),tangent:Math.tan(Math.PI*(35/180)),transform:"rotate(-35)",dy:"-0.5em"},e.DefaultRotationWithScrollbar={sine:Math.sin(.5*Math.PI),cosine:Math.cos(.5*Math.PI),tangent:Math.tan(.5*Math.PI),transform:"rotate(-90)",dy:"-0.8em"},e.rotate=i,e.clip=a}(Z=a.LabelLayoutStrategy||(a.LabelLayoutStrategy={}));var J;!function(e){function t(){return $(n)}function i(e){e.find(".destroyme").remove()}function a(e,t,i,a){var n,o,s,l=0,u=e.width(),c=u/2,h=a-c-10,d=2;t+(c-l)>i?(n=i+h-(c-l),o=u-d-l-(i-t),s=u-l-(i-t)):t>c-l?(n=t+h,o=c-d,s=c):(n=c-l+h,o=t+l-d,s=t+l),r(e,n,o,s)}function r(e,t,i,a){e.css("left",t+"px"),e.find(".destroyme").remove(),e.append('<style class="destroyme">.triangle-border:before{left:'+i+"px;}</style>"),e.append('<style class="destroyme">.triangle-border:after{left:'+a+"px;}</style>")}var n='<div class="callout triangle-border ms-font-mi"><div class="textArea"/></div>';e.createCallout=t,e.clearCallout=i,e.renderCallout=a}(J=a.ToolTip||(a.ToolTip={})),a.createOrdinalScale=O,a.createLinearScale=F,a.getRangeForColumn=G,a.applyCustomizedDomain=z,a.combineDomain=W,a.createAxisLabel=U,a.scaleShouldClamp=B,a.normalizeNonFiniteNumber=k}(a=t.AxisHelper||(t.AxisHelper={}))}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var i;!function(t){function i(e,t){var i={};if(!e)return i;var a=e.objects;if(a){var r=a.categoryAxis;r&&(i={show:r.show,axisType:r.axisType,start:r.start,end:r.end,showAxisTitle:null==r.showAxisTitle?t:r.showAxisTitle,axisStyle:r.axisStyle})}return i}function a(e,t){var i={};if(!e)return i;var a=e.objects;if(a){var r=a.valueAxis;r&&(i={show:r.show,position:r.position,start:r.start,end:r.end,showAxisTitle:null==r.showAxisTitle?t:r.showAxisTitle,axisStyle:r.axisStyle,secShow:r.secShow,secPosition:r.secPosition,secStart:r.secStart,secEnd:r.secEnd,secShowAxisTitle:r.secShowAxisTitle,secAxisStyle:r.secAxisStyle})}return i}function r(t,i){return t&&(t=i&&i.axisType?i.axisType===e.axisType.scalar:!0),t}t.getCategoryAxisProperties=i,t.getValueAxisProperties=a,t.isScalar=r}(i=t.CartesianHelper||(t.CartesianHelper={}))}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var i=e.data.SQExprShortSerializer,a=function(){function t(e,t,i){this.colors=e,this.fillProp=t,this.defaultDataPointColor=i,this.defaultColorScale=e.getNewColorScale()}return t.prototype.getColorForSeriesValue=function(t,a,r){return this.fillProp&&e.DataViewObjects.getFillColor(t,this.fillProp)||this.defaultDataPointColor||this.colors.getColorScaleByKey(i.serializeArray(a||[])).getColor(r).value},t.prototype.getColorForMeasure=function(t,i){var a=this.defaultColorScale.getColor(i).value;return this.fillProp&&e.DataViewObjects.getFillColor(t,this.fillProp)||this.defaultDataPointColor||a},t.normalizeSelector=function(e,t){return e&&(t||e.data)?{data:e.data}:e},t}();t.ColorHelper=a}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var i,a="rect";!function(i){function r(e,i,a,r,n,o){return void 0!==o?0!==r?o:0:t.AxisHelper.getBestNumberOfTicks(e,i,a,r)}function n(e,t,a){if(e){var r=a.start,n=a.end;return i.transformDomain(t,r,n)}return t}function s(t,i,a){if(!t.categories||0===t.categories.length)return t;if("number"!=typeof i&&"number"!=typeof a)return t;var r=t.categories[0],n=r.values,o=r.objects,s=[],l=[],u=[];if("number"!=typeof i&&(i=n[0]),"number"!=typeof a&&(a=n[n.length-1]),i>a)return t;for(var c=0,h=t.values.length;h>c;c++)l.push([]);for(var d=0,h=n.length;h>d;d++)if(n[d]>=i&&n[d]<=a&&(s.push(n[d]),o&&u.push(o[d]),t.values))for(var p=0;p<t.values.length;p++)l[p].push(t.values[p].values[d]);var g=e.Prototype.inherit(t),f=g.values=e.Prototype.inherit(g.values),m=g.categories=e.Prototype.inherit(t.categories),y=g.categories[0]=e.Prototype.inherit(m[0]);y.values=s,y.objects&&(y.objects=u);for(var d=0,h=t.values.length;h>d;d++){var v=f[d]=e.Prototype.inherit(f[d]);v.values=l[d]}return g}function l(i,a,r,n,s,l){var u=r.categoryThickness,c=r.isScalar,h=r.outerPaddingRatio,d=new o(i,c),p=t.AxisHelper.createDomain(i.series,i.categoryMetadata?i.categoryMetadata.type:e.ValueType.fromDescriptor({text:!0}),c,[s,l]),g=t.AxisHelper.createAxis({pixelSpan:a,dataDomain:p,metaDataColumn:i.categoryMetadata,formatStringProp:t.columnChartProps.general.formatString,outerPadding:u*h,isCategoryAxis:!0,isScalar:c,isVertical:n,categoryThickness:u,useTickIntervalForDisplayUnits:!0,getValueFn:function(e,t){return d.lookupXValue(e,t)}});return r.categoryThickness=g.categoryThickness,g}function u(e,t){t&&e.attr("draggable","true").on("dragstart",t)}function c(e,t,a,r){return r&&!t||a&&!e?i.DimmedOpacity:i.DefaultOpacity}function h(e,t){for(var i=0,a=Number.MAX_VALUE,r=0,n=t.length;n>r;r++){var o=Math.abs(e-t[r]);a>o&&(a=o,i=r)}return i}function d(e,r,n,o){var s=e.selectAll(t.ColumnChart.SeriesClasses.selector),l="undefined"==typeof o;s.selectAll(a+r).filter(function(e){return e.categoryIndex!==n&&(l||e.categoryIndex===o)}).transition().style("fill-opacity",i.DimmedOpacity),s.selectAll(a+r).filter(function(e){return e.categoryIndex===n}).style("fill-opacity",i.DefaultOpacity)}function p(e,i,a){var r=i.selectAll(t.ColumnChart.SeriesClasses.selector),n=r.data(e.series,function(e){return e.key});return n.enter().append("g").classed(t.ColumnChart.SeriesClasses["class"],!0),n.exit().remove(),n}function g(e,t,r,n,o){var s;s=o?function(e){var t=_.filter(e.data,function(e){return!!e.value});return t}:function(e){return e.data};var l=t.selectAll(n.selector),u=l.data(s,function(e){return e.key}),c=e.hasSelection;return u.enter().append(a).attr("class",function(e){return n["class"].concat(e.highlight?" highlight":"")}),u.style("fill",function(e){return e.color}).style("fill-opacity",function(t){return i.getFillOpacity(t.selected,t.highlight,c,e.hasHighlights)}).attr(r.shapeLayout),u.exit().remove(),u}function f(e,i,a,r,n,o){if(void 0===n&&(n=!1),e){for(var s=e.data(),l=[],u=0,c=s.length;c>u;u++)Array.prototype.push.apply(l,s[u].data);return t.dataLabelUtils.drawDefaultLabelsForDataPointChart(l,i,a,r,n,o)}t.dataLabelUtils.cleanDataLabels(i)}function m(e){for(var t=e.domain(),i=0,a=t.length;a>i;++i)t[i]===Number.POSITIVE_INFINITY?t[i]=Number.MAX_VALUE:t[i]===Number.NEGATIVE_INFINITY&&(t[i]=-Number.MAX_VALUE);e.domain(t)}function y(e,i){var a=i.xScale,r=i.yScale,n=r(0),o=a(0);switch(e.chartType){case t.ColumnChartType.stackedBar:case t.ColumnChartType.hundredPercentStackedBar:return o+Math.abs(t.AxisHelper.diffScaled(a,0,e.valueAbsolute))+t.AxisHelper.diffScaled(a,e.position-e.valueAbsolute,0)+t.dataLabelUtils.defaultColumnLabelMargin;case t.ColumnChartType.clusteredBar:return o+t.AxisHelper.diffScaled(a,Math.max(0,e.value),0)+t.dataLabelUtils.defaultColumnLabelMargin;case t.ColumnChartType.stackedColumn:case t.ColumnChartType.hundredPercentStackedColumn:return n+t.AxisHelper.diffScaled(r,e.position,0)-t.dataLabelUtils.defaultColumnLabelMargin;case t.ColumnChartType.clusteredColumn:return n+t.AxisHelper.diffScaled(r,Math.max(0,e.value),0)-t.dataLabelUtils.defaultColumnLabelMargin}}i.DimmedOpacity=.4,i.DefaultOpacity=1,i.getTickCount=r,i.applyUserMinMax=n,i.transformDomain=s,i.getCategoryAxis=l,i.applyInteractivity=u,i.getFillOpacity=c,i.getClosestColumnIndex=h,i.setChosenColumnOpacity=d,i.drawSeries=p,i.drawDefaultShapes=g,i.drawDefaultLabels=f,i.normalizeInfinityInScale=m,i.calculatePosition=y}(i=t.ColumnUtil||(t.ColumnUtil={}));var r;!function(e){function t(e,t){return n.createValueFormatter(e,!1,t)}function i(e,t){var i=e.selectAll(t.selector).data([]);i.exit().remove()}e.createValueFormatter=t,e.clearColumns=i}(r=t.ClusteredUtil||(t.ClusteredUtil={}));var n;!function(a){function r(e,i){return t.AxisHelper.diffScaled(e,0,i)}function n(t,i){var a={min:0,max:10};if(0===t.length)return a;var r=d3.min(t,function(e){return d3.min(e.data,function(e){return e.position-e.valueAbsolute})}),n=d3.max(t,function(e){return d3.max(e.data,function(e){return e.position})});return i&&(r=e.Double.roundToPrecision(r,c.roundingError),n=e.Double.roundToPrecision(n,c.roundingError)),{min:r,max:n}}function o(r,o,s,l,u,c){var h=n(r.series,o),d=h.min,p=h.max,g=t.AxisHelper.getRecommendedNumberOfTicksForYAxis(s),f=i.getTickCount(d,p,r.valuesMetadata,g,o,u),m=t.AxisHelper.normalizeLinearDomain({min:d,max:p}),y=[m.min,m.max],v=t.AxisHelper.combineDomain(c,y),C=d3.scale.linear().range(l).domain(v).nice(f||void 0).clamp(t.AxisHelper.scaleShouldClamp(v,y));i.normalizeInfinityInScale(C);var b=t.AxisHelper.getCategoryValueType(r.valuesMetadata[0],!0),x=t.valueFormatter.getFormatString(r.valuesMetadata[0],t.columnChartProps.general.formatString),S=t.AxisHelper.getMinTickValueInterval(x,b),w=t.AxisHelper.getRecommendedTickValuesForALinearRange(f,C,S),_=d3.svg.axis().scale(C).tickValues(w),T=t.ColumnChart.getTickInterval(w),D=a.createValueFormatter(r.valuesMetadata,o,T);_.tickFormat(D.format);var P=w.map(function(e){return D.format(e)});return{axis:_,scale:C,formatter:D,values:P,axisType:e.ValueType.fromDescriptor({numeric:!0}),axisLabel:null,isCategoryAxis:!1}}function s(e,i,a){return i?t.valueFormatter.create({format:c.percentFormat,value:a,value2:0,allowFormatBeautification:!0}):t.valueFormatter.create({format:t.valueFormatter.getFormatString(e[0],t.columnChartProps.general.formatString),value:a,value2:0,allowFormatBeautification:!0})}function l(e,i,a,r,n){for(var o=0,s=0,l=0;a>l;l++){var u=n.getValueBySeriesAndCategory(l,i);u=t.AxisHelper.normalizeNonFiniteNumber(u),u>0?o+=u:0>u&&(s-=u)}var c=o+s;return{pos:o?o/c/o:1,neg:s?s/c/s:1}}function u(e,t){var i=e.selectAll(t.selector).data([]);i.exit().remove()}var c={percentFormat:"0%",roundingError:1e-4};a.getSize=r,a.calcValueDomain=n,a.getValueAxis=o,a.createValueFormatter=s,a.getStackedMultiplier=l,a.clearColumns=u}(n=t.StackedUtil||(t.StackedUtil={}));var o=function(){function e(e,t){this.data=e,this.isScalar=t}return e.prototype.lookupXValue=function(e,i){var a=t.AxisHelper.isDateTime(i);if(a&&this.isScalar)return new Date(e);var r=this.data;if(i.text)return r.categories[e];var n=r.series[0];if(n){var o=n.data;if(o){this.data.hasHighlights&&(e=2*e);var s=o[e];if(s)return a?new Date(s.categoryValue):s.categoryValue}}return e},e}();t.DataWrapper=o}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var i;!function(i){function a(e,i,a){if(e.categories&&e.categories.length>0){var r=e.categories[0];return r.source&&t.DataRoleHelper.hasRole(r.source,i)&&t.DataRoleHelper.hasRole(r.source,a)}return!1}function r(i,a){if(i.categories&&i.categories.length>0){var r=i.categories[0],n=r.values;return r.values.length>0?{categories:n,categoryFormatter:t.valueFormatter.create({format:t.valueFormatter.getFormatString(r.source,a),value:n[0],value2:n[n.length-1],displayUnitSystemType:e.DisplayUnitSystemType.Verbose}),categoryIdentities:r.identity,categoryObjects:r.objects}:{categories:[],categoryFormatter:{format:t.valueFormatter.format}}}return s()}function n(e){return void 0!==e.groupName?e.groupName:e.queryName}function o(e,i,a){var r=e,n=e.displayName;return void 0!==e.groupName&&(r=i.source,n=e.groupName),t.valueFormatter.format(n,t.valueFormatter.getFormatString(r,a))}function s(){return{categories:[null],categoryFormatter:{format:t.valueFormatter.format}}}function l(e,i,a,r){var n=null,o=null;if(e&&a&&a.displayName&&(n=a.displayName),i){var s=[];r&&(s=r.map(function(e){return e?e.displayName:""}).filter(function(e,t,i){return""!==e&&i.indexOf(e)===t}),o=t.valueFormatter.formatListAnd(s))}return{xAxisLabel:n,yAxisLabel:o}}i.categoryIsAlsoSeriesRole=a,i.getPivotedCategories=r,i.getSeriesName=n,i.getFormattedLegendLabel=o,i.createAxesLabels=l}(i=t.converterHelper||(t.converterHelper={}))}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var i;!function(i){function a(e,t){return void 0===e&&(e=!1),{show:e,position:0,displayUnits:0,precision:I,labelColor:t||i.defaultLabelColor,formatterOptions:null}}function r(){return{show:!0,position:0,displayUnits:0,precision:I,labelColor:i.defaultInsideLabelColor,showCategory:!0,formatterOptions:null}}function n(e){var t=a(!1);return t.position=null,t.labelColor=e?i.defaultInsideLabelColor:i.defaultLabelColor,t}function o(){return{show:!1,position:0,displayUnits:0,precision:I,labelColor:i.defaultLabelColor,formatterOptions:null}}function s(){return{show:!1,displayUnits:0,precision:I,labelColor:i.defaultLabelColor,position:null,showCategory:!0,formatterOptions:null}}function l(t,i,a,r,n,o){void 0===n&&(n=!1);var s=new e.DataLabelManager,l=s.hideCollidedLabels(r,t,a),u=h(l,i);return u?(u.attr({x:function(e){return e.labelX},y:function(e){return e.labelY}}).text(function(e){return e.labeltext}).style(a.style),n&&o&&u.transition().duration(o),u.exit().remove(),u):void 0}function u(e,t,i,a,r){void 0===a&&(a=!1);var n=e.filter(i.filter),o=h(n,t);return o?(o.attr(i.labelLayout).text(i.labelText).style(i.style),a&&r&&o.transition().duration(r),o.exit().remove(),o):void 0}function c(i,a,r,n,o,s,l){var u=new e.DataLabelManager,c=u.hideCollidedLabels(n,i,r,!0),d=h(c,a,!0);if(d){d.attr({x:function(e){return e.labelX},y:function(e){return e.labelY},dy:".35em"}).text(function(e){return e.labeltext}).style(r.style),d.exit().remove(),a.select(H.selector).empty()&&a.append("g").classed(H["class"],!0);var p=a.select(H.selector).selectAll("polyline").data(c,function(e){return e.data.identity.getKey()}),g=2.05,f=function(e){return e.startAngle+(e.endAngle-e.startAngle)/2};p.enter().append("polyline").classed(O["class"],!0),p.attr("points",function(e){var t=l.centroid(e);t[0]=.95*o*(f(e)<Math.PI?1:-1);var i=l.centroid(e),a=s.centroid(e);return a[0]*=g,a[1]*=g,[a,i,t]}).style({opacity:function(e){return t.DonutChart.PolylineOpacity},stroke:function(e){return e.data.labelColor}}),p.exit().remove()}}function h(e,t,i){if(void 0===i&&(i=!1),0===e.length)return d(t,!0),null;t.select(R.selector).empty()&&t.append("g").classed(R["class"],!0);var a=i?t.select(R.selector).selectAll(E.selector).data(e,function(e){return e.data.identity.getKey()}):t.select(R.selector).selectAll(E.selector).data(e);return a.enter().append("text").classed(E["class"],!0),a}function d(e,t){void 0===t&&(t=!1);var i=[],a=e.selectAll(E.selector).data(i);if(a.exit().remove(),e.selectAll(R.selector).remove(),t){var r=e.selectAll(O.selector).data(i);r.exit().remove(),e.selectAll(H.selector).remove()}}function p(e,i,a){e.selectAll(E.selector).style("fill-opacity",function(e){var r=t.ColumnUtil.getFillOpacity(e.selected,e.highlight,!e.highlight&&i,!e.selected&&a)<1?0:1;return r})}function g(t,a,r,n){var o={text:n?n.format(t):e.formattingService.formatValue(t,r),fontFamily:i.LabelTextProperties.fontFamily,fontSize:i.LabelTextProperties.fontSize,fontWeight:i.LabelTextProperties.fontWeight};return a=a?a:i.maxLabelWidth,e.TextMeasurementService.getTailoredTextOrDefault(o,a)}function f(e,t,i,a){return{x:function(i){return e.scale(i.categoryIndex)+t/2},y:function(e){return m(i.scale,e,a)}}}function m(t,a,r){var n=t(0)-t(Math.abs(a.value)),o=t(a.position),s=t(r[0]),l=t(a.position+a.value);if(a.value<0){var u={text:a.labeltext,fontFamily:i.LabelTextProperties.fontFamily,fontSize:i.LabelTextProperties.fontSize,fontWeight:i.LabelTextProperties.fontWeight},c=o+n+e.TextMeasurementService.measureSvgTextHeight(u);if(s>c)return c}else{var h=o-n-i.labelMargin;if(h>0)return h}return a.isLabelInside=!0,y(o,l,s)}function y(e,t,i){return e=0>e?0:e,e=e>i?i:e,t=0>t?0:t,t=t>i?i:t,Math.abs(t-e)/2+Math.min(e,t)}function v(a,r,n){if(null==a||null===a.value)return!1;var o={text:n.labelText(a),fontFamily:i.LabelTextProperties.fontFamily,fontSize:i.LabelTextProperties.fontSize,fontWeight:i.LabelTextProperties.fontWeight},s=t.WaterfallChart.getRectTop(r.scale,a.position,a.value)-i.labelMargin;if(s>0)return!0;var l=e.TextMeasurementService.measureSvgTextWidth(o),u=e.TextMeasurementService.measureSvgTextHeight(o),c=n.categoryWidth,h=Math.abs(t.AxisHelper.diffScaled(r.scale,Math.max(0,Math.abs(a.value)),0));return l>c||u>h?!1:!0}function C(e){return{labelText:function(e){return g(e.labeltext)},labelLayout:{x:function(e){return e.x},y:function(t){var a=t.radius+i.labelMargin;return 0===e.position?t.y-a:t.y+a}},filter:function(e){return null!=e&&null!=e.labeltext},style:{fill:function(e){return e.labelFill}}}}function b(e,a,r,n,o,s,l,u){var c=n?i.hundredPercentFormat:null,h=N(),d=L(o,e.labelSettings),p=e.labelSettings,f=l&&t.WebInteractivityService?l.hasSelection():!1;return{labelText:function(e){var t=null!=c?c:e.labelFormatString,a=h.getOrCreate(t,p,d);return g(a.format(e.value),i.maxLabelWidth)},labelLayout:a,filter:function(t){return i.getColumnChartLabelFilter(t,f,e.hasHighlights,s,u)},style:{fill:function(e){return e.labelFill},"text-anchor":r?"middle":"start"}}}function x(a,r,n){var o,s,l=r.xScale,u=r.yScale,c=r.columnWidth,h={text:a.labeltext,fontFamily:i.LabelTextProperties.fontFamily,fontSize:i.LabelTextProperties.fontSize,fontWeight:i.LabelTextProperties.fontWeight},d=e.TextMeasurementService.measureSvgTextWidth(h),p=e.TextMeasurementService.measureSvgTextHeight(h),g=!1,f=t.ColumnUtil.calculatePosition(a,r);switch(a.chartType){case t.ColumnChartType.stackedBar:case t.ColumnChartType.hundredPercentStackedBar:(!a.lastSeries||f+d>n||a.chartType===t.ColumnChartType.hundredPercentStackedBar)&&(o=-t.StackedUtil.getSize(l,a.valueAbsolute),s=c,g=!0);break;case t.ColumnChartType.clusteredBar:f+d>n&&(o=Math.abs(t.AxisHelper.diffScaled(l,0,a.value)),s=c,g=!0);break;case t.ColumnChartType.stackedColumn:case t.ColumnChartType.hundredPercentStackedColumn:(!a.lastSeries||0>=f||a.chartType===t.ColumnChartType.hundredPercentStackedColumn)&&(o=c,s=t.StackedUtil.getSize(u,a.valueAbsolute),g=!0);break;case t.ColumnChartType.clusteredColumn:0>=f&&(o=c,s=Math.abs(t.AxisHelper.diffScaled(u,0,a.value)),g=!0);break;default:return!0}return g&&(d>o||p>s)?!1:!0}function S(e,i,a,r,n){var o=i?t.ColumnUtil.getFillOpacity(e.selected,e.highlight,!e.highlight&&i,!e.selected&&a):t.ColumnUtil.getFillOpacity(e.selected,e.highlight,i,a);return null!=e&&null!=e.value&&x(e,r,n)&&1===o}function w(e,a,r,n,o){return{labelText:function(e){return g(e.category)},labelLayout:{x:function(t){return e(t.x)},y:function(e){var s=t.ScatterChart.getBubbleRadius(e.radius,o,n)+i.labelMargin;return 0===r.position?a(e.y)-s:a(e.y)+s}},filter:function(e){return null!=e&&null!=e.category},style:{fill:function(e){return e.labelFill}}}}function _(e,t,a,r,n){var o=N(),s=L(n,a);return{labelText:function(e){var t=o.getOrCreate(e.labelFormatString,a,s);return g(t.format(e.value))},labelLayout:{x:function(t){return e(r?t.categoryValue:t.categoryIndex)},y:function(e){return 0===a.position?t(e.value)-i.labelMargin:t(e.value)+i.labelMargin}},filter:function(e){return null!=e&&null!=e.value},style:{fill:function(e){return e.labelFill}}}}function T(e,t,a,r,n){var o=function(e){return e.startAngle+(e.endAngle-e.startAngle)/2},s=r.width/2-t,l=Math.min(s,i.maxLabelWidth),u=i.createColumnFormatterCacheManager();return{labelText:function(t){if(e.show){var i=u.getOrCreate(t.data.labelFormatString,e,n);return e.showCategory?g(g(t.data.label,l)+" "+i.format(t.data.measure),s):g(t.data.measure,l,null,i)}return g(t.data.label,l)},labelLayout:{x:function(e){return t*(o(e)<Math.PI?1:-1)},y:function(e){var t=a.centroid(e);return t[1]}},filter:function(e){return null!=e&&null!=e.data&&null!=e.data.label},style:{fill:function(e){return e.data.labelColor},"text-anchor":function(e){return o(e)<Math.PI?"start":"end"}}}}function D(a,r,n,o,s,l){var u=r.yScale,c=r.xScale,h=r.margin.left,d=r.xScale.rangeBand()/2+n,p=r.verticalRange/2,f=t.valueFormatter.getFormatString(a.valuesMetadata[0],t.funnelChartProps.general.formatString),m=e.TextMeasurementService.measureSvgTextWidth,y=null;if(0===s.displayUnits){var v=d3.min(a.slices,function(e){return e.value}),C=d3.max(a.slices,function(e){return e.value});y=Math.max(Math.abs(v),Math.abs(C))}var b=N();return{labelText:function(e){var t=Math.abs(u(e.value)-u(0)),i=Math.abs(u(e.value)-u(0))-2*o,a=p-t/2-o,r=null!=f?f:e.labelFormatString,n=Math.max(i,a),l=b.getOrCreate(r,s,y);return g(l.format(e.value),n)},labelLayout:{y:function(e,t){return c(t)+d},x:function(t){var a=Math.abs(u(t.value)-u(0)),r=Math.abs(u(t.value)-u(0))-2*o,n=p-a/2-o,l=Math.max(r,n),c=null!=f?f:t.labelFormatString,d=b.getOrCreate(c,s,y),v={text:g(d.format(t.value),l),fontFamily:i.LabelTextProperties.fontFamily,fontSize:i.LabelTextProperties.fontSize,fontWeight:i.LabelTextProperties.fontWeight},C=m(v),x=s.position;switch(x===e.labelPosition.outsideEnd&&C>n?x=e.labelPosition.insideCenter:x===e.labelPosition.insideCenter&&C>r&&(x=e.labelPosition.outsideEnd),x){case e.labelPosition.outsideEnd:return h+p+a/2+o+C/2;default:return t.labelFill=i.defaultInsideLabelColor,h+p}}},filter:function(e){return null!=e&&null!=e.value},style:{fill:function(e){return e.labelFill},"fill-opacity":function(e){return t.ColumnUtil.getFillOpacity(e.selected,!1,!1,!1)}}}}function P(e,t,i,a,r){if(void 0===i&&(i=!1),void 0===a&&(a=!1),!e)return[];var n={objectName:"labels",selector:null,properties:{show:e.show,color:e.labelColor}};return a&&(n.properties.labelDisplayUnits=e.displayUnits),i&&(n.properties.labelPrecision=e.precision),t&&(n.properties.labelPosition=e.position,r&&(n.validValues={labelPosition:r})),[n]}function M(e,t,i,a){void 0===i&&(i=!1),void 0===a&&(a=!1);var n=e?e:i?s():a?r():o(),l={objectName:"categoryLabels",selector:null,properties:{show:i||a?n.showCategory:n.show}};return t&&(l.properties.color=n.labelColor),[l]}function L(e,t){return e&&e.displayUnit&&0===t.displayUnits?e.displayUnit.value:null}function A(){return{show:!0,position:e.labelPosition.insideCenter,displayUnits:0,precision:I,labelColor:i.defaultLabelColor,formatterOptions:null}}function N(){return{cache:{defaultFormatter:null},getOrCreate:function(e,i,a){return e?(this.cache[e]||(this.cache[e]=t.valueFormatter.create(V(i,e,a))),this.cache[e]):(this.cache.defaultFormatter||(this.cache.defaultFormatter=t.valueFormatter.create(V(i,e,a))),this.cache.defaultFormatter)}}}function V(e,t,i){return{format:t,precision:e.precision,value:e.displayUnits,value2:i,allowFormatBeautification:!0}}i.labelMargin=8,i.maxLabelWidth=50,i.defaultColumnLabelMargin=5,i.defaultColumnHalfLabelHeight=4,i.LabelTextProperties={fontFamily:"wf_standard-font",fontSize:"12px",fontWeight:"normal"},i.defaultLabelColor="#777777",i.defaultInsideLabelColor="#ffffff",i.hundredPercentFormat="0.00 %;-0.00 %;0.00 %";var I=2,R={"class":"labels",selector:".labels"},H={"class":"lines",selector:".lines"},E={"class":"data-labels",selector:".data-labels"},O={"class":"line-label",selector:".line-label"};i.getDefaultLabelSettings=a,i.getDefaultTreemapLabelSettings=r,i.getDefaultColumnLabelSettings=n,i.getDefaultPointLabelSettings=o,i.getDefaultDonutLabelSettings=s,i.drawDefaultLabelsForDataPointChart=l,i.drawDefaultLabelsForFunnelChart=u,i.drawDefaultLabelsForDonutChart=c,i.cleanDataLabels=d,i.setHighlightedLabelsOpacity=p,i.getLabelFormattedText=g,i.getLabelLayoutXYForWaterfall=f,i.doesDataLabelFitInShape=v,i.getMapLabelLayout=C,i.getColumnChartLabelLayout=b,i.getColumnChartLabelFilter=S,i.getScatterChartLabelLayout=w,i.getLineChartLabelLayout=_,i.getDonutChartLabelLayout=T,i.getFunnelChartLabelLayout=D,i.enumerateDataLabels=P,i.enumerateCategoryLabels=M,i.getDefaultFunnelLabelSettings=A,i.createColumnFormatterCacheManager=N}(i=t.dataLabelUtils||(t.dataLabelUtils={}))}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t;!function(e){function t(e,t){if(e&&e.length>0){var a=e[0];if(a.values&&a.values.length>0)for(var r=0,n=a.values.length;n>r;++r){var o=a.values[r];if(o&&o.source&&i(o.source,t))return r}}return-1}function i(e,t){var i=e.roles;return i&&i[t]}function a(e,t){return null!=e&&null!=e.metadata&&e.metadata.columns&&_.any(e.metadata.columns,function(e){return e.roles&&void 0!==e.roles[t]})}e.getMeasureIndexOfRole=t,e.hasRole=i,e.hasRoleInDataView=a}(t=e.DataRoleHelper||(e.DataRoleHelper={}))}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t;!function(t){function i(t){return t.interactivity&&t.interactivity.selection?e.createInteractivityService(t.host):t.interactivity&&t.interactivity.isInteractiveLegend?new e.MobileInteractivityService:null}t.buildInteractivityService=i}(t=e.VisualInteractivityFactory||(e.VisualInteractivityFactory={}))}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){function t(e,t,a,r){var n=new i(t,a,r);return n.getWarningMessages(e)}e.getInvalidValueWarnings=t;var i=function(){function t(e,t,i){this.supportsNaN=e,this.supportsNegativeInfinity=t,this.supportsPositiveInfinity=i}return t.prototype.getWarningMessages=function(t){this.loadWarningStatus(t);var i=[];return this.hasNaN&&!this.supportsNaN&&i.push(new e.NaNNotSupportedWarning),(this.hasNegativeInfinity&&!this.supportsNegativeInfinity||this.hasPositiveInfinity&&!this.supportsPositiveInfinity)&&i.push(new e.InfinityValuesNotSupportedWarning),this.hasOutOfRange&&i.push(new e.ValuesOutOfRangeWarning),i},t.prototype.loadWarningStatus=function(e){this.hasNaN=!1,this.hasNegativeInfinity=!1,this.hasOutOfRange=!1,this.hasPositiveInfinity=!1;for(var t=0;t<e.length;t++){var i=e[t],a=i&&i.categorical&&i.categorical.values?i.categorical.values:null;if(!a)return;for(var r=a.length,n=0;r>n;n++){var o=a[n];if(o.values)for(var s=o.values.length,l=0;s>l;l++){var u=o.values[l];isNaN(u)?this.hasNaN=!0:u===Number.POSITIVE_INFINITY?this.hasPositiveInfinity=!0:u===Number.NEGATIVE_INFINITY?this.hasNegativeInfinity=!0:(-1e300>u||u>1e300)&&(this.hasOutOfRange=!0)}}}},t}()}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t;!function(e){function t(e){return new i(e,1)}function a(e){return new i(e,0)}e.createHTMLListView=t,e.createSVGListView=a}(t=e.ListViewFactory||(e.ListViewFactory={}));var i=function(){function t(e,i){var a=this;this.options=e,this.mode=i,this.options.baseContainer.style("overflow-y","auto").on("scroll",function(){return a.render(!1)}),this.scrollContainer=e.baseContainer.append(0===i?"svg":"div").attr("class","scrollRegion"),this.visibleGroupContainer=this.scrollContainer.append(0===i?"g":"div").attr("class","visibleGroup"),t.SetDefaultOptions(e),this.position=0}return t.SetDefaultOptions=function(e){e.rowHeight=e.rowHeight||1},t.prototype.rowHeight=function(e){return this.options.rowHeight=e,this},t.prototype.data=function(e,t){return this._data=e,this._dataIdFunction=t,this._totalRows=e?e.length:0,this},t.prototype.viewport=function(e){return this.options.viewport=e,this},t.prototype.empty=function(){this._data=[],this.render(!1,!0)},t.prototype.render=function(e,t){if(void 0===e&&(e=!1),void 0===t&&(t=!1),this._data&&this.options){var i,a=this.options,r=a.rowHeight;if(t?(this.position=0,i=0,$(a.baseContainer.node()).scrollTop(i)):i=a.baseContainer.node().scrollTop,e){var n=a.viewport.height;this.visibleRows=Math.ceil(n/r)+1}var o=Math.max(0,this._totalRows*r);this.scrollContainer.style("height",o+"px").attr("height",o);var s=this.position,l=this.position=Math.floor(i/r);this.delta=l-s,this.scrollToFrame(l)}},t.prototype.scrollToFrame=function(i){var a=this.options,r=this.visibleGroupContainer,n=this._totalRows,o=a.rowHeight,s=this.visibleRows,l=i*o;r.attr("transform",function(t){return e.SVGUtil.translate(0,l)}).style("transform",function(t){return e.SVGUtil.translateWithPixels(0,l)}).style("-webkit-transform",function(t){return e.SVGUtil.translateWithPixels(0,l)});var u=Math.max(0,Math.min(i,n-s+1)),c=u+s,h=r.selectAll(".row").data(this._data.slice(u,Math.min(c,n)),this._dataIdFunction);h.enter().append("g").classed("row",!0).call(function(e){return a.enter(e)}),h.order();var d=r.selectAll(".row:not(.transitioning)");d.call(function(e){return a.update(e)}),0===this.mode&&d.each(function(t,i){var a=e.SVGUtil.translate(0,i*o);d3.select(this).attr("transform",function(e){return a}).style("transform",function(e){return a})}),h.exit().call(function(e){return a.exit(e)}).remove(),c>=n*t.loadMoreDataThreshold&&a.loadMoreData()},t.loadMoreDataThreshold=.8,t}()}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var i=e.data.Selector,a=function(){function t(e,t){this.selector=e,this.highlight=t,this.key=JSON.stringify({selector:e?i.getKey(e):null,highlight:t})}return t.prototype.equals=function(e){return this.selector&&e.selector?this.highlight===e.highlight&&i.equals(this.selector,e.selector):!this.selector==!e.selector&&this.highlight===e.highlight},t.prototype.includes=function(t,i){void 0===i&&(i=!1);var a=this.selector,r=t.selector;if(!a||!r)return!1;var n=a.data,o=r.data;if(!n&&a.metadata&&a.metadata!==r.metadata)return!1;if(!i&&this.highlight!==t.highlight)return!1;if(n){if(!o)return!1;if(n.length>0)for(var s=0,l=n.length;l>s;s++){var u=n[s];if(!o.some(function(t){return e.DataViewScopeIdentity.equals(u,t)}))return!1}}return!0},t.prototype.getKey=function(){return this.key},t.prototype.hasIdentity=function(){return this.selector&&!!this.selector.data},t.prototype.getSelector=function(){return this.selector},t.prototype.getSelectorsByColumn=function(){return this.selectorsByColumn},t.createNull=function(e){return void 0===e&&(e=!1),new t(null,e)},t.createWithId=function(e,i){void 0===i&&(i=!1);var a=null;return e&&(a={data:[e]}),new t(a,i)},t.createWithMeasure=function(e,i){void 0===i&&(i=!1);var a={metadata:e},r=new t(a,i);return r.selectorsByColumn={metadata:e},r},t.createWithIdAndMeasure=function(e,i,a){void 0===a&&(a=!1);var r={};e&&(r.data=[e]),i&&(r.metadata=i),e||i||(r=null);var n=new t(r,a);return n},t.createWithIdAndMeasureAndCategory=function(e,t,i,a){void 0===a&&(a=!1);var r=this.createWithIdAndMeasure(e,t,a);return r.selectorsByColumn={},r.selectorsByColumn.dataMap=[{queryName:i,data:e}],t&&(r.selectorsByColumn.metadata=t),r},t.createWithIds=function(e,i,a){void 0===a&&(a=!1);var r=null,n=t.idArray(e,i);return n&&(r={data:n}),new t(r,a)},t.createWithIdsAndMeasure=function(e,i,a,r){void 0===r&&(r=!1);var n={},o=t.idArray(e,i);return o&&(n.data=o),a&&(n.metadata=a),e||i||a||(n=null),new t(n,r)},t.createWithIdsAndMeasureAndCategory=function(e,i,a,r){void 0===r&&(r=!1);var n=e?e.data:null,o=i?i.data:null,s=this.createWithIdsAndMeasure(n,o,a,r),l={},u=t.selectorMapArray(e,i);return u&&(l.dataMap=u),a&&(l.metadata=a),e||i||a||(l=null),s.selectorsByColumn=l,s},t.createWithHighlight=function(e){return new t(e.getSelector(),!0)},t.selectorMapArray=function(e,t){if(e&&e.data||t&&t.data){var i=[];return e&&e.data&&i.push(e),t&&t.data&&(e&&e.data===t.data||i.push(t)),i}},t.idArray=function(e,t){if(e||t){var i=[];return e&&i.push(e),t&&t!==e&&i.push(t),i}},t}();t.SelectionId=a}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){"use strict";var i;!function(t){var i,a=jsCommon.Utility;!function(t){function i(e,t,i){var a=e.x+t>=0?e.x+t:0,r=e.y+i>=0?e.y+i:0;return{x:a,y:r}}function r(e,t){return void 0!==e&&null!==e&&void 0!==t&&null!==t&&e.x===t.x&&e.y===t.y}function n(e){return null!==e?{x:e.x,y:e.y}:null}function o(e){return"{x:"+e.x+", y:"+e.y+"}"}function s(e){return e.x+","+e.y}function l(e,t){if(null===e||null===t)return null;var i=t.x-e.x,a=t.y-e.y;return Math.sqrt(i*i+a*a)}function u(t,i){return t===i||void 0!==t&&void 0!==i&&e.Double.equalWithPrecision(t.x,i.x)&&e.Double.equalWithPrecision(t.y,i.y)}function c(e,t){if(null===e)return void 0===t?null:t;if(void 0===e)return void 0===t?null:t;
if(2===e.length)return{x:a.parseNumber(e[0]),y:a.parseNumber(e[1])};if("string"==typeof e){var i=e.split(",");return 2!==i.length?void 0===t?null:t:{x:a.parseNumber(i[0]),y:a.parseNumber(i[1])}}return 2!==e.length&&"string"!=typeof e?void 0===t?null:t:{x:a.parseNumber(e.x),y:a.parseNumber(e.y)}}t.offset=i,t.equals=r,t.clone=n,t.toString=o,t.serialize=s,t.getDistance=l,t.equalWithPrecision=u,t.parsePoint=c}(i=t.Point||(t.Point={}));var r;!function(t){function i(e){return 0===e.width&&0===e.height}function r(e,t){return void 0!==e&&null!==e&&void 0!==t&&null!==t&&e.width===t.width&&e.height===t.height}function n(e){return null!==e?{width:e.width,height:e.height}:null}function o(e,t){var i=n(e);return t&&(i.width+=t.left+t.right,i.height+=t.top+t.bottom),i}function s(e,t){var i=n(e);return t&&(i.width=i.width-t.left-t.right,i.width<0&&(i.width=0),i.height=i.height-t.top-t.bottom,i.height<0&&(i.height=0)),i}function l(e,t){return t&&(e.width=Math.max(e.width,t.width),e.height=Math.max(e.height,t.height)),e}function u(e){return{left:0,top:0,width:e.width,height:e.height}}function c(e){return"{width:"+e.width+", height:"+e.height+"}"}function h(e,t){return e===t||void 0!==e&&void 0!==t&&e.width===t.width&&e.height===t.height}function d(t,i){return t===i||void 0!==t&&void 0!==i&&e.Double.equalWithPrecision(t.width,i.width)&&e.Double.equalWithPrecision(t.height,i.height)}function p(e,t){if(null===e)return void 0===t?null:t;if(void 0===e)return void 0===t?null:t;if(2===e.length)return{width:a.parseNumber(e[0]),height:a.parseNumber(e[1])};if("string"==typeof e){var i=e.split(",");return 2!==i.length?void 0===t?null:t:{width:a.parseNumber(i[0]),height:a.parseNumber(i[1])}}return 2!==e.length&&"string"!=typeof e?void 0===t?null:t:{width:a.parseNumber(e.width),height:a.parseNumber(e.height)}}t.isEmpty=i,t.equals=r,t.clone=n,t.inflate=o,t.deflate=s,t.combine=l,t.toRect=u,t.toString=c,t.equal=h,t.equalWithPrecision=d,t.parseSize=p}(r=t.Size||(t.Size={}));var n;!function(t){function i(e){return{x:e.left,y:e.top}}function r(e){return{width:e.width,height:e.height}}function n(e,t){e.width=t.width,e.height=t.height}function o(e){return e.left+e.width}function s(e){return e.top+e.height}function l(e){return{x:e.left,y:e.top}}function u(e){return{x:e.left+e.width,y:e.top}}function c(e){return{x:e.left,y:e.top+e.height}}function h(e){return{x:e.left+e.width,y:e.top+e.height}}function d(e,t){return void 0!==t&&null!==t&&e.left===t.left&&e.top===t.top&&e.width===t.width&&e.height===t.height}function p(e){return null!==e?{left:e.left,top:e.top,width:e.width,height:e.height}:null}function g(e){return"{left:"+e.left+", top:"+e.top+", width:"+e.width+", height:"+e.height+"}"}function f(e,t,i){var a=e.left+t>=0?e.left+t:0,r=e.top+i>=0?e.top+i:0;return{left:a,top:r,width:e.width,height:e.height}}function m(e,t){var i=p(e);return t&&(i.left-=t.left,i.top-=t.top,i.width+=t.left+t.right,i.height+=t.top+t.bottom),i}function y(e,t){var i=p(e);return t&&(i.left+=t.left,i.top+=t.top,i.width-=t.left+t.right,i.height-=t.top+t.bottom),i}function v(e,t){return{left:e.left-t,top:e.top-t,width:e.width+t+t,height:e.height+t+t}}function C(e,t){return{left:e.left+t,top:e.top+t,width:e.width-t-t,height:e.height-t-t}}function b(e,t,i){return{x:Math.min(Math.max(e.left,t),e.left+e.width),y:Math.min(Math.max(e.top,i),e.top+e.height)}}function x(e,t){return e===t||void 0!==e&&void 0!==t&&e.left===t.left&&e.top===t.top&&e.width===t.width&&e.height===t.height}function S(t,i){return t===i||void 0!==t&&void 0!==i&&e.Double.equalWithPrecision(t.left,i.left)&&e.Double.equalWithPrecision(t.top,i.top)&&e.Double.equalWithPrecision(t.width,i.width)&&e.Double.equalWithPrecision(t.height,i.height)}function w(e){return void 0===e||null===e||0===e.width&&0===e.height}function _(e,t){return null===e||null===t?!1:e.left<=t.x&&t.x<=e.left+e.width&&e.top<=t.y&&t.y<=e.top+e.height}function T(e,t){if(!e||!t)return!1;var i=Math.max(e.left,t.left),a=Math.min(e.left+e.width,t.left+t.width);if(i>a)return!1;var r=Math.max(e.top,t.top),n=Math.min(e.top+e.height,t.top+t.height);return n>=r}function D(e,t){if(!e)return t;if(!t)return e;var i=Math.max(e.left,t.left),a=Math.max(e.top,t.top),r=Math.min(e.left+e.width,t.left+t.width),n=Math.min(e.top+e.height,t.top+t.height);return r>=i&&n>=a?{left:i,top:a,width:r-i,height:n-a}:{left:0,top:0,width:0,height:0}}function P(e,t){if(!e)return t;if(!t)return e;var i=Math.min(e.left,t.left),a=Math.min(e.top,t.top),r=Math.max(e.left+e.width,t.left+t.width),n=Math.max(e.top+e.height,t.top+t.height);return{left:i,top:a,width:r-i,height:n-a}}function M(e,t){if(null===e)return void 0===t?null:t;if(void 0===e)return void 0===t?null:t;if(4===e.length)return{left:a.parseNumber(e[0]),top:a.parseNumber(e[1]),width:a.parseNumber(e[2]),height:a.parseNumber(e[3])};if("string"==typeof e){var i=e.split(",");return 4!==i.length?void 0===t?null:t:{left:a.parseNumber(i[0]),top:a.parseNumber(i[1]),width:a.parseNumber(i[2]),height:a.parseNumber(i[3])}}return 4!==e.length&&"string"!=typeof e?void 0===t?null:t:{left:a.parseNumber(e.left),top:a.parseNumber(e.top),width:a.parseNumber(e.width),height:a.parseNumber(e.height)}}t.getOffset=i,t.getSize=r,t.setSize=n,t.right=o,t.bottom=s,t.topLeft=l,t.topRight=u,t.bottomLeft=c,t.bottomRight=h,t.equals=d,t.clone=p,t.toString=g,t.offset=f,t.inflate=m,t.deflate=y,t.inflateBy=v,t.deflateBy=C,t.getClosestPoint=b,t.equal=x,t.equalWithPrecision=S,t.isEmpty=w,t.containsPoint=_,t.isIntersecting=T,t.intersect=D,t.combine=P,t.parseRect=M}(n=t.Rect||(t.Rect={}));var o;!function(t){function i(e,t){var i=o(e);return t&&(i.left=e.left+t.left,i.right=e.right+t.right,i.bottom=e.bottom+t.bottom,i.top=e.top+t.top),i}function r(e){return e.left+e.right}function n(e){return e.top+e.bottom}function o(e){return null!==e?{left:e.left,top:e.top,right:e.right,bottom:e.bottom}:null}function s(e,t){return void 0!==e&&null!==e&&void 0!==t&&null!==t&&e.left===t.left&&e.bottom===t.bottom&&e.right===t.right&&e.top===t.top}function l(e){var t=e.right;e.right=e.left,e.left=t}function u(e){var t=e.top;e.top=e.bottom,e.bottom=t}function c(e){return"{top:"+e.top+", left:"+e.left+", right:"+e.right+", bottom:"+e.bottom+"}"}function h(e){return e.top+"px "+e.right+"px "+e.bottom+"px "+e.left+"px"}function d(e){return 0===e.left&&0===e.top&&0===e.right&&0===e.bottom}function p(e,t){return e===t||void 0!==e&&void 0!==t&&e.left===t.left&&e.top===t.top&&e.right===t.right&&e.bottom===t.bottom}function g(t,i){return t===i||void 0!==t&&void 0!==i&&e.Double.equalWithPrecision(t.left,i.left)&&e.Double.equalWithPrecision(t.top,i.top)&&e.Double.equalWithPrecision(t.right,i.right)&&e.Double.equalWithPrecision(t.bottom,i.bottom)}function f(e,t,i){if(null===e)return void 0===t?null:t;if(void 0===e)return void 0===t?null:t;if(4===e.length)return{left:a.parseNumber(e[0]),top:a.parseNumber(e[1]),right:a.parseNumber(e[2]),bottom:a.parseNumber(e[3])};if("string"==typeof e){var r=e.split(",");return 4!==r.length?void 0===t?null:t:{left:a.parseNumber(r[0]),top:a.parseNumber(r[1]),right:a.parseNumber(r[2]),bottom:a.parseNumber(r[3])}}return 4!==e.length&&"string"!=typeof e?void 0===t?null:t:{left:a.parseNumber(e.left),top:a.parseNumber(e.top),right:a.parseNumber(e.right),bottom:a.parseNumber(e.bottom)}}t.inflate=i,t.getWidth=r,t.getHeight=n,t.clone=o,t.equals=s,t.flipHorizontal=l,t.flipVertical=u,t.toString=c,t.toCssString=h,t.isEmpty=d,t.equal=p,t.equalWithPrecision=g,t.parseThickness=f}(o=t.Thickness||(t.Thickness={}));var s;!function(t){function i(e){return 0===e.x&&0===e.y}function a(e,t){return void 0!==e&&null!==e&&void 0!==t&&null!==t&&e.x===t.x&&e.y===t.y}function r(e){return null!==e?{x:e.x,y:e.y}:null}function n(e){return"{x:"+e.x+", y:"+e.y+"}"}function o(e){return Math.sqrt(e.x*e.x+e.y*e.y)}function s(e){return e.x*e.x+e.y*e.y}function l(e,t){return{x:e.x*t,y:e.y*t}}function u(e){return i(e)?e:l(e,1/o(e))}function c(e){return{x:e.y,y:-e.x}}function h(e){return{x:-e.y,y:e.x}}function d(e,t){var i=e.x*Math.cos(t)-e.y*Math.sin(t),a=e.x*Math.sin(t)+e.y*Math.cos(t);return{x:i,y:a}}function p(e,t){return e===t||void 0!==e&&void 0!==t&&e.x===t.x&&e.y===t.y}function g(t,i){return t===i||void 0!==t&&void 0!==i&&e.Double.equalWithPrecision(t.x,i.x)&&e.Double.equalWithPrecision(t.y,i.y)}function f(e,t){return e&&t?{x:e.x+t.x,y:e.y+t.y}:void 0}function m(e,t){return e&&t?{x:e.x-t.x,y:e.y-t.y}:void 0}function y(e,t){return e&&t?e.x*t.x+e.y*t.y:void 0}function v(e,t){return e&&t?{x:t.x-e.x,y:t.y-e.y}:void 0}t.isEmpty=i,t.equals=a,t.clone=r,t.toString=n,t.getLength=o,t.getLengthSqr=s,t.scale=l,t.normalize=u,t.rotate90DegCW=c,t.rotate90DegCCW=h,t.rotate=d,t.equal=p,t.equalWithPrecision=g,t.add=f,t.subtract=m,t.dotProduct=y,t.getDeltaVector=v}(s=t.Vector||(t.Vector={}))}(i=t.shapes||(t.shapes={}))}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t;!function(e){function t(e,t){return"translate("+e+","+t+")"}function i(e){return"translateX("+e+"px)"}function a(e,t){return"translate("+e+"px,"+t+"px)"}function r(e,t,i,a,r){return"translate("+e+","+t+") rotate("+r+","+i+","+a+")"}function n(){var e=Date.now;Date.now=function(){return 1/0},d3.timer.flush(),Date.now=e}function o(e){if(e){var t=e,i=e;i.animation&&(t=i.animation),t&&t.transitionImmediate&&n()}}function s(e){e.getAttribute("d")||e.setAttribute("d","")}function l(e){isNaN(e.x)&&(e.x=0),isNaN(e.y)&&(e.y=0)}function u(e){if(!e||0===e.length)return{x:"0",y:"0"};var t,i=e.split(/[\s,]+/),a="0",r=i[0];if(1===i.length)t=r.substring(10,r.length-1);else{var n=i[1];a=n.substring(0,n.length-1);var t=r.substring(10,r.length)}return{x:t,y:a}}function c(e){return e+"px"}function h(e,t,i){var a="rotate("+i+" "+e/2+" "+t/2+")",r="M0 0";return r+="L0 "+t,r+="L"+e+" "+t/2+" Z",{path:r,transform:a}}e.AlmostZero=1e-6,e.translate=t,e.translateXWithPixels=i,e.translateWithPixels=a,e.translateAndRotate=r,e.flushAllD3Transitions=n,e.flushAllD3TransitionsIfNeeded=o,e.ensureDAttribute=s,e.ensureValidSVGPoint=l,e.parseTranslateTransform=u,e.convertToPixelString=c,e.createArrow=h}(t=e.SVGUtil||(e.SVGUtil={}))}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t;!function(e){function t(e){return e.toString().replace(new RegExp(" ","g"),"&nbsp")}e.removeBreakingSpaces=t}(t=e.TextUtil||(e.TextUtil={}))}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t,i=jsCommon.Utility;!function(e){function t(e,t){return null!=e&&null!=e.type&&null!=e.type.misc&&null!=e.type.misc.webUrl&&e.type.misc.webUrl&&null!=t&&i.isValidUrl(t)}e.isValidUrl=t}(t=e.UrlHelper||(e.UrlHelper={}))}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var i;!function(i){function a(e){if(e)for(var t in e){var i=e[t];for(var a in i.properties){var r=i.properties[a];if(r.type&&r.type.fillRule)return r.rule.inputRole}}}function r(e){var t=e&&e.query&&e.query.projections&&e.query.projections.Gradient?!0:!1;return t}function n(e){var t;if(e&&!$.isEmptyObject(e)){t=l();for(var i in t){var a=e.hasOwnProperty(i);if(a){var r=e[i];r&&r.solid&&r.solid.color&&(r=r.solid.color),t[i]=r}}}return t}function o(e){if(e&&e.values){var i=e.values.grouped();return t.DataRoleHelper.getMeasureIndexOfRole(i,"Gradient")}return-1}function s(e){var t=o(e);return t>=0}function l(){var e=p(),t={diverging:!1,minColor:e.minColor,midColor:D,maxColor:e.maxColor,minValue:void 0,midValue:void 0,maxValue:void 0};return t}function u(){return f()}function c(e,t,i){var a,r,n=i.dataPoint[0].properties,o=n.fillRule;o&&($.isNumeric(t)&&(a=void 0!==t?T["double"](+t):void 0),("minColor"===e||"midColor"===e||"maxColor"===e)&&(r=v(o,e,t)),"minColor"===e?C(o,r):"midColor"===e?b(o,r):"maxColor"===e?x(o,r):"minValue"===e?S(o,a):"midValue"===e?w(o,a):"maxValue"===e?_(o,a):"diverging"===e?(o=t?m(o):f(o),n.fillRule=o):"revertToDefault"===e&&(o=this.getDefaultFillRuleDefinition(),n.fillRule=o))}function h(e){return e?g(e):l()}function d(e){return e&&e.dataPoint&&e.dataPoint.length>0&&e.dataPoint[0].properties?e.dataPoint[0].properties.fillRule:null}function p(){var t=new e.visuals.DataColorPalette,i=t.getColorByIndex(0),a=d3.scale.linear().domain([0,100]).range(["#ffffff",i.value]),r=i.value,n=a(20),o=D;return{minColor:n,midColor:o,maxColor:r}}function g(e){var t,i,a,r,n,o=D,s=void 0!==e.linearGradient3;if(e.linearGradient2){var l=e.linearGradient2.max.color,u=e.linearGradient2.min.color,c=e.linearGradient2.max.value,h=e.linearGradient2.min.value;t=l.value,i=u.value,c&&(a=c.value),h&&(n=h.value)}else if(e.linearGradient3){var l=e.linearGradient3.max.color,d=e.linearGradient3.mid.color,u=e.linearGradient3.min.color,c=e.linearGradient3.max.value,p=e.linearGradient3.mid.value,h=e.linearGradient3.min.value;t=l.value,o=d.value,i=u.value,c&&(a=c.value),p&&(r=p.value),h&&(n=h.value)}return{diverging:s,minColor:i,midColor:o,maxColor:t,minValue:n,midValue:r,maxValue:a}}function f(e){var t=h(e),i={linearGradient2:{max:{color:T.text(t.maxColor)},min:{color:T.text(t.minColor)}}};return i}function m(e){var t=h(e),i={linearGradient3:{max:{color:T.text(t.maxColor)},mid:{color:T.text(t.midColor)},min:{color:T.text(t.minColor)}}};return i}function y(e,t){var i,a;return e.linearGradient3?(a=m(),"minColor"===t?i=a.linearGradient3.min.color:"midColor"===t?i=a.linearGradient3.mid.color:"maxColor"===t&&(i=a.linearGradient3.max.color)):e.linearGradient2&&(a=f(),"minColor"===t?i=a.linearGradient2.min.color:"maxColor"===t&&(i=a.linearGradient2.max.color)),i}function v(e,t,i){var a;return a=i?T.text(i):y(e,t)}function C(e,t){e.linearGradient2?e.linearGradient2.min.color=t:e.linearGradient3&&(e.linearGradient3.min.color=t)}function b(e,t){e.linearGradient3&&(e.linearGradient3.mid.color=t)}function x(e,t){e.linearGradient2?e.linearGradient2.max.color=t:e.linearGradient3&&(e.linearGradient3.max.color=t)}function S(e,t){e.linearGradient2?e.linearGradient2.min.value=t:e.linearGradient3&&(e.linearGradient3.min.value=t)}function w(e,t){e.linearGradient3&&(e.linearGradient3.mid.value=t)}function _(e,t){e.linearGradient2?e.linearGradient2.max.value=t:e.linearGradient3&&(e.linearGradient3.max.value=t)}var T=e.data.SQExprBuilder,D="#ffffff";i.getFillRuleRole=a,i.shouldShowGradient=r,i.getUpdatedGradientSettings=n,i.getGradientMeasureIndex=o,i.hasGradientRole=s,i.getDefaultGradientSettings=l,i.getDefaultFillRuleDefinition=u,i.updateFillRule=c,i.getGradientSettings=h,i.getFillRule=d,i.getGradientSettingsFromRule=g}(i=t.GradientUtils||(t.GradientUtils={}))}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t;!function(e){function t(){return"#FFF"}function i(){return 50}function a(){return!0}function r(){return{color:t(),transparency:i(),show:a()}}e.getDefaultColor=t,e.getDefaultTransparency=i,e.getDefaultShow=a,e.getDefaultValues=r}(t=e.visualBackgroundHelper||(e.visualBackgroundHelper={}))}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t=e.visuals.shapes;!function(e){e[e.None=0]="None",e[e.TopLeft=1]="TopLeft",e[e.TopCenter=2]="TopCenter",e[e.TopRight=4]="TopRight",e[e.MiddleLeft=8]="MiddleLeft",e[e.MiddleCenter=16]="MiddleCenter",e[e.MiddleRight=32]="MiddleRight",e[e.BottomLeft=64]="BottomLeft",e[e.BottomCenter=128]="BottomCenter",e[e.BottomRight=256]="BottomRight",e[e.InsideCenter=512]="InsideCenter",e[e.InsideBase=1024]="InsideBase",e[e.InsideEnd=2048]="InsideEnd",e[e.OutsideBase=4096]="OutsideBase",e[e.OutsideEnd=8192]="OutsideEnd",e[e.All=16383]="All"}(e.ContentPositions||(e.ContentPositions={}));var i=e.ContentPositions;!function(e){e[e.None=0]="None",e[e.VerticalBottomTop=1]="VerticalBottomTop",e[e.VerticalTopBottom=2]="VerticalTopBottom",e[e.HorizontalLeftRight=3]="HorizontalLeftRight",e[e.HorizontalRightLeft=4]="HorizontalRightLeft"}(e.RectOrientation||(e.RectOrientation={}));var a=e.RectOrientation;!function(e){e[e.Allowed=0]="Allowed",e[e.Disallowed=1]="Disallowed",e[e.Partial=2]="Partial"}(e.OutsidePlacement||(e.OutsidePlacement={}));var r=e.OutsidePlacement,n=function(){function n(){this.movingStep=3,this.hideOverlapped=!0,this._defaultSettings={anchorMargin:n.DefaultAnchorMargin,anchorRectOrientation:a.None,contentPosition:i.BottomCenter,outsidePlacement:r.Disallowed,maximumMovingDistance:n.DefaultMaximumMovingDistance,minimumMovingDistance:n.DefaultMinimumMovingDistance,validContentPositions:i.BottomCenter,opacity:1}}return Object.defineProperty(n.prototype,"defaultSettings",{get:function(){return this._defaultSettings},enumerable:!0,configurable:!0}),n.prototype.hideCollidedLabels=function(e,t,i,a){void 0===a&&(a=!1);var r=new o(e,t,i),s=[],l={x:0,y:0};a&&(l.x=e.width/2,l.y=e.height/2);for(var u=0,c=t.length;c>u;u++)if(i.filter(t[u])){var h=this.getLabelInfo(t[u]);h.anchorPoint={x:i.labelLayout.x(t[u])+l.x,y:i.labelLayout.y(t[u])+l.y};var d=this.calculateContentPosition(h,h.contentPosition,t[u].size,h.anchorMargin);n.isValid(d)&&!this.hasCollisions(r,h,d,e)&&(t[u].labelX=d.left-l.x,t[u].labelY=d.top-l.y,r.add(h,d),s.push(t[u]))}return s},n.prototype.getLabelInfo=function(e){var t=this._defaultSettings;return e.anchorMargin=void 0!==e.anchorMargin?e.anchorMargin:t.anchorMargin,e.anchorRectOrientation=void 0!==e.anchorRectOrientation?e.anchorRectOrientation:t.anchorRectOrientation,e.contentPosition=void 0!==e.contentPosition?e.contentPosition:t.contentPosition,e.maximumMovingDistance=void 0!==e.maximumMovingDistance?e.maximumMovingDistance:t.maximumMovingDistance,e.minimumMovingDistance=void 0!==e.minimumMovingDistance?e.minimumMovingDistance:t.minimumMovingDistance,e.outsidePlacement=void 0!==e.outsidePlacement?e.outsidePlacement:t.outsidePlacement,e.validContentPositions=void 0!==e.validContentPositions?e.validContentPositions:t.validContentPositions,e.opacity=void 0!==e.opacity?e.opacity:t.opacity,e.maximumMovingDistance+=e.anchorMargin,e},n.prototype.calculateContentPositionFromPoint=function(e,t,a,r){var n={x:0,y:0};if(e){if(void 0!==e.x&&isFinite(e.x))switch(n.x=e.x,t){case i.TopLeft:case i.MiddleLeft:case i.BottomLeft:n.x-=a.width/2;break;case i.TopRight:case i.MiddleRight:case i.BottomRight:n.x+=a.width/2}if(void 0!==e.y&&isFinite(e.y))switch(n.y=e.y,t){case i.MiddleLeft:case i.MiddleCenter:case i.MiddleRight:n.y-=a.height/2;break;case i.TopRight:case i.TopLeft:case i.TopCenter:n.y-=a.height}if(void 0!==r&&isFinite(r))switch(t){case i.TopLeft:n.x-=r,n.y-=r;break;case i.MiddleLeft:n.x-=r;break;case i.BottomLeft:n.x-=r,n.y+=r;break;case i.TopCenter:n.y-=r;break;case i.MiddleCenter:break;case i.BottomCenter:n.y+=r;break;case i.TopRight:n.x+=r,n.y-=r;break;case i.MiddleRight:n.x+=r;break;case i.BottomRight:n.x+=r,n.y+=r}}return{left:n.x,top:n.y,width:a.width,height:a.height}},n.prototype.calculateContentPositionFromRect=function(e,t,a,r,n){switch(a){case i.InsideCenter:return this.handleInsideCenterPosition(t,r,e,n);case i.InsideEnd:return this.handleInsideEndPosition(t,r,e,n);case i.InsideBase:return this.handleInsideBasePosition(t,r,e,n);case i.OutsideEnd:return this.handleOutsideEndPosition(t,r,e,n);case i.OutsideBase:return this.handleOutsideBasePosition(t,r,e,n)}return{left:0,top:0,width:-1,height:-1}},n.prototype.handleInsideCenterPosition=function(e,t,i,r){switch(e){case a.VerticalBottomTop:case a.VerticalTopBottom:return s.middleVertical(t,i,r);case a.HorizontalLeftRight:case a.HorizontalRightLeft:default:return s.middleHorizontal(t,i,r)}},n.prototype.handleInsideEndPosition=function(e,t,i,r){switch(e){case a.VerticalBottomTop:return s.topInside(t,i,r);case a.VerticalTopBottom:return s.bottomInside(t,i,r);case a.HorizontalRightLeft:return s.leftInside(t,i,r);case a.HorizontalLeftRight:default:return s.rightInside(t,i,r)}},n.prototype.handleInsideBasePosition=function(e,t,i,r){switch(e){case a.VerticalBottomTop:return s.bottomInside(t,i,r);case a.VerticalTopBottom:return s.topInside(t,i,r);case a.HorizontalRightLeft:return s.rightInside(t,i,r);case a.HorizontalLeftRight:default:return s.leftInside(t,i,r)}},n.prototype.handleOutsideEndPosition=function(e,t,i,r){switch(e){case a.VerticalBottomTop:return s.topOutside(t,i,r);case a.VerticalTopBottom:return s.bottomOutside(t,i,r);case a.HorizontalRightLeft:return s.leftOutside(t,i,r);case a.HorizontalLeftRight:default:return s.rightOutside(t,i,r)}},n.prototype.handleOutsideBasePosition=function(e,t,i,r){switch(e){case a.VerticalBottomTop:return s.bottomOutside(t,i,r);case a.VerticalTopBottom:return s.topOutside(t,i,r);case a.HorizontalRightLeft:return s.rightOutside(t,i,r);case a.HorizontalLeftRight:default:return s.leftOutside(t,i,r)}},n.prototype.calculateContentPosition=function(e,t,a,r){return t!==i.InsideEnd&&t!==i.InsideCenter&&t!==i.InsideBase&&t!==i.OutsideBase&&t!==i.OutsideEnd?this.calculateContentPositionFromPoint(e.anchorPoint,t,a,r):this.calculateContentPositionFromRect(e.anchorRect,e.anchorRectOrientation,t,a,r)},n.prototype.hasCollisions=function(i,a,o,s){var l=t.Rect;if(i.hasConflict(o))return!0;var u={left:0,top:o.height/2,width:s.width,height:s.height};if(u=l.inflate(u,{left:n.InflateAmount,top:0,right:n.InflateAmount,bottom:0}),u=l.intersect(u,o),l.isEmpty(u))return!0;var c=e.Double.lessWithPrecision;switch(a.outsidePlacement){case r.Disallowed:return c(u.width,o.width)||c(u.height,o.height/2);case r.Partial:return c(u.width,o.width/2)||c(u.height,o.height/4)}return!1},n.isValid=function(e){return!t.Rect.isEmpty(e)&&e.width>0&&e.height>0},n.DefaultAnchorMargin=0,n.DefaultMaximumMovingDistance=12,n.DefaultMinimumMovingDistance=3,n.InflateAmount=5,n}();e.DataLabelManager=n;var o=function(){function i(t,a,r){this._grid=[],(0===t.width||0===t.height)&&(this._cellSize=t,this._rowCount=this._colCount=0),this._cellSize={width:0,height:0};for(var n=0,o=a.length;o>n;n++){var s=a[n];s.labeltext=r.labelText(s);var l={fontFamily:e.visuals.dataLabelUtils.LabelTextProperties.fontFamily,fontSize:e.visuals.dataLabelUtils.LabelTextProperties.fontSize,fontWeight:e.visuals.dataLabelUtils.LabelTextProperties.fontWeight,text:s.labeltext};s.size={width:e.TextMeasurementService.measureSvgTextWidth(l),height:e.TextMeasurementService.measureSvgTextHeight(l)};var u=2*s.size.width,c=2*s.size.height;u>this._cellSize.width&&(this._cellSize.width=u),c>this._cellSize.height&&(this._cellSize.height=c)}0===this._cellSize.width&&(this._cellSize.width=t.width),0===this._cellSize.height&&(this._cellSize.height=t.height),this._colCount=this.getGridRowColCount(this._cellSize.width,t.width,i.ARRANGEGRID_MIN_COUNT,i.ARRANGEGRID_MAX_COUNT),this._rowCount=this.getGridRowColCount(this._cellSize.height,t.height,i.ARRANGEGRID_MIN_COUNT,i.ARRANGEGRID_MAX_COUNT),this._cellSize.width=t.width/this._colCount,this._cellSize.height=t.height/this._rowCount;for(var h=this._grid,d=0;d<this._colCount;d++){h[d]=[];for(var p=0;p<this._rowCount;p++)h[d][p]=[]}}return i.prototype.add=function(e,t){for(var i=this.getGridIndexRect(t),a=this._grid,r=i.left;r<i.right;r++)for(var n=i.top;n<i.bottom;n++)a[r][n].push({element:e,rect:t})},i.prototype.hasConflict=function(e){for(var i=this.getGridIndexRect(e),a=this._grid,r=t.Rect.isIntersecting,n=i.left;n<i.right;n++)for(var o=i.top;o<i.bottom;o++)for(var s=0;s<a[n][o].length;s++){var l=a[n][o][s];if(r(l.rect,e))return!0}return!1},i.prototype.getGridRowColCount=function(e,t,i,a){return Math.min(Math.max(Math.ceil(t/e),i),a)},i.prototype.getGridIndexRect=function(e){var t=function(e,t,i){return Math.min(Math.max(e,t),i)};return{left:t(Math.floor(e.left/this._cellSize.width),0,this._colCount),top:t(Math.floor(e.top/this._cellSize.height),0,this._rowCount),right:t(Math.ceil((e.left+e.width)/this._cellSize.width),0,this._colCount),bottom:t(Math.ceil((e.top+e.height)/this._cellSize.height),0,this._rowCount)}},i.ARRANGEGRID_MIN_COUNT=1,i.ARRANGEGRID_MAX_COUNT=100,i}();e.DataLabelArrangeGrid=o;var s;!function(e){function t(e,t,i){return{left:t.left+t.width/2-e.width/2,top:t.top+i,width:e.width,height:e.height}}function i(e,t,i){return{left:t.left+t.width/2-e.width/2,top:t.top+t.height-e.height-i,width:e.width,height:e.height}}function a(e,t,i){return{left:t.left+t.width-e.width-i,top:t.top+t.height/2-e.height/2,width:e.width,height:e.height}}function r(e,t,i){return{left:t.left+i,top:t.top+t.height/2-e.height/2,width:e.width,height:e.height}}function n(e,t,i){return{left:t.left+t.width/2-e.width/2,top:t.top-e.height-i,width:e.width,height:e.height}}function o(e,t,i){return{left:t.left+t.width/2-e.width/2,top:t.top+t.height+i,width:e.width,height:e.height}}function s(e,t,i){return{left:t.left+t.width+i,top:t.top+t.height/2-e.height/2,width:e.width,height:e.height}}function l(e,t,i){return{left:t.left-e.width-i,top:t.top+t.height/2-e.height/2,width:e.width,height:e.height}}function u(e,t,i){return{left:t.left+t.width/2-e.width/2+i,top:t.top+t.height/2-e.height/2,width:e.width,height:e.height}}function c(e,t,i){return{left:t.left+t.width/2-e.width/2,top:t.top+t.height/2-e.height/2+i,width:e.width,height:e.height}}e.topInside=t,e.bottomInside=i,e.rightInside=a,e.leftInside=r,e.topOutside=n,e.bottomOutside=o,e.rightOutside=s,e.leftOutside=l,e.middleHorizontal=u,e.middleVertical=c}(s||(s={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t=function(){function t(e){this.unit=e,this.sequence=[],this.min=new Date("9999-12-31T23:59:59.999"),this.max=new Date("0001-01-01T00:00:00.000")}return t.prototype.add=function(e){e<this.min&&(this.min=e),e>this.max&&(this.max=e),this.sequence.push(e)},t.prototype.extendToCover=function(e,i){for(var a=this.min;a>e;)a=t.addInterval(a,-this.interval,this.unit),this.sequence.splice(0,0,a);for(this.min=a,a=this.max;i>a;)a=t.addInterval(a,this.interval,this.unit),this.sequence.push(a);this.max=a},t.prototype.moveToCover=function(e,i){var a=t.getDelta(e,i,this.unit),r=Math.floor(a/this.interval);for(this.min=t.addInterval(this.min,r*this.interval,this.unit),this.sequence=[],this.sequence.push(this.min),this.max=this.min;this.max<i;)this.max=t.addInterval(this.max,this.interval,this.unit),this.sequence.push(this.max)},t.calculate=function(i,a,r,n){switch(n||(n=t.getIntervalUnit(i,a,r)),n){case e.DateTimeUnit.Year:return t.calculateYears(i,a,r);case e.DateTimeUnit.Month:return t.calculateMonths(i,a,r);case e.DateTimeUnit.Week:return t.calculateWeeks(i,a,r);case e.DateTimeUnit.Day:return t.calculateDays(i,a,r);case e.DateTimeUnit.Hour:return t.calculateHours(i,a,r);case e.DateTimeUnit.Minute:return t.calculateMinutes(i,a,r);case e.DateTimeUnit.Second:return t.calculateSeconds(i,a,r);case e.DateTimeUnit.Millisecond:return t.calculateMilliseconds(i,a,r)}},t.calculateYears=function(i,a,r){for(var n=e.NumericSequenceRange.calculateDataRange(i.getFullYear(),a.getFullYear(),!1),o=e.NumericSequence.calculate(n,r,0),s=o.sequence,l=new t(e.DateTimeUnit.Year),u=0;u<s.length;u++){var c=s[u];c&&l.add(new Date(c,0,1))}return l.interval=o.interval,l.intervalOffset=o.intervalOffset,l},t.calculateMonths=function(i,a,r){var n=i.getFullYear(),o=a.getFullYear(),s=i.getMonth(),l=12*(o-n)+a.getMonth(),u=new Date(n,0,1),c=e.NumericSequence.calculateUnits(s,l,r,[1,2,3,6,12]),h=t.fromNumericSequence(u,c,e.DateTimeUnit.Month);return h},t.calculateWeeks=function(i,a,r){var n=0,o=i.getDay(),s=(o-n+7)%7,l=i.getDate()-s,u=new Date(i.getFullYear(),i.getMonth(),l),c=0,h=e.Double.ceilWithPrecision(t.getDelta(u,a,e.DateTimeUnit.Week)),d=e.NumericSequence.calculateUnits(c,h,r,[1,2,4,8]),p=t.fromNumericSequence(u,d,e.DateTimeUnit.Week);return p},t.calculateDays=function(i,a,r){var n=new Date(i.getFullYear(),i.getMonth(),i.getDate()),o=0,s=e.Double.ceilWithPrecision(t.getDelta(i,a,e.DateTimeUnit.Day)),l=e.NumericSequence.calculateUnits(o,s,r,[1,2,7,14]),u=t.fromNumericSequence(n,l,e.DateTimeUnit.Day);return u},t.calculateHours=function(i,a,r){var n=new Date(i.getFullYear(),i.getMonth(),i.getDate()),o=e.Double.floorWithPrecision(t.getDelta(n,i,e.DateTimeUnit.Hour)),s=e.Double.ceilWithPrecision(t.getDelta(n,a,e.DateTimeUnit.Hour)),l=e.NumericSequence.calculateUnits(o,s,r,[1,2,3,6,12,24]),u=t.fromNumericSequence(n,l,e.DateTimeUnit.Hour);return u},t.calculateMinutes=function(i,a,r){var n=new Date(i.getFullYear(),i.getMonth(),i.getDate(),i.getHours()),o=e.Double.floorWithPrecision(t.getDelta(n,i,e.DateTimeUnit.Minute)),s=e.Double.ceilWithPrecision(t.getDelta(n,a,e.DateTimeUnit.Minute)),l=e.NumericSequence.calculateUnits(o,s,r,[1,2,5,10,15,30,60,120,180,360,720,1440]),u=t.fromNumericSequence(n,l,e.DateTimeUnit.Minute);return u},t.calculateSeconds=function(i,a,r){var n=new Date(i.getFullYear(),i.getMonth(),i.getDate(),i.getHours(),i.getMinutes()),o=e.Double.floorWithPrecision(t.getDelta(n,i,e.DateTimeUnit.Second)),s=e.Double.ceilWithPrecision(t.getDelta(n,a,e.DateTimeUnit.Second)),l=e.NumericSequence.calculateUnits(o,s,r,[1,2,5,10,15,30,60,120,300,600,900,1800,3600]),u=t.fromNumericSequence(n,l,e.DateTimeUnit.Second);return u},t.calculateMilliseconds=function(i,a,r){var n=new Date(i.getFullYear(),i.getMonth(),i.getDate(),i.getHours(),i.getMinutes(),i.getSeconds()),o=t.getDelta(n,i,e.DateTimeUnit.Millisecond),s=t.getDelta(n,a,e.DateTimeUnit.Millisecond),l=e.NumericSequence.calculate(e.NumericSequenceRange.calculate(o,s),r,0),u=t.fromNumericSequence(n,l,e.DateTimeUnit.Millisecond);return u},t.fromNumericSequence=function(e,i,a){for(var r=new t(a),n=0;n<i.sequence.length;n++){var o=i.sequence[n],s=t.addInterval(e,o,a);r.add(s)}return r.interval=i.interval,r.intervalOffset=i.intervalOffset,r},t.addInterval=function(t,a,r){switch(a=Math.round(a),r){case e.DateTimeUnit.Year:return i.addYears(t,a);case e.DateTimeUnit.Month:return i.addMonths(t,a);case e.DateTimeUnit.Week:return i.addWeeks(t,a);case e.DateTimeUnit.Day:return i.addDays(t,a);case e.DateTimeUnit.Hour:return i.addHours(t,a);case e.DateTimeUnit.Minute:return i.addMinutes(t,a);case e.DateTimeUnit.Second:return i.addSeconds(t,a);case e.DateTimeUnit.Millisecond:return i.addMilliseconds(t,a)}},t.getDelta=function(t,i,a){var r=0;switch(a){case e.DateTimeUnit.Year:r=i.getFullYear()-t.getFullYear();break;case e.DateTimeUnit.Month:r=12*(i.getFullYear()-t.getFullYear())+i.getMonth()-t.getMonth();break;case e.DateTimeUnit.Week:r=(i.getTime()-t.getTime())/6048e5;break;case e.DateTimeUnit.Day:r=(i.getTime()-t.getTime())/864e5;break;case e.DateTimeUnit.Hour:r=(i.getTime()-t.getTime())/36e5;break;case e.DateTimeUnit.Minute:r=(i.getTime()-t.getTime())/6e4;break;case e.DateTimeUnit.Second:r=(i.getTime()-t.getTime())/1e3;break;case e.DateTimeUnit.Millisecond:r=i.getTime()-t.getTime()}return r},t.getIntervalUnit=function(i,a,r){r=Math.max(r,2);var n=t.getDelta(i,a,e.DateTimeUnit.Day);if(n>356&&n>=180*r)return e.DateTimeUnit.Year;if(n>60&&n>7*r)return e.DateTimeUnit.Month;if(n>14&&n>2*r)return e.DateTimeUnit.Week;var o=t.getDelta(i,a,e.DateTimeUnit.Hour);if(n>2&&o>12*r)return e.DateTimeUnit.Day;if(o>=24&&o>=r)return e.DateTimeUnit.Hour;var s=t.getDelta(i,a,e.DateTimeUnit.Minute);if(s>2&&s>=r)return e.DateTimeUnit.Minute;var l=t.getDelta(i,a,e.DateTimeUnit.Second);if(l>2&&l>=.8*r)return e.DateTimeUnit.Second;var u=t.getDelta(i,a,e.DateTimeUnit.Millisecond);if(u>0)return e.DateTimeUnit.Millisecond;var c=i;return 0!==c.getMilliseconds()?e.DateTimeUnit.Millisecond:0!==c.getSeconds()?e.DateTimeUnit.Second:0!==c.getMinutes()?e.DateTimeUnit.Minute:0!==c.getHours()?e.DateTimeUnit.Hour:1!==c.getDate()?e.DateTimeUnit.Day:0!==c.getMonth()?e.DateTimeUnit.Month:e.DateTimeUnit.Year},t.MIN_COUNT=1,t.MAX_COUNT=1e3,t}();e.DateTimeSequence=t;var i;!function(e){function t(e){return e%4===0&&e%100!==0||e%400===0}function i(e,i){return t(e)?d[i]:h[i]}function a(e,i){var a=e.getFullYear(),r=e.getMonth(),n=e.getDate(),o=2===r&&29===n,s=new Date(e.getTime()),a=a+i;return o&&!t(a)&&(n=28),s.setFullYear(a,r,n),s}function r(e,t){var a=e.getFullYear(),r=e.getMonth(),n=e.getDate(),o=new Date(e.getTime());return a+=(t-t%12)/12,r+=t%12,r>11&&(r%=12,a++),n=Math.min(n,i(a,r)),o.setFullYear(a,r,n),o}function n(e,t){return o(e,7*t)}function o(e,t){var i=e.getFullYear(),a=e.getMonth(),r=e.getDate(),n=new Date(e.getTime());return n.setFullYear(i,a,r+t),
n}function s(e,t){return new Date(e.getTime()+36e5*t)}function l(e,t){return new Date(e.getTime()+6e4*t)}function u(e,t){return new Date(e.getTime()+1e3*t)}function c(e,t){return new Date(e.getTime()+t)}var h=[31,28,31,30,31,30,31,31,30,31,30,31],d=[31,29,31,30,31,30,31,31,30,31,30,31];e.addYears=a,e.addMonths=r,e.addWeeks=n,e.addDays=o,e.addHours=s,e.addMinutes=l,e.addSeconds=u,e.addMilliseconds=c}(i=e.DateUtils||(e.DateUtils={}))}(powerbi||(powerbi={}));var powerbi;!function(e){function t(t,r){for(var n=[],o=3;a>o;o++){var s=t(o);s&&i(n,e.Double.pow10(o),s.title,s.format,r)}return n}function i(e,t,i,a,r){if(i||a){var n=t;if(e.length>0){var s=e[e.length-1];r&&(n=r(t,s.value,n)),s.applicableRangeMax=n}var l=new o;l.value=t,l.applicableRangeMin=n,l.applicableRangeMax=1e3*n,l.title=i,l.labelFormat=a,e.push(l)}}var a=24,r=1e14,n=1e-4,o=function(){function t(){}return t.prototype.project=function(e){return this.value?e/this.value:e},t.prototype.reverseProject=function(e){return this.value?e*this.value:e},t.prototype.isApplicableTo=function(t){t=Math.abs(t);var i=e.Double.getPrecision(t,3);return e.Double.greaterOrEqualWithPrecision(t,this.applicableRangeMin,i)&&e.Double.lessWithPrecision(t,this.applicableRangeMax,i)},t}();e.DisplayUnit=o;var s=function(){function t(e){this.units=e?e:[]}return Object.defineProperty(t.prototype,"title",{get:function(){return this.displayUnit?this.displayUnit.title:void 0},enumerable:!0,configurable:!0}),t.prototype.update=function(e){void 0!==e&&(this._unitBaseValue=e,this.displayUnit=this.findApplicableDisplayUnit(e))},t.prototype.findApplicableDisplayUnit=function(e){for(var t=this.units.length,i=0;t>i;i++){var a=this.units[i];if(a.isApplicableTo(e))return a}return void 0},t.prototype.format=function(i,a,r,n){if(!t.UNSUPPORTED_FORMATS.test(a)){if(this.displayUnit){var o=this.displayUnit.project(i),s=n?t.getNonScientificFormatWithPrecision(this.displayUnit.labelFormat,r):this.displayUnit.labelFormat;return this.formatHelper(i,o,s,a,r,n)}if(null!=r){if(n&&a&&t.NUMBER_FORMAT.test(a)){var l=t.getFormatWithPrecision(r);return a=a.replace(/0\.0*/g,l),this.formatHelper(i,i,"",a,r,n)}if(n){var s=t.getNonScientificFormatWithPrecision("{0}",r);return this.formatHelper(i,i,s,a,r,n)}return this.formatHelper(i,i,"",a,r,n)}}return a=this.removeFractionIfNecessary(a),e.formattingService.formatValue(i,a)},t.prototype.formatHelper=function(i,a,r,n,o,s){var l=null!=o?e.Double.pow10(o):e.Double.getPrecision(i),u=e.Double.roundToPrecision(a,l);if(n&&!e.formattingService.isStandardNumberFormat(n))return e.formattingService.formatNumberWithCustomOverride(u,n,r);var c=s?t.getFormatWithPrecision(o):"G",h=e.formattingService.formatValue(u,c);return e.formattingService.format(r,[h])},t.getNonScientificFormatWithPrecision=function(e,i){if(!i||void 0===e)return e;var a="{0:"+t.getFormatWithPrecision(i)+"}";return e.replace("{0}",a)},t.getFormatWithPrecision=function(e){return null==e?"G":",0."+jsCommon.StringExtensions.repeat("0",Math.abs(e))},t.prototype.formatSingleValue=function(t,i,a){return this.update(this.shouldUseValuePrecision(t)?e.Double.getPrecision(t,8):t),this.format(t,i,a)},t.prototype.shouldUseValuePrecision=function(e){return 0===this.units.length?!0:Math.abs(e)<this.units[0].applicableRangeMin},t.prototype.removeFractionIfNecessary=function(e){return e&&(Math.abs(this._unitBaseValue)>=.01&&(e=e.replace(/^(p\d*)$/i,"p0")),Math.abs(this._unitBaseValue)>=1&&(e=e.replace(/[#0]\.[#0]+$/,"0"),e=e.replace(/^(n\d*)$/i,"n0"),e=e.replace(/^(f\d*)$/i,"f0"),e=e.replace(/^(c\d*)$/i,"c0"))),e},t.UNSUPPORTED_FORMATS=/^(p\d*)|(.*\%)|(e\d*)$/i,t.NUMBER_FORMAT=/#|0/,t}();e.DisplayUnitSystem=s;var l=function(e){function t(){e.call(this,[])}return __extends(t,e),t}(s);e.NoDisplayUnitSystem=l;var u=function(e){function i(t){e.call(this,i.getUnits(t))}return __extends(i,e),i.prototype.format=function(t,i,a,r){return this.displayUnit||!this.isScientific(t)||s.UNSUPPORTED_FORMATS.test(i)||(!i||i.toUpperCase().indexOf("E")<0)&&(i="0.######E+0"),e.prototype.format.call(this,t,i,a,r)},i.prototype.isScientific=function(e){return-r>e||e>r||e>-n&&n>e&&0!==e},i.reset=function(){i._units=null},i.getUnits=function(e){if(!i._units){i._units=t(e,function(e,t,i){return e-t>=1e3?e/10:i}),i._scientificBigNumbersBoundary=r;for(var a=0,n=i._units.length;n>a;++a){var o=i._units[a];o.applicableRangeMax>i._scientificBigNumbersBoundary&&(i._scientificBigNumbersBoundary=o.applicableRangeMax)}}return i._units},i}(s);e.DefaultDisplayUnitSystem=u;var c=function(e){function i(t){e.call(this,i.getUnits(t))}return __extends(i,e),i.reset=function(){i._units=null},i.getUnits=function(e){return i._units||(i._units=t(e)),i._units},i}(s);e.WholeUnitsDisplayUnitSystem=c}(powerbi||(powerbi={}));var powerbi;!function(e){var t=function(){function t(){}return t.calculate=function(i,a,r,n,o,s){var l=new t;if(a=void 0===a?10:e.Double.ensureInRange(a,t.MIN_COUNT,t.MAX_COUNT),void 0===n&&(n=e.Double.MIN_EXP),void 0===o&&(o=!1),void 0===r&&(r=1),void 0===s&&(s=[1,2,5]),i.forcedSingleStop)return l.interval=i.getSize(),l.intervalOffset=l.interval-(i.forcedSingleStop-i.min),l.min=i.min,l.max=i.max,l.sequence=[i.forcedSingleStop],l;var u=0,c=0,h=9,d=r>0&&!i.hasFixedMin,p=r>0&&!i.hasFixedMax,g=i.getSize(),f=e.Double.log10(g),m=e.Double.log10(s[0]);f-=m;var y=e.Double.log10(a);if(f-=y,f=Math.max(f,n-m+1),0!==u){var v=e.Double.pow10(f),C=e.Double.floorToPrecision(i.min,v),b=e.Double.ceilToPrecision(i.max,v),x=e.NumericSequenceRange.calculateFixedRange(C,b);x.shrinkByStep(i,u),c=x.min,h=x.max;var S=Math.floor(x.getSize()/u)}else{var w;for(w=0;3>w;w++){for(var _=f+w,v=e.Double.pow10(_),C=e.Double.floorToPrecision(i.min,v),b=e.Double.ceilToPrecision(i.max,v),T=s.length,D=e.Double.pow10(_-1),P=0;T>P;P++){var M=s[P]*D,x=e.NumericSequenceRange.calculateFixedRange(C,b,o);if(x.shrinkByStep(i,M),d&&i.min===x.min&&r>=1&&(x.min-=M),p&&i.max===x.max&&r>=1&&(x.max+=M),S=e.Double.ceilWithPrecision(x.getSize()/M),a>=S||2===w&&P===T-1||1===a&&2===S&&(M>i.getSize()||i.min<0&&i.max>0&&2*M>=i.getSize())){u=M,c=x.min,h=x.max;break}}if(0!==u)break}}(S>32*a||S>t.MAX_COUNT)&&(S=Math.min(32*a,t.MAX_COUNT),u=(h-c)/S),l.min=c,l.max=h,l.interval=u,l.intervalOffset=c-i.min,l._maxAllowedMargin=r,l._canExtendMin=d,l._canExtendMax=p;var L=e.Double.getPrecision(u,0);l.precision=L;var A=[],N=e.Double.roundToPrecision(c,L);A.push(N);for(var P=0;S>P;P++)N=e.Double.roundToPrecision(N+u,L),A.push(N);return l.sequence=A,l.trimMinMax(i.min,i.max),l},t.calculateUnits=function(i,a,r,n){r=e.Double.ensureInRange(r,t.MIN_COUNT,t.MAX_COUNT),i===a&&(a=i+1);for(var o=0,s=0,l=0;l<n.length;l++){s=n[l];var u=e.Double.ceilWithPrecision(a/s),c=e.Double.floorWithPrecision(i/s);if(o=u-c,r>=o)break}var h=-i;h%=s;var d=new t;d.sequence=[];for(var p=i+h;d.sequence.push(p),!(p>=a);p+=s);return d.interval=s,d.intervalOffset=h,d.min=d.sequence[0],d.max=d.sequence[d.sequence.length-1],d},t.prototype.trimMinMax=function(e,t){var i=(e-this.min)/this.interval,a=(this.max-t)/this.interval,r=.001;(!this._canExtendMin||i>this._maxAllowedMargin&&i>r)&&(this.min=e),(!this._canExtendMax||a>this._maxAllowedMargin&&a>r)&&(this.max=t)},t.MIN_COUNT=1,t.MAX_COUNT=1e3,t}();e.NumericSequence=t}(powerbi||(powerbi={}));var powerbi;!function(e){var t=function(){function t(){}return t.prototype._ensureIncludeZero=function(){this.includeZero&&(this.min>0&&!this.hasFixedMin&&(this.min=0),this.max<0&&!this.hasFixedMax&&(this.max=0))},t.prototype._ensureNotEmpty=function(){if(this.min===this.max)if(this.min){var i,a=this.min,r=e.Double.log10(Math.abs(a));r>=0&&4>r?(i=.5,this.forcedSingleStop=a):(i=e.Double.pow10(r)/2,this.forcedSingleStop=null),this.min=a-i,this.max=a+i}else this.min=0,this.max=t.DEFAULT_MAX,this.hasFixedMin=!0,this.hasFixedMax=!0},t.prototype._ensureDirection=function(){if(this.min>this.max){var e=this.min;this.min=this.max,this.max=e}},t.prototype.getSize=function(){return this.max-this.min},t.prototype.shrinkByStep=function(e,t){var i=this.min/t,a=e.min/t,r=Math.floor(a-i);this.min+=r*t,i=this.max/t,a=e.max/t,r=Math.ceil(a-i),this.max+=r*t},t.calculate=function(a,r,n,o,s){var l=new t;return l.includeZero=s?!0:!1,l.hasDataRange=i.hasValue(a)&&i.hasValue(r),l.hasFixedMin=i.hasValue(n),l.hasFixedMax=i.hasValue(o),a=e.Double.ensureInRange(a,t.MIN_SUPPORTED_DOUBLE,t.MAX_SUPPORTED_DOUBLE),r=e.Double.ensureInRange(r,t.MIN_SUPPORTED_DOUBLE,t.MAX_SUPPORTED_DOUBLE),l.hasFixedMin&&l.hasFixedMax?(l.min=n,l.max=o):l.hasFixedMin?(l.min=n,l.max=r>n?r:n):l.hasFixedMax?(l.min=o>a?a:o,l.max=o):l.hasDataRange?(l.min=a,l.max=r):(l.min=0,l.max=0),l._ensureIncludeZero(),l._ensureNotEmpty(),l._ensureDirection(),0===l.min?l.hasFixedMin=!0:0===l.max&&(l.hasFixedMax=!0),l},t.calculateDataRange=function(e,a,r){return i.hasValue(e)&&i.hasValue(a)?t.calculate(e,a,null,null,r):t.calculateFixedRange(0,t.DEFAULT_MAX)},t.calculateFixedRange=function(e,i,a){var r=new t;return r.hasDataRange=!1,r.includeZero=a,r.min=e,r.max=i,r._ensureIncludeZero(),r._ensureNotEmpty(),r._ensureDirection(),r.hasFixedMin=!0,r.hasFixedMax=!0,r},t.DEFAULT_MAX=10,t.MIN_SUPPORTED_DOUBLE=-1e307,t.MAX_SUPPORTED_DOUBLE=1e307,t}();e.NumericSequenceRange=t;var i;!function(e){function t(e){return void 0!==e&&null!==e}e.hasValue=t}(i=e.ValueUtil||(e.ValueUtil={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var i;!function(t){function i(e){var t=S[e];return t?w[t]||e:e}function a(e){var t=w["DisplayUnitSystem_E"+e+"_Title"],i=w["DisplayUnitSystem_E"+e+"_LabelFormat"];return t||i?{title:t,format:i}:void 0}function r(e){return w[e]}function n(t){return e.NumberFormat.getCustomFormatMetadata(t)}function o(t){_=t,e.DefaultDisplayUnitSystem.reset(),e.WholeUnitsDisplayUnitSystem.reset()}function s(e,t){void 0===t&&(t=!1);var i=t?_.beautify(e):e;return{format:function(e){return null==e?_["null"]:v(e,i)}}}function l(t){var i=t.allowFormatBeautification?_.beautify(t.format):t.format;if(d(t)){var a=h(t.displayUnitSystemType),r=!!t.formatSingleValues;a.update(Math.max(Math.abs(t.value||0),Math.abs(t.value2||0)));var n,o=null!=t.precision;return o?n=-t.precision:a.displayUnit&&(n=-T),{format:function(t){var s=C(t,!0);return x.isNullOrUndefinedOrWhiteSpaceString(s)?(t&&!a.displayUnit&&Math.abs(t)<D&&!o&&(t=e.Double.roundToPrecision(t,e.Double.pow10(e.Double.getPrecision(t)))),r?a.formatSingleValue(t,i,n):a.format(t,i,n,o)):s},displayUnit:a.displayUnit}}if(p(t.value,t.value2,t.tickCount)){var l=e.DateTimeSequence.getIntervalUnit(t.value,t.value2,t.tickCount);return{format:function(t){if(null==t)return _["null"];var i=e.formattingService.dateFormatString(l);return v(t,i)}}}return s(i)}function u(e,t,i){return null==e?_["null"]:v(e,i?_.beautify(t):t)}function c(e,t){return v(e,t)}function h(t){if(null==t)return new e.DefaultDisplayUnitSystem(_.describe);switch(t){case e.DisplayUnitSystemType.Default:return new e.DefaultDisplayUnitSystem(_.describe);case e.DisplayUnitSystemType.WholeUnits:return new e.WholeUnitsDisplayUnitSystem(_.describe);case e.DisplayUnitSystemType.Verbose:return new e.NoDisplayUnitSystem;default:return new e.DefaultDisplayUnitSystem(_.describe)}}function d(t){var i=t.value,a=t.value2,r=t.format;if(t.formatSingleValues&&r&&Math.abs(i)<P){var n=!e.NumberFormat.isStandardFormat(r);if(n){var o=e.NumberFormat.getCustomFormatMetadata(r,n).precision;if(M>o)return!1}else if(e.Double.isInteger(i))return!1}return"number"==typeof i||"number"==typeof a?!0:void 0}function p(e,t,i){return e instanceof Date&&t instanceof Date&&void 0!==i&&null!==i}function g(t,i,a){if(t){if(i){var r=e.DataViewObjects.getValue(t.objects,i);if(r)return r}if(!a){var n=t.type;if(n){if(n.dateTime)return"d";if(n.integer)return"g";if(n.numeric)return"#,0.00"}}}}function f(e,t){var i;if(!e)return null;var a=e.length;if(a>0){i=e[0];for(var r=a-1,n=1,o=r;o>n;n++){var s=e[n];i=x.format(_.restatementComma,i,s)}if(a>1){var s=e[r];i=x.format(t,i,s)}}else i=null;return i}function m(e){return f(e,_.restatementCompoundAnd)}function y(e){return f(e,_.restatementCompoundOr)}function v(t,i){var a=C(t,!1);return x.isNullOrUndefinedOrWhiteSpaceString(a)?e.formattingService.formatValue(t,i):a}function C(e,t){return null==e&&t?_["null"]:e===!0?_["true"]:e===!1?_["false"]:"number"==typeof e&&isNaN(e)?_.NaN:e===Number.NEGATIVE_INFINITY?_.negativeInfinity:e===Number.POSITIVE_INFINITY?_.infinity:""}function b(e){var t=h(e);return t.units}var x=jsCommon.StringExtensions,S={"0.00 %;-0.00 %;0.00 %":"Percentage","0.0 %;-0.0 %;0.0 %":"Percentage1"},w={NullValue:"(Blank)",BooleanTrue:"True",BooleanFalse:"False",NaNValue:"NaN",InfinityValue:"+Infinity",NegativeInfinityValue:"-Infinity",RestatementComma:"{0}, {1}",RestatementCompoundAnd:"{0} and {1}",RestatementCompoundOr:"{0} or {1}",DisplayUnitSystem_E3_LabelFormat:"{0}K",DisplayUnitSystem_E3_Title:"Thousands",DisplayUnitSystem_E6_LabelFormat:"{0}M",DisplayUnitSystem_E6_Title:"Millions",DisplayUnitSystem_E9_LabelFormat:"{0}bn",DisplayUnitSystem_E9_Title:"Billions",DisplayUnitSystem_E12_LabelFormat:"{0}T",DisplayUnitSystem_E12_Title:"Trillions",Percentage:"#,0.##%",Percentage1:"#,0.#%",TableTotalLabel:"Total",Tooltip_HighlightedValueDisplayName:"Highlighted",GeotaggingString_Continent:"continent",GeotaggingString_Continents:"continents",GeotaggingString_Country:"country",GeotaggingString_Countries:"countries",GeotaggingString_State:"state",GeotaggingString_States:"states",GeotaggingString_City:"city",GeotaggingString_Cities:"cities",GeotaggingString_Town:"town",GeotaggingString_Towns:"towns",GeotaggingString_Province:"province",GeotaggingString_Provinces:"provinces",GeotaggingString_County:"county",GeotaggingString_Counties:"counties",GeotaggingString_Village:"village",GeotaggingString_Villages:"villages",GeotaggingString_Post:"post",GeotaggingString_Zip:"zip",GeotaggingString_Code:"code",GeotaggingString_Place:"place",GeotaggingString_Places:"places",GeotaggingString_Address:"address",GeotaggingString_Addresses:"addresses",GeotaggingString_Street:"street",GeotaggingString_Streets:"streets",GeotaggingString_Longitude:"longitude",GeotaggingString_Longitude_Short:"lon",GeotaggingString_Latitude:"latitude",GeotaggingString_Latitude_Short:"lat",GeotaggingString_PostalCode:"postal code",GeotaggingString_PostalCodes:"postal codes",GeotaggingString_ZipCode:"zip code",GeotaggingString_ZipCodes:"zip codes",GeotaggingString_Territory:"territory",GeotaggingString_Territories:"territories"};t.getLocalizedString=r;var _={"null":w.NullValue,"true":w.BooleanTrue,"false":w.BooleanFalse,NaN:w.NaNValue,infinity:w.InfinityValue,negativeInfinity:w.NegativeInfinityValue,beautify:function(e){return i(e)},describe:function(e){return a(e)},restatementComma:w.RestatementComma,restatementCompoundAnd:w.RestatementCompoundAnd,restatementCompoundOr:w.RestatementCompoundOr},T=2,D=1e3,P=1e4,M=2;t.getFormatMetadata=n,t.setLocaleOptions=o,t.createDefaultFormatter=s,t.create=l,t.format=u,t.formatRaw=c,t.getFormatString=g,t.formatListAnd=m,t.formatListOr=y,t.getDisplayUnits=b}(i=t.valueFormatter||(t.valueFormatter={}))}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){function t(){return new i}e.createColorAllocatorFactory=t;var i=function(){function e(){}return e.prototype.linearGradient2=function(e){return new a(e)},e.prototype.linearGradient3=function(e,t){return t?new n(e):new r(e)},e}(),a=function(){function e(e){this.options=e;var t=e.min,i=e.max;this.scale=d3.scale.linear().domain([t.value,i.value]).range([t.color,i.color]).clamp(!0)}return e.prototype.color=function(e){var t=this.options.min,i=this.options.max;return t.value===i.value?e>=i.value?i.color:t.color:this.scale(e)},e}(),r=function(){function e(e){this.options=e;var t=e.min,i=e.mid,a=e.max;this.scale=d3.scale.linear().domain([t.value,i.value,a.value]).range([t.color,i.color,a.color]).clamp(!0)}return e.prototype.color=function(e){var t=this.options.min,i=this.options.mid,a=this.options.max;return a.value===i.value||i.value===t.value||a.value===i.value&&a.value===t.value?e>=a.value?a.color:e>=i.value?i.color:t.color:this.scale(e)},e}(),n=function(){function e(e){this.options=e;var t=e.min,i=e.mid,a=e.max;this.scale1=d3.scale.linear().domain([t.value,i.value]).range([t.color,i.color]).clamp(!0),this.scale2=d3.scale.linear().domain([i.value,a.value]).range([i.color,a.color]).clamp(!0)}return e.prototype.color=function(e){var t=this.options.min,i=this.options.mid,a=this.options.max;return a.value===i.value||i.value===t.value||a.value===i.value&&a.value===t.value?e>=a.value?a.color:e>=i.value?i.color:t.color:e<=i.value?this.scale1(e):this.scale2(e)},e}()}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t={"0.00 %;-0.00 %;0.00 %":"Percentage","0.0 %;-0.0 %;0.0 %":"Percentage1"},i={NullValue:"(Blank)",BooleanTrue:"True",BooleanFalse:"False",NaNValue:"NaN",InfinityValue:"+Infinity",NegativeInfinityValue:"-Infinity",Restatement_Comma:"{0}, {1}",Restatement_CompoundAnd:"{0} and {1}",DisplayUnitSystem_E3_LabelFormat:"{0}K",DisplayUnitSystem_E3_Title:"Thousands",DisplayUnitSystem_E6_LabelFormat:"{0}M",DisplayUnitSystem_E6_Title:"Millions",DisplayUnitSystem_E9_LabelFormat:"{0}bn",DisplayUnitSystem_E9_Title:"Billions",DisplayUnitSystem_E12_LabelFormat:"{0}T",DisplayUnitSystem_E12_Title:"Trillions",Percentage:"#,0.##%",Percentage1:"#,0.#%",TableTotalLabel:"Total",Tooltip_HighlightedValueDisplayName:"Highlighted",GeotaggingString_Continent:"continent",GeotaggingString_Continents:"continents",GeotaggingString_Country:"country",GeotaggingString_Countries:"countries",GeotaggingString_State:"state",GeotaggingString_States:"states",GeotaggingString_City:"city",GeotaggingString_Cities:"cities",GeotaggingString_Town:"town",GeotaggingString_Towns:"towns",GeotaggingString_Province:"province",GeotaggingString_Provinces:"provinces",GeotaggingString_County:"county",GeotaggingString_Counties:"counties",GeotaggingString_Village:"village",GeotaggingString_Villages:"villages",GeotaggingString_Post:"post",GeotaggingString_Zip:"zip",GeotaggingString_Code:"code",GeotaggingString_Place:"place",GeotaggingString_Places:"places",GeotaggingString_Address:"address",GeotaggingString_Addresses:"addresses",GeotaggingString_Street:"street",GeotaggingString_Streets:"streets",GeotaggingString_Longitude:"longitude",GeotaggingString_Longitude_Short:"lon",GeotaggingString_Latitude:"latitude",GeotaggingString_Latitude_Short:"lat",GeotaggingString_PostalCode:"postal code",GeotaggingString_PostalCodes:"postal codes",GeotaggingString_ZipCode:"zip code",GeotaggingString_ZipCodes:"zip codes",GeotaggingString_Territory:"territory",GeotaggingString_Territories:"territories",Waterfall_IncreaseLabel:"Increase",Waterfall_DecreaseLabel:"Decrease",Waterfall_TotalLabel:"Total"},a=function(){function a(){}return a.initialize=function(){e.valueFormatter.setLocaleOptions(a.createLocaleOptions()),e.TooltipManager.setLocalizedStrings(a.createTooltipLocaleOptions())},a.createLocaleOptions=function(){return{"null":i.NullValue,"true":i.BooleanTrue,"false":i.BooleanFalse,NaN:i.NaNValue,infinity:i.InfinityValue,negativeInfinity:i.NegativeInfinityValue,beautify:function(e){return a.beautify(e)},describe:function(e){return a.describeUnit(e)},restatementComma:i.Restatement_Comma,restatementCompoundAnd:i.Restatement_CompoundAnd,restatementCompoundOr:i.Restatement_CompoundOr}},a.createTooltipLocaleOptions=function(){return{highlightedValueDisplayName:i.Tooltip_HighlightedValueDisplayName}},a.prototype.getLocalizedString=function(e){return i[e]},a.prototype.onDragStart=function(){},a.prototype.canSelect=function(){return!1},a.prototype.onSelect=function(){},a.prototype.loadMoreData=function(){},a.prototype.persistProperties=function(e){},a.prototype.onCustomSort=function(e){},a.prototype.getViewMode=function(){return 0},a.prototype.setWarnings=function(e){},a.prototype.setToolbar=function(e){},a.beautify=function(e){var a=t[e];return a?i[a]||e:e},a.describeUnit=function(e){var t=i["DisplayUnitSystem_E"+e+"_Title"],a=i["DisplayUnitSystem_E"+e+"_LabelFormat"];return t||a?{title:t,format:a}:void 0},a}();e.DefaultVisualHostServices=a,e.defaultVisualHostServices=new a}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){function i(e){return new o(e)}function a(e){return e.append("rect").classed("clearCatcher",!0).attr({width:"100%",height:"100%"})}function r(e){for(var t=0,i=e.length;i>t;t++)if(e[t].selected)return!0;return!1}var n=jsCommon.ArrayExtensions;t.createInteractivityService=i,t.appendClearCatcher=a,t.dataHasSelection=r;var o=function(){function i(e){this.sendSelectionToVisual=function(){},this.sendSelectionToLegend=function(){},this.sendSelectionToSecondVisual=function(){},this.selectedIds=[],this.hasColumnChart=!1,this.mapPointerEventsDisabled=!1,this.mapPointerTimeoutSet=!1,this.hostService=e}return i.prototype.clearSelection=function(){this.clearSelectionInternal(),this.sendSelectionToVisual(),this.sendSelectionToLegend(),this.sendSelectionToSecondVisual()},i.prototype.hasSelection=function(){return this.selectedIds.length>0},i.prototype.legendHasSelection=function(){return r(this.selectableLegendDataPoints)},i.prototype.select=function(e,t){void 0===t&&(t=d3.event.ctrlKey),e.identity.highlight&&(e=_.find(this.selectableDataPoints,function(t){return!t.identity.highlight&&e.identity.includes(t.identity,!0)}));var i=e.identity;if(i){var a=!e.selected||!t&&this.selectedIds.length>1;t&&(a?(e.selected=!0,this.selectedIds.push(i)):(e.selected=!1,this.removeId(i))),t&&this.hostService.canSelect({data:this.selectedIds.map(function(e){return e.getSelector()})})||(this.clearSelectionInternal(),a&&(e.selected=!0,this.selectedIds.push(i))),this.syncSelectionState()}},i.prototype.removeId=function(e){for(var t=this.selectedIds,i=t.length-1;i>-1;i--){var a=t[i];e.includes(a)&&t.splice(i,1)}},i.isSelected=function(t,i,a){return null!=i.objects&&i.objects[a]&&e.DataViewObjects.getValue(i.objects[a],t)},i.prototype.createPropertiesToHost=function(t){var i={};if(this.selectedIds.length>0){var a=e.data.Selector.filterFromSelector(this.selectedIds.map(function(e){return e.getSelector()}),!1);i[t.propertyName]=a}return[{objectName:t.objectName,selector:void 0,properties:i}]},i.prototype.sendPersistPropertiesToHost=function(e){this.hostService.persistProperties(this.createPropertiesToHost(e))},i.prototype.sendSelectToHost=function(){var e=this.hostService;if(e.onSelect){var t={data:this.selectedIds.filter(function(e){return e.hasIdentity()}).map(function(e){return e.getSelector()})},i=this.selectedIds.filter(function(e){return e.getSelectorsByColumn()&&e.hasIdentity()}).map(function(e){return e.getSelectorsByColumn()});i&&i.length>0&&(t.data2=i),e.onSelect(t)}},i.prototype.sendSelectionToHost=function(e){e&&this.sendPersistPropertiesToHost(e),this.sendSelectToHost()},i.prototype.clearSelectionInternal=function(){n.clear(this.selectedIds);var e=this.selectableDataPoints,t=this.selectableLegendDataPoints,i=this.secondSelectableDataPoints;if(e)for(var a=e.length-1;a>-1;a--)e[a].selected=!1;if(i)for(var a=i.length-1;a>-1;a--)i[a].selected=!1;if(t)for(var a=t.length-1;a>-1;a--)t[a].selected=!1},i.prototype.applySelectionStateToData=function(e){for(var t=0,i=e.length;i>t;t++){var a=e[t];a.selected=this.selectedIds.some(function(e){return e.includes(a.identity)})}return this.hasSelection()},i.prototype.initAndSyncSelectionState=function(e){var t=this.selectableDataPoints,i=this.selectableLegendDataPoints,a=this.secondSelectableDataPoints,r=this.selectedIds;if(t&&0===r.length){if(t)for(var n=0,o=t.length;o>n;n++)t[n].selected&&r.push(t[n].identity);if(a)for(var n=0,o=a.length;o>n;n++)a[n].selected&&r.push(a[n].identity);if(i)for(var n=0,o=i.length;o>n;n++)i[n].selected&&r.push(i[n].identity)}this.syncSelectionState(e)},i.prototype.syncSelectionState=function(e){var t=this.selectedIds,i=this.selectableDataPoints,a=this.selectableLegendDataPoints,r=this.secondSelectableDataPoints,n=!1;if(i){for(var o=0,s=i.length;s>o;o++){var l=i[o];t.some(function(e){return e.includes(l.identity)})?(l.selected||(l.selected=!0),n=!0):l.selected&&(l.selected=!1)}if(r)for(var o=0,s=r.length;s>o;o++){var l=r[o];t.some(function(e){return e.includes(l.identity)})?(l.selected||(l.selected=!0),n=!0):l.selected&&(l.selected=!1)}if(a)for(var o=0,s=a.length;s>o;o++){var u=a[o];t.some(function(e){return e.includes(u.identity)})?u.selected=!0:u.selected&&(u.selected=!1)}!n&&t.length>0&&(this.clearSelectionInternal(),this.sendSelectionToHost(e))}},i.prototype.apply=function(e,t){e.accept(this,t)},i.prototype.visitColumnChart=function(e){var i=this,a=this.behavior;a||(a=this.behavior=new t.ColumnChartWebBehavior),this.selectableDataPoints=e.datapoints,this.initAndSyncSelectionState();var r=e.bars,n=e.clearCatcher;r.on("click",function(t,r){i.select(t),a.select(i.hasSelection(),e),i.sendSelectionToHost(),i.sendSelectionToLegend&&i.sendSelectionToLegend(),i.sendSelectionToSecondVisual()}),n.on("click",function(){i.clearSelection(),i.sendSelectionToHost()}),this.sendSelectionToVisual=function(){a.select(i.hasSelection(),e)},this.hasColumnChart=!0},i.prototype.visitLineChart=function(e){this.hasColumnChart?this.visitLineChartCombo(e):this.visitLineChartNoCombo(e)},i.prototype.visitLineChartNoCombo=function(e){var i=this,a=this.behavior;a||(a=this.behavior=new t.LineChartWebBehavior),this.selectableDataPoints=e.dataPoints,this.initAndSyncSelectionState();var r=e.lines,n=e.interactivityLines,o=e.dots,s=e.clearCatcher,l=e.areas,u=function(e,t){i.select(e),a.select(i.hasSelection(),r,o,l),i.sendSelectionToHost(),i.sendSelectionToLegend()};n.on("click",u),o.on("click",u),l&&l.on("click",u),s.on("click",function(){i.clearSelection(),a.select(!1,r,o,l),i.sendSelectionToHost()}),this.sendSelectionToVisual=function(){a.select(i.hasSelection(),r,o,l)}},i.prototype.visitLineChartCombo=function(e){var i=this,a=this.secondBehavior;a||(a=this.secondBehavior=new t.LineChartWebBehavior),this.secondSelectableDataPoints=e.dataPoints,this.initAndSyncSelectionState();var r=e.lines,n=e.interactivityLines,o=e.dots,s=e.areas,l=function(e,t){i.select(e),a.select(i.hasSelection(),r,o,s),i.sendSelectionToHost(),i.sendSelectionToLegend&&i.sendSelectionToLegend(),i.sendSelectionToVisual&&i.sendSelectionToVisual()};n.on("click",l),o.on("click",l),s&&s.on("click",l),this.sendSelectionToSecondVisual=function(){a.select(i.hasSelection(),r,o,s)}},i.prototype.visitDataDotChart=function(e){var i=this,a=this.behavior;a||(a=this.behavior=new t.DataDotChartWebBehavior),this.selectableDataPoints=e.datapoints,this.initAndSyncSelectionState();var r=e.dots,n=e.clearCatcher;r.on("click",function(e,t){i.select(e),a.select(i.hasSelection(),r),i.sendSelectionToHost()}),n.on("click",function(){i.clearSelection(),a.select(!1,r),i.sendSelectionToHost()}),this.sendSelectionToVisual=function(){a.select(i.hasSelection(),r)}},i.prototype.visitDonutChart=function(e){var i=this,a=this.behavior;a||(a=this.behavior=new t.DonutChartWebBehavior(e)),this.selectableDataPoints=e.datapoints,this.initAndSyncSelectionState();var r=e.slices,n=e.highlightSlices,o=e.clearCatcher,s=e.hasHighlights,l=function(e){i.select(e.data),a.select(i.hasSelection(),r,!1,s,e.data),a.select(i.hasSelection(),n,!0,s,e.data),i.sendSelectionToHost(),i.sendSelectionToLegend()};r.on("click",l),n.on("click",l),o.on("click",function(){i.clearSelection(),i.sendSelectionToHost(),i.sendSelectionToLegend()}),this.sendSelectionToVisual=function(){a.select(i.hasSelection(),r,!1,s),a.select(i.hasSelection(),n,!0,s)}},i.prototype.visitFunnel=function(e){var i=this,a=this.behavior;a||(a=this.behavior=new t.FunnelWebBehavior),this.selectableDataPoints=e.datapoints,this.initAndSyncSelectionState();var r=e.bars,n=e.labels,o=e.clearCatcher,s=e.hasHighlights;r.on("click",function(e,t){i.select(e),a.select(i.hasSelection(),r,s),i.sendSelectionToHost()}),n&&n.on("click",function(e,t){i.select(e),a.select(i.hasSelection(),r,s),i.sendSelectionToHost()}),o.on("click",function(){i.clearSelection(),i.sendSelectionToHost()}),this.sendSelectionToVisual=function(){a.select(i.hasSelection(),r,s)}},i.prototype.visitScatterChart=function(e){var i=this,a=this.behavior;a||(a=this.behavior=new t.ScatterChartWebBehavior),this.selectableDataPoints=e.data.dataPoints,this.initAndSyncSelectionState();var r=e.dataPointsSelection,n=e.clearCatcher;r.on("click",function(e,t){i.select(e),a.select(i.hasSelection(),r),i.sendSelectionToHost(),i.sendSelectionToLegend()}),n.on("click",function(){i.clearSelection(),i.sendSelectionToHost()}),this.sendSelectionToVisual=function(){a.select(i.hasSelection(),e.dataPointsSelection)}},i.prototype.visitTreemap=function(e){var i=this,a=this.behavior;a||(a=this.behavior=new t.TreemapWebBehavior),this.selectableDataPoints=e.nodes,this.initAndSyncSelectionState();var r=e.shapes,n=e.highlightShapes,o=e.labels,s=e.hasHighlights,l=function(e){i.select(e),a.select(i.hasSelection(),r,!1),a.select(i.hasSelection(),n,!0),i.sendSelectionToHost(),i.sendSelectionToLegend()};r.on("click",l),n.on("click",l),o.on("click",function(e,t){i.select(e),a.select(i.hasSelection(),r,s),i.sendSelectionToHost(),i.sendSelectionToLegend()}),this.sendSelectionToVisual=function(){a.select(i.hasSelection(),r,s)}},i.prototype.visitSlicer=function(e){var i=this,a=this.behavior;a||(a=this.behavior=new t.SlicerWebBehavior);var r=t.slicerProps.filterPropertyIdentifier;this.selectableDataPoints=e.datapoints,this.initAndSyncSelectionState(r);var n=e.slicerItemContainers,o=e.slicerItemLabels,s=e.slicerItemInputs,l=e.slicerClear;n.on("mouseover",function(e){e.mouseOver=!0,e.mouseOut=!1,a.mouseInteractions(o)}),n.on("mouseout",function(e){e.mouseOver=!1,e.mouseOut=!0,a.mouseInteractions(o)}),o.on("click",function(e){i.select(e,i.hasSelection()),a.select(o),i.sendSelectionToHost(r)}),l.on("click",function(e){i.clearSelection(),a.clearSlicers(o,s),i.sendSelectionToHost(r)}),this.sendSelectionToVisual=function(){a.select(o)},this.sendSelectionToVisual()},i.prototype.visitWaterfallChart=function(e){var i=this,a=this.behavior;a||(a=this.behavior=new t.WaterfallChartWebBehavior),this.selectableDataPoints=e.datapoints,this.initAndSyncSelectionState();var r=e.bars,n=e.clearCatcher;r.on("click",function(e,t){i.select(e),a.select(i.hasSelection(),r),i.sendSelectionToHost()}),n.on("click",function(){i.clearSelection(),i.sendSelectionToHost()}),this.sendSelectionToVisual=function(){a.select(i.hasSelection(),r)}},i.prototype.visitMap=function(e){var i=this,a=this.behavior;a||(a=this.behavior=new t.MapBehavior),this.selectableDataPoints=e.dataPoints,this.initAndSyncSelectionState();var r=e.bubbles,n=e.slices,o=e.shapes,s=e.clearCatcher,l=function(e,t){r&&r.style("pointer-events","all"),o&&o.style("pointer-events","all"),i.select(e),a.select(i.hasSelection(),r,n,o),i.sendSelectionToHost()};this.mapPointerEventsDisabled||(r&&r.style("pointer-events","all"),n&&n.style("pointer-events","all"),o&&o.style("pointer-events","all")),r&&(r.on("click",l),r.on("mousewheel",function(){i.mapPointerEventsDisabled||r.style("pointer-events","none"),i.mapPointerEventsDisabled=!0,i.mapPointerTimeoutSet||(i.mapPointerTimeoutSet=!0,setTimeout(function(){r&&r.style("pointer-events","all"),i.mapPointerEventsDisabled=!1,i.mapPointerTimeoutSet=!1},200))})),n&&(n.on("click",function(e,t){n.style("pointer-events","all"),i.mapPointerEventsDisabled=!1,i.select(e.data),a.select(i.hasSelection(),r,n,o),i.sendSelectionToHost()}),n.on("mousewheel",function(){i.mapPointerEventsDisabled||n.style("pointer-events","none"),i.mapPointerEventsDisabled=!0,i.mapPointerTimeoutSet||(i.mapPointerTimeoutSet=!0,setTimeout(function(){n&&n.style("pointer-events","all"),i.mapPointerEventsDisabled=!1,i.mapPointerTimeoutSet=!1},200))})),o&&(o.on("click",l),o.on("mousewheel",function(){i.mapPointerEventsDisabled||o.style("pointer-events","none"),i.mapPointerEventsDisabled=!0,i.mapPointerTimeoutSet||(i.mapPointerTimeoutSet=!0,setTimeout(function(){o&&o.style("pointer-events","all"),i.mapPointerEventsDisabled=!1,
i.mapPointerTimeoutSet=!1},200))})),s.on("click",function(){i.clearSelection(),i.sendSelectionToHost()}),this.sendSelectionToVisual=function(){a.select(i.hasSelection(),r,n,o)}},i.prototype.visitLegend=function(e){var i=this,a=new t.LegendWebBehavior;this.selectableLegendDataPoints=e.datapoints,this.initAndSyncSelectionState();var r=e.legendItems,n=e.legendIcons,o=e.clearCatcher;r.on("click",function(e){i.select(e),a.select(i.legendHasSelection(),n),i.sendSelectionToVisual(),i.sendSelectionToSecondVisual(),i.sendSelectionToHost()}),o.on("click",function(){s(!0),i.sendSelectionToVisual(),i.sendSelectionToSecondVisual()}),this.sendSelectionToLegend=function(){a.select(i.legendHasSelection(),n)},this.sendSelectionToLegend();var s=function(e){i.clearSelection(),a.select(i.legendHasSelection(),n),e&&i.sendSelectionToHost()}},i}();t.WebInteractivityService=o;var s=function(){function e(){}return e.prototype.apply=function(e,t){e.accept(this,t)},e.prototype.makeDataPointsSelectable=function(){for(var e=this,t=[],i=0;i<arguments.length;i++)t[i-0]=arguments[i];for(var a=0,r=t.length;r>a;a++){var n=t[a];n.on("click",function(t,i){e.behavior.select(!0,n,t,i)})}return this},e.prototype.makeRootSelectable=function(e){var t=this;return e.on("click",function(e,i){t.behavior.selectRoot()}),this},e.prototype.makeDragable=function(){for(var e=this,t=[],i=0;i<arguments.length;i++)t[i-0]=arguments[i];for(var a=0,r=t.length;r>a;a++){var n=t[a],o=d3.behavior.drag().on("drag",function(t){e.behavior.drag(0)}).on("dragend",function(t){e.behavior.drag(1)});n.call(o)}return this},e.prototype.clearSelection=function(){},e.prototype.applySelectionStateToData=function(e){return!1},e.prototype.visitColumnChart=function(e){},e.prototype.visitLineChart=function(e){},e.prototype.visitDataDotChart=function(e){},e.prototype.visitDonutChart=function(e){},e.prototype.visitFunnel=function(e){},e.prototype.visitScatterChart=function(e){var i=this.behavior;e.data.dataPoints.length>0&&(i||(i=this.behavior=new t.ScatterChartMobileBehavior),i.setOptions(e),this.makeDataPointsSelectable(e.dataPointsSelection),this.makeRootSelectable(e.root),this.makeDragable(e.root),i.selectRoot())},e.prototype.visitTreemap=function(e){},e.prototype.visitSlicer=function(e){},e.prototype.visitWaterfallChart=function(e){},e.prototype.visitMap=function(e){},e.prototype.visitLegend=function(e){},e.prototype.hasSelection=function(){return!1},e}();t.MobileInteractivityService=s}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var i;!function(t){var i;!function(t){function i(e,t){return new a(e,t)}t.createGeocodingCache=i;var a=function(){function t(e,t){this.geocodeCache={},this.maxCacheSize=e,this.maxCacheSizeOverflow=t}return t.prototype.getCoordinates=function(t){var i=this.geocodeCache[t.key];return i?(i.query.incrementCacheHit(),i.coordinate):(i=e.localStorageService.getData(t.key),i?(this.registerInMemory(t,i.coordinate),i.coordinate):void 0)},t.prototype.registerCoordinates=function(e,t){this.registerInMemory(e,t),this.registerInStorage(e,t)},t.prototype.registerInMemory=function(e,t){var i=this.geocodeCache,a=Object.keys(i),r=a.length,n=this.maxCacheSize;if(a.length>n+this.maxCacheSizeOverflow)for(var o=a.sort(function(e,t){var a=i[e].query.getCacheHits(),r=i[t].query.getCacheHits();return r>a?-1:a>r?1:0}),s=0;r-n>s;s++)i[o[s]]=void 0;i[e.key]={query:e,coordinate:t}},t.prototype.registerInStorage=function(t,i){e.localStorageService.setData(t.key,{query:t,coordinate:i})},t}()}(i=t.Services||(t.Services={}))}(i=t.BI||(t.BI={}))}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var i;!function(i){function a(t,i,a){var r=e.Prototype.inherit(i);r.create=a,t[i.name]=r}function r(){return new l}function n(e){return new u(e)}function o(e){return new c(e)}function s(e){return new h(e)}var l=function(){function t(){this._plugins=e.visuals.plugins}return t.prototype.getVisuals=function(){var e=this._plugins,t=Object.keys(e);return t.map(function(t){return e[t]})},t.prototype.getPlugin=function(e){if(e){var t=this._plugins[e];if(t)return t}},t.prototype.capabilities=function(e){var t=this.getPlugin(e);return t?t.capabilities:void 0},t}();i.VisualPluginService=l,i.createPlugin=a;var u=function(i){function r(r){i.call(this),this.featureSwitches=r,this.visualPlugins={},this.featureSwitches.devToolsEnabled&&this.addCustomVisualizations([]),a(this.visualPlugins,e.visuals.plugins.barChart,function(){return new t.CartesianChart({chartType:5,isScrollable:!0,animator:new t.WebColumnChartAnimator})}),a(this.visualPlugins,e.visuals.plugins.card,function(){return new t.Card({isScrollable:!0,animator:new t.Animator})}),a(this.visualPlugins,e.visuals.plugins.clusteredBarChart,function(){return new t.CartesianChart({chartType:4,isScrollable:!0,animator:new t.WebColumnChartAnimator})}),a(this.visualPlugins,e.visuals.plugins.clusteredColumnChart,function(){return new t.CartesianChart({chartType:2,isScrollable:!0,animator:new t.WebColumnChartAnimator})}),a(this.visualPlugins,e.visuals.plugins.columnChart,function(){return new t.CartesianChart({chartType:3,isScrollable:!0,animator:new t.WebColumnChartAnimator})}),a(this.visualPlugins,e.visuals.plugins.dataDotClusteredColumnComboChart,function(){return new t.CartesianChart({chartType:14,isScrollable:!0,animator:new t.WebColumnChartAnimator})}),a(this.visualPlugins,e.visuals.plugins.dataDotStackedColumnComboChart,function(){return new t.CartesianChart({chartType:15,isScrollable:!0,animator:new t.WebColumnChartAnimator})}),a(this.visualPlugins,e.visuals.plugins.donutChart,function(){return new t.DonutChart({animator:new t.WebDonutChartAnimator,isScrollable:!0})}),a(this.visualPlugins,e.visuals.plugins.funnel,function(){return new t.FunnelChart({animator:new t.WebFunnelAnimator})}),a(this.visualPlugins,e.visuals.plugins.gauge,function(){return new t.Gauge({animator:new t.Animator})}),a(this.visualPlugins,e.visuals.plugins.hundredPercentStackedBarChart,function(){return new t.CartesianChart({chartType:6,isScrollable:!0,animator:new t.WebColumnChartAnimator})}),a(this.visualPlugins,e.visuals.plugins.hundredPercentStackedColumnChart,function(){return new t.CartesianChart({chartType:7,isScrollable:!0,animator:new t.WebColumnChartAnimator})}),a(this.visualPlugins,e.visuals.plugins.lineChart,function(){return new t.CartesianChart({chartType:0,isScrollable:!0,animator:new t.Animator})}),a(this.visualPlugins,e.visuals.plugins.areaChart,function(){return new t.CartesianChart({chartType:1,isScrollable:!0,animator:new t.Animator})}),a(this.visualPlugins,e.visuals.plugins.lineClusteredColumnComboChart,function(){return new t.CartesianChart({chartType:12,isScrollable:!0,animator:new t.WebColumnChartAnimator})}),a(this.visualPlugins,e.visuals.plugins.lineStackedColumnComboChart,function(){return new t.CartesianChart({chartType:13,isScrollable:!0,animator:new t.WebColumnChartAnimator})}),a(this.visualPlugins,e.visuals.plugins.pieChart,function(){return new t.DonutChart({sliceWidthRatio:0,animator:new t.WebDonutChartAnimator,isScrollable:!0})}),a(this.visualPlugins,e.visuals.plugins.scatterChart,function(){return new t.CartesianChart({chartType:8,isScrollable:!0,animator:new t.Animator})}),a(this.visualPlugins,e.visuals.plugins.treemap,function(){return new t.Treemap({animator:new t.WebTreemapAnimator,isScrollable:!0})}),a(this.visualPlugins,e.visuals.plugins.waterfallChart,function(){return new t.CartesianChart({chartType:11,isScrollable:!0})})}return __extends(r,i),r.prototype.getVisuals=function(){var t=[e.visuals.plugins.barChart,e.visuals.plugins.columnChart,e.visuals.plugins.clusteredBarChart,e.visuals.plugins.clusteredColumnChart,e.visuals.plugins.hundredPercentStackedBarChart,e.visuals.plugins.hundredPercentStackedColumnChart,e.visuals.plugins.lineChart,e.visuals.plugins.areaChart,e.visuals.plugins.lineStackedColumnComboChart,e.visuals.plugins.lineClusteredColumnComboChart,e.visuals.plugins.waterfallChart,e.visuals.plugins.scatterChart,e.visuals.plugins.pieChart,e.visuals.plugins.treemap,e.visuals.plugins.map,e.visuals.plugins.table,e.visuals.plugins.matrix,e.visuals.plugins.filledMap,e.visuals.plugins.funnel,e.visuals.plugins.gauge,e.visuals.plugins.multiRowCard,e.visuals.plugins.card,e.visuals.plugins.slicer,e.visuals.plugins.donutChart];return this.featureSwitches.devToolsEnabled&&this.addCustomVisualizations(t),this.featureSwitches.dataDotChartEnabled&&(t.push(e.visuals.plugins.dataDotClusteredColumnComboChart),t.push(e.visuals.plugins.dataDotStackedColumnComboChart)),t},r.prototype.addCustomVisualizations=function(t){var i=e.localStorageService.getData("customVisualizations");if(i)for(var a=i.length,r=0;a>r;r++){var n=i[r].pluginName,o=this.getPlugin(n);if(!o){var s=i[r].javaScriptCode,l=$("<script/>",{html:s+"//# sourceURL="+n+".js\n//# sourceMappingURL="+n+".js.map"});l.attr("pluginName",n),$("body").append(l);var u=$("<style/>",{html:i[r].cssCode});u.attr("pluginName",n),$("head").append(u),o=this.getPlugin(n)}t.push(o)}},r.prototype.getPlugin=function(e){return this.visualPlugins[e]?this.visualPlugins[e]:i.prototype.getPlugin.call(this,e)},r}(l);i.MinervaVisualPluginService=u;var c=function(e){function t(t){e.call(this),this.featureSwitches=t,this.visualPlugins={}}return __extends(t,e),t.prototype.getPlugin=function(t){return this.visualPlugins[t]?this.visualPlugins[t]:e.prototype.getPlugin.call(this,t)},t}(l);i.DashboardPluginService=c;var h=function(i){function r(n){var o=this;i.call(this),this.smallViewPortProperties=n||{CartesianSmallViewPortProperties:{hideAxesOnSmallViewPort:!0,hideLegendOnSmallViewPort:!0,MinHeightLegendVisible:r.MinHeightLegendVisible,MinHeightAxesVisible:r.MinHeightAxesVisible},GaugeSmallViewPortProperties:{hideGaugeSideNumbersOnSmallViewPort:!0,smallGaugeMarginsOnSmallViewPort:!0,MinHeightGaugeSideNumbersVisible:r.MinHeightGaugeSideNumbersVisible,GaugeMarginsOnSmallViewPort:r.GaugeMarginsOnSmallViewPort},FunnelSmallViewPortProperties:{hideFunnelCategoryLabelsOnSmallViewPort:!0,minHeightFunnelCategoryLabelsVisible:r.MinHeightFunnelCategoryLabelsVisible}},t.TooltipManager.ShowTooltips=!1,this.visualPlugins={},a(this.visualPlugins,e.visuals.plugins.lineChart,function(){return new t.CartesianChart({chartType:0,cartesianSmallViewPortProperties:o.smallViewPortProperties.CartesianSmallViewPortProperties})}),a(this.visualPlugins,e.visuals.plugins.lineClusteredColumnComboChart,function(){return new t.CartesianChart({chartType:12,cartesianSmallViewPortProperties:o.smallViewPortProperties.CartesianSmallViewPortProperties})}),a(this.visualPlugins,e.visuals.plugins.lineStackedColumnComboChart,function(){return new t.CartesianChart({chartType:13,cartesianSmallViewPortProperties:o.smallViewPortProperties.CartesianSmallViewPortProperties})}),a(this.visualPlugins,e.visuals.plugins.scatterChart,function(){return new t.CartesianChart({chartType:8,cartesianSmallViewPortProperties:o.smallViewPortProperties.CartesianSmallViewPortProperties})}),a(this.visualPlugins,e.visuals.plugins.gauge,function(){return new t.Gauge({chartType:t.Gauge,gaugeSmallViewPortProperties:o.smallViewPortProperties.GaugeSmallViewPortProperties})}),a(this.visualPlugins,e.visuals.plugins.funnel,function(){return new t.FunnelChart({animator:null,funnelSmallViewPortProperties:o.smallViewPortProperties.FunnelSmallViewPortProperties})})}return __extends(r,i),r.prototype.getPlugin=function(e){return this.visualPlugins[e]?this.visualPlugins[e]:i.prototype.getPlugin.call(this,e)},r.MinHeightLegendVisible=80,r.MinHeightAxesVisible=80,r.MinHeightGaugeSideNumbersVisible=80,r.GaugeMarginsOnSmallViewPort=10,r.MinHeightFunnelCategoryLabelsVisible=80,r}(l);i.MobileVisualPluginService=h,i.create=r,i.createMinerva=n,i.createDashboard=o,i.createMobile=s}(i=t.visualPluginFactory||(t.visualPluginFactory={}))}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t;!function(e){function t(e,t){if(e)for(var i=0;i<e.length;i++){var a=e[i];a(t)}}var i="unselectable";e.fire=t;var a=function(){function t(e,t){this._owner=e,this._direction=t,this._timerHandle=void 0,this.createView();var a=this;this._element.addEventListener("mousedown",function(e){a.onMouseDown(e)}),$(this._element).addClass(i),$(this._svg).addClass(i),$(this._polygon).addClass(i)}return Object.defineProperty(t.prototype,"element",{get:function(){return this._element},enumerable:!0,configurable:!0}),t.prototype.createView=function(){var e="http://www.w3.org/2000/svg";this._polygon=document.createElementNS(e,"polygon"),this._polygon.setAttributeNS(null,"points","3,3 6,3 13,8 6,13 3,13 10,8"),this._polygon.setAttributeNS(null,"fill",t.ARROW_COLOR),this._svg=document.createElementNS(e,"svg");var i=this._svg.style;i.position="absolute",i.left="0px",i.top="0px",this._svg.appendChild(this._polygon),this._element=document.createElement("div"),this._element.className=r.arrowClassName,this._element.appendChild(this._svg),this._owner.element.appendChild(this._element)},t.prototype.onMouseDown=function(e){var t=this;if(clearTimeout(this._timerHandle),!this._mouseUpWrapper){e.cancelBubble=!0;var t=this;this._mouseUpWrapper=function(e){t.onMouseUp(e)},r.addDocumentMouseUpEvent(this._mouseUpWrapper)}this._owner._scrollSmallIncrement(this._direction),this._owner.refresh(),this._timerHandle=setTimeout(function(){t.onMouseDown(e)},100),e.preventDefault&&e.preventDefault()},t.prototype.onMouseUp=function(e){clearTimeout(this._timerHandle),r.removeDocumentMouseUpEvent(this._mouseUpWrapper),this._mouseUpWrapper=void 0},t.prototype.arrange=function(t,i,a){var r=Math.min(t,i),n=r/16,o=(t-r)/2,s=(i-r)/2;this._polygon.setAttributeNS(null,"transform","translate("+o+", "+s+") scale("+n+") rotate("+a+",8,8)"),this._svg.setAttributeNS(null,"width",t+"px"),this._svg.setAttributeNS(null,"height",i+"px"),e.HTMLElementUtils.setElementWidth(this._element,t),e.HTMLElementUtils.setElementHeight(this._element,i)},t.MIN_WIDTH=26,t.ARROW_COLOR="#404040",t}();e.ScrollbarButton=a;var r=function(){function r(e){this.MIN_BAR_SIZE=10,this.min=0,this.max=10,this.viewMin=0,this.viewSize=2,this.smallIncrement=1,this._onscroll=[],this._screenToOffsetScale=1,this.createView(e);var t=this;this._element.addEventListener("mousedown",function(e){t.onBackgroundMouseDown(e)}),this._middleBar.addEventListener("mousedown",function(e){t.onMiddleBarMouseDown(e)}),this._timerHandle=void 0,this._visible=!0,this.element.winControl=this,$(this._touchPanel).addClass(i)}return r.prototype.scrollBy=function(e){this.scrollTo(this.viewMin+e)},r.prototype.scrollUp=function(){this.scrollBy(-this.smallIncrement)},r.prototype.scrollDown=function(){this.scrollBy(this.smallIncrement)},r.prototype.scrollPageUp=function(){this.scrollBy(-this.viewSize)},r.prototype.scrollPageDown=function(){this.scrollBy(this.viewSize)},Object.defineProperty(r.prototype,"width",{get:function(){return this._width},set:function(e){this._width=e,this._element.style.width=e,this.invalidateArrange()},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"height",{get:function(){return this._height},set:function(e){this._height=e,this._element.style.height=e,this.invalidateArrange()},enumerable:!0,configurable:!0}),r.prototype.refresh=function(){},Object.defineProperty(r.prototype,"element",{get:function(){return this._element},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"maxButton",{get:function(){return this._maxButton},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"middleBar",{get:function(){return this._middleBar},enumerable:!0,configurable:!0}),r.prototype._scrollSmallIncrement=function(e){this.scrollBy(this.smallIncrement*e)},Object.defineProperty(r.prototype,"visible",{get:function(){return this._visible},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"isInMouseCapture",{get:function(){return void 0!==this._timerHandle},enumerable:!0,configurable:!0}),r.prototype.show=function(e){this._visible=e,this.element.style.visibility=e?"visible":"hidden",this.invalidateArrange()},r.prototype._getMouseOffset=function(e){return void 0!==e.offsetX?{x:e.offsetX,y:e.offsetY}:void 0!==e.layerX?{x:e.layerX,y:e.layerY}:{x:e.screenX,y:e.screenY}},r.prototype._getOffsetXDelta=function(e){return(e.screenX-this._screenPrevMousePos.x)/this._screenToOffsetScale},r.prototype._getOffsetYDelta=function(e){return(e.screenY-this._screenPrevMousePos.y)/this._screenToOffsetScale},r.prototype._getOffsetXTouchDelta=function(e){return this._getMouseOffset(e).x-this._offsetTouchPrevPos.x},r.prototype._getOffsetYTouchDelta=function(e){return this._getMouseOffset(e).y-this._offsetTouchPrevPos.y},r.prototype.initTouch=function(e,t){var i=this;this._touchPanel=e,this._allowMouseDrag=void 0===t?!0:t,"ontouchmove"in e?(e.addEventListener("touchstart",function(e){return i.onTouchStart(e)}),e.addEventListener("touchmove",function(e){return i.onTouchMove(e)}),e.addEventListener("touchend",function(e){return i.onTouchEnd(e)})):(e.addEventListener("mousedown",function(e){return i.onTouchMouseDown(e)}),e.addEventListener("mousemove",function(e){return i.onTouchMouseMove(e)}),e.addEventListener("mouseup",function(e){return i.onTouchMouseUp(e)}))},r.prototype.onTouchStart=function(e){1===e.touches.length&&this.onTouchMouseDown(e.touches[0])},r.prototype.onTouchMove=function(e){1===e.touches.length&&(e.preventDefault&&e.preventDefault(),this.onTouchMouseMove(e.touches[0]))},r.prototype.onTouchEnd=function(e){this.onTouchMouseUp(1===e.touches.length?e.touches[0]:e,!0)},r.prototype.onTouchMouseDown=function(e){(this._allowMouseDrag||e.pointerType!==MSPointerEvent.MSPOINTER_TYPE_MOUSE)&&("setCapture"in this._touchPanel&&this._touchPanel.setCapture(!0),this._offsetTouchPrevPos=this._offsetTouchStartPos=null,this._touchStarted=!0)},r.prototype._getOffsetTouchDelta=function(e){return null},r.prototype.onTouchMouseMove=function(e){if(this._touchStarted){this._offsetTouchStartPos||(this._offsetTouchPrevPos=this._offsetTouchStartPos=this._getMouseOffset(e));var t=this._getOffsetTouchDelta(e);0!==t&&(this.scrollBy(-t/this._getRunningSize(!1)*this.viewSize),this._offsetTouchPrevPos=this._getMouseOffset(e)),e.preventDefault&&e.preventDefault(),e.cancelBubble=!0}},r.prototype.onTouchMouseUp=function(e,t){if(this._touchStarted&&this._offsetTouchStartPos){var i=this._getMouseOffset(e);!t&&(Math.abs(this._offsetTouchStartPos.x-i.x)>3||Math.abs(this._offsetTouchStartPos.y-i.y)>3)&&(e.preventDefault&&e.preventDefault(),e.cancelBubble=!0)}"releaseCapture"in this._touchPanel&&this._touchPanel.releaseCapture(),this._touchStarted=!1},r.prototype.registerElementForMouseWheelScrolling=function(e){var t=this;e.addEventListener("mousewheel",function(e){t.onMouseWheel(e)}),e.addEventListener("DOMMouseScroll",function(e){t.onFireFoxMouseWheel(e)})},r.prototype.createView=function(e){this._element=document.createElement("div"),this._element.className=r.className,this._element.setAttribute("drag-resize-disabled","true"),e.appendChild(this._element),this._minButton=new a(this,-1),this._maxButton=new a(this,1),this._middleBar=document.createElement("div"),this._middleBar.className=r.barClassName,this._element.appendChild(this._middleBar)},r.prototype.scrollTo=function(e){var i=Math.min(this.max-this.viewSize,Math.max(this.min,e));i!==this.viewMin&&(this.viewMin=i,t(this._onscroll,null))},r.prototype._scrollByPage=function(e){},r.prototype._getRunningSize=function(e){return null},r.prototype._getOffsetDelta=function(e){return null},r.prototype.scroll=function(e){var t=this._getOffsetDelta(e)/this._getRunningSize(!0)*(this.max-this.min);if(0>t){if(this._getScreenMousePos(e)>=this._screenMaxMousePos)return}else if(t>0&&this._getScreenMousePos(e)<=this._screenMinMousePos)return;this.scrollBy(t)},Object.defineProperty(r.prototype,"actualWidth",{get:function(){return void 0===this._actualWidth&&this.arrange(),this._actualWidth},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"actualHeight",{get:function(){return void 0===!this._actualHeight&&this.arrange(),this._actualHeight},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"actualButtonWidth",{get:function(){return void 0===!this._actualButtonWidth&&this.arrange(),this._actualButtonWidth},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"actualButtonHeight",{get:function(){return void 0===!this._actualButtonHeight&&this.arrange(),this._actualButtonHeight},enumerable:!0,configurable:!0}),r.prototype.arrange=function(){this._actualWidth||(this._actualWidth=this._element.offsetWidth,this._actualHeight=this._element.offsetHeight,this._actualButtonWidth=this._calculateButtonWidth(),this._actualButtonHeight=this._calculateButtonHeight(),this._minButton.arrange(this._actualButtonWidth,this._actualButtonHeight,this._getMinButtonAngle()),this._maxButton.arrange(this._actualButtonWidth,this._actualButtonHeight,this._getMaxButtonAngle()),this._setMaxButtonPosition())},r.prototype._calculateButtonWidth=function(){return null},r.prototype._calculateButtonHeight=function(){return null},r.prototype._getMinButtonAngle=function(){return null},r.prototype._getMaxButtonAngle=function(){return null},r.prototype._setMaxButtonPosition=function(){},r.prototype.invalidateArrange=function(){this._actualWidth=void 0,this._actualHeight=void 0,this._actualButtonWidth=void 0,this._actualButtonHeight=void 0},r.prototype.onHoldBackgroundMouseDown=function(e){var t=this,i=this._timerHandle?r.ScrollbarBackgroundMousedownHoldDelay:r.ScrollbarBackgroundFirstTimeMousedownHoldDelay;this._timerHandle=setTimeout(function(){t.onBackgroundMouseDown(e)},i)},r.prototype.onBackgroundMouseDown=function(e){var t=this;clearTimeout(this._timerHandle),this._backgroundMouseUpWrapper||(e.cancelBubble=!0,this._backgroundMouseUpWrapper=function(e){t.onBackgroundMouseUp(e)},r.addDocumentMouseUpEvent(this._backgroundMouseUpWrapper)),this._scrollByPage(e),this.refresh(),this.onHoldBackgroundMouseDown(e),e.preventDefault&&e.preventDefault()},r.prototype.onBackgroundMouseUp=function(e){clearTimeout(this._timerHandle),this._timerHandle=void 0,r.removeDocumentMouseUpEvent(this._backgroundMouseUpWrapper),this._backgroundMouseUpWrapper=void 0},r.prototype.getPinchZoomY=function(){return document.documentElement.clientHeight/window.innerHeight},r.prototype.onMiddleBarMouseDown=function(t){t.cancelBubble=!0,this._screenPrevMousePos={x:t.screenX,y:t.screenY},this._screenMinMousePos=this._getScreenMousePos(t)-(this._getScreenContextualLeft(this._middleBar)-this._getScreenContextualRight(this._minButton.element)),this._screenMaxMousePos=this._getScreenMousePos(t)+(this._getScreenContextualLeft(this._maxButton.element)-this._getScreenContextualRight(this._middleBar)),this._screenToOffsetScale=e.HTMLElementUtils.getAccumulatedScale(this.element)*this.getPinchZoomY();var i=this;this._middleBarMouseMoveWrapper=function(e){i.onMiddleBarMouseMove(e)},r.addDocumentMouseMoveEvent(this._middleBarMouseMoveWrapper),this._middleBarMouseUpWrapper=function(e){i.onMiddleBarMouseUp(e)},r.addDocumentMouseUpEvent(this._middleBarMouseUpWrapper),t.preventDefault&&t.preventDefault()},r.prototype.onMiddleBarMouseMove=function(e){this._screenPrevMousePos&&(this.scroll(e),this.refresh(),this._screenPrevMousePos={x:e.screenX,y:e.screenY})},r.prototype.onMiddleBarMouseUp=function(e){this._screenPrevMousePos=void 0,r.removeDocumentMouseMoveEvent(this._middleBarMouseMoveWrapper),this._middleBarMouseMoveWrapper=void 0,r.removeDocumentMouseUpEvent(this._middleBarMouseUpWrapper),this._middleBarMouseUpWrapper=void 0,e.preventDefault&&e.preventDefault()},r.prototype._getScreenContextualLeft=function(e){return null},r.prototype._getScreenContextualRight=function(e){return null},r.prototype.onMouseWheel=function(e){e.wheelDelta&&this.mouseWheel(e.wheelDelta)},r.prototype.onFireFoxMouseWheel=function(e){e.detail&&this.mouseWheel(-e.detail)},r.prototype.mouseWheel=function(e){this.visible&&(0>e?e=Math.min(-r.MouseWheelRange,e):e>0&&(e=Math.max(r.MouseWheelRange,e)),this.scrollBy(-e/r.MouseWheelRange*this.smallIncrement))},r.prototype._getScreenMousePos=function(e){return null},r.addDocumentMouseUpEvent=function(e){document.addEventListener("mouseup",e)},r.removeDocumentMouseUpEvent=function(e){document.removeEventListener("mouseup",e)},r.addDocumentMouseMoveEvent=function(e){document.addEventListener("mousemove",e)},r.removeDocumentMouseMoveEvent=function(e){document.removeEventListener("mousemove",e)},r.DefaultScrollbarWidth="15px",r.ScrollbarBackgroundFirstTimeMousedownHoldDelay=500,r.ScrollbarBackgroundMousedownHoldDelay=50,r.MouseWheelRange=120,r.className="scroll-bar-div",r.barClassName="scroll-bar-part-bar",r.arrowClassName="scroll-bar-part-arrow",r}();e.Scrollbar=r;var n=function(t){function i(e){t.call(this,e),this.height=r.DefaultScrollbarWidth}return __extends(i,t),i.prototype._calculateButtonWidth=function(){return Math.min(this.actualWidth/2,Math.max(this.actualHeight,a.MIN_WIDTH))},i.prototype._calculateButtonHeight=function(){return this.actualHeight},i.prototype._getMinButtonAngle=function(){return-180},i.prototype._getMaxButtonAngle=function(){return 0},i.prototype._setMaxButtonPosition=function(){e.HTMLElementUtils.setElementLeft(this.maxButton.element,this.actualWidth-this.actualButtonWidth)},i.prototype.refresh=function(){this.arrange();var t=this.actualWidth-2*this.actualButtonWidth-2,i=this.viewSize/(this.max-this.min)*t;i<this.MIN_BAR_SIZE&&(t-=this.MIN_BAR_SIZE-i,i=this.MIN_BAR_SIZE),0>t&&(t=0,i=0),i=Math.min(i,t);var a=this.viewMin/(this.max-this.min)*t;e.HTMLElementUtils.setElementWidth(this.middleBar,i),e.HTMLElementUtils.setElementHeight(this.middleBar,this.actualHeight),e.HTMLElementUtils.setElementLeft(this.middleBar,this.actualButtonWidth+1+a)},i.prototype.show=function(i){i!==this.visible&&(t.prototype.show.call(this,i),i?this.element.style.height=this.height:e.HTMLElementUtils.setElementHeight(this.element,0))},i.prototype._scrollByPage=function(e){var t=this.middleBar.offsetLeft,i=t+this.middleBar.offsetWidth,a=void 0===e.offsetX?e.layerX:e.offsetX;a>i?this.scrollPageDown():t>a&&this.scrollPageUp()},i.prototype._getRunningSize=function(e){var t=this.actualWidth;if(e){var i=this.actualButtonWidth+1;t-=2*i;var a=t*(this.viewSize/(this.max-this.min));a<this.MIN_BAR_SIZE&&(t-=this.MIN_BAR_SIZE-a)}return t},i.prototype._getOffsetDelta=function(e){return this._getOffsetXDelta(e)},i.prototype._getOffsetTouchDelta=function(e){return this._getOffsetXTouchDelta(e)},i.prototype._getScreenContextualLeft=function(e){return e.getBoundingClientRect().left},i.prototype._getScreenContextualRight=function(e){return e.getBoundingClientRect().right},i.prototype._getScreenMousePos=function(e){return e.screenX},i}(r);e.HorizontalScrollbar=n;var o=function(t){function i(e){t.call(this,e),this.width=r.DefaultScrollbarWidth}return __extends(i,t),i.prototype._calculateButtonWidth=function(){return this.actualWidth},i.prototype._calculateButtonHeight=function(){return Math.min(this.actualHeight/2,Math.max(this.actualWidth,a.MIN_WIDTH))},i.prototype._getMinButtonAngle=function(){return-90},i.prototype._getMaxButtonAngle=function(){return 90},i.prototype._setMaxButtonPosition=function(){e.HTMLElementUtils.setElementTop(this.maxButton.element,this.actualHeight-this.actualButtonHeight)},i.prototype.refresh=function(){this.arrange();var t=this.actualHeight-2*this.actualButtonHeight-2,i=this.viewSize/(this.max-this.min)*t;i<this.MIN_BAR_SIZE&&(t-=this.MIN_BAR_SIZE-i,i=this.MIN_BAR_SIZE),0>t&&(t=0,i=0);var a=this.viewMin/(this.max-this.min)*t;e.HTMLElementUtils.setElementWidth(this.middleBar,this.actualWidth),e.HTMLElementUtils.setElementHeight(this.middleBar,i),e.HTMLElementUtils.setElementTop(this.middleBar,this.actualButtonHeight+1+a)},i.prototype.show=function(i){i!==this.visible&&(t.prototype.show.call(this,i),i?this.element.style.width=this.width:e.HTMLElementUtils.setElementWidth(this.element,0))},i.prototype._scrollByPage=function(e){var t=this.middleBar.offsetTop,i=t+this.middleBar.offsetHeight,a=void 0===e.offsetY?e.layerY:e.offsetY;a>i?this.scrollPageDown():t>a&&this.scrollPageUp()},i.prototype._getRunningSize=function(e){var t=this.actualHeight;if(e){var i=this.actualButtonHeight+1;t-=2*i;var a=t*(this.viewSize/(this.max-this.min));a<this.MIN_BAR_SIZE&&(t-=this.MIN_BAR_SIZE-a)}return t},i.prototype._getOffsetDelta=function(e){return this._getOffsetYDelta(e)},i.prototype._getOffsetTouchDelta=function(e){return this._getOffsetYTouchDelta(e)},i.prototype._getScreenContextualLeft=function(e){return e.getBoundingClientRect().top},i.prototype._getScreenContextualRight=function(e){return e.getBoundingClientRect().bottom},i.prototype._getScreenMousePos=function(e){return e.screenY},i}(r);e.VerticalScrollbar=o}(t=e.controls||(e.controls={}))}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t;!function(e){var t;!function(t){var i="unselectable",a=function(){function e(e,t){this._element=e,this._handler=t,this._elementMouseDownWrapper=null,this._elementMouseMoveWrapper=null,this._elementMouseOutWrapper=null,this._documentMouseMoveWrapper=null,this._documentMouseUpWrapper=null,this._startMousePosition=null,this._originalCursor=null}return e.addDocumentMouseUpEvent=function(e){document.addEventListener("mouseup",e)},e.removeDocumentMouseUpEvent=function(e){document.removeEventListener("mouseup",e)},e.addDocumentMouseMoveEvent=function(e){document.addEventListener("mousemove",e)},e.removeDocumentMouseMoveEvent=function(e){document.removeEventListener("mousemove",e)},e.getMouseCoordinates=function(e){return{x:e.pageX,y:e.pageY}},e.getMouseCoordinateDelta=function(e,t){return{x:t.x-e.x,y:t.y-e.y}},e.prototype.initialize=function(){var e=this;this._elementMouseDownWrapper=function(t){return e.onElementMouseDown(t)},this._element.addEventListener("mousedown",this._elementMouseDownWrapper),this._elementMouseMoveWrapper=function(t){return e.onElementMouseMove(t)},this._element.addEventListener("mousemove",this._elementMouseMoveWrapper),this._elementMouseOutWrapper=function(t){return e.onElementMouseOut(t)},this._element.addEventListener("mouseout",this._elementMouseOutWrapper),this._elementMouseDoubleClickOutWrapper=function(t){return e.onElementMouseDoubleClick(t)},this._element.addEventListener("dblclick",this._elementMouseDoubleClickOutWrapper)},e.prototype.uninitialize=function(){this._element.removeEventListener("mousedown",this._elementMouseDownWrapper),this._elementMouseDownWrapper=null,this._element.removeEventListener("mousemove",this._elementMouseMoveWrapper),this._elementMouseMoveWrapper=null,this._element.removeEventListener("mouseout",this._elementMouseOutWrapper),this._elementMouseOutWrapper=null,this._element.removeEventListener("dblclick",this._elementMouseDoubleClickOutWrapper),this._elementMouseDoubleClickOutWrapper=null},Object.defineProperty(e.prototype,"cell",{get:function(){return null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"element",{get:function(){return this._element},enumerable:!0,configurable:!0}),e.prototype._hotSpot=function(e){return!1},e.prototype.onElementMouseDown=function(t){var i=this,a=e.getMouseCoordinates(t);this._hotSpot(a)&&("setCapture"in this._element&&this._element.setCapture(),t.cancelBubble=!0,this._startMousePosition=a,this._documentMouseMoveWrapper=function(e){return i.onDocumentMouseMove(e)},e.addDocumentMouseMoveEvent(this._documentMouseMoveWrapper),this._documentMouseUpWrapper=function(e){return i.onDocumentMouseUp(e)},e.addDocumentMouseUpEvent(this._documentMouseUpWrapper),document.documentElement&&(this._originalCursor=document.documentElement.style.cursor,document.documentElement.style.cursor=e.resizeCursor),this._handler.onStartResize(this.cell,this._startMousePosition.x,this._startMousePosition.y))},e.prototype.onElementMouseMove=function(t){this._startMousePosition||(this._hotSpot(e.getMouseCoordinates(t))?null===this._originalCursor&&(this._originalCursor=this._element.style.cursor,
this._element.style.cursor=e.resizeCursor):null!==this._originalCursor&&(this._element.style.cursor=this._originalCursor,this._originalCursor=null))},e.prototype.onElementMouseOut=function(e){this._startMousePosition||null!==this._originalCursor&&(this._element.style.cursor=this._originalCursor,this._originalCursor=null)},e.prototype.onElementMouseDoubleClick=function(t){this._hotSpot(e.getMouseCoordinates(t))&&this._handler.onReset(this.cell)},e.prototype.onDocumentMouseMove=function(t){if(this._startMousePosition){var i=e.getMouseCoordinateDelta(this._startMousePosition,e.getMouseCoordinates(t));this._handler.onResize(this.cell,i.x,i.y)}},e.prototype.onDocumentMouseUp=function(t){this._startMousePosition=null,"releaseCapture"in this._element&&this._element.releaseCapture(),e.removeDocumentMouseMoveEvent(this._documentMouseMoveWrapper),this._documentMouseMoveWrapper=null,e.removeDocumentMouseUpEvent(this._documentMouseUpWrapper),this._documentMouseUpWrapper=null,document.documentElement&&(document.documentElement.style.cursor=this._originalCursor),t.preventDefault&&t.preventDefault(),this._handler.onEndResize(this.cell)},e.resizeHandleSize=4,e.resizeCursor="e-resize",e}();t.TablixResizer=a;var r=function(e){function t(t,i,a){this._cell=t,e.call(this,i,a)}return __extends(t,e),Object.defineProperty(t.prototype,"cell",{get:function(){return this._cell},enumerable:!0,configurable:!0}),t.prototype._hotSpot=function(e){return e.x>=this.element.getBoundingClientRect().right-a.resizeHandleSize},t}(a);t.TablixDomResizer=r;var n=function(){function i(a,r){this._tableCell=null,this._contentElement=t.TablixUtils.createDiv(),this._contentElement.style.position="relative",a||this._contentElement.style.setProperty("float","left"),this._contentHost=t.TablixUtils.createDiv(),this._contentHost.style.position="relative",r===e.TablixLayoutKind.DashboardTile&&(this._contentHost.style.textOverflow="ellipsis",this._contentHost.style.paddingRight="2px"),this._contentElement.appendChild(this._contentHost),this._resizer=null,i.addNoMarginStyle()}return i.prototype.initialize=function(e){this._owner=e},Object.defineProperty(i.prototype,"owner",{get:function(){return this._owner},enumerable:!0,configurable:!0}),i.prototype.registerTableCell=function(e){this._tableCell=e,e.appendChild(this._contentElement),e.className=i._noMarginsStyleName,e.style.verticalAlign="top",e.style.lineHeight="normal"},Object.defineProperty(i.prototype,"tableCell",{get:function(){return this._tableCell},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"contentElement",{get:function(){return this._contentElement},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"contentHost",{get:function(){return this._contentHost},enumerable:!0,configurable:!0}),i.prototype.registerClickHandler=function(e){this._contentElement.onclick=e},i.prototype.unregisterClickHandler=function(){this._contentElement.onclick=null},i.prototype.onContentWidthChanged=function(t){e.HTMLElementUtils.setElementWidth(this._contentElement,t)},i.prototype.onContentHeightChanged=function(t){e.HTMLElementUtils.setElementHeight(this._contentElement,t)},i.prototype.onColumnSpanChanged=function(e){this._tableCell.colSpan=e},i.prototype.onRowSpanChanged=function(e){this._tableCell.rowSpan=e},i.prototype.onTextAlignChanged=function(e){this._tableCell.style.textAlign=e},i.prototype.onClear=function(){this._contentHost.className="",this._contentHostStyle="",this._tableCell.className=i._noMarginsStyleName,this._containerStyle=""},i.prototype.onHorizontalScroll=function(t,i){e.HTMLElementUtils.setElementLeft(this._contentHost,i),e.HTMLElementUtils.setElementWidth(this._contentHost,t)},i.prototype.onVerticalScroll=function(t,i){e.HTMLElementUtils.setElementTop(this._contentHost,i),e.HTMLElementUtils.setElementHeight(this._contentHost,t)},i.prototype.onInitializeScrolling=function(){e.HTMLElementUtils.setElementLeft(this._contentHost,0),e.HTMLElementUtils.setElementTop(this._contentHost,0),e.HTMLElementUtils.setElementWidth(this._contentHost,-1),e.HTMLElementUtils.setElementHeight(this._contentHost,-1)},i.prototype.setContentHostStyle=function(e){this._contentHostStyle!==e&&(this._contentHostStyle=e,this._contentHost.className=this._contentHostStyle)},i.prototype.setContainerStyle=function(e){this._containerStyle!==e&&(this._containerStyle=e,this._tableCell.className=this._containerStyle+" "+i._noMarginsStyleName)},i.prototype.clearContainerStyle=function(){this._containerStyle=void 0,this._tableCell.className!==i._noMarginsStyleName&&(this._tableCell.className=i._noMarginsStyleName)},i.prototype.enableHorizontalResize=function(e,t){e!==(null!==this._resizer)&&(e?(this._resizer=new r(this._owner,this._tableCell,t),this._resizer.initialize()):(this._resizer.uninitialize(),this._resizer=null))},i.addNoMarginStyle=function(){if(!i._noMarginsStyle){var e=document.createElement("style");e.appendChild(document.createTextNode("."+i._noMarginsStyleName+"{ padding: 0px; margin: 0px}")),document.head.appendChild(e),i._noMarginsStyle=e}},i.prototype.disableDragResize=function(){this._tableCell.setAttribute(i._dragResizeDisabledAttributeName,"true")},i._noMarginsStyleName="bi-tablix-cellNoMarginStyle",i._dragResizeDisabledAttributeName="drag-resize-disabled",i}();t.TablixCellPresenter=n;var o=function(){function e(e){this._tableRow=null,this._fitProportionally=e}return e.prototype.initialize=function(e){this._row=e},e.prototype.createCellPresenter=function(e){return new n(this._fitProportionally,e)},e.prototype.registerRow=function(e){this._tableRow=e},e.prototype.onAppendCell=function(e){var t=e._presenter;if(null===t.tableCell){var i=this._tableRow.insertCell(-1);t.registerTableCell(i)}else this._tableRow.appendChild(t.tableCell)},e.prototype.onInsertCellBefore=function(e,t){var i=e._presenter;if(null===i.tableCell){var a=this._tableRow.insertCell(Math.max(0,t._presenter.tableCell.cellIndex-1));i.registerTableCell(a)}else this._tableRow.insertBefore(e._presenter.tableCell,t._presenter.tableCell)},e.prototype.onRemoveCell=function(e){this._tableRow.removeChild(e._presenter.tableCell)},e.prototype.getHeight=function(){return this.getCellHeight(this._row.getTablixCell())},e.prototype.getCellHeight=function(e){return-1},e.prototype.getCellContentHeight=function(e){return-1},Object.defineProperty(e.prototype,"tableRow",{get:function(){return this._tableRow},enumerable:!0,configurable:!0}),e}();t.TablixRowPresenter=o;var s=function(e){function t(t,i){e.call(this,i),this._gridPresenter=t}return __extends(t,e),t.prototype.getCellHeight=function(e){return this._gridPresenter.sizeComputationManager.cellHeight},t.prototype.getCellContentHeight=function(e){return this._gridPresenter.sizeComputationManager.contentHeight},t}(o);t.DashboardRowPresenter=s;var l=function(t){function i(){t.apply(this,arguments)}return __extends(i,t),i.prototype.getCellHeight=function(t){return e.HTMLElementUtils.getElementHeight(t._presenter.tableCell)},i.prototype.getCellContentHeight=function(t){return e.HTMLElementUtils.getElementHeight(t._presenter.contentElement)},i}(o);t.CanvasRowPresenter=l;var u=function(){function e(){}return e.prototype.initialize=function(e){this._column=e},e.prototype.getWidth=function(){return this.getCellWidth(this._column.getTablixCell())},e.prototype.getCellWidth=function(e){return-1},e.prototype.getCellContentWidth=function(e){return-1},e}();t.TablixColumnPresenter=u;var c=function(e){function t(t){e.call(this),this._gridPresenter=t}return __extends(t,e),t.prototype.getCellWidth=function(e){return this._gridPresenter.sizeComputationManager.cellWidth},t.prototype.getCellContentWidth=function(e){return this._gridPresenter.sizeComputationManager.contentWidth},t}(u);t.DashboardColumnPresenter=c;var h=function(t){function i(){t.apply(this,arguments)}return __extends(i,t),i.prototype.getCellWidth=function(t){return e.HTMLElementUtils.getElementWidth(t._presenter.tableCell)},i.prototype.getCellContentWidth=function(t){return e.HTMLElementUtils.getElementWidth(t._presenter.contentElement)},i}(u);t.CanvasColumnPresenter=h;var d=function(){function a(){this._table=t.TablixUtils.createTable(),this._table.className=i,this._footerTable=t.TablixUtils.createTable(),this._footerTable.className=i}return a.prototype.initialize=function(e,t,i,a){this._owner=e,t.appendChild(this._table),i.appendChild(this._footerTable)},a.prototype.getWidth=function(){return-1},a.prototype.getHeight=function(){return-1},a.prototype.getScreenToCssRatioX=function(){return 1},a.prototype.getScreenToCssRatioY=function(){return 1},a.prototype.createRowPresenter=function(){return null},a.prototype.createColumnPresenter=function(){return null},a.prototype.onAppendRow=function(e){var t=e.presenter;if(null===t.tableRow){var i=this._table.insertRow(-1);t.registerRow(i)}else this._table.tBodies[0].appendChild(e.presenter.tableRow)},a.prototype.onInsertRowBefore=function(e,t){var i=e.presenter;if(null===i.tableRow){var a=this._table.insertRow(Math.max(0,t.presenter.tableRow.rowIndex-1));i.registerRow(a)}else this._table.tBodies[0].insertBefore(e.presenter.tableRow,t.presenter.tableRow)},a.prototype.onRemoveRow=function(e){this._table.tBodies[0].removeChild(e.presenter.tableRow)},a.prototype.onAddFooterRow=function(e){var t=e.presenter;if(null===t.tableRow){var i=this._footerTable.insertRow(-1);t.registerRow(i)}else this._footerTable.tBodies[0].appendChild(e.presenter.tableRow)},a.prototype.onClear=function(){e.HTMLElementUtils.clearChildren(this._table),e.HTMLElementUtils.clearChildren(this._footerTable)},a.prototype.onFillColumnsProportionallyChanged=function(e){e?(this._table.style.width="100%",this._footerTable.style.width="100%"):(this._table.style.width="auto",this._footerTable.style.width="auto")},a}();t.TablixGridPresenter=d;var p=function(e){function t(t){e.call(this),this._sizeComputationManager=t}return __extends(t,e),t.prototype.createRowPresenter=function(){return new s(this,this._owner.fillColumnsProportionally)},t.prototype.createColumnPresenter=function(){return new c(this)},Object.defineProperty(t.prototype,"sizeComputationManager",{get:function(){return this._sizeComputationManager},enumerable:!0,configurable:!0}),t.prototype.getWidth=function(){return this._sizeComputationManager.gridWidth},t.prototype.getHeight=function(){return this._sizeComputationManager.gridHeight},t}(d);t.DashboardTablixGridPresenter=p;var g=function(t){function i(){t.apply(this,arguments)}return __extends(i,t),i.prototype.createRowPresenter=function(){return new l(this._owner.fillColumnsProportionally)},i.prototype.createColumnPresenter=function(){return new h},i.prototype.getWidth=function(){return e.HTMLElementUtils.getElementWidth(this._table)},i.prototype.getHeight=function(){return e.HTMLElementUtils.getElementHeight(this._table)},i}(d);t.CanvasTablixGridPresenter=g}(t=e.internal||(e.internal={}))}(t=e.controls||(e.controls={}))}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var i;!function(t){var i;!function(t){var i=function(){function e(e){this._binder=e,this._adjustmentFactor=1}return e.prototype._getOwner=function(){return null},Object.defineProperty(e.prototype,"binder",{get:function(){return this._binder},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"adjustmentFactor",{get:function(){return this._adjustmentFactor},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"itemsToRealizeCount",{get:function(){return this._itemsToRealizeCount},set:function(e){this._itemsToRealizeCount=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"itemsEstimatedContextualWidth",{get:function(){return this._itemsEstimatedContextualWidth},set:function(e){this._itemsEstimatedContextualWidth=e},enumerable:!0,configurable:!0}),e.prototype.onStartRenderingIteration=function(){var e=this._getOwner();e.measureEnabled&&!e.done&&this._getEstimatedItemsToRealizeCount(),this._realizedLeavesCount=0},e.prototype.onEndRenderingIteration=function(e,t){t||this._getOwner().allItemsRealized||(this._adjustmentFactor*=this._getSizeAdjustment(e))},e.prototype.onEndRenderingSession=function(){this._adjustmentFactor=1},e.prototype.onCornerCellRealized=function(e,t){},e.prototype.onHeaderRealized=function(e,t,i){i&&this._realizedLeavesCount++},Object.defineProperty(e.prototype,"needsToRealize",{get:function(){return this._realizedLeavesCount<this._itemsToRealizeCount},enumerable:!0,configurable:!0}),e.prototype._getEstimatedItemsToRealizeCount=function(){},e.prototype._getSizeAdjustment=function(e){return 1},e}();t.TablixDimensionRealizationManager=i;var a=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),Object.defineProperty(t.prototype,"owner",{set:function(e){this._owner=e},enumerable:!0,configurable:!0}),t.prototype._getOwner=function(){return this._owner},t.prototype._getEstimatedItemsToRealizeCount=function(){this.estimateRowsToRealizeCount()},t.prototype.estimateRowsToRealizeCount=function(){return this._owner.dimension.model?void(this._owner.alignToEnd?this.itemsToRealizeCount=this._owner.dimension.getItemsCount()-this._owner.dimension.getIntegerScrollOffset()+1:this.itemsToRealizeCount=Math.ceil(this._owner.contextualWidthToFill/(this._owner.owner.getEstimatedRowHeight()*this.adjustmentFactor)+this._owner.dimension.getFractionScrollOffset())-this._owner.otherLayoutManager.dimension.getDepth()+1):void(this.itemsToRealizeCount=0)},t.prototype.getEstimatedRowHierarchyWidth=function(){if(!this._owner.dimension.model||0===this._owner.dimension.getItemsCount())return 0;var e=new n;this.updateRowHiearchyEstimatedWidth(this._owner.dimension.model,this._owner.dimension._hierarchyNavigator.getIndex(this._owner.dimension.getFirstVisibleItem(0)),e);for(var t=e.items,i=t.length,a=0,r=0;i>r;r++){var o=t[r];a+=0!==o.maxNonLeafWidth?o.maxNonLeafWidth:o.maxLeafWidth}return a},t.prototype.updateRowHiearchyEstimatedWidth=function(e,t,i){for(var a=this._owner.owner.owner.hierarchyNavigator,r=this.binder,n=a.getCount(e),s=t;n>s;s++){if(i.leafCount===this.itemsToRealizeCount)return;var l=a.getAt(e,s),u=r.getHeaderLabel(l),c=this._owner.getEstimatedHeaderWidth(u,t),h=a.isLeaf(l),d=a.getLevel(l),p=i.items[d];p||(p=new o,i.items[d]=p),h?(p.maxLeafWidth=Math.max(p.maxLeafWidth,c),i.leafCount=i.leafCount+1):(p.maxNonLeafWidth=Math.max(p.maxNonLeafWidth,c),this.updateRowHiearchyEstimatedWidth(a.getChildren(l),this._owner.dimension.getFirstVisibleChildIndex(l),i))}},t.prototype._getSizeAdjustment=function(e){return e/((this._owner.getRealizedItemsCount()-this._owner.dimension.getFractionScrollOffset())*this._owner.owner.getEstimatedRowHeight())},t}(i);t.RowRealizationManager=a;var r=function(i){function a(){i.apply(this,arguments)}return __extends(a,i),Object.defineProperty(a.prototype,"owner",{set:function(e){this._owner=e},enumerable:!0,configurable:!0}),a.prototype._getOwner=function(){return this._owner},a.prototype._getEstimatedItemsToRealizeCount=function(){this.estimateColumnsToRealizeCount(this.getEstimatedRowHierarchyWidth())},Object.defineProperty(a.prototype,"rowRealizationManager",{get:function(){return this._owner.otherLayoutManager.realizationManager},enumerable:!0,configurable:!0}),a.prototype.getEstimatedRowHierarchyWidth=function(){return this._owner.otherLayoutManager.done?this._owner.getOtherHierarchyContextualHeight():this.rowRealizationManager.getEstimatedRowHierarchyWidth()*this.adjustmentFactor},a.prototype.estimateColumnsToRealizeCount=function(i){var a=this._owner.contextualWidthToFill-i;if(!this._owner.dimension.model||e.Double.lessOrEqualWithPrecision(a,0,t.DimensionLayoutManager._pixelPrecision))return void(this.itemsToRealizeCount=0);var r=this.binder,n=this._owner.owner.owner.hierarchyNavigator,o=this._owner.dimension.getIntegerScrollOffset(),s=this._owner.dimension.getItemsCount();this.itemsEstimatedContextualWidth=0;var l=this._owner.otherLayoutManager.dimension.getIntegerScrollOffset(),u=Math.min(l+this.rowRealizationManager.itemsToRealizeCount,this._owner.otherLayoutManager.dimension.getItemsCount()-1),c=s-o;if(this._owner.alignToEnd)return void(this.itemsToRealizeCount=c);for(var h=o;s>h;h++){if(e.Double.greaterOrEqualWithPrecision(this.itemsEstimatedContextualWidth,a,t.DimensionLayoutManager._pixelPrecision))return void(this.itemsToRealizeCount=h-o);var d,p=0;d=h===o?this._owner.getVisibleSizeRatio():1;var g=n.getLeafAt(this._owner.dimension.model,h),f=r.getHeaderLabel(g);p=Math.max(p,this._owner.getEstimatedHeaderWidth(f,h));for(var m=l;u>m;m++){var y=n.getIntersection(n.getLeafAt(this._owner.otherLayoutManager.dimension.model,m),g);f=r.getCellContent(y),p=Math.max(p,this._owner.getEstimatedBodyCellWidth(f))}this.itemsEstimatedContextualWidth+=p*d*this.adjustmentFactor}this.itemsToRealizeCount=c},a.prototype._getSizeAdjustment=function(e){return e/(this.getEstimatedRowHierarchyWidth()+this.itemsEstimatedContextualWidth)},a}(i);t.ColumnRealizationManager=r;var n=function(){function e(){this.items=[],this.leafCount=0}return e}();t.RowWidths=n;var o=function(){function e(){this.maxLeafWidth=0,this.maxNonLeafWidth=0}return e}();t.RowWidth=o}(i=t.internal||(t.internal={}))}(i=t.controls||(t.controls={}))}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t;!function(e){var t;!function(t){var i=function(){function e(e,t,i){this._scrollable=!1,this._presenter=e,this.extension=t,this._presenter.initialize(this),this._row=i,this.item=null,this.type=null,this._horizontalOffset=0,this._verticalOffset=0,this._colSpan=1,this._rowSpan=1,this._contentWidth=-1,this._contentHeight=-1}return Object.defineProperty(e.prototype,"colSpan",{get:function(){return this._colSpan},set:function(e){this._colSpan!==e&&(this._presenter.onColumnSpanChanged(e),this._colSpan=e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rowSpan",{get:function(){return this._rowSpan},set:function(e){this._rowSpan!==e&&(this._presenter.onRowSpanChanged(e),this._rowSpan=e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"textAlign",{get:function(){return this._textAlign},set:function(e){e!==this._textAlign&&(this._presenter.onTextAlignChanged(e),this._textAlign=e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"horizontalOffset",{get:function(){return this._horizontalOffset},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"verticalOffset",{get:function(){return this._verticalOffset},enumerable:!0,configurable:!0}),e.prototype.isScrollable=function(){return this._scrollable},e.prototype.clear=function(){this.isScrollable()&&this.initializeScrolling(),this._presenter.onClear(),this.setContentWidth(-1),this.setContentHeight(-1)},e.prototype.initializeScrolling=function(){this._presenter.onInitializeScrolling(),this._horizontalOffset=0,this._verticalOffset=0,this.setContentWidth(-1),this.setContentHeight(-1)},e.prototype.prepare=function(e){this.isScrollable()&&this.initializeScrolling(),this._scrollable=e},e.prototype.scrollVertically=function(e,t){if(this.isScrollable()){var i=-e*t;this._verticalOffset=i,this._presenter.onVerticalScroll(e,i),this.setContentHeight(e+i)}},e.prototype.scrollHorizontally=function(e,t){if(this.isScrollable()){var i=-e*t;this._horizontalOffset=i,this._presenter.onHorizontalScroll(e,i),this.setContentWidth(e+i)}},e.prototype.setContentWidth=function(e){e!==this._contentWidth&&(this._contentWidth=e,this._presenter.onContentWidthChanged(e))},e.prototype.setContentHeight=function(e){e!==this._contentHeight&&(this._contentHeight=e,this._presenter.onContentHeightChanged(e))},e.prototype.enableHorizontalResize=function(e,t){this._presenter.enableHorizontalResize(e,t)},e}();t.TablixCell=i;var a=function(){function t(e){this._presenter=e,this._presenter.initialize(this),this._contentWidth=-1,this._width=-1,this._sizeFixed=!1,this._aligningWidth=-1,this._fixedToAligningWidth=!1,this._items=[],this._itemType=null,this._footerCell=null}return t.prototype.initialize=function(e){this._owner=e,this._realizedRowHeaders=[],this._realizedColumnHeaders=[],this._realizedCornerCells=[],this._realizedBodyCells=[]},Object.defineProperty(t.prototype,"owner",{get:function(){return this._owner},enumerable:!0,configurable:!0}),t.prototype.getType=function(){return this._realizedCornerCells.length>0?e.TablixCellType.CornerCell:e.TablixCellType.ColumnHeader},t.prototype.getColumnHeadersOrCorners=function(){return this._realizedCornerCells.length>0?this._realizedCornerCells:this._realizedColumnHeaders},t.prototype.columnHeadersOrCornersEqual=function(e,t,i){if(this._items.length!==t.length)return!1;for(var a=this._items.length,r=0;a>r;r++)if(!this.columnHeaderOrCornerEquals(this._itemType,this._items[r],e,t[r].item,i))return!1;return!0},Object.defineProperty(t.prototype,"itemType",{get:function(){return this._itemType},enumerable:!0,configurable:!0}),t.prototype.getLeafItem=function(){return 0===this._items.length?null:this._items[this._items.length-1]},t.prototype.columnHeaderOrCornerEquals=function(t,i,a,r,n){if(t!==a)return!1;if(t===e.TablixCellType.CornerCell){if(!n.cornerCellItemEquals(i,r))return!1}else if(!n.headerItemEquals(i,r))return!1;return!0},t.prototype.OnLeafRealized=function(e){var t=this.getType(),i=this.getColumnHeadersOrCorners();if(this.columnHeadersOrCornersEqual(t,i,e))this.clearSpanningCellsWidth(this._realizedColumnHeaders);else{var a=i.length;this._items=[];for(var r=0;a>r;r++)this._items.push(i[r].item);this._itemType=t,this.clearSize()}},t.prototype.clearSpanningCellsWidth=function(e){for(var t=0;t<e.length;t++){var i=e[t];i.colSpan>1&&i.setContentWidth(-1)}},t.prototype.addCornerCell=function(e){e._column=this,this._realizedCornerCells.push(e),e.setContentWidth(this._contentWidth)},t.prototype.addRowHeader=function(e){e._column=this,this._realizedRowHeaders.push(e),e.setContentWidth(this._contentWidth)},t.prototype.addColumnHeader=function(e,t){e._column=this,this._realizedColumnHeaders.push(e),t&&e.setContentWidth(this._contentWidth)},t.prototype.addBodyCell=function(e){e._column=this,this._realizedBodyCells.push(e),e.setContentWidth(this._contentWidth)},Object.defineProperty(t.prototype,"footer",{get:function(){return this._footerCell},set:function(e){this._footerCell=e,e._column=this,e.setContentWidth(this._contentWidth)},enumerable:!0,configurable:!0}),t.prototype.resize=function(e){e!==this.getContentContextualWidth()&&(this._contentWidth=e,this.setContentWidth(this._contentWidth),this._sizeFixed=!0,this._fixedToAligningWidth=!1,this._aligningWidth=-1)},t.prototype.fixSize=function(){var e=-1!==this._aligningWidth,t=e!==this._fixedToAligningWidth;(!this._sizeFixed||t||e)&&(-1===this._aligningWidth?(this._contentWidth+=1,this.setContentWidth(this._contentWidth)):this.setContentWidth(this._aligningWidth),this._sizeFixed=!0,this._fixedToAligningWidth=-1!==this._aligningWidth)},t.prototype.clearSize=function(){this._contentWidth=-1,this.setContentWidth(this._contentWidth),this._sizeFixed=!1},t.prototype.getContentContextualWidth=function(){return this._contentWidth},t.prototype.getCellIContentContextualWidth=function(e){return this._presenter.getCellContentWidth(e)},t.prototype.getCellSpanningWidthWithScrolling=function(e,t){var i=this.getContextualWidth()+this.getScrollingOffset();if(e.colSpan>1)for(var a=this.getIndex(t),r=t.realizedColumns,n=1;n<e.colSpan;n++)i+=r[n+a].getContextualWidth();return i},t.prototype.getScrollingOffset=function(){var e=0;return this._realizedColumnHeaders.length>0&&(e=this._realizedColumnHeaders[this._realizedColumnHeaders.length-1].horizontalOffset),e},t.prototype.getContextualWidth=function(){return(-1===this._width||-1===this._contentWidth)&&(this._width=this._presenter.getWidth()),this._width},t.prototype.calculateSize=function(){if(!this._sizeFixed){for(var e=0,t=this._realizedColumnHeaders.length,i=0;t>i;i++){var a=this._realizedColumnHeaders[i];1===a.colSpan&&(e=Math.max(e,this._presenter.getCellContentWidth(a)))}t=this._realizedRowHeaders.length;for(var i=0;t>i;i++){var a=this._realizedRowHeaders[i];1===a.colSpan&&(e=Math.max(e,this._presenter.getCellContentWidth(a)))}t=this._realizedCornerCells.length;for(var i=0;t>i;i++)e=Math.max(e,this._presenter.getCellContentWidth(this._realizedCornerCells[i]));t=this._realizedBodyCells.length;for(var i=0;t>i;i++)e=Math.max(e,this._presenter.getCellContentWidth(this._realizedBodyCells[i]));null!==this._footerCell&&1===this._footerCell.colSpan&&(e=Math.max(e,this._presenter.getCellContentWidth(this._footerCell))),this._contentWidth=e}},t.prototype.setAligningContextualWidth=function(e){this._aligningWidth=e},t.prototype.getAligningContextualWidth=function(){return this._aligningWidth},t.prototype.setContentWidth=function(e){for(var t=this._realizedColumnHeaders.length,i=0;t>i;i++){var a=this._realizedColumnHeaders[i];1===a.colSpan&&a.setContentWidth(e)}t=this._realizedRowHeaders.length;for(var i=0;t>i;i++){var a=this._realizedRowHeaders[i];1===a.colSpan&&a.setContentWidth(e)}t=this._realizedCornerCells.length;for(var i=0;t>i;i++)this._realizedCornerCells[i].setContentWidth(e);t=this._realizedBodyCells.length;for(var i=0;t>i;i++)this._realizedBodyCells[i].setContentWidth(e);null!==this._footerCell&&1===this._footerCell.colSpan&&this._footerCell.setContentWidth(e),this._width=-1},t.prototype.getTablixCell=function(){var e=this._realizedColumnHeaders.length>0?this._realizedColumnHeaders:this._realizedCornerCells;return e[e.length-1]},t.prototype.getIndex=function(e){return e.realizedColumns.indexOf(this)},t.prototype.getHeaders=function(){return this._realizedColumnHeaders},t.prototype.getOtherDimensionHeaders=function(){return this._realizedRowHeaders},t.prototype.getCellContextualSpan=function(e){return e.colSpan},t.prototype.getOtherDimensionOwner=function(e){return e._row},t}();t.TablixColumn=a;var r=function(){function t(e){this._contentHeight=-1,this._presenter=e,this._presenter.initialize(this),this._allocatedCells=[],this._heightFixed=!1,this._contentHeight=-1,this._height=-1}return t.prototype.initialize=function(e){this._owner=e,this._realizedRowHeaders=[],this._realizedBodyCells=[],this._realizedCornerCells=[],this._realizedColumnHeaders=[],this._realizedCellsCount=0},Object.defineProperty(t.prototype,"presenter",{get:function(){return this._presenter},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"owner",{get:function(){return this._owner},enumerable:!0,configurable:!0}),t.prototype.releaseUnusedCells=function(e){this.releaseCells(e,this._realizedCellsCount)},t.prototype.releaseAllCells=function(e){this.releaseCells(e,0)},t.prototype.releaseCells=function(e,t){for(var i=this._allocatedCells,a=i.length,r=t;a>r;r++){var n=i[r];e._unbindCell(n),n.clear()}},t.prototype.moveScrollableCellsToEnd=function(e){for(var t=Math.max(this._realizedRowHeaders.length,this._realizedCornerCells.length),i=t;t+e>i;i++){var a=this._allocatedCells[i];this._presenter.onRemoveCell(a),this._presenter.onAppendCell(a),this._allocatedCells.push(a)}this._allocatedCells.splice(t,e)},t.prototype.moveScrollableCellsToStart=function(e){for(var t=Math.max(this._realizedRowHeaders.length,this._realizedCornerCells.length),i=t;t+e>i;i++){var a=this._allocatedCells.pop();this._presenter.onRemoveCell(a),this._presenter.onInsertCellBefore(a,this._allocatedCells[t]),this._allocatedCells.splice(t,0,a)}},t.prototype.getOrCreateCornerCell=function(e){var t=this.getOrCreateCell();return t.prepare(!1),e.addCornerCell(t),this._realizedCornerCells.push(t),t.setContentHeight(this._contentHeight),t},t.prototype.getOrCreateRowHeader=function(e,t,i){var a=this.getOrCreateCell();return a.prepare(t),e.addRowHeader(a),this._realizedRowHeaders.push(a),i&&a.setContentHeight(this._contentHeight),a},t.prototype.getOrCreateColumnHeader=function(e,t,i){var a=this.getOrCreateCell();return a.prepare(t),e.addColumnHeader(a,i),this._realizedColumnHeaders.push(a),a.setContentHeight(this._contentHeight),a},t.prototype.getOrCreateBodyCell=function(e,t){var i=this.getOrCreateCell();return i.prepare(t),e.addBodyCell(i),this._realizedBodyCells.push(i),i.setContentHeight(this._contentHeight),i},t.prototype.getOrCreateFooterRowHeader=function(e){var t=this.getOrCreateCell();return t.prepare(!1),e.footer=t,this._realizedRowHeaders.push(t),t.setContentHeight(this._contentHeight),t},t.prototype.getOrCreateFooterBodyCell=function(e,t){var i=this.getOrCreateCell();return i.prepare(t),e.footer=i,this._realizedBodyCells.push(i),i.setContentHeight(this._contentHeight),i},t.prototype.getRowHeaderLeafIndex=function(){for(var t=-1,i=this._allocatedCells.length,a=0;i>a&&this._allocatedCells[a].type===e.TablixCellType.RowHeader;a++)t++;return t},t.prototype.getAllocatedCellAt=function(e){return this._allocatedCells[e]},t.prototype.moveCellsBy=function(e){if(0!==this._allocatedCells.length)if(e>0)for(var t=this._allocatedCells[0],i=0;e>i;i++){var a=this.createCell(this);this._presenter.onInsertCellBefore(a,t),this._allocatedCells.unshift(a),t=a}else{e=-e;for(var i=0;e>i;i++)this._presenter.onRemoveCell(this._allocatedCells[i]);this._allocatedCells.splice(0,e)}},t.prototype.getRealizedCellCount=function(){return this._realizedCellsCount},t.prototype.getRealizedHeadersCount=function(){return this._realizedRowHeaders.length},t.prototype.getRealizedHeaderAt=function(e){return this._realizedRowHeaders[e]},t.prototype.getTablixCell=function(){var e;return e=this._realizedRowHeaders.length>0?this._realizedRowHeaders:this._realizedCornerCells.length>0?this._realizedCornerCells:this._realizedColumnHeaders,e[e.length-1]},t.prototype.getOrCreateEmptySpaceCell=function(){var e=this._allocatedCells[this._realizedCellsCount];return void 0===e&&(e=this.createCell(this),this._allocatedCells[this._realizedCellsCount]=e,this._presenter.onAppendCell(e)),e},t.prototype.createCell=function(e){var t=this._presenter.createCellPresenter(this._owner.owner.layoutManager.getLayoutKind());return new i(t,t,this)},t.prototype.getOrCreateCell=function(){var e=this._allocatedCells[this._realizedCellsCount];return void 0===e?(e=this.createCell(this),this._allocatedCells[this._realizedCellsCount]=e,this._presenter.onAppendCell(e)):(e.colSpan=1,e.rowSpan=1),this._realizedCellsCount=this._realizedCellsCount+1,e},t.prototype.resize=function(e){e!==this.getContentContextualWidth()&&(this._contentHeight=e,this.setContentHeight(),this._heightFixed=!0,this.setAligningContextualWidth(-1))},t.prototype.fixSize=function(){this.sizeFixed()||(this.setContentHeight(),this._heightFixed=!0)},t.prototype.getContentContextualWidth=function(){return this._contentHeight},t.prototype.getCellIContentContextualWidth=function(e){return this.presenter.getCellContentHeight(e)},t.prototype.getCellSpanningHeight=function(e,t){var i=this.getContextualWidth();if(e.rowSpan>1)for(var a=this.getIndex(t),r=t.realizedRows,n=1;n<e.rowSpan;n++)i+=r[n+a].getContextualWidth();return i},t.prototype.getContextualWidth=function(){return(-1===this._height||-1===this._contentHeight)&&(this._height=this._presenter.getHeight()),this._height},t.prototype.sizeFixed=function(){return this._heightFixed},t.prototype.calculateSize=function(){if(!this._heightFixed){for(var e=0,t=this._realizedRowHeaders.length,i=0;t>i;i++){var a=this._realizedRowHeaders[i];1===a.rowSpan&&(e=Math.max(e,this._presenter.getCellContentHeight(a)))}t=this._realizedCornerCells.length;for(var i=0;t>i;i++)e=Math.max(e,this._presenter.getCellContentHeight(this._realizedCornerCells[i]));t=this._realizedColumnHeaders.length;for(var i=0;t>i;i++){var a=this._realizedColumnHeaders[i];1===a.rowSpan&&(e=Math.max(e,this._presenter.getCellContentHeight(a)))}t=this._realizedBodyCells.length;for(var i=0;t>i;i++)e=Math.max(e,this._presenter.getCellContentHeight(this._realizedBodyCells[i]));this._contentHeight=e}},t.prototype.setAligningContextualWidth=function(e){},t.prototype.getAligningContextualWidth=function(){return-1},t.prototype.setContentHeight=function(){for(var e=this._realizedRowHeaders.length,t=0;e>t;t++){
var i=this._realizedRowHeaders[t];i.rowSpan&&i.setContentHeight(this._contentHeight)}e=this._realizedCornerCells.length;for(var t=0;e>t;t++)this._realizedCornerCells[t].setContentHeight(this._contentHeight);e=this._realizedColumnHeaders.length;for(var t=0;e>t;t++){var i=this._realizedColumnHeaders[t];1===i.rowSpan&&i.setContentHeight(this._contentHeight)}e=this._realizedBodyCells.length;for(var t=0;e>t;t++)this._realizedBodyCells[t].setContentHeight(this._contentHeight);this._height=-1},t.prototype.getIndex=function(e){return e.realizedRows.indexOf(this)},t.prototype.getHeaders=function(){return this._realizedRowHeaders},t.prototype.getOtherDimensionHeaders=function(){return this._realizedColumnHeaders},t.prototype.getCellContextualSpan=function(e){return e.rowSpan},t.prototype.getOtherDimensionOwner=function(e){return e._column},t}();t.TablixRow=r;var n=function(){function e(e){this._presenter=e,this._footerRow=null}return e.prototype.initialize=function(e,t,i){this._owner=e,this._presenter.initialize(this,t,i,e),this.fillColumnsProportionally=!1,this._realizedRows=[],this._realizedColumns=[],this._emptySpaceHeaderCell=null,this._emptyFooterSpaceCell=null},Object.defineProperty(e.prototype,"owner",{get:function(){return this._owner},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fillColumnsProportionally",{get:function(){return this._fillColumnsProportionally},set:function(e){this._fillColumnsProportionally!==e&&(this._fillColumnsProportionally=e,this._presenter.onFillColumnsProportionallyChanged(e))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"realizedColumns",{get:function(){return this._realizedColumns},set:function(e){this._realizedColumns=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"realizedRows",{get:function(){return this._realizedRows},set:function(e){this._realizedRows=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"footerRow",{get:function(){return this._footerRow},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"emptySpaceHeaderCell",{get:function(){return this._emptySpaceHeaderCell},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"emptySpaceFooterCell",{get:function(){return this._emptyFooterSpaceCell},enumerable:!0,configurable:!0}),e.prototype.ShowEmptySpaceCells=function(e,t){0!==this._realizedRows.length&&(0===this._realizedRows.length||this._emptySpaceHeaderCell||(this._emptySpaceHeaderCell=this._realizedRows[0].getOrCreateEmptySpaceCell(),this._emptySpaceHeaderCell.rowSpan=e,this._emptySpaceHeaderCell.colSpan=1,this._emptySpaceHeaderCell.setContentWidth(t)),this._footerRow&&null===this._emptyFooterSpaceCell&&(this._emptyFooterSpaceCell=this._footerRow.getOrCreateEmptySpaceCell(),this._emptyFooterSpaceCell.rowSpan=1,this._emptyFooterSpaceCell.colSpan=1,this._emptyFooterSpaceCell.setContentWidth(t)))},e.prototype.HideEmptySpaceCells=function(){this._emptySpaceHeaderCell&&(this._emptySpaceHeaderCell.clear(),this._emptySpaceHeaderCell=null),this._emptyFooterSpaceCell&&(this._emptyFooterSpaceCell.clear(),this._emptyFooterSpaceCell=null)},e.prototype.onStartRenderingSession=function(e){e&&(this.clearRows(),this.clearColumns())},e.prototype.onStartRenderingIteration=function(){this.initializeRows(),this.initializeColumns()},e.prototype.onEndRenderingIteration=function(){var e=this._rows;if(void 0!==e)for(var t=e.length,i=0;t>i;i++)e[i].releaseUnusedCells(this._owner);this._footerRow&&this._footerRow.releaseUnusedCells(this._owner)},e.prototype.getOrCreateRow=function(e){var t=this._rows[e];return void 0===t&&(t=new r(this._presenter.createRowPresenter()),t.initialize(this),this._presenter.onAppendRow(t),this._rows[e]=t),void 0===this._realizedRows[e]&&(this._realizedRows[e]=t),t},e.prototype.getOrCreateFootersRow=function(){return null===this._footerRow&&(this._footerRow=new r(this._presenter.createRowPresenter()),this._footerRow.initialize(this),this._presenter.onAddFooterRow(this._footerRow)),this._footerRow},e.prototype.moveRowsToEnd=function(e,t){for(var i=0;t>i;i++){var a=this._rows[i+e];this._presenter.onRemoveRow(a),this._presenter.onAppendRow(a),this._rows.push(a)}this._rows.splice(e,t)},e.prototype.moveRowsToStart=function(e,t){for(var i=this._rows[e],a=0;t>a;a++){var r=this._rows.pop();this._presenter.onRemoveRow(r),this._presenter.onInsertRowBefore(r,i),this._rows.splice(e+a,0,r)}},e.prototype.moveColumnsToEnd=function(e,t){for(var i=this._rows[0]._realizedCornerCells.length,a=Math.max(this._columns[i]._realizedColumnHeaders.length-1,0),r=a;r<this._rows.length;r++)this._rows[r].moveScrollableCellsToEnd(t);for(var r=0;t>r;r++){var n=this._columns[r+e];this._columns.push(n)}this._columns.splice(e,t)},e.prototype.moveColumnsToStart=function(e,t){for(var i=this._rows[0]._realizedCornerCells.length,a=Math.max(this._columns[i]._realizedColumnHeaders.length-1,0),r=a;r<this._rows.length;r++)this._rows[r].moveScrollableCellsToStart(t);for(var r=0;t>r;r++){var n=this._columns.pop();this._columns.splice(e+r,0,n)}},e.prototype.getOrCreateColumn=function(e){var t=this._columns[e];return void 0===t&&(t=new a(this._presenter.createColumnPresenter()),t.initialize(this),this._columns[e]=t),void 0===this._realizedColumns[e]&&(this._realizedColumns[e]=t),t},e.prototype.initializeColumns=function(){this._columns||(this._columns=[]);for(var e=this._columns.length,t=0;e>t;t++)this._columns[t].initialize(this);this._realizedColumns=[]},e.prototype.clearColumns=function(){this._columns=null,this._realizedColumns=null},e.prototype.initializeRows=function(){var e=this._owner.rowDimension.hasFooter()&&null!==this._footerRow;this._realizedRows=[],this._rows||(this._rows=[]);for(var t=this._rows,i=t.length,a=0;i>a;a++)t[a].initialize(this);e&&(this._footerRow||this.getOrCreateFootersRow(),this._footerRow.initialize(this))},e.prototype.clearRows=function(){var e=this._rows;if(e){for(var t=e.length,i=0;t>i;i++)e[i].releaseAllCells(this._owner);this._footerRow&&this._footerRow.releaseAllCells(this._owner),this._presenter.onClear(),this._footerRow=null,this._rows=null,this._realizedRows=null}},e.prototype.getWidth=function(){return this._presenter.getWidth()},e.prototype.getHeight=function(){return this._presenter.getHeight()},e}();t.TablixGrid=n}(t=e.internal||(e.internal={}))}(t=e.controls||(e.controls={}))}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var i;!function(t){var i;!function(i){var a=function(){function e(){}return Object.defineProperty(e.prototype,"visibleWidth",{get:function(){return this._viewport?this._viewport.width:0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"visibleHeight",{get:function(){return this._viewport?this._viewport.height:0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"gridWidth",{get:function(){return this.visibleWidth},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"gridHeight",{get:function(){return this.visibleHeight},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rowHeight",{get:function(){return this._cellHeight},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cellWidth",{get:function(){return this._cellWidth},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cellHeight",{get:function(){return this._cellHeight},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"contentWidth",{get:function(){return this._cellWidth-e.DashboardCellPaddingLeft-e.DashboardCellPaddingRight},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"contentHeight",{get:function(){return this._cellHeight},enumerable:!0,configurable:!0}),e.prototype.updateColumnCount=function(e){this._columnCount=e},e.prototype.updateViewport=function(t){this._viewport=t,this._cellWidth=this.computeColumnWidth(this._columnCount),this._cellHeight=e.DashboardRowHeight},e.prototype.computeColumnWidth=function(e){var t=this._viewport.width;return 250>=t?this.fitToColumnCount(3,e):510>=t?this.fitToColumnCount(6,e):770>=t?this.fitToColumnCount(9,e):void 0},e.prototype.fitToColumnCount=function(e,t){var i=Math.min(e,t);return Math.floor(this._viewport.width/i)},e.DashboardCellPaddingLeft=10,e.DashboardCellPaddingRight=5,e.DashboardRowHeight=19,e}();i.SizeComputationManager=a;var r=function(){function t(e,t,i){this._owner=e,this._grid=t,this._lastScrollOffset=null,this._isScrolling=!1,this._fixedSizeEnabled=!0,this._done=!1,this._realizationManager=i}return Object.defineProperty(t.prototype,"owner",{get:function(){return this._owner},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"realizationManager",{get:function(){return this._realizationManager},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fixedSizeEnabled",{get:function(){return this._fixedSizeEnabled},set:function(e){this._fixedSizeEnabled=e},enumerable:!0,configurable:!0}),t.prototype.onCornerCellRealized=function(e,t,i){this._realizationManager.onCornerCellRealized(e,t)},t.prototype.onHeaderRealized=function(e,t,i){this._realizationManager.onHeaderRealized(e,t,i)},Object.defineProperty(t.prototype,"needsToRealize",{get:function(){return this._realizationManager.needsToRealize},enumerable:!0,configurable:!0}),t.prototype.getVisibleSizeRatio=function(){return 1-this.dimension.getFractionScrollOffset()},Object.defineProperty(t.prototype,"alignToEnd",{get:function(){return this._alignToEnd},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"done",{get:function(){return this._done},enumerable:!0,configurable:!0}),t.prototype._requiresMeasure=function(){return!0},t.prototype.startScrollingSession=function(){this._isScrolling=!0},t.prototype.endScrollingSession=function(){this._isScrolling=!1},t.prototype.isScrolling=function(){return this._isScrolling},t.prototype.isResizing=function(){return!1},t.prototype.getOtherHierarchyContextualHeight=function(){var e=this.dimension.otherDimension,t=e.getDepth(),i=0,a=this._getRealizedItems();if(a.length>0)for(var r=0;t>r;r++)i+=a[r].getContextualWidth();return i},t.prototype._isAutoSized=function(){return!1},t.prototype.onStartRenderingSession=function(){this._measureEnabled=this._requiresMeasure(),this._gridOffset=this.dimension.otherDimension.getDepth()},t.prototype.onEndRenderingSession=function(){this._realizationManager.onEndRenderingSession(),this._alignToEnd=!1,this._done=!1,this._measureEnabled=!0,this._sendDimensionsToControl()},t.prototype._sendDimensionsToControl=function(){},Object.defineProperty(t.prototype,"measureEnabled",{get:function(){return this._measureEnabled},enumerable:!0,configurable:!0}),t.prototype.getFooterContextualWidth=function(){return 0},t.prototype.onStartRenderingIteration=function(e,t){this._measureEnabled&&!this._done&&(this._contextualWidthToFill=(t-this.otherScrollbarContextualWidth)*this.getGridScale()-this.getFooterContextualWidth()),this._realizationManager.onStartRenderingIteration(),e?this._lastScrollOffset=null:null!==this._lastScrollOffset&&this.swapElements()},Object.defineProperty(t.prototype,"allItemsRealized",{get:function(){return this.getRealizedItemsCount()-this._gridOffset===this.dimension.getItemsCount()||0===this.dimension.getItemsCount()},enumerable:!0,configurable:!0}),t.prototype.onEndRenderingIteration=function(){if(!this._done){if(!this._measureEnabled)return this._lastScrollOffset=this.dimension.scrollOffset,void(this._done=!0);var i,a=this.getGridContextualWidth(),r=e.Double.greaterOrEqualWithPrecision(a,this._contextualWidthToFill,t._pixelPrecision),n=this.allItemsRealized;i=r?this.scrollForwardToAlignEnd(a):this.scrollBackwardToFill(a),this._realizationManager.onEndRenderingIteration(a,r);var o=this.dimension.scrollbar.visible;this.updateScrollbar(a),this._done=(r||n)&&this.dimension.scrollbar.visible===o&&e.Double.equalWithPrecision(i,this.dimension.scrollOffset,t._scrollOffsetPrecision),this.dimension.scrollOffset=i,this._lastScrollOffset=this.dimension.scrollOffset}},t.prototype.getScrollDeltaWithinPage=function(){if(null!==this._lastScrollOffset){var e=this.dimension.getIntegerScrollOffset()-Math.floor(this._lastScrollOffset);if(Math.abs(e)<this.getRealizedItemsCount()-this.dimension.otherDimension.getDepth())return e}return null},t.prototype.swapElements=function(){var e=this.getScrollDeltaWithinPage();if(null!==e){var t=this.dimension.otherDimension.getDepth();Math.abs(e)<this.getRealizedItemsCount()-t&&(e>0?this._moveElementsToBottom(t,e):0>e&&this._moveElementsToTop(t,-e))}},t.prototype._getRealizedItems=function(){return null},t.prototype.getRealizedItemsCount=function(){var e=this._getRealizedItems();return e.length},t.prototype._moveElementsToBottom=function(e,t){},t.prototype._moveElementsToTop=function(e,t){},t.prototype.isScrollingWithinPage=function(){return null!==this.getScrollDeltaWithinPage()},t.prototype.getGridContextualWidth=function(){return 0},t.prototype.updateScrollbar=function(e){var t=this.dimension.scrollbar;t.viewMin=this.dimension.scrollOffset,t.min=0,t.max=this.dimension.getItemsCount(),t.viewSize=this.getViewSize(e),this.dimension.scrollbar.show(this.canScroll(e))},t.prototype.getViewSize=function(i){var a=this.getRealizedItemsCount();if(0===a)return 0;for(var r=this._gridOffset,n=0,o=0,s=this._contextualWidthToFill,l=s-this.getOtherHierarchyContextualHeight(),u=this.getMeaurementError(i),c=r;a>c;c++){var h;h=c===r?this.getVisibleSizeRatio():1;var d=this.getItemContextualWidthWithScrolling(c)*u;if(o+=d,n+=h,e.Double.greaterWithPrecision(o,l,t._pixelPrecision)){n-=(o-l)/d*h;break}}return n},t.prototype.isScrollableHeader=function(e,t,i){if(0!==i||0===this.dimension.getFractionScrollOffset())return!1;var a=this.dimension._hierarchyNavigator;if(a.isLeaf(e))return!0;var r=e,n=t;do{if(n=a.getChildren(r),r=this.dimension.getFirstVisibleItem(a.getLevel(r)+1),void 0===r)break;if(!a.isLastItem(r,n))return!1}while(!a.isLeaf(r));return!0},t.prototype.reachedEnd=function(){return this.dimension.getIntegerScrollOffset()+(this.getRealizedItemsCount()-this._gridOffset)>=this.dimension.getItemsCount()},t.prototype.scrollBackwardToFill=function(i){var a=this.dimension.scrollOffset;if(this.reachedEnd()){var r=this._contextualWidthToFill-i;if(this.dimension.getItemsCount()>0){var n=i/(this.getRealizedItemsCount()-this.dimension.getFractionScrollOffset());a=this.dimension.getValidScrollOffset(Math.floor(this.dimension.scrollOffset-r/n))}this._alignToEnd=!e.Double.equalWithPrecision(a,this.dimension.scrollOffset,t._scrollOffsetPrecision)}return a},t.prototype.getItemContextualWidth=function(e){var t=this._getRealizedItems();return e>=t.length?null:t[e].getContextualWidth()},t.prototype.getItemContextualWidthWithScrolling=function(e){return this.getSizeWithScrolling(this.getItemContextualWidth(e),e)},t.prototype.getSizeWithScrolling=function(e,t){var i;return i=this._gridOffset===t?this.getVisibleSizeRatio():1,e*i},t.prototype.getGridContextualWidthFromItems=function(){for(var e=this.getRealizedItemsCount(),t=0,i=0;e>i;i++)t+=this.getItemContextualWidthWithScrolling(i);return t},t.prototype.getMeaurementError=function(e){return e/this.getGridContextualWidthFromItems()},t.prototype.scrollForwardToAlignEnd=function(i){var a=this.dimension.scrollOffset;if(this._alignToEnd){var r=e.Double.equalWithPrecision(i,this._contextualWidthToFill,t._pixelPrecision);if(!r)for(var n=this.getRealizedItemsCount(),o=this._gridOffset,s=i-this._contextualWidthToFill,l=this.getMeaurementError(i),u=o;n>u;u++){var c=this.getItemContextualWidth(u)*l;if(!e.Double.lessWithPrecision(c,s,t._pixelPrecision)){var h=o===u?1-this.dimension.getFractionScrollOffset():1;a=this.dimension.getValidScrollOffset(this.dimension.scrollOffset+(u-o)+s*h/c);break}s-=c}this._alignToEnd=!r}return a},Object.defineProperty(t.prototype,"dimension",{get:function(){return null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"otherLayoutManager",{get:function(){return this.dimension.otherDimension.layoutManager},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"contextualWidthToFill",{get:function(){return this._contextualWidthToFill},enumerable:!0,configurable:!0}),t.prototype.getGridScale=function(){return 0},Object.defineProperty(t.prototype,"otherScrollbarContextualWidth",{get:function(){return 0},enumerable:!0,configurable:!0}),t.prototype.getActualContextualWidth=function(e){return this._isAutoSized()&&!this.canScroll(e)?e:this._contextualWidthToFill},t.prototype.canScroll=function(e){return!1},t.prototype.calculateSizes=function(){this.fixedSizeEnabled&&(this.calculateContextualWidths(),this.calculateSpans())},t.prototype._calculateSize=function(e){},t.prototype.calculateContextualWidths=function(){for(var e=this._getRealizedItems(),t=e.length,i=0;t>i;i++){var a=e[i];this.measureEnabled&&a.setAligningContextualWidth(-1),this._calculateSize(a)}},t.prototype.calculateSpans=function(){this.measureEnabled&&(this.updateNonScrollableItemsSpans(),this.updateScrollableItemsSpans())},t.prototype.updateNonScrollableItemsSpans=function(){for(var e=this.otherLayoutManager._getRealizedItems(),t=e.length,i=this.dimension.getDepth(),a=i;t>a;a++){var r=e[a];this.updateSpans(r,r.getHeaders())}},t.prototype.updateScrollableItemsSpans=function(){for(var e=this.otherLayoutManager._getRealizedItems(),t=Math.min(this.dimension.getDepth(),e.length),i=0;t>i;i++){var a=e[i];this.updateSpans(a,a.getOtherDimensionHeaders())}},t.prototype.fixSizes=function(){if(this.fixedSizeEnabled)for(var e=this._getRealizedItems(),t=e.length,i=0;t>i;i++)e[i].fixSize()},t.prototype.updateSpans=function(e,t){for(var i=this._getRealizedItems(),a=t.length,r=0;a>r;r++){var n=t[r],o=e.getOtherDimensionOwner(n),s=o.getCellContextualSpan(n);if(s>1)for(var l=0,u=o.getIndex(this._grid),c=0;s>c;c++){var h=i[c+u];l+=this.getSizeWithScrolling(h.getContentContextualWidth(),c+u),c===s-1&&this.updateLastChildSize(n,h,l)}}},t.prototype.updateLastChildSize=function(e,t,i){var a=t.getCellIContentContextualWidth(e)-i;a>0&&t.setAligningContextualWidth(Math.max(t.getAligningContextualWidth(),a+t.getContentContextualWidth()))},t._pixelPrecision=1.0001,t._scrollOffsetPrecision=.01,t}();i.DimensionLayoutManager=r;var n=function(){function e(e,t,i){this.column=e,this.item=e.getLeafItem(),this.itemType=e.itemType,this.startColumnWidth=t,this.resizingDelta=0,this.animationFrame=null,this.scale=i}return e}();i.ResizeState=n;var o=function(e){function i(t,i,a){e.call(this,t,i,a),a.owner=this,this.fillProportionally=!1,this._resizeState=null}return __extends(i,e),Object.defineProperty(i.prototype,"dimension",{get:function(){return this.owner.owner.columnDimension},enumerable:!0,configurable:!0}),i.prototype.isResizing=function(){return null!==this._resizeState},Object.defineProperty(i.prototype,"fillProportionally",{get:function(){return this._grid.fillColumnsProportionally},set:function(e){this._grid.fillColumnsProportionally=e},enumerable:!0,configurable:!0}),i.prototype.getGridScale=function(){return this._grid._presenter.getScreenToCssRatioX()},Object.defineProperty(i.prototype,"otherScrollbarContextualWidth",{get:function(){return this.dimension.otherDimension.scrollbar.visible?t.HTMLElementUtils.getElementWidth(this.dimension.otherDimension.scrollbar.element):0},enumerable:!0,configurable:!0}),i.prototype._getRealizedItems=function(){return this._grid.realizedColumns||(this._grid.realizedColumns=[]),this._grid.realizedColumns},i.prototype._moveElementsToBottom=function(e,t){this._grid.moveColumnsToEnd(e,t)},i.prototype._moveElementsToTop=function(e,t){this._grid.moveColumnsToStart(e,t)},i.prototype._requiresMeasure=function(){return!this.isScrolling()&&!this.otherLayoutManager.isScrolling()||this.isScrolling()||this.isResizing()},i.prototype.getGridContextualWidth=function(){return this._grid.getWidth()},i.prototype.getFirstVisibleColumn=function(){return this._grid.realizedColumns[this._gridOffset]},i.prototype._isAutoSized=function(){return this.owner.owner.autoSizeWidth},i.prototype.applyScrolling=function(){var e=this.dimension.getFractionScrollOffset(),t=0;if(0!==e){var i=this.getFirstVisibleColumn();void 0!==i&&(t=i.getContextualWidth(),this.scroll(i,t,e))}},i.prototype.scroll=function(e,t,i){this.scrollCells(e._realizedColumnHeaders,t,i),this.scrollBodyCells(this._grid.realizedRows,t,i),null!==e.footer&&e.footer.scrollHorizontally(t,i)},i.prototype.scrollCells=function(e,t,i){for(var a=e.length,r=0;a>r;r++)e[r].scrollHorizontally(t,i)},i.prototype.scrollBodyCells=function(e,t,i){for(var a,r,n=e.length,o=0;n>o;o++)a=e[o]._realizedBodyCells,void 0!==a&&(r=a[0],void 0!==r&&r.scrollHorizontally(t,i))},i.prototype.onStartResize=function(e,i,a){this._resizeState=new n(e._column,e._column.getContentContextualWidth(),t.HTMLElementUtils.getAccumulatedScale(this.owner.owner.container))},i.prototype.onResize=function(e,t,a){var r=this;this._resizeState.resizingDelta=Math.max(t/this._resizeState.scale,i.minColumnWidth-this._resizeState.startColumnWidth),null===this._resizeState.animationFrame&&(this._resizeState.animationFrame=requestAnimationFrame(function(){return r.performResizing()}))},i.prototype.onEndResize=function(e){null!==this._resizeState.animationFrame&&this.performResizing(),this._resizeState=null},i.prototype.onReset=function(e){this._resizeState=new n(e._column,-1,1),e._column.clearSize(),this.owner.owner.refresh(!1),this._resizeState=null},i.prototype.updateItemToResizeState=function(e){if(null!==this._resizeState)for(var t=e.length,i=this.owner.owner.hierarchyNavigator,a=this.otherLayoutManager.dimension.getDepth(),r=a;t>r;r++){var n=e[r];if(n.columnHeaderOrCornerEquals(this._resizeState.itemType,this._resizeState.item,n.itemType,n.getLeafItem(),i)&&n!==this._resizeState.column){this._resizeState.column=n,n.resize(this._resizeState.startColumnWidth+this._resizeState.resizingDelta);break}}},i.prototype.performResizing=function(){if(null!==this._resizeState){this._resizeState.animationFrame=null;var e=this._resizeState.startColumnWidth+this._resizeState.resizingDelta;this._resizeState.column.resize(e),this.owner.owner.refresh(!1)}},i.prototype._sendDimensionsToControl=function(){var e=this.getGridContextualWidth(),t=this.getActualContextualWidth(e),i=this.getOtherHierarchyContextualHeight(),a=this.getGridScale();this.owner.owner.updateColumnDimensions(i/a,(t-i)/a,this.getViewSize(e))},i.prototype.getEstimatedHeaderWidth=function(e,t){return-1},i.prototype.getEstimatedBodyCellWidth=function(e){return-1},i.minColumnWidth=10,i}(r);i.ColumnLayoutManager=o;var s=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.getEstimatedHeaderWidth=function(e,t){return this.ignoreColumn(t)?0:this.owner.getCellWidth(void 0)},t.prototype.getEstimatedBodyCellWidth=function(e){return this.owner.getCellWidth(void 0)},t.prototype.canScroll=function(e){return!1},t.prototype._calculateSize=function(e){var t=e.getIndex(this._grid),i=0;this.ignoreColumn(t)||(i=this.owner.getContentWidth(void 0)),e.resize(i)},t.prototype.ignoreColumn=function(e){return 0===e&&!this.owner.binder.hasRowGroups()},t}(o);i.DashboardColumnLayoutManager=s;var l=function(t){function i(){t.apply(this,arguments)}return __extends(i,t),i.prototype.getEstimatedHeaderWidth=function(e,t){return this.owner.getEstimatedTextWidth(e)},i.prototype.getEstimatedBodyCellWidth=function(e){return this.owner.getEstimatedTextWidth(e)},i.prototype.canScroll=function(t){return!e.Double.equalWithPrecision(this.dimension.scrollOffset,0,r._scrollOffsetPrecision)||this.getRealizedItemsCount()-this._gridOffset<this.dimension.getItemsCount()&&this._contextualWidthToFill>0||e.Double.greaterWithPrecision(t,this._contextualWidthToFill,r._pixelPrecision)},i.prototype._calculateSize=function(e){e.calculateSize()},i}(o);i.CanvasColumnLayoutManager=l;var u=function(e){function i(t,i,a){e.call(this,t,i,a),a.owner=this}return __extends(i,e),Object.defineProperty(i.prototype,"dimension",{get:function(){return this.owner.owner.rowDimension},enumerable:!0,configurable:!0}),i.prototype.getGridScale=function(){return this._grid._presenter.getScreenToCssRatioY()},Object.defineProperty(i.prototype,"otherScrollbarContextualWidth",{get:function(){return this.dimension.otherDimension.scrollbar.visible?t.HTMLElementUtils.getElementHeight(this.dimension.otherDimension.scrollbar.element):0},enumerable:!0,configurable:!0}),i.prototype.startScrollingSession=function(){e.prototype.startScrollingSession.call(this)},i.prototype._getRealizedItems=function(){return this._grid.realizedRows||(this._grid.realizedRows=[]),this._grid.realizedRows},i.prototype._moveElementsToBottom=function(e,t){this._grid.moveRowsToEnd(e,t)},i.prototype._moveElementsToTop=function(e,t){this._grid.moveRowsToStart(e,t)},i.prototype._requiresMeasure=function(){return!this.isScrolling()&&!this.otherLayoutManager.isScrolling()&&!this.otherLayoutManager.isResizing()||this.isScrolling()&&this.dimension.getIntegerScrollOffset()+(this.getRealizedItemsCount()-this._gridOffset)>=this.dimension.getItemsCount()},i.prototype.getGridContextualWidth=function(){return this._grid.getHeight()},i.prototype.getFirstVisibleRow=function(){return this._grid.realizedRows[this._gridOffset]},i.prototype._isAutoSized=function(){return this.owner.owner.autoSizeHeight},i.prototype.applyScrolling=function(){var e=this.dimension.getFractionScrollOffset(),t=0;if(0!==e){var i=this.getFirstVisibleRow();i&&(t=i.getContextualWidth(),this.scroll(i,t,e))}},i.prototype.scroll=function(e,t,i){this.scrollCells(e._realizedRowHeaders,t,i),this.scrollCells(e._realizedBodyCells,t,i)},i.prototype.scrollCells=function(e,t,i){for(var a=e.length,r=0;a>r;r++)e[r].scrollVertically(t,i)},i.prototype.getFooterContextualWidth=function(){return this.owner.owner.rowDimension.hasFooter()&&this.owner.grid.footerRow?this.owner.grid.footerRow.getContextualWidth():0},i.prototype.calculateContextualWidths=function(){if(e.prototype.calculateContextualWidths.call(this),this.fixedSizeEnabled){var t=this._grid.footerRow;t&&this._calculateSize(t)}},i.prototype.fixSizes=function(){e.prototype.fixSizes.call(this),this.fixedSizeEnabled&&this._grid.footerRow&&this._grid.footerRow.fixSize()},i.prototype._sendDimensionsToControl=function(){var e=this.getGridContextualWidth(),t=this.getActualContextualWidth(e),i=this.getOtherHierarchyContextualHeight(),a=this.getGridScale();this.owner.owner.updateRowDimensions(i/a,(t-i)/a,e/a,this.getViewSize(e),this._grid.footerRow?this._grid.footerRow.getContextualWidth()/a:0)},i.prototype.getEstimatedHeaderWidth=function(e,t){return-1},i}(r);i.RowLayoutManager=u;var c=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.getEstimatedHeaderWidth=function(e,t){return this.getHeaderWidth(t)},t.prototype.canScroll=function(e){return!1},t.prototype._calculateSize=function(e){var t=this.owner.getEstimatedRowHeight();e.resize(t)},t.prototype.getHeaderWidth=function(e){return 0!==e||this.owner.binder.hasRowGroups()?this.owner.getEstimatedTextWidth(void 0):0},t}(u);i.DashboardRowLayoutManager=c;var h=function(t){function i(){t.apply(this,arguments)}return __extends(i,t),i.prototype.getEstimatedHeaderWidth=function(e,t){return this.owner.getEstimatedTextWidth(e)},i.prototype.canScroll=function(t){return!e.Double.equalWithPrecision(this.dimension.scrollOffset,0,r._scrollOffsetPrecision)||this.getRealizedItemsCount()-this._gridOffset<this.dimension.getItemsCount()&&this._contextualWidthToFill>0||e.Double.greaterWithPrecision(t,this._contextualWidthToFill,r._pixelPrecision)},i.prototype._calculateSize=function(e){e.calculateSize()},i}(u);i.CanvasRowLayoutManager=h;var d=function(){function e(e,t,i,a){this._allowHeaderResize=!0,this._binder=e,this._grid=t,this._columnLayoutManager=i,this._rowLayoutManager=a}return e.prototype.initialize=function(e){this._owner=e,this._container=e.container,this._gridHost=e.contentHost,this._footersHost=e.footerHost,this._grid.initialize(e,this._gridHost,this._footersHost)},Object.defineProperty(e.prototype,"owner",{get:function(){return this._owner},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"binder",{get:function(){return this._binder},enumerable:!0,configurable:!0}),e.prototype.getTablixClassName=function(){return null},e.prototype.getLayoutKind=function(){return null},e.prototype.getOrCreateColumnHeader=function(e,t,i,a){var r=this._grid.getOrCreateRow(i),n=this._grid.getOrCreateColumn(a+this._columnLayoutManager._gridOffset),o=this.owner.hierarchyNavigator.isLeaf(e),s=r.getOrCreateColumnHeader(n,this._columnLayoutManager.isScrollableHeader(e,t,a),o);return this.enableCellHorizontalResize(o,s),s},e.prototype.getOrCreateRowHeader=function(e,t,i,a){var r=this._grid.getOrCreateRow(i+this._rowLayoutManager._gridOffset),n=this._grid.getOrCreateColumn(a),o=this._rowLayoutManager.isScrollableHeader(e,t,i);0===r.getRealizedCellCount()&&this.alignRowHeaderCells(e,r);var s=r.getOrCreateRowHeader(n,o,this.owner.hierarchyNavigator.isLeaf(e));return s.enableHorizontalResize(!1,this._columnLayoutManager),s},e.prototype.getOrCreateCornerCell=function(e,t,i){var a=this._grid.getOrCreateRow(i),r=this._grid.getOrCreateColumn(t),n=a.getOrCreateCornerCell(r),o=this._columnLayoutManager.dimension.getDepth(),s=i===o-1;return this.enableCellHorizontalResize(s,n),n},e.prototype.getOrCreateBodyCell=function(e,t,i,a,r){var n,o=this._grid.getOrCreateRow(a+this._rowLayoutManager._gridOffset),s=this._grid.getOrCreateColumn(r+this._columnLayoutManager._gridOffset);n=0===o._realizedBodyCells.length&&0!==this._owner.columnDimension.getFractionScrollOffset()?!0:this._rowLayoutManager.isScrollableHeader(t,i,a);var l=o.getOrCreateBodyCell(s,n);return l.enableHorizontalResize(!1,this._columnLayoutManager),l},e.prototype.getOrCreateFooterBodyCell=function(e,t){var i,a=this._grid.getOrCreateFootersRow(),r=this._grid.getOrCreateColumn(t+this._columnLayoutManager._gridOffset);i=0===a._realizedBodyCells.length&&0!==this._owner.columnDimension.getFractionScrollOffset();var n=a.getOrCreateFooterBodyCell(r,i);return n.enableHorizontalResize(!1,this._columnLayoutManager),n},e.prototype.getOrCreateFooterRowHeader=function(e,t){var i=this._grid.getOrCreateFootersRow(),a=this._grid.getOrCreateColumn(0),r=i.getOrCreateFooterRowHeader(a);return r.enableHorizontalResize(!1,this._columnLayoutManager),r},e.prototype.getVisibleWidth=function(){return-1},e.prototype.getVisibleHeight=function(){return-1},e.prototype.updateColumnCount=function(e,t){},e.prototype.updateViewport=function(e){},e.prototype.getEstimatedRowHeight=function(){return-1},e.prototype.getCellWidth=function(e){return-1},e.prototype.getContentWidth=function(e){return-1},e.prototype.alignRowHeaderCells=function(e,t){var i=t.getRowHeaderLeafIndex();if(-1!==i){var a=this._owner.rowDimension,r=a.getFirstVisibleChildLeaf(e);this.owner.hierarchyNavigator.headerItemEquals(r,t.getAllocatedCellAt(i).item)&&t.moveCellsBy(this.owner.hierarchyNavigator.getLevel(r)-this.owner.hierarchyNavigator.getLevel(e)-i)}},Object.defineProperty(e.prototype,"grid",{get:function(){return this._grid},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rowLayoutManager",{get:function(){return this._rowLayoutManager},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"columnLayoutManager",{get:function(){return this._columnLayoutManager},enumerable:!0,configurable:!0}),e.prototype.showEmptySpaceHeader=function(){return!1},e.prototype.onStartRenderingSession=function(e,t,i){if(this.showEmptySpaceHeader()){var a=this._grid.emptySpaceHeaderCell;a&&this._binder.unbindEmptySpaceHeaderCell(a),a=this._grid.emptySpaceFooterCell,a&&this._binder.unbindEmptySpaceFooterCell(a),this._grid.HideEmptySpaceCells()}this._scrollingDimension=e,this._scrollingDimension&&this._scrollingDimension.layoutManager.startScrollingSession(),this._rowLayoutManager.onStartRenderingSession(),this._columnLayoutManager.onStartRenderingSession(),this._grid.onStartRenderingSession(i);var r=this._columnLayoutManager.measureEnabled||this._rowLayoutManager.measureEnabled;
r&&this.measureSampleText(t)},e.prototype.onEndRenderingSession=function(){if(this._rowLayoutManager.onEndRenderingSession(),this._columnLayoutManager.onEndRenderingSession(),this._scrollingDimension&&this._scrollingDimension.layoutManager.endScrollingSession(),this._scrollingDimension=null,this.showEmptySpaceHeader()){var e=this._columnLayoutManager.contextualWidthToFill-this._columnLayoutManager.getGridContextualWidth();if(e>0){this._grid.ShowEmptySpaceCells(this._owner.columnDimension.getDepth(),e);var t=this._grid.emptySpaceHeaderCell;t&&this._binder.bindEmptySpaceHeaderCell(t),t=this._grid.emptySpaceFooterCell,t&&this._binder.bindEmptySpaceFooterCell(t)}}},e.prototype.onStartRenderingIteration=function(e){this._rowLayoutManager.onStartRenderingIteration(e,this.getVisibleHeight()),this._columnLayoutManager.onStartRenderingIteration(e,this.getVisibleWidth()),this._grid.onStartRenderingIteration()},e.prototype.onEndRenderingIteration=function(){return this._grid.onEndRenderingIteration(),this._columnLayoutManager.calculateSizes(),this._rowLayoutManager.calculateSizes(),this._columnLayoutManager.fixSizes(),this._rowLayoutManager.fixSizes(),this._columnLayoutManager.updateItemToResizeState(this._grid.realizedColumns),this._columnLayoutManager.applyScrolling(),this._rowLayoutManager.applyScrolling(),this._columnLayoutManager.onEndRenderingIteration(),this._rowLayoutManager.onEndRenderingIteration(),this._columnLayoutManager.done&&this._rowLayoutManager.done},e.prototype.onCornerCellRealized=function(e,t){var i=this.owner.hierarchyNavigator.isColumnHierarchyLeaf(e),a=this.owner.hierarchyNavigator.isRowHierarchyLeaf(e);i&&t._column.OnLeafRealized(this._owner.hierarchyNavigator),this._columnLayoutManager.onCornerCellRealized(e,t,i),this._rowLayoutManager.onCornerCellRealized(e,t,a)},e.prototype.onRowHeaderRealized=function(e,t){var i=this._owner.hierarchyNavigator,a=i.isLeaf(e);this._rowLayoutManager.onHeaderRealized(e,t,a)},e.prototype.onRowHeaderFooterRealized=function(e,t){},e.prototype.onColumnHeaderRealized=function(e,t){var i=this._owner.hierarchyNavigator,a=i.isLeaf(e);a&&t._column.OnLeafRealized(this._owner.hierarchyNavigator),this._columnLayoutManager.onHeaderRealized(e,t,a)},e.prototype.onBodyCellRealized=function(e,t){},e.prototype.onBodyCellFooterRealized=function(e,t){},e.prototype.setAllowHeaderResize=function(e){this._allowHeaderResize=e},e.prototype.enableCellHorizontalResize=function(e,t){var i=e&&this._allowHeaderResize;t.enableHorizontalResize(i,this._columnLayoutManager)},e.prototype.getEstimatedTextWidth=function(e){return-1},e.prototype.measureSampleText=function(e){},e}();i.TablixLayoutManager=d;var p=function(e){function r(t,i,a,r,n){e.call(this,t,a,new s(this,a,n),new c(this,a,r)),this._sizeComputationManager=i}return __extends(r,e),r.createLayoutManager=function(e){var t=new a;return new r(e,t,new i.TablixGrid(new i.DashboardTablixGridPresenter(t)),new i.RowRealizationManager(e),new i.ColumnRealizationManager(e))},r.prototype.getTablixClassName=function(){return"bi-dashboard-tablix"},r.prototype.getLayoutKind=function(){return t.TablixLayoutKind.DashboardTile},r.prototype.showEmptySpaceHeader=function(){return!1},r.prototype.measureSampleText=function(e){},r.prototype.getVisibleWidth=function(){return this._sizeComputationManager.visibleWidth},r.prototype.getVisibleHeight=function(){return this._sizeComputationManager.visibleHeight},r.prototype.getCellWidth=function(e){return this._sizeComputationManager.cellWidth},r.prototype.getContentWidth=function(e){return this._sizeComputationManager.contentWidth},r.prototype.getEstimatedTextWidth=function(e){return this._sizeComputationManager.contentWidth},r.prototype.updateColumnCount=function(e,t){var i=e?e.getDepth():0,a=t?t.getItemsCount():0,r=i+a;this.binder.hasRowGroups()||r--,this._sizeComputationManager.updateColumnCount(r)},r.prototype.updateViewport=function(e){this._sizeComputationManager.updateViewport(e)},r.prototype.getEstimatedRowHeight=function(){return this._sizeComputationManager.cellHeight},r}(d);i.DashboardTablixLayoutManager=p;var g=function(e){function a(t,i,a,r){e.call(this,t,i,new l(this,i,r),new h(this,i,a))}return __extends(a,e),a.createLayoutManager=function(e){return new a(e,new i.TablixGrid(new t.internal.CanvasTablixGridPresenter),new i.RowRealizationManager(e),new i.ColumnRealizationManager(e))},a.prototype.getTablixClassName=function(){return"bi-tablix"},a.prototype.getLayoutKind=function(){return t.TablixLayoutKind.Canvas},a.prototype.measureSampleText=function(e){var i=t.internal.TablixUtils.createDiv();i.style.cssFloat="left",e.appendChild(i);var a=document.createTextNode("a");i.appendChild(a),this.characterWidth=t.HTMLElementUtils.getElementWidth(i),this.characterHeight=t.HTMLElementUtils.getElementHeight(i),i.removeChild(a),e.removeChild(i)},a.prototype.showEmptySpaceHeader=function(){return!this._columnLayoutManager.fillProportionally},a.prototype.getVisibleWidth=function(){return this._columnLayoutManager.measureEnabled?this._owner.autoSizeWidth&&this._owner.maxWidth?this._owner.maxWidth:t.HTMLElementUtils.getElementWidth(this._container):-1},a.prototype.getVisibleHeight=function(){return this._rowLayoutManager.measureEnabled?this._owner.autoSizeHeight&&this._owner.maxHeight?this._owner.maxHeight:t.HTMLElementUtils.getElementHeight(this._container):-1},a.prototype.getCellWidth=function(e){return t.HTMLElementUtils.getElementWidth(e._presenter.tableCell)},a.prototype.getContentWidth=function(e){return t.HTMLElementUtils.getElementWidth(e._presenter.contentElement)},a.prototype.getEstimatedTextWidth=function(e){return e?e.length*this.characterWidth:0},a.prototype.updateColumnCount=function(e,t){},a.prototype.updateViewport=function(e){},a.prototype.getEstimatedRowHeight=function(){return this.characterHeight},a}(d);i.CanvasTablixLayoutManager=g}(i=t.internal||(t.internal={}))}(i=t.controls||(t.controls={}))}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){function t(e){if(e)for(;e.hasChildNodes();)e.removeChild(e.firstChild)}function i(e,t){e.style.top=t+"px"}function a(e,t){e.style.left=t+"px"}function r(t,i){e.isAutoSize(i)?t.style.height="auto":t.style.height=i+"px"}function n(t,i){e.isAutoSize(i)?t.style.width="auto":t.style.width=i+"px"}function o(e){return e.offsetWidth}function s(e){return e.offsetHeight}function l(e){return-1===e}function u(t){for(var i=1;t;)i*=e.getScale(t),t=t.parentElement;return i}function c(e){e=$(e);var t=e.css("-webkit-transform")||e.css("-moz-transform")||e.css("-ms-transform")||e.css("-o-transform")||e.css("transform");return t&&(t.match(/\d*\.\d*/)&&Number(t.match(/\d*\.\d*/)[0])||t.match(/\d+/)&&Number(t.match(/\d+/)[0]))||1}e.clearChildren=t,e.setElementTop=i,e.setElementLeft=a,e.setElementHeight=r,e.setElementWidth=n,e.getElementWidth=o,e.getElementHeight=s,e.isAutoSize=l,e.getAccumulatedScale=u,e.getScale=c}(t=e.HTMLElementUtils||(e.HTMLElementUtils={}))}(t=e.controls||(e.controls={}))}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){function t(){return document.createElement("table")}function i(){var e=document.createElement("div"),t=e.style;return t.whiteSpace="nowrap",t.overflow="hidden",t.lineHeight="normal",e}function a(e,t){var i=t.extension.contentHost,a=null;0===i.childElementCount?(a=document.createElement("a"),i.appendChild(a)):a=i.children[0],a.href=e,a.target="_blank",a.title=e,a.innerText=e}e.createTable=t,e.createDiv=i,e.appendATagToBodyCell=a}(t=e.TablixUtils||(e.TablixUtils={}))}(t=e.internal||(e.internal={}))}(t=e.controls||(e.controls={}))}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t;!function(e){!function(e){e[e.CornerCell=0]="CornerCell",e[e.RowHeader=1]="RowHeader",e[e.ColumnHeader=2]="ColumnHeader",e[e.BodyCell=3]="BodyCell"}(e.TablixCellType||(e.TablixCellType={}));e.TablixCellType}(t=e.controls||(e.controls={}))}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t;!function(e){!function(e){e[e.Canvas=0]="Canvas",e[e.DashboardTile=1]="DashboardTile"}(e.TablixLayoutKind||(e.TablixLayoutKind={}));var t=e.TablixLayoutKind,i=function(){function i(t,i,a,r,n){var o=this;this._scrollbarWidth=9,this._fixSizedClassName="bi-tablix-fixed-size",this._options=n;var s=n.interactive;this._isTouchEnabled=s&&n.enableTouchSupport,this._mainDiv=e.internal.TablixUtils.createDiv();var l=this._mainDiv.style;l.position="absolute",l.left="0px",l.top="0px",this._footerDiv=e.internal.TablixUtils.createDiv();var u=this._footerDiv.style;u.position="absolute",u.left="0px",this._isTouchEnabled&&this.InitializeTouchSupport(),this._gridDimensions={},this._container=e.internal.TablixUtils.createDiv(),this.className=i.getTablixClassName(),this.autoSizeWidth=!1,this.autoSizeHeight=!1,r.appendChild(this._container),this._container.addEventListener("mousewheel",function(e){o.onMouseWheel(e)}),this._container.addEventListener("DOMMouseScroll",function(e){o.onFireFoxMouseWheel(e)}),this._container.appendChild(this._mainDiv),this._container.appendChild(this._footerDiv),this._isTouchEnabled&&(this._touchInterpreter.initTouch(this._mainDiv,null,!1),this._footerTouchInterpreter.initTouch(this._footerDiv,this._mainDiv,!1)),this._layoutManager=i,this._layoutManager.initialize(this),this._hierarchyNavigator=t,this._binder=a,this._columnDimension=new e.TablixColumnDimension(this),this._rowDimension=new e.TablixRowDimension(this),this._columnDimension._otherDimension=this.rowDimension,this._rowDimension._otherDimension=this.columnDimension,this.InitializeScrollbars(),s||(this.scrollbarWidth=0),this.updateHorizontalPosition(),this.updateVerticalPosition(),this.updateFooterVisibility(),this._lastRenderingArgs={}}return i.prototype.InitializeTouchSupport=function(){this._touchManager=new e.TouchUtils.TouchManager,this._touchInterpreter=new e.TouchUtils.TouchEventInterpreter(this._touchManager),this._footerTouchInterpreter=new e.TouchUtils.TouchEventInterpreter(this._touchManager),this._columnTouchDelegate=new e.ColumnTouchDelegate(new e.TouchUtils.Rectangle),this._rowTouchDelegate=new e.RowTouchDelegate(new e.TouchUtils.Rectangle),this._bodyTouchDelegate=new e.BodyTouchDelegate(new e.TouchUtils.Rectangle),this._footerTouchDelegate=new e.ColumnTouchDelegate(new e.TouchUtils.Rectangle),this._columnTouchDelegate.setHandler(this,this.onTouchEvent),this._rowTouchDelegate.setHandler(this,this.onTouchEvent),this._bodyTouchDelegate.setHandler(this,this.onTouchEvent),this._footerTouchDelegate.setHandler(this,this.onTouchEvent),this._touchManager.addTouchRegion(this._columnTouchDelegate.dimension,this._columnTouchDelegate,this._columnTouchDelegate),this._touchManager.addTouchRegion(this._rowTouchDelegate.dimension,this._rowTouchDelegate,this._rowTouchDelegate),this._touchManager.addTouchRegion(this._bodyTouchDelegate.dimension,this._bodyTouchDelegate,this._bodyTouchDelegate),this._touchManager.addTouchRegion(this._footerTouchDelegate.dimension,this._footerTouchDelegate,this._footerTouchDelegate)},i.prototype.InitializeScrollbars=function(){this._rowDimension._initializeScrollbar(this._container,null);var e=this._rowDimension.scrollbar.element.style;e.position="absolute",e.top="0"+i.UnitOfMeasurement,e.right="0"+i.UnitOfMeasurement,this._rowDimension.scrollbar.width=this._scrollbarWidth+i.UnitOfMeasurement,this._rowDimension.scrollbar.show(!0),this._columnDimension._initializeScrollbar(this._container,null);var t=this._columnDimension.scrollbar.element.style;t.position="absolute",t.left="0"+i.UnitOfMeasurement,t.bottom="0"+i.UnitOfMeasurement,this._columnDimension.scrollbar.height=this._scrollbarWidth+i.UnitOfMeasurement,this._columnDimension.scrollbar.show(!1)},Object.defineProperty(i.prototype,"container",{get:function(){return this._container},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"contentHost",{get:function(){return this._mainDiv},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"footerHost",{get:function(){return this._footerDiv},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"className",{set:function(e){this._container.className=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"hierarchyNavigator",{get:function(){return this._hierarchyNavigator},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"binder",{get:function(){return this._binder},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"autoSizeWidth",{get:function(){return this._autoSizeWidth},set:function(e){this._autoSizeWidth=e,this._autoSizeWidth?this.removeFixSizedClassName():(this.addFixedSizeClassNameIfNeeded(),this._container.style.minWidth=this._container.style.maxWidth="none")},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"autoSizeHeight",{get:function(){return this._autoSizeHeight},set:function(e){this._autoSizeHeight=e,this._autoSizeHeight?this.removeFixSizedClassName():(this.addFixedSizeClassNameIfNeeded(),this._container.style.minHeight=this._container.style.maxHeight="none")},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"maxWidth",{get:function(){return this._maxWidth},set:function(e){this._maxWidth=e,this._container.style.maxWidth=this._maxWidth+i.UnitOfMeasurement},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"viewport",{get:function(){return this._viewport},set:function(e){this._viewport=e,this._container.style.width=this._viewport.width+i.UnitOfMeasurement,this._container.style.height=this._viewport.height+i.UnitOfMeasurement,this._rowDimension.scrollbar.invalidateArrange(),this._columnDimension.scrollbar.invalidateArrange(),this._layoutManager.updateViewport(this._viewport)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"maxHeight",{get:function(){return this._maxHeight},set:function(e){this._maxHeight=e,this._container.style.maxHeight=this._maxHeight+i.UnitOfMeasurement},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"minWidth",{get:function(){return this._minWidth},set:function(e){this._minWidth=e,this._container.style.minWidth=this._minWidth+i.UnitOfMeasurement},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"minHeight",{get:function(){return this._minHeight},set:function(e){this._minHeight=e,this._container.style.minHeight=this._minHeight+i.UnitOfMeasurement},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"scrollbarWidth",{set:function(e){this._scrollbarWidth=e,this._rowDimension.scrollbar.width=this._scrollbarWidth+i.UnitOfMeasurement,this._columnDimension.scrollbar.height=this._scrollbarWidth+i.UnitOfMeasurement},enumerable:!0,configurable:!0}),i.prototype.updateModels=function(e,t,i){t&&(this._rowDimension.model=t,e&&(this._rowDimension.scrollOffset=0)),i&&(this._columnDimension.model=i,e&&(this._columnDimension.scrollOffset=0)),this.layoutManager.updateColumnCount(this._rowDimension,this._columnDimension)},i.prototype.updateColumnDimensions=function(e,t,i){var a=this._gridDimensions;a.columnCount=i,a.rowHierarchyWidth=e,a.columnHierarchyWidth=t},i.prototype.updateRowDimensions=function(e,t,i,a,r){var n=this._gridDimensions;n.rowCount=a,n.rowHierarchyHeight=t,n.rowHierarchyContentHeight=i,n.columnHierarchyHeight=e,n.footerHeight=r},i.prototype.updateTouchDimensions=function(){var e=this._gridDimensions;this._columnTouchDelegate.resize(e.rowHierarchyWidth,0,e.columnHierarchyWidth,e.columnHierarchyHeight),this._columnTouchDelegate.setScrollDensity(e.columnCount/e.columnHierarchyWidth),this._rowTouchDelegate.resize(0,e.columnHierarchyHeight,e.rowHierarchyWidth,e.rowHierarchyHeight),this._rowTouchDelegate.setScrollDensity(e.rowCount/e.rowHierarchyHeight),this._bodyTouchDelegate.resize(e.rowHierarchyWidth,e.columnHierarchyHeight,e.columnHierarchyWidth,e.rowHierarchyHeight),this._bodyTouchDelegate.setScrollDensity(e.columnCount/e.columnHierarchyWidth,e.rowCount/e.rowHierarchyHeight),this._footerTouchDelegate.resize(e.rowHierarchyWidth,e.columnHierarchyHeight+e.rowHierarchyHeight,e.columnHierarchyWidth,e.footerHeight),this._footerTouchDelegate.setScrollDensity(e.columnCount/e.columnHierarchyWidth)},i.prototype.onMouseWheel=function(e){var t=this.determineDimensionToScroll();t&&t.scrollbar.onMouseWheel(e)},i.prototype.onFireFoxMouseWheel=function(e){var t=this.determineDimensionToScroll();t&&t.scrollbar.onFireFoxMouseWheel(e)},i.prototype.determineDimensionToScroll=function(){return this._rowDimension.scrollbar.visible?this._rowDimension:this._columnDimension.scrollbar.visible?this._columnDimension:null},Object.defineProperty(i.prototype,"layoutManager",{get:function(){return this._layoutManager},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"columnDimension",{get:function(){return this._columnDimension},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"rowDimension",{get:function(){return this._rowDimension},enumerable:!0,configurable:!0}),i.prototype.refresh=function(e){this.render(e,null)},i.prototype._onScrollAsync=function(e){var t=this;requestAnimationFrame(function(){t.performPendingScroll(e)})},i.prototype.performPendingScroll=function(e){this.render(!1,e)},i.prototype.updateHorizontalPosition=function(){this._rowDimension.scrollbar.visible?(this._columnDimension.scrollbar.element.style.right=this._scrollbarWidth+i.UnitOfMeasurement,this._footerDiv.style.right=this._scrollbarWidth+i.UnitOfMeasurement,this._mainDiv.style.right=this._scrollbarWidth+i.UnitOfMeasurement):(this._columnDimension.scrollbar.element.style.right="0"+i.UnitOfMeasurement,this._mainDiv.style.right="0"+i.UnitOfMeasurement,this._footerDiv.style.right="0"+i.UnitOfMeasurement)},i.prototype.updateFooterVisibility=function(){(this._rowDimension.hasFooter()?"block"!==this._footerDiv.style.display:"none"!==this._footerDiv.style.display)&&(this._rowDimension.hasFooter()?this._footerDiv.style.display="block":this._footerDiv.style.display="none")},i.prototype.updateVerticalPosition=function(){var e=0;this._rowDimension.hasFooter()&&(e=this._gridDimensions.footerHeight),this._footerDiv.style.height=e+i.UnitOfMeasurement;var a=this._rowDimension.scrollbar.visible,r=this._layoutManager.getLayoutKind()===t.DashboardTile,n=a||r;if(n){var o=e,s=0,l=0,u=this._columnDimension.scrollbar.visible;u&&(o+=this._scrollbarWidth,s+=this._scrollbarWidth,l=this._scrollbarWidth),this._mainDiv.style.bottom=o+i.UnitOfMeasurement,this._rowDimension.scrollbar.element.style.bottom=l+i.UnitOfMeasurement,this._footerDiv.style.bottom=s+i.UnitOfMeasurement,this._footerDiv.style.removeProperty("top")}else this._footerDiv.style.top=this._gridDimensions.rowHierarchyContentHeight+i.UnitOfMeasurement,this._footerDiv.style.removeProperty("bottom"),this._mainDiv.style.removeProperty("bottom")},i.prototype.alreadyRendered=function(e){return e!==this._lastRenderingArgs.scrollingDimension||this.rowDimension.scrollOffset!==this._lastRenderingArgs.rowScrollOffset||this.columnDimension.scrollOffset!==this._lastRenderingArgs.columnScrollOffset?!1:!0},i.prototype.render=function(e,t){if(this._columnDimension.makeScrollOffsetValid(),this._rowDimension.makeScrollOffsetValid(),e||null===t)this._lastRenderingArgs={};else if(this.alreadyRendered(t))return;var i=!1;this._renderIterationCount=0,this._layoutManager.onStartRenderingSession(t,this._mainDiv,e);var a=this._binder;a.onStartRenderingSession();for(var r=this._gridDimensions.footerHeight,n=this._gridDimensions.rowHierarchyHeight,o=this._gridDimensions.rowHierarchyContentHeight;!i;){var s=this._columnDimension.scrollbar.visible,l=this._rowDimension.scrollbar.visible;this._columnDimension._onStartRenderingIteration(),this._rowDimension._onStartRenderingIteration(),this._layoutManager.onStartRenderingIteration(e),this.renderCorner(),this._columnDimension._render(),this._rowDimension._render(),i=this._layoutManager.onEndRenderingIteration(),this._columnDimension._onEndRenderingIteration(),this._rowDimension._onEndRenderingIteration(),s!==this._columnDimension.scrollbar.visible&&this.updateVerticalPosition(),l!==this._rowDimension.scrollbar.visible&&this.updateHorizontalPosition(),this._renderIterationCount++}this._layoutManager.onEndRenderingSession(),a.onEndRenderingSession(),this._isTouchEnabled&&this.updateTouchDimensions(),this._lastRenderingArgs.rowScrollOffset=this.rowDimension.scrollOffset,this._lastRenderingArgs.columnScrollOffset=this.columnDimension.scrollOffset,this.updateContainerDimensions();var u=this._lastRenderingArgs;u.rowScrollOffset=this.rowDimension.scrollOffset,u.columnScrollOffset=this.columnDimension.scrollOffset,u.scrollingDimension=t,(r!==this._gridDimensions.footerHeight||n!==this._gridDimensions.rowHierarchyHeight||o!==this._gridDimensions.rowHierarchyContentHeight)&&this.updateVerticalPosition(),this._options.interactive&&(this._columnDimension.scrollbar.refresh(),this._rowDimension.scrollbar.refresh())},i.prototype.updateContainerDimensions=function(){var e=this._gridDimensions;if(this._autoSizeWidth){var t=this._rowDimension.scrollbar.visible?this._scrollbarWidth:0;this._container.style.width=e.rowHierarchyWidth+e.columnHierarchyWidth+t+i.UnitOfMeasurement}if(this._autoSizeHeight){var a=this._columnDimension.scrollbar.visible?this._scrollbarWidth:0;this._container.style.height=e.columnHierarchyHeight+e.rowHierarchyHeight+e.footerHeight+a+i.UnitOfMeasurement}},i.prototype.cornerCellMatch=function(t,i){var a=i.item;return i.type===e.TablixCellType.CornerCell&&a&&this._hierarchyNavigator.cornerCellItemEquals(t,a)},i.prototype.renderCorner=function(){for(var t=this._columnDimension.getDepth(),i=this._rowDimension.getDepth(),a=0;t>a;a++)for(var r=0;i>r;r++){var n=this._hierarchyNavigator.getCorner(r,a),o=this._layoutManager.getOrCreateCornerCell(n,r,a),s=this.cornerCellMatch(n,o);s||(this._unbindCell(o),o.type=e.TablixCellType.CornerCell,o.item=n,this._binder.bindCornerCell(n,o)),this._layoutManager.onCornerCellRealized(n,o)}},i.prototype._unbindCell=function(t){switch(t.type){case e.TablixCellType.BodyCell:this._binder.unbindBodyCell(t.item,t);break;case e.TablixCellType.ColumnHeader:this._binder.unbindColumnHeader(t.item,t);break;case e.TablixCellType.RowHeader:this._binder.unbindRowHeader(t.item,t);break;case e.TablixCellType.CornerCell:this._binder.unbindCornerCell(t.item,t)}t.item=null,t.type=null},i.prototype.onTouchEvent=function(e){var t,i,a;e&&e.length>0&&"_columnDimension"in e[0]&&"_rowDimension"in e[0]&&(a=e[0],t=a._columnDimension.scrollbar.visible?e[1]:0,i=a._rowDimension.scrollbar.visible?e[2]:0,a._columnDimension.scrollbar.viewMin=Math.max(0,a._columnDimension.scrollbar.viewMin+t),a._columnDimension.scrollOffset=Math.max(0,a._columnDimension.scrollOffset+t),a._rowDimension.scrollbar.viewMin=Math.max(0,a._rowDimension.scrollbar.viewMin+i),a._rowDimension.scrollOffset=Math.max(0,a._rowDimension.scrollOffset+i),0===t?a._onScrollAsync(a._rowDimension):0===i?a._onScrollAsync(a._columnDimension):a._onScrollAsync(null))},i.prototype.addFixedSizeClassNameIfNeeded=function(){this._autoSizeHeight||this._autoSizeWidth||-1!==this._container.className.indexOf(this._fixSizedClassName)||(this._container.className+=" "+this._fixSizedClassName)},i.prototype.removeFixSizedClassName=function(){this._container.className=this._container.className.replace(this._fixSizedClassName,"")},i.UnitOfMeasurement="px",i}();e.TablixControl=i}(t=e.controls||(e.controls={}))}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t;!function(e){var t=function(){function e(e){this._scrollStep=.1,this._owner=e,this._hierarchyNavigator=e.hierarchyNavigator,this._binder=e.binder,this._tablixLayoutManager=e.layoutManager,this.scrollOffset=0}return e.prototype._onStartRenderingIteration=function(){this.updateScrollPosition()},e.prototype._onEndRenderingIteration=function(){},e.prototype.getValidScrollOffset=function(e){return Math.min(Math.max(e,0),Math.max(this.getItemsCount()-this._scrollStep,0))},e.prototype.makeScrollOffsetValid=function(){this.scrollOffset=this.getValidScrollOffset(this.scrollOffset)},e.prototype.getIntegerScrollOffset=function(){return Math.floor(this.scrollOffset)},e.prototype.getFractionScrollOffset=function(){return this.scrollOffset-this.getIntegerScrollOffset()},Object.defineProperty(e.prototype,"scrollbar",{get:function(){return this._scrollbar},enumerable:!0,configurable:!0}),e.prototype.getFirstVisibleItem=function(e){return this._scrollItems[e]},e.prototype.getFirstVisibleChild=function(e){return this._hierarchyNavigator.getAt(this._hierarchyNavigator.getChildren(e),this.getFirstVisibleChildIndex(e))},e.prototype.getFirstVisibleChildIndex=function(e){var t,i=this.getFirstVisibleItem(this._hierarchyNavigator.getLevel(e)+1);return t=void 0===i||void 0!==i&&this._hierarchyNavigator.getParent(i)!==e?0:this._hierarchyNavigator.getIndex(i)},e.prototype._initializeScrollbar=function(e,t){var i=this;this._scrollbar=this._createScrollbar(e),this._scrollbar._onscroll.push(function(e){return i.onScroll()}),t&&(this.scrollbar.initTouch(t,!0),t.style.setProperty("-ms-touch-action","pinch-zoom"))},e.prototype.getItemsCount=function(){return this.model?this._hierarchyNavigator.getLeafCount(this.model):0},e.prototype.getDepth=function(){return this.model?this._hierarchyNavigator.getDepth(this.model):0},e.prototype.onScroll=function(){this.scrollOffset=this._scrollbar.viewMin,this._owner._onScrollAsync(this)},Object.defineProperty(e.prototype,"otherDimension",{get:function(){return this._otherDimension},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"layoutManager",{get:function(){return this._layoutManager},enumerable:!0,configurable:!0}),e.prototype._createScrollbar=function(e){return null},e.prototype.updateScrollPosition=function(){if(this._scrollItems=[],this.model){var e=this.getIntegerScrollOffset(),t=this._hierarchyNavigator.getLeafAt(this.model,e);if(t){this._firstVisibleScrollIndex=e;do this._scrollItems[this._hierarchyNavigator.getLevel(t)]=t,t=this._hierarchyNavigator.getParent(t);while(null!==t)}}},e}();e.TablixDimension=t;var i=function(t){function i(e){t.call(this,e),this._layoutManager=this._tablixLayoutManager.rowLayoutManager,this._footer=null}return __extends(i,t),i.prototype.setFooter=function(e){this._footer=e,this._owner.updateFooterVisibility()},i.prototype.hasFooter=function(){return null!==this._footer},i.prototype._render=function(){var e=this.getFirstVisibleItem(0);this.hasFooter()&&(this.addFooterRowHeader(this._footer),this.addFooterBodyCells(this._footer)),void 0!==e&&this.addNodes(this.model,0,this.getDepth(),this._hierarchyNavigator.getIndex(e))},i.prototype._createScrollbar=function(t){return new e.VerticalScrollbar(t)},i.prototype.addNodes=function(e,t,i,a){for(var r=this._hierarchyNavigator.getCount(e),n=a;r>n;n++){if(!this._layoutManager.needsToRealize)return;var o=this._hierarchyNavigator.getAt(e,n),s=this.addNode(o,e,t,i);t+=s.rowSpan}},i.prototype.getFirstVisibleChildLeaf=function(e){for(var t=e;!this._hierarchyNavigator.isLeaf(t);)t=this.getFirstVisibleChild(t);return t},i.prototype.bindRowHeader=function(e,t){this._binder.bindRowHeader(e,t)},i.prototype.addNode=function(t,i,a,r){var n,o=this._tablixLayoutManager.getOrCreateRowHeader(t,i,a,this._hierarchyNavigator.getLevel(t)),s=this.rowHeaderMatch(t,o);return s||(this._owner._unbindCell(o),o.type=e.TablixCellType.RowHeader,o.item=t),this._hierarchyNavigator.isLeaf(t)?(o.colSpan=r-this._hierarchyNavigator.getLevel(t),o.rowSpan=1,s||this.bindRowHeader(t,o),this._tablixLayoutManager.onRowHeaderRealized(t,o),this.addBodyCells(t,i,a)):(n=this._layoutManager.getRealizedItemsCount(),this.addNodes(this._hierarchyNavigator.getChildren(t),a,r,this.getFirstVisibleChildIndex(t)),o.colSpan=1,o.rowSpan=this._layoutManager.getRealizedItemsCount()-n+1,s||this.bindRowHeader(t,o),this._tablixLayoutManager.onRowHeaderRealized(t,o)),o},i.prototype.rowHeaderMatch=function(t,i){var a=i.item;return i.type===e.TablixCellType.RowHeader&&a&&this._hierarchyNavigator.headerItemEquals(t,a)},i.prototype.addBodyCells=function(e,t,i){for(var a=this._otherDimension.getIntegerScrollOffset(),r=this._otherDimension._layoutManager.getRealizedItemsCount()-this.getDepth(),n=this._hierarchyNavigator,o=this._otherDimension.model,s=this._tablixLayoutManager,l=0;r>l;l++){var u=n.getIntersection(e,n.getLeafAt(o,a+l)),c=s.getOrCreateBodyCell(u,e,t,i,l);this.bindBodyCell(u,c),s.onBodyCellRealized(u,c)}},i.prototype.bindBodyCell=function(t,i){var a=this.bodyCelMatch(t,i);a||(this._owner._unbindCell(i),i.type=e.TablixCellType.BodyCell,i.item=t,this._binder.bindBodyCell(t,i))},i.prototype.addFooterRowHeader=function(t){var i=this._tablixLayoutManager.getOrCreateFooterRowHeader(t,this.model);i.colSpan=this.getDepth();var a=this.rowHeaderMatch(t,i);a||(this._owner._unbindCell(i),i.type=e.TablixCellType.RowHeader,i.item=t,this.bindRowHeader(t,i),this._tablixLayoutManager.onRowHeaderFooterRealized(t,i))},i.prototype.addFooterBodyCells=function(e){for(var t=this._otherDimension.getIntegerScrollOffset(),i=this._otherDimension.layoutManager.getRealizedItemsCount()-this.getDepth(),a=this._tablixLayoutManager,r=0;i>r;r++){var n=this._hierarchyNavigator.getLeafAt(this._otherDimension.model,t+r),o=this._hierarchyNavigator.getIntersection(e,n),s=a.getOrCreateFooterBodyCell(o,r);this.bindBodyCell(o,s),a.onBodyCellFooterRealized(o,s)}},i.prototype.bodyCelMatch=function(t,i){var a=i.item;return i.type===e.TablixCellType.BodyCell&&a&&this._hierarchyNavigator.bodyCellItemEquals(t,a)},i}(t);e.TablixRowDimension=i;var a=function(t){function i(e){t.call(this,e),this._layoutManager=this._tablixLayoutManager.columnLayoutManager}return __extends(i,t),i.prototype._render=function(){var e=this.getFirstVisibleItem(0);void 0!==e&&this.addNodes(this.model,0,this.getDepth(),this._hierarchyNavigator.getIndex(e))},i.prototype._createScrollbar=function(t){var i=new e.HorizontalScrollbar(t);return i.smallIncrement=.2,i},i.prototype.addNodes=function(e,t,i,a){for(var r=this._hierarchyNavigator.getCount(e),n=a;r>n;n++){if(!this._layoutManager.needsToRealize)return;var o=this.addNode(this._hierarchyNavigator.getAt(e,n),e,t,i);t+=o.colSpan}},i.prototype.addNode=function(t,i,a,r){var n=this._tablixLayoutManager.getOrCreateColumnHeader(t,i,this._hierarchyNavigator.getLevel(t),a),o=this.columnHeaderMatch(t,n);if(o||(this._owner._unbindCell(n),n.type=e.TablixCellType.ColumnHeader,n.item=t),this._hierarchyNavigator.isLeaf(t))n.rowSpan=r-this._hierarchyNavigator.getLevel(t);else{var s=this._layoutManager.getRealizedItemsCount();this.addNodes(this._hierarchyNavigator.getChildren(t),a,r,this.getFirstVisibleChildIndex(t)),n.rowSpan=1,n.colSpan=this._layoutManager.getRealizedItemsCount()-s+1}return o||this._binder.bindColumnHeader(t,n),this._tablixLayoutManager.onColumnHeaderRealized(t,n),n},i.prototype.columnHeaderMatch=function(t,i){var a=i.item;return i.type===e.TablixCellType.ColumnHeader&&a&&this._hierarchyNavigator.headerItemEquals(t,a)},i}(t);e.TablixColumnDimension=a}(t=e.controls||(e.controls={}))}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t;!function(e){var t=function(){function t(e){this._dimension=e,this._averageSize=1,this._handlers=null,this._tablixControl=null}return Object.defineProperty(t.prototype,"dimension",{get:function(){return this._dimension},enumerable:!0,configurable:!0}),t.prototype.setScrollDensity=function(e){this._averageSize=e},t.prototype.resize=function(e,t,i,a){this._dimension.x=e,this._dimension.y=t,this._dimension.width=i,this._dimension.height=a},t.prototype.getPixelToItem=function(t,i,a,r,n){return new e.TouchUtils.TouchEvent(t*this._averageSize,0,n,-a*this._averageSize,0)},t.prototype.touchEvent=function(t){var i=[];i[0]=this._tablixControl,i[1]=t.dx,i[2]=t.dy,this._handlers&&e.fire([this._handlers],i);
},t.prototype.setHandler=function(e,t){this._handlers=t,this._tablixControl=e},t}();e.ColumnTouchDelegate=t;var i=function(){function t(e){this._dimension=e,this._averageSize=30,this._handlers=null,this._tablixControl=null}return Object.defineProperty(t.prototype,"dimension",{get:function(){return this._dimension},enumerable:!0,configurable:!0}),t.prototype.setScrollDensity=function(e){this._averageSize=e},t.prototype.resize=function(e,t,i,a){this._dimension.x=e,this._dimension.y=t,this._dimension.width=i,this._dimension.height=a},t.prototype.getPixelToItem=function(t,i,a,r,n){var o=new e.TouchUtils.TouchEvent(0,i*this._averageSize,n,0,-r*this._averageSize);return o},t.prototype.touchEvent=function(t){var i=[];i[0]=this._tablixControl,i[1]=t.dx,i[2]=t.dy,this._handlers&&e.fire([this._handlers],i)},t.prototype.setHandler=function(e,t){this._handlers=t,this._tablixControl=e},t}();e.RowTouchDelegate=i;var a=function(){function t(e){this._dimension=e,this._averageSizeX=t.DefaultAverageSizeX,this._averageSizeY=t.DefaultAverageSizeY,this._handlers=null,this._tablixControl=null}return Object.defineProperty(t.prototype,"dimension",{get:function(){return this._dimension},enumerable:!0,configurable:!0}),t.prototype.setScrollDensity=function(e,t){this._averageSizeX=e,this._averageSizeY=t},t.prototype.resize=function(e,t,i,a){var r=this._dimension;r.x=e,r.y=t,r.width=i,r.height=a},t.prototype.getPixelToItem=function(t,i,a,r,n){return new e.TouchUtils.TouchEvent(t*this._averageSizeX,i*this._averageSizeY,n,-a*this._averageSizeX,-r*this._averageSizeY)},t.prototype.touchEvent=function(t){var i=[this._tablixControl,t.dx,t.dy];this._handlers&&e.fire([this._handlers],i)},t.prototype.setHandler=function(e,t){this._handlers=t,this._tablixControl=e},t.DefaultAverageSizeX=30,t.DefaultAverageSizeY=30,t}();e.BodyTouchDelegate=a}(t=e.controls||(e.controls={}))}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t;!function(e){var t;!function(t){var i=function(){function e(e,t){this.x=e||0,this.y=t||0}return e.prototype.offset=function(e,t){this.x+=e,this.y+=t},e}();t.Point=i;var a=function(e){function t(t,i,a,r){e.call(this,t,i),this.width=a||0,this.height=r||0}return __extends(t,e),Object.defineProperty(t.prototype,"point",{get:function(){return new i(this.x,this.y)},enumerable:!0,configurable:!0}),t.prototype.contains=function(e){return t.contains(this,e)},t.contains=function(e,i){return i&&!t.isEmpty(e)?e.x<=i.x&&i.x<e.x+e.width&&e.y<=i.y&&i.y<e.y+e.height:!1},t.isEmpty=function(e){return!(void 0!==e&&e.width>=0&&e.height>=0)},t}(i);t.Rectangle=a,function(e){e[e.Vertical=0]="Vertical",e[e.Horizontal=1]="Horizontal",e[e.FreeForm=2]="FreeForm"}(t.SwipeDirection||(t.SwipeDirection={}));var r=t.SwipeDirection;!function(e){e[e.NoClick=0]="NoClick",e[e.LeftClick=1]="LeftClick",e[e.RightClick=2]="RightClick",e[e.CenterClick=3]="CenterClick"}(t.MouseButton||(t.MouseButton={}));var n=t.MouseButton,o=function(){function e(e,t,i,a,r){this._x=e,this._y=t,this._isMouseDown=i,this._dx=a||0,this._dy=r||0}return Object.defineProperty(e.prototype,"x",{get:function(){return this._x},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this._y},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dx",{get:function(){return this._dx},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dy",{get:function(){return this._dy},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isMouseDown",{get:function(){return this._isMouseDown},enumerable:!0,configurable:!0}),e}();t.TouchEvent=o;var s=function(){function e(){this._touchList=[],this._swipeDirection=r.FreeForm,this._matchingDirectionCount=0,this._lockThreshold=!0,this._scrollThreshold=!0,this._lastEvent=new o(0,0,!1)}return Object.defineProperty(e.prototype,"lastEvent",{get:function(){return this._lastEvent},enumerable:!0,configurable:!0}),e.prototype.addTouchRegion=function(e,t,i){var a={lastPoint:new o(0,0,!1),handler:t,region:e,converter:i};this._touchList=this._touchList.concat([a])},e.prototype.upAllTouches=function(){var e,t;t=this._touchList.length;for(var i=0;t>i;i++)this._touchList[i].lastPoint.isMouseDown&&(e=this._touchList[i].converter.getPixelToItem(this._touchList[i].lastPoint.x,this._touchList[i].lastPoint.y,0,0,!1),this._touchList[i].handler.touchEvent(e)),this._touchList[i].lastPoint=new o(this._touchList[i].lastPoint.x,this._touchList[i].lastPoint.y,!1);this._lastEvent=new o(0,0,!1)},e.prototype.touchEvent=function(e){var t,i,a=0,n=0,s=0,l=0,u=0,c=null;t=this._getActive(),!this._lastEvent.isMouseDown&&e.isMouseDown&&(t=this._findRegions(e)),s=this._lastEvent.x-e.x,l=this._lastEvent.y-e.y,this._lastEvent=new o(e.x,e.y,e.isMouseDown,s,l),i=t.length;for(var h=0;i>h;h++)a=e.x-t[h].region.point.x,n=e.y-t[h].region.point.y,t[h].lastPoint.isMouseDown&&e.isMouseDown?(s=a-t[h].lastPoint.x,l=n-t[h].lastPoint.y,u=Math.abs(180/Math.PI*Math.atan(l/s)),this._scrollThreshold&&(this._lockThreshold&&this._matchingDirectionCount>5?this._swipeDirection===r.Horizontal?l=0:this._swipeDirection===r.Vertical&&(s=0):20>u?(l=0,this._swipeDirection===r.Horizontal?this._matchingDirectionCount++:(this._matchingDirectionCount=1,this._swipeDirection=r.Horizontal)):(u=Math.abs(180/Math.PI*Math.atan(s/l)),20>u?(s=0,this._swipeDirection===r.Vertical?this._matchingDirectionCount++:(this._matchingDirectionCount=1,this._swipeDirection=r.Vertical)):this._swipeDirection===r.FreeForm?this._matchingDirectionCount++:(this._swipeDirection=r.FreeForm,this._matchingDirectionCount=1)))):(s=0,l=0,this._swipeDirection=r.FreeForm,this._matchingDirectionCount=0),t[h].lastPoint=new o(a,n,e.isMouseDown,s,l),c=t[h].converter.getPixelToItem(a,n,s,l,e.isMouseDown),t[h].handler.touchEvent(c)},e.prototype._findRegions=function(e){var t,a=[];t=this._touchList.length;for(var r=0;t>r;r++)this._touchList[r].region.contains(new i(e.x,e.y))&&(a=a.concat([this._touchList[r]]));return a},e.prototype._getActive=function(){var e,t=[];e=this._touchList.length;for(var i=0;e>i;i++)this._touchList[i].lastPoint.isMouseDown&&(t=t.concat([this._touchList[i]]));return t},e}();t.TouchManager=s;var l=function(){function t(e){this._manager=e,this._allowMouseDrag=!0,this._touchPanel=null,this._scale=1,this._documentMouseMoveWrapper=null,this._documentMouseUpWrapper=null}return t.prototype.initTouch=function(e,t,i){var a=this;e.style.setProperty("-ms-touch-action","pinch-zoom"),this._touchReferencePoint=t,this._touchPanel=e,this._allowMouseDrag=void 0===i?!0:i,"ontouchmove"in e?(e.addEventListener("touchstart",function(e){return a.onTouchStart(e)}),e.addEventListener("touchend",function(e){return a.onTouchEnd(e)})):(e.addEventListener("mousedown",function(e){return a.onTouchMouseDown(e)}),e.addEventListener("mouseup",function(e){return a.onTouchMouseUp(e)}))},t.prototype.getXYByClient=function(e){var t=this._rect,a=t.left,r=t.top;void 0!==window.scrollX&&(a+=window.scrollX,r+=window.scrollY);var n=new i(0,0);return n.offset(e.pageX-a,e.pageY-r),n},t.prototype.onTouchStart=function(e){1===e.touches.length&&(e.cancelBubble=!0,this.onTouchMouseDown(e.touches[0]))},t.prototype.onTouchMove=function(e){1===e.touches.length&&(e.preventDefault&&e.preventDefault(),this.onTouchMouseMove(e.touches[0]))},t.prototype.onTouchEnd=function(e){this.onTouchMouseUp(1===e.touches.length?e.touches[0]:e,!0)},t.prototype.onTouchMouseDown=function(t){var i=this;this._scale=e.HTMLElementUtils.getAccumulatedScale(this._touchPanel),document.getSelection().removeAllRanges(),this._rect=(this._touchReferencePoint?this._touchReferencePoint:this._touchPanel).getBoundingClientRect(),"ontouchmove"in this._touchPanel?(this._documentMouseMoveWrapper=function(e){return i.onTouchMove(e)},document.addEventListener("touchmove",this._documentMouseMoveWrapper),this._documentMouseUpWrapper=function(e){return i.onTouchEnd(e)},document.addEventListener("touchend",this._documentMouseUpWrapper)):(this._documentMouseMoveWrapper=function(e){return i.onTouchMouseMove(e)},document.addEventListener("mousemove",this._documentMouseMoveWrapper),this._documentMouseUpWrapper=function(e){return i.onTouchMouseUp(e)},document.addEventListener("mouseup",this._documentMouseUpWrapper)),"setCapture"in this._touchPanel&&this._touchPanel.setCapture()},t.prototype.onTouchMouseMove=function(e){var t,i,a=null!==this._rect&&e.which!==n.NoClick;a&&(i=this.getXYByClient(e),t=new o(i.x/this._scale,i.y/this._scale,a),this._manager.touchEvent(t),e.preventDefault?e.preventDefault():"returnValue"in e&&(e.returnValue=!1))},t.prototype.onTouchMouseUp=function(e,t){this._rect=null,this._manager.upAllTouches(),"releaseCapture"in this._touchPanel&&this._touchPanel.releaseCapture(),null!==this._documentMouseMoveWrapper&&("ontouchmove"in this._touchPanel?(document.removeEventListener("touchmove",this._documentMouseMoveWrapper),document.removeEventListener("touchend",this._documentMouseUpWrapper)):(document.removeEventListener("mousemove",this._documentMouseMoveWrapper),document.removeEventListener("mouseup",this._documentMouseUpWrapper)),this._documentMouseMoveWrapper=null,this._documentMouseUpWrapper=null)},t}();t.TouchEventInterpreter=l}(t=e.TouchUtils||(e.TouchUtils={}))}(t=e.controls||(e.controls={}))}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var i=function(){function i(e){this.mainText={"class":"mainText",selector:".mainText"},this.name=e,this.visualConfiguration={maxFontSize:60}}return i.prototype.getMetaDataColumn=function(e){if(e&&e.metadata&&e.metadata.columns)for(var t=0,i=e.metadata.columns.length;i>t;t++){var a=e.metadata.columns[t];if(a.isMeasure){this.metaDataColumn=a;break}}},i.prototype.getAdjustedFontHeight=function(e,t,i){var a=this.svg.append("text").text(t),r=this.getAdjustedFontHeightCore(a,e,i,0);return a.remove(),r},i.prototype.getAdjustedFontHeightCore=function(t,i,a,r){if(r>10)return a;t.attr("font-size",a);var n=e.TextMeasurementService.measureSvgTextElementWidth(t[0][0]);return i>n?a:this.getAdjustedFontHeightCore(t,i,.9*a,r+1)},i.prototype.clear=function(){this.svg.select(this.mainText.selector).text("")},i.prototype.doValueTransition=function(e,i,a,r,n,o){if(o||e!==i||null==i){e||(e=0);var s=this.svg,l=this.currentViewport,u=l.height,c=l.width,h=[i],d=this.getSeedFontHeight(c,u),p=this.getTranslateX(c),g=this.getTranslateY(S),f=this.metaDataColumn,m=t.valueFormatter.create({format:this.getFormatString(f),value:i,displayUnitSystemType:a,formatSingleValues:!0,allowFormatBeautification:!0,columnType:f?f.type:void 0}),y=m.format(e),v=m.format(i);s.attr("class",this.name);var C=s.selectAll("text").data(h);C.enter().append("text").attr("class",this.mainText["class"]);var b=C.text(y).attr("text-anchor",this.getTextAnchor()),x=b.node();if(x){var S=this.getAdjustedFontHeight(c,v,d);g=this.getTranslateY(S+(u-S)/2)}if(null==i)b.text(v);else if(f&&t.AxisHelper.isDateTime(f.type))b.text(v);else{var w=e;b.attr("font-size",S).attr("transform",t.SVGUtil.translate(p,g)).transition().duration(n).tween("text",function(e){var t=d3.interpolate(w,e);return function(e){var i=t(e);this.textContent=m.format(i)}})}t.SVGUtil.flushAllD3TransitionsIfNeeded(r)}},i.prototype.getSeedFontHeight=function(e,t){var i=Math.floor(.75*Math.min(e,t)),a=this.visualConfiguration.maxFontSize;return a?Math.min(a,i):i},i.prototype.getTranslateX=function(e){if(this.visualConfiguration)switch(this.visualConfiguration.align){case"left":return 0;case"right":return e}return e/2},i.prototype.getTranslateY=function(e){return e},i.prototype.getTextAnchor=function(){if(this.visualConfiguration)switch(this.visualConfiguration.align){case"left":return"start";case"right":return"end"}return"middle"},i.prototype.getFormatString=function(e){return t.valueFormatter.getFormatString(e,i.formatStringProp)},i.formatStringProp={objectName:"general",propertyName:"formatString"},i.objectDescs={general:{properties:{formatString:{type:{formatting:{formatString:!0}}}}}},i}();t.AnimatedText=i}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t=function(t){function i(e,i){t.call(this,"animatedNumber"),e&&(this.svg=e),i&&(this.animator=i)}return __extends(i,t),i.prototype.init=function(e){this.options=e;var t=e.element;this.svg||(this.svg=d3.select(t.get(0)).append("svg")),this.currentViewport=e.viewport,this.hostServices=e.host,this.style=e.style,this.updateViewportDependantProperties()},i.prototype.updateViewportDependantProperties=function(){var e=this.currentViewport;this.svg.attr("width",e.width).attr("height",e.height)},i.prototype.update=function(e){this.currentViewport=e.viewport;var t=this.dataViews=e.dataViews;if(t&&t[0]){var i=t[0];this.updateViewportDependantProperties(),this.getMetaDataColumn(i);var a=i&&i.single?i.single.value:0;null!=a&&this.updateInternal(a,e.suppressAnimations,!0)}},i.prototype.onDataChanged=function(e){this.update({dataViews:e.dataViews,suppressAnimations:e.suppressAnimations,viewport:this.currentViewport})},i.prototype.onResizing=function(e){this.update({dataViews:this.dataViews,suppressAnimations:!0,viewport:e})},i.prototype.canResizeTo=function(e){return!0},i.prototype.updateInternal=function(t,i,a){void 0===a&&(a=!1);var r=this.value||0,n=e.AnimatorCommon.GetAnimationDuration(this.animator,i);this.doValueTransition(r,t,null,this.options.animation,n,a),this.value=t},i.capabilities={objects:e.AnimatedText.objectDescs,dataViewMappings:[{single:{role:"Values"}}]},i}(e.AnimatedText);e.AnimatedNumber=t}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){function i(e,i,a,r,n,o){switch(void 0===o&&(o=!1),i){case 1:return void e.push(new t.LineChart({chartType:2,isScrollable:o,interactivityService:r,animator:n}));case 0:return void e.push(new t.LineChart({chartType:1,isScrollable:o,interactivityService:r,animator:n}));case 3:return void e.push(new t.ColumnChart({chartType:t.ColumnChartType.stackedColumn,animator:n,isScrollable:o,interactivityService:r}));case 2:return void e.push(new t.ColumnChart({chartType:t.ColumnChartType.clusteredColumn,animator:n,isScrollable:o,interactivityService:r}));case 7:return void e.push(new t.ColumnChart({chartType:t.ColumnChartType.hundredPercentStackedColumn,animator:n,isScrollable:o,interactivityService:r}));case 5:return void e.push(new t.ColumnChart({chartType:t.ColumnChartType.stackedBar,animator:n,isScrollable:o,interactivityService:r}));case 4:return void e.push(new t.ColumnChart({chartType:t.ColumnChartType.clusteredBar,animator:n,isScrollable:o,interactivityService:r}));case 6:return void e.push(new t.ColumnChart({chartType:t.ColumnChartType.hundredPercentStackedBar,animator:n,isScrollable:o,interactivityService:r}));case 8:return void e.push(new t.ScatterChart({interactivityService:r,animator:n}));case 11:return void e.push(new t.WaterfallChart({isScrollable:o,interactivityService:r}));case 9:var s=t.ColumnChartType.clusteredColumn;if(a){var l=a.general;if(l){switch(l.visualType1){case"Column":s=t.ColumnChartType.clusteredColumn;break;case"ColumnStacked":s=t.ColumnChartType.stackedColumn}l.visualType2}}return e.push(new t.ColumnChart({chartType:s,animator:n,isScrollable:o,interactivityService:r})),void e.push(new t.LineChart({chartType:9,isScrollable:o,interactivityService:r,animator:n}));case 10:return void e.push(new t.DataDotChart({isScrollable:o,interactivityService:r}));case 12:return e.push(new t.ColumnChart({chartType:t.ColumnChartType.clusteredColumn,animator:n,isScrollable:o,interactivityService:r})),void e.push(new t.LineChart({chartType:9,isScrollable:o,interactivityService:r,animator:n}));case 13:return e.push(new t.ColumnChart({chartType:t.ColumnChartType.stackedColumn,animator:n,isScrollable:o,interactivityService:r})),void e.push(new t.LineChart({chartType:9,isScrollable:o,interactivityService:r,animator:n}));case 14:return e.push(new t.ColumnChart({chartType:t.ColumnChartType.clusteredColumn,animator:n,isScrollable:o,interactivityService:r})),void e.push(new t.DataDotChart({isScrollable:o,interactivityService:r}));case 15:return e.push(new t.ColumnChart({chartType:t.ColumnChartType.stackedColumn,animator:n,isScrollable:o,interactivityService:r})),void e.push(new t.DataDotChart({isScrollable:o,interactivityService:r}))}}function a(e,t,i){return i>1?e&&e.length>t?[e[t]]:[]:e}function r(e){return e.length>1}function n(e,t,i){return 0===e&&!!t&&!!t.showAxisTitle||1===e&&!i&&!!t&&!!t.secShowAxisTitle}function o(e,t){var i={domain:void 0,merged:!1,tickCount:void 0,forceStartToZero:!1};if(e.length<2)return i;var a,r,n,o,s=e[0].calculateAxesProperties(t)[1],l=e[1].calculateAxesProperties(t)[1],c=s.scale.domain(),h=l.scale.domain();if(c[0]>=0&&h[0]>=0&&(i.forceStartToZero=!0),s.values&&s.values.length>0&&l.values&&l.values.length>0&&(i.tickCount=Math.max(s.values.length,l.values.length)),a=Math.min(c[0],h[0]),r=Math.max(c[1],h[1]),t.forceMerge)return{domain:[a,r],merged:!0,tickCount:i.tickCount,forceStartToZero:!1};if(c[0]>h[1]||c[1]<h[0])return i;o=Math.max(c[0],h[0]),n=Math.min(c[1],h[1]);var d=r-a;if(0===d)return i;var p=Math.abs((n-o)/d);return u>p?i:{domain:[a,r],merged:!0,tickCount:i.tickCount,forceStartToZero:!1}}function s(e,i,a,s,l){var u,c={viewport:i,margin:a,forcedXDomain:[s?s.start:null,s?s.end:null],forceMerge:l&&l.secShow===!1,showCategoryAxisLabel:!1,showValueAxisLabel:!1},h=l&&l.secShow===!0,d=!1;r(e)&&!h&&(u=o(e,c),d=u.merged,d?c.forcedYDomain=u.domain:c.forcedTickCount=u.tickCount),l&&(c.forcedYDomain=t.AxisHelper.applyCustomizedDomain([l.start,l.end],c.forcedYDomain));for(var p,g=0,f=e.length;f>g;g++){var m=e[g];1!==g||d||(c.forcedYDomain=l?[l.secStart,l.secEnd]:null,u&&u.forceStartToZero&&(c.forcedYDomain?null==c.forcedYDomain[0]&&(c.forcedYDomain[0]=0):c.forcedYDomain=[0,void 0])),c.showCategoryAxisLabel=!!s&&!!s.showAxisTitle,c.showValueAxisLabel=n(g,l,d);var y=m.calculateAxesProperties(c);if(0===g)p={x:y[0],y1:y[1]};else if(y&&!p.y2)if(y[0].axis.scale().domain().length>p.x.axis.scale().domain().length){c.showValueAxisLabel=!!l&&!!l.showAxisTitle;var y=m.calculateAxesProperties(c);p.x=y[0],p.y1=y[1]}else m.overrideXScale(p.x),d||y[1].usingDefaultDomain||(p.y2=y[1])}return p}var l=jsCommon.EnumExtensions,u=.1,c=function(){function n(e){this.isScrollable=!1,e&&(this.type=e.chartType,e.isScrollable&&(this.isScrollable=e.isScrollable),this.animator=e.animator,e.cartesianSmallViewPortProperties&&(this.cartesianSmallViewPortProperties=e.cartesianSmallViewPortProperties))}return n.getAxisVisibility=function(e){switch(e){case 5:case 4:case 6:return 1;case 8:return 3;default:return 2}},n.prototype.init=function(i){this.visualInitOptions=i,this.layers=[];var a=this.element=i.element,r=this.currentViewport=i.viewport;this.hostServices=i.host,this.brush=d3.svg.brush(),a.addClass(n.ClassName),this.margin={top:1,right:1,bottom:1,left:1},this.yAxisOrientation=e.yAxisPosition.left,this.adjustMargins(r),this.sharedColorPalette=new h(i.style.colorPalette.dataColors);var o=n.getAxisVisibility(this.type),s=this.scrollY=l.hasFlag(o,3)||l.hasFlag(o,1),u=this.scrollX=l.hasFlag(o,3)||l.hasFlag(o,2),c=this.svg=d3.select(a.get(0)).append("svg");c.style("position","absolute");var d=this.axisGraphicsContext=c.append("g").classed(n.AxisGraphicsContextClassName,!0);this.svgScrollable=c.append("svg").classed("svgScrollable",!0).style("overflow","hidden");var p=this.axisGraphicsContextScrollable=this.svgScrollable.append("g").classed(n.AxisGraphicsContextClassName,!0);this.clearCatcher=t.appendClearCatcher(this.axisGraphicsContextScrollable),this.brushGraphicsContext=c.append("g").attr("class","x brush");var g=s?p:d;this.xAxisGraphicsContext=s?d.append("g").attr("class","x axis"):p.append("g").attr("class","x axis"),this.y1AxisGraphicsContext=g.append("g").attr("class","y axis"),this.y2AxisGraphicsContext=g.append("g").attr("class","y axis"),this.xAxisGraphicsContext.classed("showLinesOnAxis",s),this.y1AxisGraphicsContext.classed("showLinesOnAxis",u),this.y2AxisGraphicsContext.classed("showLinesOnAxis",u),this.xAxisGraphicsContext.classed("hideLinesOnAxis",!s),this.y1AxisGraphicsContext.classed("hideLinesOnAxis",!u),this.y2AxisGraphicsContext.classed("hideLinesOnAxis",!u),this.interactivityService=t.VisualInteractivityFactory.buildInteractivityService(i),this.legend=t.createLegend(a,i.interactivity&&i.interactivity.isInteractiveLegend,11!==this.type?this.interactivityService:void 0,this.isScrollable)},n.prototype.renderAxesLabels=function(i,a,r,o,s,l){this.axisGraphicsContext.selectAll(".xAxisLabel").remove(),this.axisGraphicsContext.selectAll(".yAxisLabel").remove();var u=this.margin,c=r.width-(u.left+u.right),h=r.height,d=n.FontSize,p=this.yAxisOrientation,g=p===e.yAxisPosition.right;if(!o){var f=this.axisGraphicsContext.append("text").style("text-anchor","middle").text(i.x).call(function(e){e.each(function(){var e=d3.select(this);e.attr({"class":"xAxisLabel",transform:t.SVGUtil.translate(c/2,h-d)})})});f.call(t.AxisHelper.LabelLayoutStrategy.clip,c,e.TextMeasurementService.svgEllipsis)}if(!s){var m=this.axisGraphicsContext.append("text").style("text-anchor","middle").text(i.y).call(function(e){e.each(function(){var e=d3.select(this);e.attr({"class":"yAxisLabel",transform:"rotate(-90)",y:g?c+u.right-d:-u.left,x:-((h-u.top-a)/2),dy:"1em"})})});m.call(t.AxisHelper.LabelLayoutStrategy.clip,h-(u.bottom+u.top),e.TextMeasurementService.svgEllipsis)}if(!l&&i.y2){var y=this.axisGraphicsContext.append("text").style("text-anchor","middle").text(i.y2).call(function(e){e.each(function(){var e=d3.select(this);e.attr({"class":"yAxisLabel",transform:"rotate(-90)",y:g?-u.left:c+u.right-d,x:-((h-u.top-a)/2),dy:"1em"})})});y.call(t.AxisHelper.LabelLayoutStrategy.clip,h-(u.bottom+u.top),e.TextMeasurementService.svgEllipsis)}},n.prototype.adjustMargins=function(e){var i=this.margin,a=e.width-(i.left+i.right),r=e.height-(i.top+i.bottom),n=this.element.find(".x.axis");0===t.AxisHelper.getRecommendedNumberOfTicksForXAxis(a)&&0===t.AxisHelper.getRecommendedNumberOfTicksForYAxis(r)?(this.margin={top:0,right:0,bottom:0,left:0},n.hide()):n.show()},n.prototype.updateAxis=function(i){this.adjustMargins(i);var a=this.margin,r=i.width-(a.left+a.right),o=i.height-(a.top+a.bottom),s=this.yAxisOrientation,l=s===e.yAxisPosition.right;this.xAxisGraphicsContext.attr("transform",t.SVGUtil.translate(0,o)),this.y1AxisGraphicsContext.attr("transform",t.SVGUtil.translate(l?0:r,0)),this.y2AxisGraphicsContext.attr("transform",t.SVGUtil.translate(l?0:r,0)),this.svg.attr({width:i.width,height:i.height}),this.svgScrollable.attr({width:i.width,height:i.height}),this.svgScrollable.attr({x:0}),this.axisGraphicsContext.attr("transform",t.SVGUtil.translate(a.left,a.top)),this.axisGraphicsContextScrollable.attr("transform",t.SVGUtil.translate(a.left,a.top)),this.isXScrollBarVisible?(this.svgScrollable.attr({x:this.margin.left}),this.axisGraphicsContextScrollable.attr("transform",t.SVGUtil.translate(0,a.top)),this.svgScrollable.attr("width",r),this.svg.attr("width",i.width).attr("height",i.height+n.ScrollBarWidth)):this.isYScrollBarVisible&&(this.svgScrollable.attr("height",o+a.top),this.svg.attr("width",i.width+n.ScrollBarWidth).attr("height",i.height))},n.getIsScalar=function(i,a,r){var n=e.DataViewObjects.getValue(i,a);return i&&void 0!==n?n===e.axisType.scalar&&!t.AxisHelper.isOrdinal(r):!t.AxisHelper.isOrdinal(r)},n.prototype.populateObjectProperties=function(i){if(i&&i.length>0){var a=i[0].metadata;a?this.legendObjectProperties=e.DataViewObjects.getObject(a.objects,"legend",{}):this.legendObjectProperties={},this.categoryAxisProperties=t.CartesianHelper.getCategoryAxisProperties(a),this.valueAxisProperties=t.CartesianHelper.getValueAxisProperties(a);var r=this.valueAxisProperties.position;this.yAxisOrientation=r?r.toString():e.yAxisPosition.left}},n.prototype.update=function(e){var i=this.dataViews=e.dataViews;if(this.currentViewport=e.viewport,i){var r=this.layers;if(0===r.length&&this.createAndInitLayers(i),i&&i.length>0){var n=t.getInvalidValueWarnings(i,!1,!1,!1);n&&n.length>0&&this.hostServices.setWarnings(n),this.populateObjectProperties(i)}this.sharedColorPalette.clearPreferredScale();for(var o=0,s=r.length;s>o;o++)r[o].setData(a(i,o,s)),s>1&&this.sharedColorPalette.rotateScale();this.visualInitOptions.interactivity&&this.visualInitOptions.interactivity.isInteractiveLegend||this.renderLegend(),this.render(!this.hasSetData||e.suppressAnimations),this.hasSetData=this.hasSetData||i&&i.length>0}},n.prototype.onDataChanged=function(e){this.update({dataViews:e.dataViews,suppressAnimations:e.suppressAnimations,viewport:this.currentViewport})},n.prototype.onResizing=function(e){this.currentViewport&&this.currentViewport.height===e.height&&this.currentViewport.width===e.width||this.update({dataViews:this.dataViews,suppressAnimations:!0,viewport:e})},n.prototype.enumerateObjectInstances=function(i){var a=[],r=this.layers?this.layers.length:0;if("legend"===i.objectName){if(!this.shouldShowLegendCard())return;var n=e.DataViewObject.getValue(this.legendObjectProperties,t.legendProps.show,this.legend.isVisible()),o=e.DataViewObject.getValue(this.legendObjectProperties,t.legendProps.showTitle,!0),s=e.DataViewObject.getValue(this.legendObjectProperties,t.legendProps.titleText,this.layerLegendData?this.layerLegendData.title:"");a.push({selector:null,properties:{show:n,position:t.LegendPosition[this.legend.getOrientation()],showTitle:o,titleText:s},objectName:i.objectName})}else"categoryAxis"===i.objectName&&this.hasCategoryAxis?a=this.getCategoryAxisValues():"valueAxis"===i.objectName&&(a=this.getValueAxisValues());for(var l=0,u=r;u>l;l++){var c=this.layers[l];if(c.enumerateObjectInstances){var h=c.enumerateObjectInstances(i);if(h){if(l>0)if("dataPoint"===i.objectName){var d=this.findObjectWithProperty(h,"defaultColor");if(d){var p=h.indexOf(d);h.splice(p,1)}var g=this.findObjectWithProperty(h,"showAllDataPoints");if(g){var p=h.indexOf(g);h.splice(p,1)}}else"labels"===i.objectName&&a.length>0&&(h=[]);"categoryAxis"===i.objectName||"valueAxis"===i.objectName?a.length>0&&h.length>0&&(a[0].properties.showAxisTitle=h[0].properties.showAxisTitle):a=a.concat(h)}}}return a},n.prototype.shouldShowLegendCard=function(){var e=this.layers,t=this.dataViews;if(e&&t)for(var i=e.length,a=0,r=0;i>r;r++){if(e[r].hasLegend())return!0;var n=t[r];if(n&&n.categorical&&n.categorical.values&&n.categorical.values.length>0&&(a++,a>1))return!0}return!1},n.prototype.scrollTo=function(e){var t=this.brush.extent(),i=t[1]-t[0];t[0]=this.scrollScale(e),t[1]=t[0]+i,this.brush.extent(t);var a=this.scrollScale.rangeExtent()[1];this.setMinBrush(a,this.brushMinExtent);var r=this.brush.on("brush");r(null,0)},n.prototype.getCategoryAxisValues=function(){var i=[],a=e.axisType.both,r=!1;this.layers&&this.layers[0].getSupportedCategoryAxisType&&(a=this.layers[0].getSupportedCategoryAxisType(),r=a===e.axisType.scalar?!0:t.CartesianHelper.isScalar(a===e.axisType.both,this.categoryAxisProperties)),r||this.categoryAxisProperties&&(this.categoryAxisProperties.start=null,this.categoryAxisProperties.end=null);var n={selector:null,properties:{},objectName:"categoryAxis"};return n.properties.show=this.categoryAxisProperties&&null!=this.categoryAxisProperties.show?this.categoryAxisProperties.show:!0,this.yAxisIsCategorical&&(n.properties.position=this.valueAxisProperties&&null!=this.valueAxisProperties.position?this.valueAxisProperties.position:e.yAxisPosition.left),a===e.axisType.both&&(n.properties.axisType=r?e.axisType.scalar:e.axisType.categorical),r&&(n.properties.start=this.categoryAxisProperties?this.categoryAxisProperties.start:null,n.properties.end=this.categoryAxisProperties?this.categoryAxisProperties.end:null),n.properties.showAxisTitle=this.categoryAxisProperties&&null!=this.categoryAxisProperties.showAxisTitle?this.categoryAxisProperties.showAxisTitle:!1,i.push(n),i.push({selector:null,properties:{axisStyle:this.categoryAxisProperties&&this.categoryAxisProperties.axisStyle?this.categoryAxisProperties.axisStyle:e.axisStyle.showTitleOnly},objectName:"categoryAxis",validValues:{axisStyle:this.categoryAxisHasUnitType?[e.axisStyle.showTitleOnly,e.axisStyle.showUnitOnly,e.axisStyle.showBoth]:[e.axisStyle.showTitleOnly]}}),i},n.prototype.getValueAxisValues=function(){var t=[],i={selector:null,properties:{},objectName:"valueAxis"};if(i.properties.show=this.valueAxisProperties&&null!=this.valueAxisProperties.show?this.valueAxisProperties.show:!0,2===this.layers.length&&(i.properties.secShow=this.valueAxisProperties&&null!=this.valueAxisProperties.secShow?this.valueAxisProperties.secShow:this.y2AxisExists,i.properties.secShow&&(i.properties.axisLabel="")),this.yAxisIsCategorical||(i.properties.position=this.valueAxisProperties&&null!=this.valueAxisProperties.position?this.valueAxisProperties.position:e.yAxisPosition.left),i.properties.start=this.valueAxisProperties?this.valueAxisProperties.start:null,i.properties.end=this.valueAxisProperties?this.valueAxisProperties.end:null,i.properties.showAxisTitle=this.valueAxisProperties&&null!=this.valueAxisProperties.showAxisTitle?this.valueAxisProperties.showAxisTitle:!1,t.push(i),t.push({selector:null,properties:{axisStyle:this.valueAxisProperties&&null!=this.valueAxisProperties.axisStyle?this.valueAxisProperties.axisStyle:e.axisStyle.showTitleOnly},objectName:"valueAxis",validValues:{axisStyle:this.valueAxisHasUnitType?[e.axisStyle.showTitleOnly,e.axisStyle.showUnitOnly,e.axisStyle.showBoth]:[e.axisStyle.showTitleOnly]}}),this.y2AxisExists&&i.properties.secShow){var a={selector:null,properties:{},objectName:"valueAxis"};a.properties.secAxisLabel="",a.properties.secPosition=this.valueAxisProperties&&null!=this.valueAxisProperties.secPosition?this.valueAxisProperties.secPosition:e.yAxisPosition.right,a.properties.secStart=this.valueAxisProperties?this.valueAxisProperties.secStart:null,a.properties.secEnd=this.valueAxisProperties?this.valueAxisProperties.secEnd:null,a.properties.secShowAxisTitle=this.valueAxisProperties&&null!=this.valueAxisProperties.secShowAxisTitle?this.valueAxisProperties.secShowAxisTitle:!1,t.push(a),t.push({selector:null,properties:{secAxisStyle:this.valueAxisProperties&&this.valueAxisProperties.secAxisStyle?this.valueAxisProperties.secAxisStyle:e.axisStyle.showTitleOnly},objectName:"valueAxis",validValues:{secAxisStyle:this.secValueAxisHasUnitType?[e.axisStyle.showTitleOnly,e.axisStyle.showUnitOnly,e.axisStyle.showBoth]:[e.axisStyle.showTitleOnly]}})}return t},n.prototype.findObjectWithProperty=function(e,t){for(var i=0,a=e.length;a>i;i++){var r=e[i];if(void 0!==r.properties[t])return r}},n.prototype.onClearSelection=function(){if(this.hasSetData)for(var e=0,t=this.layers.length;t>e;e++){var i=this.layers[e];i.onClearSelection(),i.render(!0)}},n.prototype.createAndInitLayers=function(t){var a,r=this;if(t&&t.length>0){var n=t[0].metadata;n&&(a=n.objects)}var o=this.layers;i(o,this.type,a,this.interactivityService,this.animator,this.isScrollable);var s=e.Prototype.inherit(this.visualInitOptions);s.svg=this.axisGraphicsContextScrollable,s.cartesianHost={updateLegend:function(e){return r.legend.drawLegend(e,r.currentViewport)},getSharedColors:function(){return r.sharedColorPalette}};for(var l=0,u=o.length;u>l;l++)o[l].init(s)},n.prototype.renderLegend=function(){for(var e=this.layers,i={title:"",dataPoints:[]},a=0,r=e.length;r>a;a++)this.layerLegendData=e[a].calculateLegend(),this.layerLegendData&&(i.title=0===a?this.layerLegendData.title||"":i.title,i.dataPoints=i.dataPoints.concat(this.layerLegendData.dataPoints||[]),this.layerLegendData.grouped&&(i.grouped=!0));var n=this.legendObjectProperties;if(n){t.LegendData.update(i,n);var o=n[t.legendProps.position];o&&this.legend.changeOrientation(t.LegendPosition[o])}else this.legend.changeOrientation(t.LegendPosition.Top);(1===i.dataPoints.length&&!i.grouped||this.hideLegends())&&(i.dataPoints=[]),this.legend.drawLegend(i,this.currentViewport)},n.prototype.hideLegends=function(){return this.cartesianSmallViewPortProperties&&this.cartesianSmallViewPortProperties.hideLegendOnSmallViewPort&&this.currentViewport.height<this.cartesianSmallViewPortProperties.MinHeightLegendVisible?!0:!1;
},n.prototype.addUnitTypeToAxisLabel=function(i){var a=i.x.formatter&&i.x.formatter.displayUnit?i.x.formatter.displayUnit.title:null;i.x.isCategoryAxis?this.categoryAxisHasUnitType=null!==a:this.valueAxisHasUnitType=null!==a,i.x.axisLabel&&a&&(i.x.isCategoryAxis?i.x.axisLabel=t.AxisHelper.createAxisLabel(this.categoryAxisProperties,i.x.axisLabel,a):i.x.axisLabel=t.AxisHelper.createAxisLabel(this.valueAxisProperties,i.x.axisLabel,a)),a=i.y1.formatter&&i.y1.formatter.displayUnit?i.y1.formatter.displayUnit.title:null,i.y1.isCategoryAxis?this.categoryAxisHasUnitType=null!==a:this.valueAxisHasUnitType=null!==a,i.y1.axisLabel&&a&&(i.y1.isCategoryAxis?i.y1.axisLabel=t.AxisHelper.createAxisLabel(this.categoryAxisProperties,i.y1.axisLabel,a):i.y1.axisLabel=t.AxisHelper.createAxisLabel(this.valueAxisProperties,i.y1.axisLabel,a)),i.y2&&(a=i.y2.formatter&&i.y2.formatter.displayUnit?i.y2.formatter.displayUnit.title:null,this.secValueAxisHasUnitType=null!==a,i.y2.axisLabel&&a&&this.valueAxisProperties&&this.valueAxisProperties.secAxisStyle&&(this.valueAxisProperties.secAxisStyle===e.axisStyle.showBoth?i.y2.axisLabel=i.y2.axisLabel+" ("+a+")":this.valueAxisProperties.secAxisStyle===e.axisStyle.showUnitOnly&&(i.y2.axisLabel=a)))},n.prototype.shouldRenderSecondaryAxis=function(e){return!this.valueAxisProperties||null==this.valueAxisProperties.secShow||this.valueAxisProperties.secShow?!0:!1},n.prototype.shouldRenderAxis=function(e,t){return void 0===t&&(t="show"),e?(!e.isCategoryAxis||this.categoryAxisProperties&&null!=this.categoryAxisProperties[t]&&!this.categoryAxisProperties[t])&&(e.isCategoryAxis||this.valueAxisProperties&&null!=this.valueAxisProperties[t]&&!this.valueAxisProperties[t])?!1:!0:!1},n.prototype.render=function(i){var a=this.legendMargins=this.legend.getMargins(),o={height:this.currentViewport.height-a.height,width:this.currentViewport.width-a.width},l=this.getMaxMarginFactor(),u=this.leftMarginLimit=o.width*l,c=this.bottomMarginLimit=Math.max(n.MinBottomMargin,o.height*l),h=this.margin;h.top=n.TopMargin,h.bottom=c,h.right=0;var d=s(this.layers,o,h,this.categoryAxisProperties,this.valueAxisProperties);this.y2AxisExists=null!=d.y2,this.yAxisIsCategorical=d.y1.isCategoryAxis,this.hasCategoryAxis=this.yAxisIsCategorical?d.y1&&d.y1.values.length>0:d.x&&d.x.values.length>0;var p,g,f=this.shouldRenderAxis(d.x),m=this.shouldRenderAxis(d.y1),y=this.shouldRenderSecondaryAxis(d.y2),v=o.width-(h.left+h.right),C={fontFamily:"wf_segoe-ui_normal",fontSize:n.FontSizeString},b=!1;this.isXScrollBarVisible=!1,this.isYScrollBarVisible=!1;var x=this.yAxisOrientation,S=x===e.yAxisPosition.right;if(this.layers&&(this.layers[0].getVisualCategoryAxisIsScalar&&(b=this.layers[0].getVisualCategoryAxisIsScalar()),!b&&this.isScrollable&&this.layers[0].getPreferredPlotArea)){var w=this.scrollX?d.x.categoryThickness:d.y1.categoryThickness,_=this.scrollX?d.x.values.length:d.y1.values.length;g=this.layers[0].getPreferredPlotArea(b,_,w),this.scrollX&&g&&g.width>o.width&&(this.isXScrollBarVisible=!0,o.height-=n.ScrollBarWidth),this.scrollY&&g&&g.height>o.height&&(this.isYScrollBarVisible=!0,o.width-=n.ScrollBarWidth,v=o.width-(h.left+h.right))}var T=this.needRotate=t.AxisHelper.LabelLayoutStrategy.willRotate(d.x,v,e.TextMeasurementService.measureSvgTextWidth,C),D=t.AxisHelper.getTickLabelMargins({width:v,height:o.height},u,e.TextMeasurementService.measureSvgTextWidth,d.x,d.y1,T,c,C,d.y2,this.isXScrollBarVisible||this.isYScrollBarVisible,S,f,m,y),P=S?D.yRight:D.yLeft,M=S?D.yLeft:D.yRight,L=D.xMax;P+=n.LeftPadding,r(this.layers)&&(M+=n.RightPadding),L+=n.BottomPadding,this.hideAxisLabels(a)&&(d.x.axisLabel=null,d.y1.axisLabel=null,d.y2&&(d.y2.axisLabel=null)),this.addUnitTypeToAxisLabel(d);var A={x:d.x.axisLabel,y:d.y1.axisLabel,y2:d.y2?d.y2.axisLabel:null},N=null!=A.x||null!=A.y||null!=A.y2;if(null!=A.x&&(L+=n.XAxisLabelPadding),null!=A.y&&(P+=n.YAxisLabelPadding),null!=A.y2&&(M+=n.YAxisLabelPadding),(S&&(P!==h.right||M!==h.left)||!S&&(P!==h.left||M!==h.right)||L!==h.bottom||this.currentViewport.height!==o.height||this.isXScrollBarVisible||this.isYScrollBarVisible)&&(h.left=S?M:P,h.right=S?P:M,h.bottom=L,this.margin=h,d=s(this.layers,o,h,this.categoryAxisProperties,this.valueAxisProperties),v=o.width-(h.left+h.right)),this.isXScrollBarVisible){p=d.x.scale;var V=this.margin.left,I=o.height;this.renderChartWithScrollBar(p,V,I,g.width,o,d,v,D,N,A,i)}else if(this.isYScrollBarVisible){p=d.y1.scale;var V=o.width,I=this.margin.top;this.renderChartWithScrollBar(p,V,I,g.height,o,d,v,D,N,A,i)}else this.renderChart(p,d,v,D,N,A,o,i);this.updateAxis(o),this.isXScrollBarVisible||this.isYScrollBarVisible||this.brushGraphicsContext.selectAll("rect").remove()},n.prototype.hideAxisLabels=function(e){return this.cartesianSmallViewPortProperties&&this.cartesianSmallViewPortProperties.hideAxesOnSmallViewPort&&this.currentViewport.height+e.height<this.cartesianSmallViewPortProperties.MinHeightAxesVisible&&!this.visualInitOptions.interactivity.isInteractiveLegend?!0:!1},n.prototype.renderChartWithScrollBar=function(e,i,a,r,o,s,l,u,c,h,d){var p,g,f=this,m=e,y=this.scrollScale=m.copy(),v=this.brush,C=this.margin.top,b=this.margin.left,x=this.margin.right,S=this.margin.bottom;this.isXScrollBarVisible?(p=o.width-(b+x),g=this.getMinExtent(r,p),y.rangeBands([0,p]),v.x(y).extent([0,g])):(p=o.height-(C+S),g=this.getMinExtent(r,p),y.rangeBands([0,p]),v.y(y).extent([0,g])),this.brushMinExtent=g,v.on("brush",function(){return window.requestAnimationFrame(function(){return f.onBrushed(y,m,s,l,u,c,h,o,p)})}).on("brushend",function(){return f.onBrushEnd(g)});var w=this.brushContext=this.brushGraphicsContext.attr({transform:t.SVGUtil.translate(i,a),"drag-resize-disabled":"true"}).call(v);w.selectAll(".resize rect").remove(),w.select(".background").style("cursor","pointer"),w.selectAll(".extent").style({"fill-opacity":n.fillOpacity,cursor:"hand"}),this.isXScrollBarVisible?w.selectAll("rect").attr("height",n.ScrollBarWidth):w.selectAll("rect").attr("width",n.ScrollBarWidth),m&&y&&(m.rangeBands([0,p]),this.renderChart(m,s,l,u,c,h,o,d,y,v.extent()))},n.prototype.getMinExtent=function(e,t){return t*t/e},n.prototype.onBrushEnd=function(e){var t=this.brushContext;this.isXScrollBarVisible?t.select(".extent").attr("width",e):t.select(".extent").attr("height",e)},n.prototype.onBrushed=function(e,t,i,a,r,o,s,l,u){var c=this.brush;if(t&&e){n.clampBrushExtent(this.brush,u,this.brushMinExtent);var h=c.extent();this.renderChart(t,i,a,r,o,s,l,!0,e,h)}},n.prototype.setMinBrush=function(e,t){n.clampBrushExtent(this.brush,e,t)},n.clampBrushExtent=function(e,t,i){var a=e.extent(),r=a[1]-a[0];if(!(r===i&&a[1]<=t&&a[0]>=0)){if(r>i){var n=(r-i)/2;a[0]+=n,a[1]-=n}else if(i>r){var n=(i-r)/2;a[0]-=n,a[1]+=n}a[0]<0?(a[0]=0,a[1]=i):a[0]>t-i&&(a[0]=t-i,a[1]=t),e.extent(a)}},n.prototype.getMaxMarginFactor=function(){return this.visualInitOptions.style.maxMarginFactor||n.MaxMarginFactor},n.prototype.renderChart=function(i,a,r,o,s,l,u,c,h,d){var p=this.bottomMarginLimit,g=this.leftMarginLimit,f=this.needRotate,m=this.layers,y=t.AnimatorCommon.GetAnimationDuration(this.animator,c);if(h){var v,C=[],b=d[0],x=d[1],S=h(1)-h(0),w=Math.floor(b/S),T=Math.ceil((x-b)/S),D=w+T,P=h.domain();if(i.domain(P),v=P.slice(w,D),v&&v.length>0){for(var M=0;M<m.length;M++)C[M]=m[M].setFilteredData(v[0],v[v.length-1]+1);i.domain(v);var L;L=this.isXScrollBarVisible?a.x:a.y1,L.axis.scale(i),L.scale(i),L.axis.ticks(v.length),L.axis.tickValues(v);var A=L.axis.tickFormat();L.values=_.map(v,function(e){return A(e)})}}if(this.shouldRenderAxis(a.x)){a.x.axis.orient("bottom"),f&&a.x.axis.tickPadding(n.TickPaddingRotatedX);var N=this.xAxisGraphicsContext;y?N.transition().duration(y).call(a.x.axis).call(n.darkenZeroLine):N.call(a.x.axis).call(n.darkenZeroLine),N.selectAll("text").call(t.AxisHelper.LabelLayoutStrategy.rotate,r,p,e.TextMeasurementService.svgEllipsis,f,p===o.xMax,a.x,this.margin,this.isXScrollBarVisible||this.isYScrollBarVisible)}else this.xAxisGraphicsContext.selectAll("*").remove();if(this.shouldRenderAxis(a.y1)){var V=this.yAxisOrientation,I=V===e.yAxisPosition.right;a.y1.axis.tickSize(r).tickPadding(n.TickPaddingY).orient(V.toLowerCase());var R=this.y1AxisGraphicsContext;y?R.transition().duration(y).call(a.y1.axis).call(n.darkenZeroLine):R.call(a.y1.axis).call(n.darkenZeroLine),!a.y2||this.valueAxisProperties&&null!=this.valueAxisProperties.secShow&&!this.valueAxisProperties.secShow?this.y2AxisGraphicsContext.selectAll("*").remove():(a.y2.axis.tickPadding(n.TickPaddingY).orient(I?e.yAxisPosition.left.toLowerCase():e.yAxisPosition.right.toLowerCase()),y?this.y2AxisGraphicsContext.transition().duration(y).call(a.y2.axis).call(n.darkenZeroLine):this.y2AxisGraphicsContext.call(a.y2.axis).call(n.darkenZeroLine)),o.yLeft>=g&&R.selectAll("text").call(t.AxisHelper.LabelLayoutStrategy.clip,g-n.LeftPadding,e.TextMeasurementService.svgEllipsis)}else this.y1AxisGraphicsContext.selectAll("*").remove(),this.y2AxisGraphicsContext.selectAll("*").remove();if(s){var H=!this.shouldRenderAxis(a.x,"showAxisTitle"),E=!this.shouldRenderAxis(a.y1,"showAxisTitle"),O=this.valueAxisProperties&&null!=this.valueAxisProperties.secShowAxisTitle&&this.valueAxisProperties.secShowAxisTitle===!1;this.renderAxesLabels(l,this.legendMargins.height,u,H,E,O)}else this.axisGraphicsContext.selectAll(".xAxisLabel").remove(),this.axisGraphicsContext.selectAll(".yAxisLabel").remove();for(var M=0,F=m.length;F>M;M++)m[M].render(c)},n.darkenZeroLine=function(e){var t=e.selectAll("g.tick").filter(function(e){return 0===e}).node();t&&d3.select(t).select("line").classed("zero-line",!0)},n.getPreferredPlotArea=function(e,t,i,a,r){var o={height:i.height,width:i.width};if(!r&&a){var s=n.getPreferredCategorySpan(e,t);o.width=Math.max(s,i.width)}return o},n.getPreferredCategorySpan=function(e,t){return t*(e+2*n.OuterPaddingRatio)},n.getLayout=function(e,t){var i=t.categoryCount,a=t.availableWidth,r=t.domain,o=!!t.isScalar,s=!!t.isScrollable,l=n.getCategoryThickness(e?e.series:null,i,a,r,o),u=l*n.OuterPaddingRatio*2,c=Math.round((a-u)/l),h=Math.min(c,i),d=n.OuterPaddingRatio;if(!o){var p=(a-l*h)/2;d=p/l}return!o&&s&&(h=i),{categoryCount:h,categoryThickness:l,outerPaddingRatio:d,isScalar:o}},n.getCategoryThickness=function(e,t,i,a,r){var o;if(2>t)o=i*(1-n.OuterPaddingRatio);else if(r&&a&&a.length>1){var s=n.getMinInterval(e),l=a[a.length-1]-a[0],u=s/(l+s*n.OuterPaddingRatio*2);o=i*u,o=Math.max(o,n.MinScalarRectThickness)}else o=i/(t+2*n.OuterPaddingRatio),o=Math.max(o,n.MinOrdinalRectThickness);var c=i/(3+2*n.OuterPaddingRatio);return!r&&t>=3?Math.max(Math.min(o,c),n.MinOrdinalRectThickness):Math.min(o,c)},n.getMinInterval=function(e){var t=Number.MAX_VALUE;if(e.length>0)for(var i=e[0].data.filter(function(e){return!e.highlight}),a=0,r=i.length-1;r>a;a++)t=Math.min(t,Math.abs(i[a+1].categoryValue-i[a].categoryValue));return t},n.MinOrdinalRectThickness=20,n.MinScalarRectThickness=2,n.OuterPaddingRatio=.4,n.InnerPaddingRatio=.2,n.TickLabelPadding=2,n.ClassName="cartesianChart",n.AxisGraphicsContextClassName="axisGraphicsContext",n.MaxMarginFactor=.25,n.MinBottomMargin=25,n.TopMargin=8,n.LeftPadding=10,n.RightPadding=15,n.BottomPadding=12,n.YAxisLabelPadding=20,n.XAxisLabelPadding=18,n.TickPaddingY=10,n.TickPaddingRotatedX=5,n.FontSize=11,n.FontSizeString=t.SVGUtil.convertToPixelString(n.FontSize),n.ScrollBarWidth=10,n.fillOpacity=.125,n}();t.CartesianChart=c;var h=function(){function e(e){this.palette=e,this.clearPreferredScale()}return e.prototype.getColorScaleByKey=function(e){return this.setPreferredScale(e),this.preferredScale},e.prototype.getNewColorScale=function(){return this.preferredScale},e.prototype.getColorByIndex=function(e){return this.palette.getColorByIndex(e)},e.prototype.getSentimentColors=function(){return this.palette.getSentimentColors()},e.prototype.getBasePickerColors=function(){return this.palette.getBasePickerColors()},e.prototype.clearPreferredScale=function(){this.preferredScale=this.palette.getNewColorScale(),this.rotated=!1},e.prototype.rotateScale=function(){this.preferredScale=this.preferredScale.clone(),this.preferredScale.clearAndRotateScale(),this.rotated=!0},e.prototype.setPreferredScale=function(e){this.rotated||(this.preferredScale=this.palette.getColorScaleByKey(e))},e}();t.SharedColorPalette=h}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){function i(t){return void 0===t&&(t=!1),{dataRoles:[{name:"Category",kind:0,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Axis")},{name:"Series",kind:0,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Legend")},{name:"Y",kind:1,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Value")},{name:"Gradient",kind:1,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Gradient")}],objects:{general:{displayName:e.data.createDisplayNameGetter("Visual_General"),properties:{formatString:{type:{formatting:{formatString:!0}}}}},legend:{displayName:e.data.createDisplayNameGetter("Visual_Legend"),properties:{show:{displayName:e.data.createDisplayNameGetter("Visual_Show"),type:{bool:!0}},position:{displayName:e.data.createDisplayNameGetter("Visual_LegendPosition"),type:{formatting:{legendPosition:!0}}},showTitle:{displayName:e.data.createDisplayNameGetter("Visual_LegendShowTitle"),type:{bool:!0}},titleText:{displayName:e.data.createDisplayNameGetter("Visual_LegendTitleText"),type:{text:!0}}}},categoryAxis:{displayName:t?e.data.createDisplayNameGetter("Visual_YAxis"):e.data.createDisplayNameGetter("Visual_XAxis"),properties:{show:{displayName:e.data.createDisplayNameGetter("Visual_Show"),type:{bool:!0}},position:{displayName:e.data.createDisplayNameGetter("Visual_YAxis_Position"),type:{formatting:{yAxisPosition:!0}}},start:{displayName:e.data.createDisplayNameGetter("Visual_Axis_Start"),type:{numeric:!0}},end:{displayName:e.data.createDisplayNameGetter("Visual_Axis_End"),type:{numeric:!0}},axisType:{displayName:e.data.createDisplayNameGetter("Visual_Axis_Type"),type:{formatting:{axisType:!0}}},showAxisTitle:{displayName:e.data.createDisplayNameGetter("Visual_Axis_Title"),type:{bool:!0}},axisStyle:{displayName:e.data.createDisplayNameGetter("Visual_Axis_Style"),type:{formatting:{axisStyle:!0}}}}},valueAxis:{displayName:t?e.data.createDisplayNameGetter("Visual_XAxis"):e.data.createDisplayNameGetter("Visual_YAxis"),properties:{show:{displayName:e.data.createDisplayNameGetter("Visual_Show"),type:{bool:!0}},position:{displayName:e.data.createDisplayNameGetter("Visual_YAxis_Position"),type:{formatting:{yAxisPosition:!0}}},start:{displayName:e.data.createDisplayNameGetter("Visual_Axis_Start"),type:{numeric:!0}},end:{displayName:e.data.createDisplayNameGetter("Visual_Axis_End"),type:{numeric:!0}},intersection:{displayName:e.data.createDisplayNameGetter("Visual_Axis_Intersection"),type:{numeric:!0}},showAxisTitle:{displayName:e.data.createDisplayNameGetter("Visual_Axis_Title"),type:{bool:!0}},axisStyle:{displayName:e.data.createDisplayNameGetter("Visual_Axis_Style"),type:{formatting:{axisStyle:!0}}}}},dataPoint:{displayName:e.data.createDisplayNameGetter("Visual_DataPoint"),properties:{defaultColor:{displayName:e.data.createDisplayNameGetter("Visual_DefaultColor"),type:{fill:{solid:{color:!0}}}},showAllDataPoints:{displayName:e.data.createDisplayNameGetter("Visual_DataPoint_Show_All"),type:{bool:!0}},fill:{displayName:e.data.createDisplayNameGetter("Visual_Fill"),type:{fill:{solid:{color:!0}}}},fillRule:{displayName:e.data.createDisplayNameGetter("Visual_Gradient"),type:{fillRule:{}},rule:{inputRole:"Gradient",output:{property:"fill",selector:["Category"]}}}}},labels:{displayName:e.data.createDisplayNameGetter("Visual_DataPointsLabels"),properties:{show:{displayName:e.data.createDisplayNameGetter("Visual_Show"),type:{bool:!0}},color:{displayName:e.data.createDisplayNameGetter("Visual_LabelsFill"),type:{fill:{solid:{color:!0}}}},labelDisplayUnits:{displayName:e.data.createDisplayNameGetter("Visual_DisplayUnits"),type:{formatting:{labelDisplayUnits:!0}}},labelPrecision:{displayName:e.data.createDisplayNameGetter("Visual_Precision"),type:{numeric:!0}}}}},dataViewMappings:[{conditions:[{Category:{max:1},Series:{max:0},Gradient:{max:0}},{Category:{max:1},Series:{min:1,max:1},Y:{max:1},Gradient:{max:0}},{Category:{max:1},Series:{max:0},Y:{min:0,max:1},Gradient:{max:1}}],categorical:{categories:{"for":{"in":"Category"},dataReductionAlgorithm:{top:{}}},values:{group:{by:"Series",select:[{"for":{"in":"Y"}},{bind:{to:"Gradient"}}],dataReductionAlgorithm:{top:{}}}},rowCount:{preferred:{min:2},supported:{min:0}}}}],supportsHighlight:!0,sorting:{"default":{}}}}t.getColumnChartCapabilities=i,t.columnChartProps={dataPoint:{defaultColor:{objectName:"dataPoint",propertyName:"defaultColor"},fill:{objectName:"dataPoint",propertyName:"fill"},showAllDataPoints:{objectName:"dataPoint",propertyName:"showAllDataPoints"}},general:{formatString:{objectName:"general",propertyName:"formatString"}},categoryAxis:{axisType:{objectName:"categoryAxis",propertyName:"axisType"}}}}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var i=jsCommon.EnumExtensions,a=jsCommon.ArrayExtensions,r=2,n=4,o=8,s=16,l=32|s;!function(e){e[e.clusteredBar=r|o]="clusteredBar",e[e.clusteredColumn=n|o]="clusteredColumn",e[e.hundredPercentStackedBar=r|l]="hundredPercentStackedBar",e[e.hundredPercentStackedColumn=n|l]="hundredPercentStackedColumn",e[e.stackedBar=r|s]="stackedBar",e[e.stackedColumn=n|s]="stackedColumn"}(t.ColumnChartType||(t.ColumnChartType={}));var u=t.ColumnChartType,c={category:"Category",series:"Series",y:"Y"},h=function(){function o(e){var t=e.chartType;this.chartType=t,this.categoryAxisType=null,this.animator=e.animator,this.isScrollable=e.isScrollable,this.interactivityService=e.interactivityService}return o.customizeQuery=function(e){var i=e.dataViewMappings[0];if(i&&i.categorical&&i.categorical.categories){var r=i.categorical.categories,n=r["for"]["in"].items;if(!a.isUndefinedOrEmpty(n)){var o,s=n[0].type;i.metadata&&(o=i.metadata.objects),t.CartesianChart.getIsScalar(o,t.columnChartProps.categoryAxis.axisType,s)&&(r.dataReductionAlgorithm={sample:{}})}}},o.getSortableRoles=function(e){var i=e.dataViewMappings[0];if(!i||!i.categorical||!i.categorical.categories)return null;var r=i.categorical.categories,n=r["for"]["in"].items;if(!a.isUndefinedOrEmpty(n)){var o,s=n[0].type;if(i.metadata&&(o=i.metadata.objects),!t.CartesianChart.getIsScalar(o,t.columnChartProps.categoryAxis.axisType,s))return["Category","Y"]}return null},o.prototype.updateVisualMetadata=function(e,t,i){this.xAxisProperties=e,this.yAxisProperties=t,this.margin=i},o.prototype.init=function(e){this.svg=e.svg,this.clearCatcher=this.svg.select(".clearCatcher"),this.mainGraphicsContext=this.svg.append("g").classed("columnChartMainGraphicsContext",!0),this.style=e.style,this.currentViewport=e.viewport,this.hostService=e.host,this.interactivity=e.interactivity,this.colors=this.style.colorPalette.dataColors,this.cartesianVisualHost=e.cartesianHost,this.options=e,this.supportsOverflow=!i.hasFlag(this.chartType,s);var a=this.element=e.element;switch(a.addClass(o.ColumnChartClassName),this.chartType){case u.clusteredBar:this.columnChart=new t.ClusteredBarChartStrategy;break;case u.clusteredColumn:this.columnChart=new t.ClusteredColumnChartStrategy;break;case u.stackedBar:case u.hundredPercentStackedBar:this.columnChart=new t.StackedBarChartStrategy;break;case u.stackedColumn:case u.hundredPercentStackedColumn:default:this.columnChart=new t.StackedColumnChartStrategy}},o.prototype.getCategoryLayout=function(e,a){var n;n=i.hasFlag(this.chartType,r)?this.currentViewport.height-(this.margin.top+this.margin.bottom):this.currentViewport.width-(this.margin.left+this.margin.right);var o=this.data?this.data.categoryMetadata:void 0,s=t.AxisHelper.getCategoryValueType(o),l=this.data?this.data.scalarCategoryAxis:!1,u=t.AxisHelper.createDomain(this.data.series,s,l,a.forcedXDomain);return t.CartesianChart.getLayout(this.data,{availableWidth:n,categoryCount:e,domain:u,isScalar:l,isScrollable:this.isScrollable})},o.converter=function(a,r,s,l,u,h,p){void 0===s&&(s=!1),void 0===l&&(l=!1),void 0===u&&(u=!1),void 0===h&&(h=null);var g=t.CartesianHelper.getCategoryAxisProperties(h),f=t.CartesianHelper.getValueAxisProperties(h);l=t.CartesianHelper.isScalar(l,g),a=t.ColumnUtil.applyUserMinMax(l,a,g);var m=new d(a),y=t.converterHelper.getPivotedCategories(a,t.columnChartProps.general.formatString),v=y.categories,C=y.categoryFormatter,b=y.categoryIdentities,x=a.categories&&a.categories.length>0?a.categories[0].source:void 0,S=t.dataLabelUtils.getDefaultColumnLabelSettings(s);if(h&&h.objects){var w=h.objects,_=e.DataViewObjects.getFillColor(w,t.columnChartProps.dataPoint.defaultColor),T=e.DataViewObjects.getValue(w,t.columnChartProps.dataPoint.showAllDataPoints),D=w.labels;D&&(void 0!==D.show&&(S.show=D.show),void 0!==D.color&&(S.labelColor=D.color.solid.color),void 0!==D.labelDisplayUnits&&(S.displayUnits=D.labelDisplayUnits),void 0!==D.labelPrecision&&(S.precision=D.labelPrecision>=0?D.labelPrecision:0))}for(var P=m.getLegend(r,_),M=P.legend.dataPoints,L=P.seriesSources,A=o.createDataPoints(a,v,b,M,P.seriesObjects,m,S,s,l,u,t.converterHelper.categoryIsAlsoSeriesRole(a,c.series,c.category),y.categoryObjects,_,p,x),N=A.series,V=[],I=0,R=M.length;R>I;I++)V.push(L[I]);var H=t.converterHelper.createAxesLabels(g,f,x,V);if(!i.hasFlag(p,n)){var E=H.xAxisLabel;H.xAxisLabel=H.yAxisLabel,H.yAxisLabel=E}return{categories:v,categoryFormatter:C,series:N,valuesMetadata:V,legendData:P.legend,hasHighlights:A.hasHighlights,categoryMetadata:x,scalarCategoryAxis:l,labelSettings:S,axesLabels:{x:H.xAxisLabel,y:H.yAxisLabel},hasDynamicSeries:A.hasDynamicSeries,defaultDataPointColor:_,showAllDataPoints:T,hasSelection:!1}},o.createDataPoints=function(e,a,r,n,l,u,c,h,d,p,g,f,m,y,v){void 0===h&&(h=!1),void 0===d&&(d=!1),void 0===p&&(p=!1);var C=e&&e.values?e.values.grouped():void 0,b=a.length,x=n.length,S=[];if(1>x||1>b)return{series:S,hasHighlights:!1,hasDynamicSeries:!1};for(var w=e.categories,v=w&&w.length>0?w[0].source:null,_=t.AxisHelper.getCategoryValueType(v),T=t.AxisHelper.isDateTime(_),D=[],P=[],M=[],L=[],A=!(!e.values||!e.values.source),N=!1,V=u.hasHighlightValues(0),I=0;x>I;I++){for(var R=[],H=[],E=0;b>E;E++){var O=u.getValueBySeriesAndCategory(I,E);if(R[E]=O,V){var F=u.getHighlightBySeriesAndCategory(I,E);H[E]=F,O>=0&&F>=0&&O>=F||0>=O&&0>=F&&F>=O||(N=!0)}}M.push(R),V&&L.push(H)}N&&!p&&(N=!1,V=!1,M=L);for(var G=f,z=t.columnChartProps.general.formatString,I=0;x>I;I++){var W=[],U=n[I];S.push({displayName:U.label,key:"series"+I,index:I,data:W,identity:U.identity,color:U.color}),x>1&&(G=l[I]);for(var B=e.values[I].source,E=0;b>E;E++){0===I&&(D.push(0),P.push(0));var O=t.AxisHelper.normalizeNonFiniteNumber(M[I][E]);if(!(null==O&&I>0)){var k=O,j=a[E];if(T&&j&&(j=j.getTime()),!d||null!=j&&!isNaN(j)){var q;h&&(q=t.StackedUtil.getStackedMultiplier(e,E,x,b,u));var Y=O,Q=0>O;q&&(O*=Q?q.neg:q.pos);var X,K=Math.abs(O);Q?(X=P[E],isNaN(K)||(P[E]-=K)):(isNaN(K)||(D[E]+=K),X=D[E]);var $;v&&r&&($={queryName:v?v.queryName:void 0,data:r?r[E]:void 0});var Z;A&&(Z={queryName:e.values.source.queryName,data:C[I].identity});var J=t.SelectionId.createWithIdsAndMeasureAndCategory($,Z,u.getMeasureNameByIndex(I)),ee=a[E],te=o.getDataPointColor(U,E,G),ie=t.TooltipBuilder.createTooltipInfo(z,e.categories,ee,e.values,k,null,I),ae=c.labelColor;if(i.hasFlag(y,s)){var re=this.getStackedLabelColor(Q,I,x,E,M);ae=re||I===x-1&&!Q?ae:t.dataLabelUtils.defaultInsideLabelColor}var ne={categoryValue:j,value:O,position:X,valueAbsolute:K,valueOriginal:Y,seriesIndex:I,categoryIndex:E,color:te,selected:!1,originalValue:O,originalPosition:X,originalValueAbsolute:K,identity:J,key:J.getKey(),tooltipInfo:ie,labelFill:ae,labelFormatString:B.format,lastSeries:re,chartType:y};if(W.push(ne),V){var oe=L[I][E],se=oe,le=!0;null===oe&&(oe=0,le=!1),h&&(oe*=q.pos);var ue=Math.abs(oe),ce=X;oe>0?ce-=K-ue:0===oe&&O>0&&(ce-=K);var he=t.SelectionId.createWithHighlight(J),ee=a[E],de=le?oe:void 0,ie=t.TooltipBuilder.createTooltipInfo(z,e.categories,ee,e.values,k,null,I,de);le&&(ne.tooltipInfo=ie);var pe={categoryValue:j,value:oe,position:ce,valueAbsolute:ue,valueOriginal:se,seriesIndex:I,categoryIndex:E,color:te,selected:!1,highlight:!0,originalValue:O,originalPosition:X,originalValueAbsolute:K,drawThinner:N,identity:he,key:he.getKey(),tooltipInfo:ie,labelFormatString:B.format,labelFill:c.labelColor,lastSeries:re,chartType:y};W.push(pe)}}}}}return{series:S,hasHighlights:V,hasDynamicSeries:A}},o.getDataPointColor=function(i,a,r){if(r){var n=e.DataViewObjects.getFillColor(r[a],t.columnChartProps.dataPoint.fill);if(n)return n}return i.color},o.getStackedLabelColor=function(e,i,a,r,n){for(var o=!(e&&i===a-1&&1!==a),s=i+1;a>s;s++){var l=t.AxisHelper.normalizeNonFiniteNumber(n[s][r]);if(null!==l&&((!e||e&&0===i)&&l>0||e&&0!==i)){o=!1;break}}return o},o.sliceSeries=function(t,i,a){void 0===a&&(a=0);var r=[];if(t&&t.length>0)for(var n=0,o=t.length;o>n;n++){var s=r[n]=e.Prototype.inherit(t[n]);s.data=t[n].data.filter(function(e){return e.categoryIndex>=a&&e.categoryIndex<i})}return r},o.getForcedTickValues=function(e,t,i){if(1>=i)return[];for(var a=[],r=(t-e)/(i-1),n=0;i-1>n;n++)a.push(e+n*r);return a.push(t),-1===a.indexOf(0)&&a.push(0),a},o.getTickInterval=function(e){return 0===e.length?0:1===e.length?e[0]:(e.sort(function(e,t){return e-t}),e[1]-e[0])},o.getInteractiveLegendDomElement=function(e){return e.children(".interactive-legend").get(0)},o.prototype.setData=function(e){var a=i.hasFlag(this.chartType,l);if(this.data={categories:[],categoryFormatter:null,series:[],valuesMetadata:[],legendData:null,hasHighlights:!1,categoryMetadata:null,scalarCategoryAxis:!1,labelSettings:t.dataLabelUtils.getDefaultColumnLabelSettings(a),axesLabels:{x:null,y:null},hasDynamicSeries:!1,defaultDataPointColor:null,hasSelection:!1},e.length>0){var r=e[0];if(r&&r.categorical){var n=this.dataViewCat=r.categorical,s=n.categories,u=s&&s.length>0?s[0].source:null,c=t.AxisHelper.getCategoryValueType(u);this.data=o.converter(n,this.cartesianVisualHost.getSharedColors(),a,t.CartesianChart.getIsScalar(r.metadata?r.metadata.objects:null,t.columnChartProps.categoryAxis.axisType,c),this.supportsOverflow,r.metadata,this.chartType);for(var h=this.data.series,d=0,p=h.length;p>d;d++){var g=h[d];this.interactivityService&&this.interactivityService.applySelectionStateToData(g.data)&&(this.data.hasSelection=!0)}}}},o.prototype.calculateLegend=function(){if(this.interactivity&&this.interactivity.isInteractiveLegend)return this.createInteractiveLegendDataPoints(0);var e=this.data?this.data.legendData:null,t=e?e.dataPoints:[];return a.isUndefinedOrEmpty(t)?null:e},o.prototype.hasLegend=function(){return this.data&&(this.data.hasDynamicSeries||this.data.series&&this.data.series.length>1)},o.prototype.enumerateObjectInstances=function(e){switch(e.objectName){case"dataPoint":if(!t.GradientUtils.hasGradientRole(this.dataViewCat))return this.enumerateDataPoints();break;case"labels":return i.hasFlag(this.chartType,l)?t.dataLabelUtils.enumerateDataLabels(this.data.labelSettings,!1):t.dataLabelUtils.enumerateDataLabels(this.data.labelSettings,!1,!0,!0)}return null},o.prototype.enumerateDataPoints=function(){var e=this.data;if(e){var i=[],a=e.series.length;if(0===a)return i;if(e.hasDynamicSeries||a>1||!e.categoryMetadata)for(var r=0;a>r;r++){var n=e.series[r];i.push({objectName:"dataPoint",displayName:n.displayName,selector:t.ColorHelper.normalizeSelector(n.identity.getSelector()),properties:{fill:{solid:{color:n.color}}}})}else{var o=e.series[0].data,s=e.categoryFormatter;i.push({objectName:"dataPoint",selector:null,properties:{defaultColor:{solid:{color:e.defaultDataPointColor||this.colors.getColorByIndex(0).value}}}},{objectName:"dataPoint",selector:null,properties:{showAllDataPoints:!!e.showAllDataPoints}});for(var r=0;r<o.length;r++){var l=o[r],u=e.categories[r];i.push({objectName:"dataPoint",displayName:s?s.format(u):u,selector:t.ColorHelper.normalizeSelector(l.identity.getSelector(),!0),properties:{fill:{solid:{color:l.color}}}})}}return i}},o.prototype.calculateAxesProperties=function(a){var n=this.data;this.currentViewport=a.viewport;var s=this.margin=a.margin,u=n&&n.categories?n.categories.length:0,c=n?this.getCategoryLayout(u,a):{categoryCount:0,categoryThickness:t.CartesianChart.MinOrdinalRectThickness,outerPaddingRatio:t.CartesianChart.OuterPaddingRatio,isScalar:!1};if(this.categoryAxisType=c.isScalar?e.axisType.scalar:null,n&&!c.isScalar&&!this.isScrollable){var h=Math.min(u,c.categoryCount);h!==u&&(n=e.Prototype.inherit(n),n.series=o.sliceSeries(n.series,h),n.categories=n.categories.slice(0,h))}this.columnChart.setData(n);var d=this.getPreferredPlotArea(c.isScalar,c.categoryCount,c.categoryThickness);d.width===this.currentViewport.width&&(d.width-=s.left+s.right),d.height-=s.top+s.bottom;var p=i.hasFlag(this.chartType,l),g={height:d.height,width:d.width,duration:0,hostService:this.hostService,mainGraphicsContext:this.mainGraphicsContext,margin:this.margin,layout:c,animator:this.animator,interactivityService:this.interactivityService,viewportHeight:this.currentViewport.height-(s.top+s.bottom),is100Pct:p};if(this.ApplyInteractivity(g),this.columnChart.setupVisualProps(g),i.hasFlag(this.chartType,r)){var f=a.forcedXDomain;a.forcedXDomain=a.forcedYDomain,a.forcedYDomain=f}return this.xAxisProperties=this.columnChart.setXScale(p,a.forcedTickCount,a.forcedXDomain),this.yAxisProperties=this.columnChart.setYScale(p,a.forcedTickCount,a.forcedYDomain),a.showCategoryAxisLabel&&this.xAxisProperties.isCategoryAxis||a.showValueAxisLabel&&!this.xAxisProperties.isCategoryAxis?this.xAxisProperties.axisLabel=n.axesLabels.x:this.xAxisProperties.axisLabel=null,a.showValueAxisLabel&&!this.yAxisProperties.isCategoryAxis||a.showCategoryAxisLabel&&this.yAxisProperties.isCategoryAxis?this.yAxisProperties.axisLabel=n.axesLabels.y:this.yAxisProperties.axisLabel=null,[this.xAxisProperties,this.yAxisProperties]},o.prototype.getPreferredPlotArea=function(e,a,n){var o={height:this.currentViewport.height,width:this.currentViewport.width};if(this.isScrollable&&!e){var s=t.CartesianChart.getPreferredCategorySpan(a,n);i.hasFlag(this.chartType,r)?o.height=Math.max(s,o.height):o.width=Math.max(s,o.width)}return o},o.prototype.ApplyInteractivity=function(e){var t=this,i=this.interactivity;if(i&&(i.dragDataPoint&&(e.onDragStart=function(e){e.identity&&t.hostService.onDragStart({event:d3.event,data:{data:e.identity.getSelector()}})}),i.isInteractiveLegend)){var a=function(){var e=d3.mouse(t.mainGraphicsContext[0][0]),i=e[0],a=e[1],r=t.columnChart.getClosestColumnIndex(i,a);t.selectColumn(r)},r=o.getInteractiveLegendDomElement(this.element);this.svg.on("click",a),d3.select(r).on("click",a);var n=d3.behavior.drag().origin(Object).on("drag",a);this.svg.call(n),d3.select(r).call(n)}},o.prototype.selectColumn=function(e,t){if(void 0===t&&(t=!1),t||this.lastInteractiveSelectedColumnIndex!==e){var i=this.createInteractiveLegendDataPoints(e),a=i.dataPoints;this.cartesianVisualHost.updateLegend(i),a.length>0&&this.columnChart.selectColumn(e,this.lastInteractiveSelectedColumnIndex),this.lastInteractiveSelectedColumnIndex=e}},o.prototype.createInteractiveLegendDataPoints=function(e){var i=this.data;if(!i||a.isUndefinedOrEmpty(i.series))return{dataPoints:[]};for(var r=t.columnChartProps.general.formatString,n=[],o=i.categories&&i.categories[e],s=i.series,l=i.legendData&&i.legendData.dataPoints,u=new d(this.dataViewCat),c=0,h=s.length;h>c;c++){var p=u.getValueBySeriesAndCategory(c,e),g=i.valuesMetadata[c],f=t.converterHelper.getFormattedLegendLabel(g,this.dataViewCat.values,r),m=l.length>=c&&l[c].color;n.push({color:m,icon:t.LegendIcon.Box,label:f,category:i.categoryFormatter?i.categoryFormatter.format(o):o,measure:t.valueFormatter.format(p,t.valueFormatter.getFormatString(g,r)),identity:t.SelectionId.createNull(),selected:!1})}return{dataPoints:n
}},o.prototype.overrideXScale=function(e){this.xAxisProperties=e},o.prototype.render=function(e){var i=this.columnChart.drawColumns(!e),a=this.data;if(t.TooltipManager.addTooltip(i.shapesSelection,function(e){return e.data.tooltipInfo}),this.interactivityService){for(var r=[],n=0,o=a.series.length;o>n;n++)r=r.concat(a.series[n].data);var s={bars:i.shapesSelection,datapoints:r,clearCatcher:this.clearCatcher,hasHighlights:a.hasHighlights,mainGraphicsContext:this.mainGraphicsContext,labelLayout:i.labelLayout,viewport:i.viewport,axisOptions:i.axisOptions,showLabel:a.labelSettings.show};this.interactivityService.apply(this,s)}this.interactivity&&this.interactivity.isInteractiveLegend&&this.data.series.length>0&&this.selectColumn(0,!0),t.SVGUtil.flushAllD3TransitionsIfNeeded(this.options)},o.prototype.onClearSelection=function(){this.interactivityService&&this.interactivityService.clearSelection()},o.prototype.accept=function(e,t){e.visitColumnChart(t)},o.prototype.getVisualCategoryAxisIsScalar=function(){return this.data?this.data.scalarCategoryAxis:!1},o.prototype.getSupportedCategoryAxisType=function(){var i=this.data?this.data.categoryMetadata:void 0,a=t.AxisHelper.getCategoryValueType(i),r=t.AxisHelper.isOrdinal(a);return r?e.axisType.categorical:e.axisType.both},o.prototype.setFilteredData=function(t,i){var a=e.Prototype.inherit(this.data);return a.series=o.sliceSeries(a.series,i,t),a.categories=a.categories.slice(t,i),this.columnChart.setData(a),a},o.ColumnChartClassName="columnChart",o.SeriesClasses={"class":"series",selector:".series"},o}();t.ColumnChart=h;var d=function(){function e(e){this.dataView=e}return e.prototype.getLegend=function(e,i){var a=[],r=[],n=[],o=!1,s=new t.ColorHelper(e,t.columnChartProps.dataPoint.fill,i);if(this.dataView&&this.dataView.values){for(var l=this.dataView.values,u=l.grouped(),c=!(!l||!l.source),h=t.columnChartProps.general.formatString,d=0,p=u.length;p>d;d++)for(var g=u[d],f=g.objects,m=g.values,y=0,v=m.length;v>y;y++){var C=m[y],b=C.source;if(!t.DataRoleHelper.hasRole(b,"Gradient")||t.DataRoleHelper.hasRole(b,"Y")){r.push(b),n.push(C.objects);var x=C.identity?t.SelectionId.createWithIdAndMeasure(C.identity,b.queryName):t.SelectionId.createWithMeasure(this.getMeasureNameByIndex(y)),S=t.converterHelper.getFormattedLegendLabel(b,l,h),w=c?s.getColorForSeriesValue(f||b.objects,l.identityFields,b.groupName):s.getColorForMeasure(f||b.objects,b.queryName);a.push({icon:t.LegendIcon.Box,color:w,label:S,identity:x,selected:!1}),C.identity&&void 0!==b.groupName&&(o=!0)}}var _=this.dataView.values,T=_&&_.source?_.source.displayName:""}var D={title:T,dataPoints:a,grouped:o};return{legend:D,seriesSources:r,seriesObjects:n}},e.prototype.getValueBySeriesAndCategory=function(e,t){return this.dataView.values[e].values[t]},e.prototype.getMeasureNameByIndex=function(e){return this.dataView.values[e].source.queryName},e.prototype.hasHighlightValues=function(e){var t=this.dataView&&this.dataView.values?this.dataView.values[e]:void 0;return t&&!!t.highlights},e.prototype.getHighlightBySeriesAndCategory=function(e,t){return this.dataView.values[e].highlights[t]},e}()}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var i=function(){function i(){}return i.prototype.setupVisualProps=function(e){this.graphicsContext=e,this.margin=e.margin,this.width=this.graphicsContext.width,this.height=this.graphicsContext.height,this.categoryLayout=e.layout,this.animator=e.animator,this.interactivityService=e.interactivityService,this.viewportHeight=e.viewportHeight},i.prototype.setData=function(e){this.data=e},i.prototype.setXScale=function(e,i,a){var r,n,o=this.width;a&&2===a.length&&(r=a[0],n=a[1]);var s=this.xProps=t.ColumnUtil.getCategoryAxis(this.data,o,this.categoryLayout,!1,r,n),l=this.data.series.length,u=this.categoryLayout.categoryThickness*(1-t.CartesianChart.InnerPaddingRatio)/l;return this.seriesOffsetScale=d3.scale.ordinal().domain(this.data.series.map(function(e){return e.index})).rangeBands([0,l*u]),s},i.prototype.setYScale=function(i,a,r){var n=this.viewportHeight,o=t.AxisHelper.createValueDomain(this.data.series,!0)||t.fallBackDomain,s=t.AxisHelper.getRecommendedNumberOfTicksForYAxis(n),l=t.ColumnUtil.getTickCount(o[0],o[1],this.data.valuesMetadata,s,i,a),u=t.AxisHelper.normalizeLinearDomain({min:o[0],max:o[1]});o=[u.min,u.max];var c=t.AxisHelper.combineDomain(r,o),h=d3.scale.linear().range([n,0]).domain(c).nice(l||void 0).clamp(t.AxisHelper.scaleShouldClamp(c,o));t.ColumnUtil.normalizeInfinityInScale(h);var d=t.AxisHelper.getCategoryValueType(this.data.valuesMetadata[0],!0),p=t.valueFormatter.getFormatString(this.data.valuesMetadata[0],t.columnChartProps.general.formatString),g=t.AxisHelper.getMinTickValueInterval(p,d),f=t.AxisHelper.getRecommendedTickValuesForALinearRange(l,h,g),m=d3.svg.axis().scale(h).tickValues(f),y=t.ColumnChart.getTickInterval(f),v=t.ClusteredUtil.createValueFormatter(this.data.valuesMetadata,y);m.tickFormat(v.format);var C=f.map(function(e){return v.format(e)}),b=this.yProps={axis:m,scale:h,formatter:v,values:C,axisType:e.ValueType.fromDescriptor({text:!0}),axisLabel:null,isCategoryAxis:!1};return b},i.prototype.drawColumns=function(e){var a=this.data;this.columnsCenters=null;var r=this.categoryLayout.categoryThickness*(1-t.CartesianChart.InnerPaddingRatio),n=r/a.series.length,o={columnWidth:n,categoryWidth:r,xScale:this.xProps.scale,yScale:this.yProps.scale,seriesOffsetScale:this.seriesOffsetScale,isScalar:this.categoryLayout.isScalar,margin:this.margin},s=i.getLayout(a,o),l=a.labelSettings,u=null;null!=l&&(u=t.dataLabelUtils.getColumnChartLabelLayout(a,this.getLabelLayoutXY(o,l),!0,!1,this.yProps.formatter,o,this.interactivityService));var c,h,d=t.ColumnUtil.drawSeries(a,this.graphicsContext.mainGraphicsContext,o);return this.animator&&e&&(c=this.animator.animate({viewModel:a,series:d,layout:s,itemCS:i.classes.item,interactivityService:this.interactivityService,mainGraphicsContext:this.graphicsContext.mainGraphicsContext,labelLayout:u,viewPort:{height:this.height,width:this.width}}),h=c.shapes),this.animator&&e&&!c.failed||(h=t.ColumnUtil.drawDefaultShapes(a,d,s,i.classes.item,!this.animator),null!==u&&(l.show?t.ColumnUtil.drawDefaultLabels(d,this.graphicsContext.mainGraphicsContext,u,{height:this.height,width:this.width}):t.dataLabelUtils.cleanDataLabels(this.graphicsContext.mainGraphicsContext))),t.ColumnUtil.applyInteractivity(h,this.graphicsContext.onDragStart),{shapesSelection:h,labelLayout:u,viewport:{height:this.height,width:this.width},axisOptions:o}},i.prototype.selectColumn=function(e,a){t.ColumnUtil.setChosenColumnOpacity(this.graphicsContext.mainGraphicsContext,i.classes.item.selector,e,a),this.moveHandle(e)},i.prototype.getClosestColumnIndex=function(e,i){return t.ColumnUtil.getClosestColumnIndex(e,this.getColumnsCenters())},i.prototype.getColumnsCenters=function(){var e=this;if(!this.columnsCenters){var i=this.categoryLayout.categoryThickness*(1-t.CartesianChart.InnerPaddingRatio);if(this.data.series.length>0){var a=0;this.categoryLayout.isScalar||(a=i/2);var r=this.data.series[0];this.columnsCenters=r.data.map(function(t){return e.xProps.scale(e.categoryLayout.isScalar?t.categoryValue:t.categoryIndex)+a})}}return this.columnsCenters},i.prototype.moveHandle=function(e){var t=this.getColumnsCenters(),i=t[e];if(this.columnSelectionLineHandle){var a=this.columnSelectionLineHandle;a.select("line").attr({x1:i,x2:i}),a.select("circle").attr({cx:i})}else{var a=this.columnSelectionLineHandle=this.graphicsContext.mainGraphicsContext.append("g");a.append("line").classed("interactive-hover-line",!0).attr({x1:i,x2:i,y1:0,y2:this.height}),a.append("circle").attr({cx:i,cy:this.height,r:"6px"}).classed("drag-handle",!0)}},i.getLayout=function(e,i){var a=i.columnWidth,r=.5*a,n=r/2,o=i.isScalar,s=i.xScale,l=i.yScale,u=i.seriesOffsetScale,c=l(0),h=0;return o&&(h=i.categoryWidth/2),{shapeLayout:{width:function(e){return e.drawThinner?r:a},x:function(e){return s(o?e.categoryValue:e.categoryIndex)+u(e.seriesIndex)-h+(e.drawThinner?n:0)},y:function(e){return c+t.AxisHelper.diffScaled(l,Math.max(0,e.value),0)},height:function(e){return Math.abs(t.AxisHelper.diffScaled(l,0,e.value))}},shapeLayoutWithoutHighlights:{width:function(e){return a},x:function(e){return s(o?e.categoryValue:e.categoryIndex)+u(e.seriesIndex)-h},y:function(e){return c+t.AxisHelper.diffScaled(l,Math.max(0,e.originalValue),0)},height:function(e){return Math.abs(t.AxisHelper.diffScaled(l,0,e.originalValue))}},zeroShapeLayout:{width:function(e){return e.drawThinner?r:a},x:function(e){return s(o?e.categoryValue:e.categoryIndex)+u(e.seriesIndex)-h+(e.drawThinner?n:0)},y:function(e){return c},height:function(e){return 0}}}},i.prototype.getLabelLayoutXY=function(e,i){var a=e.columnWidth,r=.5*a,n=e.isScalar,o=e.xScale,s=e.yScale,l=e.seriesOffsetScale,u=0,c=s(0);return n&&(u=e.categoryWidth/2),{x:function(e){return o(n?e.categoryValue:e.categoryIndex)+l(e.seriesIndex)-u+r},y:function(i){var a=t.ColumnUtil.calculatePosition(i,e),r=c+t.AxisHelper.diffScaled(s,Math.max(0,i.value),0)/2-t.dataLabelUtils.defaultColumnLabelMargin;return 0>=a?(i.labelFill=t.dataLabelUtils.defaultInsideLabelColor,r):a}}},i.classes={item:{"class":"column",selector:".column"}},i}();t.ClusteredColumnChartStrategy=i;var a=function(){function i(){}return i.prototype.setupVisualProps=function(e){this.graphicsContext=e,this.margin=e.margin,this.width=this.graphicsContext.width,this.height=this.graphicsContext.height,this.categoryLayout=e.layout,this.animator=e.animator,this.interactivityService=e.interactivityService,this.viewportHeight=e.viewportHeight},i.prototype.setData=function(e){this.data=e},i.prototype.setYScale=function(e,i,a){var r,n,o=this.height;a&&2===a.length&&(r=a[0],n=a[1]);var s=this.yProps=t.ColumnUtil.getCategoryAxis(this.data,o,this.categoryLayout,!0,r,n),l=this.data.series.length,u=this.categoryLayout.categoryThickness*(1-t.CartesianChart.InnerPaddingRatio)/l;return this.seriesOffsetScale=d3.scale.ordinal().domain(this.data.series.map(function(e){return e.index})).rangeBands([0,l*u]),s},i.prototype.setXScale=function(i,a,r){var n=this.width,o=this.viewportHeight,s=t.AxisHelper.createValueDomain(this.data.series,!0)||t.fallBackDomain,l=t.AxisHelper.getBestNumberOfTicks(s[0],s[1],this.data.valuesMetadata,t.AxisHelper.getRecommendedNumberOfTicksForXAxis(n)),u=t.AxisHelper.normalizeLinearDomain({min:s[0],max:s[1]});s=[u.min,u.max];var c=t.AxisHelper.combineDomain(r,s),h=d3.scale.linear().range([0,n]).domain(c).nice(l||void 0).clamp(t.AxisHelper.scaleShouldClamp(c,s));t.ColumnUtil.normalizeInfinityInScale(h);var d=t.AxisHelper.getCategoryValueType(this.data.valuesMetadata[0],!0),p=t.valueFormatter.getFormatString(this.data.valuesMetadata[0],t.columnChartProps.general.formatString),g=t.AxisHelper.getMinTickValueInterval(p,d),f=t.AxisHelper.getRecommendedTickValuesForALinearRange(l,h,g),m=d3.svg.axis().scale(h).tickSize(-o,0).tickValues(f),y=t.ColumnChart.getTickInterval(f),v=t.ClusteredUtil.createValueFormatter(this.data.valuesMetadata,y);m.tickFormat(v.format);var C=f.map(function(e){return v.format(e)}),b=this.xProps={axis:m,scale:h,formatter:v,values:C,axisType:e.ValueType.fromDescriptor({numeric:!0}),axisLabel:null,isCategoryAxis:!1};return b},i.prototype.drawColumns=function(e){var a=this.data;this.barsCenters=null;var r=this.categoryLayout.categoryThickness*(1-t.CartesianChart.InnerPaddingRatio),n=r/a.series.length,o={columnWidth:n,categoryWidth:r,xScale:this.xProps.scale,yScale:this.yProps.scale,seriesOffsetScale:this.seriesOffsetScale,isScalar:this.categoryLayout.isScalar,margin:this.margin},s=i.getLayout(a,o),l=a.labelSettings,u=null;null!=l&&(u=t.dataLabelUtils.getColumnChartLabelLayout(a,this.getLabelLayoutXY(o,this.width,l),!1,!1,this.xProps.formatter,o,this.interactivityService,this.width));var c,h,d=t.ColumnUtil.drawSeries(a,this.graphicsContext.mainGraphicsContext,o);return this.animator&&e&&(c=this.animator.animate({viewModel:a,series:d,layout:s,itemCS:i.classes.item,interactivityService:this.interactivityService,mainGraphicsContext:this.graphicsContext.mainGraphicsContext,labelLayout:u,viewPort:{height:this.height,width:this.width}}),h=c.shapes),this.animator&&e&&!c.failed||(h=t.ColumnUtil.drawDefaultShapes(a,d,s,i.classes.item,!this.animator),null!==u&&(l.show?t.ColumnUtil.drawDefaultLabels(d,this.graphicsContext.mainGraphicsContext,u,{height:this.height,width:this.width}):t.dataLabelUtils.cleanDataLabels(this.graphicsContext.mainGraphicsContext))),t.ColumnUtil.applyInteractivity(h,this.graphicsContext.onDragStart),{shapesSelection:h,labelLayout:u,viewport:{height:this.height,width:this.width},axisOptions:o}},i.prototype.selectColumn=function(e,a){t.ColumnUtil.setChosenColumnOpacity(this.graphicsContext.mainGraphicsContext,i.classes.item.selector,e,a),this.moveHandle(e)},i.prototype.getClosestColumnIndex=function(e,i){return t.ColumnUtil.getClosestColumnIndex(i,this.getBarsCenters())},i.prototype.getBarsCenters=function(){var e=this;if(!this.barsCenters){var i=this.categoryLayout.categoryThickness*(1-t.CartesianChart.InnerPaddingRatio);if(this.data.series.length>0){var a=0;this.categoryLayout.isScalar||(a=i/2);var r=this.data.series[0];this.barsCenters=r.data.map(function(t){return e.yProps.scale(e.categoryLayout.isScalar?t.categoryValue:t.categoryIndex)+a})}}return this.barsCenters},i.prototype.moveHandle=function(e){var t=this.getBarsCenters(),i=t[e];if(this.columnSelectionLineHandle){var a=this.columnSelectionLineHandle;a.select("line").attr({y1:i,y2:i}),a.select("circle").attr({cy:i})}else{var a=this.columnSelectionLineHandle=this.graphicsContext.mainGraphicsContext.append("g");a.append("line").classed("interactive-hover-line",!0).attr({x1:0,x2:this.width,y1:i,y2:i}),a.append("circle").attr({cx:0,cy:i,r:"6px"}).classed("drag-handle",!0)}},i.getLayout=function(e,i){var a=i.columnWidth,r=.5*a,n=r/2,o=i.isScalar,s=i.xScale,l=i.yScale,u=i.seriesOffsetScale,c=s(0),h=0;return o&&(h=i.categoryWidth/2),{shapeLayout:{width:function(e){return Math.abs(t.AxisHelper.diffScaled(s,0,e.value))},x:function(e){return c+t.AxisHelper.diffScaled(s,Math.min(0,e.value),0)},y:function(e){return l(o?e.categoryValue:e.categoryIndex)+u(e.seriesIndex)-h+(e.drawThinner?n:0)},height:function(e){return e.drawThinner?r:a}},shapeLayoutWithoutHighlights:{width:function(e){return Math.abs(t.AxisHelper.diffScaled(s,0,e.originalValue))},x:function(e){return c+t.AxisHelper.diffScaled(s,Math.min(0,e.originalValue),0)},y:function(e){return l(o?e.categoryValue:e.categoryIndex)+u(e.seriesIndex)-h},height:function(e){return a}},zeroShapeLayout:{width:function(e){return 0},x:function(e){return c+t.AxisHelper.diffScaled(s,Math.min(0,e.value),0)},y:function(e){return l(o?e.categoryValue:e.categoryIndex)+u(e.seriesIndex)-h+(e.drawThinner?n:0)},height:function(e){return e.drawThinner?r:a}}}},i.prototype.getLabelLayoutXY=function(i,a,r){var n=i.columnWidth,o=.5*n,s=i.isScalar,l=i.xScale,u=i.yScale,c=i.seriesOffsetScale,h=0,d=l(0);return s&&(h=i.categoryWidth/2),{x:function(r){var n={text:r.labeltext,fontFamily:t.dataLabelUtils.LabelTextProperties.fontFamily,fontSize:t.dataLabelUtils.LabelTextProperties.fontSize,fontWeight:t.dataLabelUtils.LabelTextProperties.fontWeight},o=e.TextMeasurementService.measureSvgTextWidth(n),s=t.ColumnUtil.calculatePosition(r,i);return s+o>a?(r.labelFill=t.dataLabelUtils.defaultInsideLabelColor,d+t.AxisHelper.diffScaled(l,Math.max(0,r.value),0)/2-o/2):s},y:function(e){return u(s?e.categoryValue:e.categoryIndex)+c(e.seriesIndex)-h+o+t.dataLabelUtils.defaultColumnHalfLabelHeight}}},i.classes={item:{"class":"bar",selector:".bar"}},i}();t.ClusteredBarChartStrategy=a}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var i=function(){function e(){}return e.prototype.setupVisualProps=function(e){this.graphicsContext=e,this.margin=e.margin,this.width=this.graphicsContext.width,this.height=this.graphicsContext.height,this.categoryLayout=e.layout,this.animator=e.animator,this.interactivityService=e.interactivityService,this.viewportHeight=e.viewportHeight},e.prototype.setData=function(e){this.data=e},e.prototype.setXScale=function(e,i,a){var r,n,o=this.width;a&&2===a.length&&(r=a[0],n=a[1]);var s=this.xProps=t.ColumnUtil.getCategoryAxis(this.data,o,this.categoryLayout,!1,r,n);return s},e.prototype.setYScale=function(e,i,a){var r=this.viewportHeight,n=this.yProps=t.StackedUtil.getValueAxis(this.data,e,r,[r,0],i,a);return n},e.prototype.drawColumns=function(i){var a=this.data;this.columnsCenters=null;var r={columnWidth:this.categoryLayout.categoryThickness*(1-t.CartesianChart.InnerPaddingRatio),xScale:this.xProps.scale,yScale:this.yProps.scale,isScalar:this.categoryLayout.isScalar,margin:this.margin},n=e.getLayout(a,r),o=a.labelSettings,s=null;null!=o&&(s=t.dataLabelUtils.getColumnChartLabelLayout(a,this.getLabelLayoutXY(r,o),!0,this.graphicsContext.is100Pct,this.yProps.formatter,r,this.interactivityService));var l,u,c=t.ColumnUtil.drawSeries(a,this.graphicsContext.mainGraphicsContext,r);return this.animator&&i&&(l=this.animator.animate({viewModel:a,series:c,layout:n,itemCS:e.classes.item,interactivityService:this.interactivityService,mainGraphicsContext:this.graphicsContext.mainGraphicsContext,labelLayout:s,viewPort:{height:this.height,width:this.width}}),u=l.shapes),this.animator&&i&&!l.failed||(u=t.ColumnUtil.drawDefaultShapes(a,c,n,e.classes.item,!this.animator),null!==s&&(o.show?t.ColumnUtil.drawDefaultLabels(c,this.graphicsContext.mainGraphicsContext,s,{height:this.height,width:this.width}):t.dataLabelUtils.cleanDataLabels(this.graphicsContext.mainGraphicsContext))),t.ColumnUtil.applyInteractivity(u,this.graphicsContext.onDragStart),{shapesSelection:u,labelLayout:s,viewport:{height:this.height,width:this.width},axisOptions:r}},e.prototype.selectColumn=function(i,a){t.ColumnUtil.setChosenColumnOpacity(this.graphicsContext.mainGraphicsContext,e.classes.item.selector,i,a),this.moveHandle(i)},e.prototype.getClosestColumnIndex=function(e,i){return t.ColumnUtil.getClosestColumnIndex(e,this.getColumnsCenters())},e.prototype.getColumnsCenters=function(){var e=this;if(!this.columnsCenters){var i=this.categoryLayout.categoryThickness*(1-t.CartesianChart.InnerPaddingRatio);if(this.data.series.length>0){var a=0;this.categoryLayout.isScalar||(a=i/2);var r=this.data.series[0];this.columnsCenters=r.data.map(function(t){return e.xProps.scale(e.categoryLayout.isScalar?t.categoryValue:t.categoryIndex)+a})}}return this.columnsCenters},e.prototype.moveHandle=function(e){var t=this.getColumnsCenters(),i=t[e];if(this.columnSelectionLineHandle){var a=this.columnSelectionLineHandle;a.select("line").attr({x1:i,x2:i}),a.select("circle").attr({cx:i})}else{var a=this.columnSelectionLineHandle=this.graphicsContext.mainGraphicsContext.append("g");a.append("line").classed("interactive-hover-line",!0).attr({x1:i,x2:i,y1:0,y2:this.height}),a.append("circle").attr({cx:i,cy:this.height,r:"6px"}).classed("drag-handle",!0)}},e.getLayout=function(e,i){var a=i.columnWidth,r=i.isScalar,n=i.xScale,o=i.yScale,s=o(0),l=0;return r&&(l=a/2),{shapeLayout:{width:function(e,t){return a},x:function(e,t){return n(r?e.categoryValue:e.categoryIndex)-l},y:function(e,i){return s+t.AxisHelper.diffScaled(o,e.position,0)},height:function(e,i){return t.StackedUtil.getSize(o,e.valueAbsolute)}},shapeLayoutWithoutHighlights:{width:function(e,t){return a},x:function(e,t){return n(r?e.categoryValue:e.categoryIndex)-l},y:function(e,i){return s+t.AxisHelper.diffScaled(o,e.originalPosition,0)},height:function(e,i){return t.StackedUtil.getSize(o,e.originalValueAbsolute)}},zeroShapeLayout:{width:function(e,t){return a},x:function(e,t){return n(r?e.categoryValue:e.categoryIndex)-l},y:function(e,i){return s+t.AxisHelper.diffScaled(o,e.position,0)+t.StackedUtil.getSize(o,e.valueAbsolute)},height:function(e,t){return 0}}}},e.prototype.getLabelLayoutXY=function(e,t){var i=e.columnWidth,a=.5*i,r=e.isScalar,n=e.xScale,o=0,s=this.graphicsContext.is100Pct,l=this.getLabelLayoutY;return r&&(o=a),{x:function(e){return n(r?e.categoryValue:e.categoryIndex)-o+a},y:function(i){return l(i,s,e,t)}}},e.prototype.getLabelLayoutY=function(e,i,a,r){var n=a.yScale,o=n(0),s=o+t.AxisHelper.diffScaled(n,e.position,0)+t.StackedUtil.getSize(n,e.valueAbsolute)/2+t.dataLabelUtils.defaultColumnHalfLabelHeight,l=t.ColumnUtil.calculatePosition(e,a);return i||!e.lastSeries?s:0>=l?(e.labelFill=t.dataLabelUtils.defaultInsideLabelColor,s):l},e.classes={item:{"class":"column",selector:".column"},highlightItem:{"class":"highlightColumn",selector:".highlightColumn"}},e}();t.StackedColumnChartStrategy=i;var a=function(){function i(){}return i.prototype.setupVisualProps=function(e){this.graphicsContext=e,this.margin=e.margin,this.width=this.graphicsContext.width,this.height=this.graphicsContext.height,this.categoryLayout=e.layout,this.animator=e.animator,this.interactivityService=e.interactivityService,this.viewportHeight=e.viewportHeight},i.prototype.setData=function(e){this.data=e},i.prototype.setYScale=function(e,i,a){var r,n,o=this.height;a&&2===a.length&&(r=a[0],n=a[1]);var s=this.yProps=t.ColumnUtil.getCategoryAxis(this.data,o,this.categoryLayout,!0,r,n);return s},i.prototype.setXScale=function(e,i,a){var r=this.viewportHeight,n=this.xProps=t.StackedUtil.getValueAxis(this.data,e,this.width,[0,this.width],void 0,a);return n.axis.tickSize(-r,0),n},i.prototype.drawColumns=function(e){var a=this.data;this.barsCenters=null;var r={columnWidth:this.categoryLayout.categoryThickness*(1-t.CartesianChart.InnerPaddingRatio),xScale:this.xProps.scale,yScale:this.yProps.scale,isScalar:this.categoryLayout.isScalar,margin:this.margin},n=i.getLayout(a,r),o=a.labelSettings,s=null;null!=o&&(s=t.dataLabelUtils.getColumnChartLabelLayout(a,this.getLabelLayoutXY(r,this.width,o),!1,this.graphicsContext.is100Pct,this.xProps.formatter,r,this.interactivityService,this.width));var l,u,c=t.ColumnUtil.drawSeries(a,this.graphicsContext.mainGraphicsContext,r);return this.animator&&e&&(l=this.animator.animate({viewModel:a,series:c,layout:n,itemCS:i.classes.item,interactivityService:this.interactivityService,mainGraphicsContext:this.graphicsContext.mainGraphicsContext,labelLayout:s,viewPort:{height:this.height,width:this.width}}),u=l.shapes),this.animator&&e&&!l.failed||(u=t.ColumnUtil.drawDefaultShapes(a,c,n,i.classes.item,!this.animator),null!==s&&(o.show?t.ColumnUtil.drawDefaultLabels(c,this.graphicsContext.mainGraphicsContext,s,{height:this.height,width:this.width}):t.dataLabelUtils.cleanDataLabels(this.graphicsContext.mainGraphicsContext))),t.ColumnUtil.applyInteractivity(u,this.graphicsContext.onDragStart),{shapesSelection:u,labelLayout:s,viewport:{height:this.height,width:this.width},axisOptions:r}},i.prototype.selectColumn=function(e,a){t.ColumnUtil.setChosenColumnOpacity(this.graphicsContext.mainGraphicsContext,i.classes.item.selector,e,a),this.moveHandle(e)},i.prototype.getClosestColumnIndex=function(e,i){return t.ColumnUtil.getClosestColumnIndex(i,this.getBarsCenters())},i.prototype.getBarsCenters=function(){var e=this;if(!this.barsCenters){var i=this.categoryLayout.categoryThickness*(1-t.CartesianChart.InnerPaddingRatio);if(this.data.series.length>0){var a=0;this.categoryLayout.isScalar||(a=i/2);var r=this.data.series[0];this.barsCenters=r.data.map(function(t){return e.yProps.scale(e.categoryLayout.isScalar?t.categoryValue:t.categoryIndex)+a})}}return this.barsCenters},i.prototype.moveHandle=function(e){var t=this.getBarsCenters(),i=t[e];if(this.columnSelectionLineHandle){var a=this.columnSelectionLineHandle;a.select("line").attr({y1:i,y2:i}),a.select("circle").attr({cy:i})}else{var a=this.columnSelectionLineHandle=this.graphicsContext.mainGraphicsContext.append("g");a.append("line").classed("interactive-hover-line",!0).attr({x1:0,x2:this.width,y1:i,y2:i}),a.append("circle").classed("drag-handle",!0).attr({cx:0,cy:i,r:"6px"})}},i.getLayout=function(e,i){var a=i.columnWidth,r=i.isScalar,n=i.xScale,o=i.yScale,s=n(0),l=0;return r&&(l=a/2),{shapeLayout:{width:function(e,i){return-t.StackedUtil.getSize(n,e.valueAbsolute)},x:function(e,i){return s+t.AxisHelper.diffScaled(n,e.position-e.valueAbsolute,0)},y:function(e,t){return o(r?e.categoryValue:e.categoryIndex)-l},height:function(e,t){return a}},shapeLayoutWithoutHighlights:{width:function(e,i){return-t.StackedUtil.getSize(n,e.originalValueAbsolute)},x:function(e,i){return s+t.AxisHelper.diffScaled(n,e.originalPosition-e.originalValueAbsolute,0)},y:function(e,t){return o(r?e.categoryValue:e.categoryIndex)-l},height:function(e,t){return a}},zeroShapeLayout:{width:function(e,t){return 0},x:function(e,i){return s+t.AxisHelper.diffScaled(n,e.position-e.valueAbsolute,0)},y:function(e,t){return o(r?e.categoryValue:e.categoryIndex)-l},height:function(e,t){return a}}}},i.prototype.getLabelLayoutXY=function(i,a,r){var n=i.columnWidth,o=.5*n,s=i.isScalar,l=i.xScale,u=i.yScale,c=0,h=l(0),d=this.graphicsContext.is100Pct;return s&&(c=o),{x:function(r){var n={text:r.labeltext,fontFamily:t.dataLabelUtils.LabelTextProperties.fontFamily,fontSize:t.dataLabelUtils.LabelTextProperties.fontSize,fontWeight:t.dataLabelUtils.LabelTextProperties.fontWeight},o=e.TextMeasurementService.measureSvgTextWidth(n),s=h+t.AxisHelper.diffScaled(l,r.position-r.valueAbsolute,0)+Math.abs(t.StackedUtil.getSize(l,r.valueAbsolute))/2-o/2,u=t.ColumnUtil.calculatePosition(r,i);return d||!r.lastSeries?s:u+o>a?(r.labelFill=t.dataLabelUtils.defaultInsideLabelColor,s):u},y:function(e){return u(s?e.categoryValue:e.categoryIndex)-c+o+t.dataLabelUtils.defaultColumnHalfLabelHeight}}},i.classes={item:{"class":"bar",selector:".bar"},highlightItem:{"class":"highlightBar",selector:".highlightBar"}},i}();t.StackedBarChartStrategy=a}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var i;!function(t){t.capabilities={dataRoles:[{name:"Category",kind:0,displayName:e.data.createDisplayNameGetter("Role_ComboChart_Category")},{name:"Series",kind:0,displayName:e.data.createDisplayNameGetter("Role_ComboChart_Series")},{name:"Y",kind:1,displayName:e.data.createDisplayNameGetter("Role_ComboChart_Y")},{name:"Y2",kind:1,displayName:e.data.createDisplayNameGetter("Role_ComboChart_Y2")}],objects:{general:{properties:{formatString:{type:{formatting:{formatString:!0}}},visualType1:{type:{text:!0}},visualType2:{type:{text:!0}}}},legend:{displayName:e.data.createDisplayNameGetter("Visual_Legend"),properties:{show:{displayName:e.data.createDisplayNameGetter("Visual_Show"),type:{bool:!0}},position:{displayName:e.data.createDisplayNameGetter("Visual_LegendPosition"),type:{formatting:{legendPosition:!0}}},showTitle:{displayName:e.data.createDisplayNameGetter("Visual_LegendShowTitle"),type:{bool:!0}},titleText:{displayName:e.data.createDisplayNameGetter("Visual_LegendTitleText"),type:{text:!0}}}},categoryAxis:{displayName:e.data.createDisplayNameGetter("Visual_XAxis"),properties:{show:{displayName:e.data.createDisplayNameGetter("Visual_Show"),type:{bool:!0}},start:{displayName:e.data.createDisplayNameGetter("Visual_Axis_Start"),type:{numeric:!0}},end:{displayName:e.data.createDisplayNameGetter("Visual_Axis_End"),type:{numeric:!0}},axisType:{displayName:e.data.createDisplayNameGetter("Visual_Axis_Type"),type:{formatting:{axisType:!0}}},showAxisTitle:{displayName:e.data.createDisplayNameGetter("Visual_Axis_Title"),type:{bool:!0}},axisStyle:{displayName:e.data.createDisplayNameGetter("Visual_Axis_Style"),type:{formatting:{axisStyle:!0}}}}},valueAxis:{displayName:e.data.createDisplayNameGetter("Visual_YAxis"),properties:{show:{displayName:e.data.createDisplayNameGetter("Visual_Show"),type:{bool:!0}},secShow:{displayName:e.data.createDisplayNameGetter("Visual_YAxis_ShowSecondary"),type:{bool:!0}},axisLabel:{displayName:e.data.createDisplayNameGetter("Visual_YAxis_ColumnTitle"),type:{none:!0}},position:{displayName:e.data.createDisplayNameGetter("Visual_YAxis_Position"),type:{formatting:{yAxisPosition:!0}}},start:{displayName:e.data.createDisplayNameGetter("Visual_Axis_Start"),type:{numeric:!0}},end:{displayName:e.data.createDisplayNameGetter("Visual_Axis_End"),type:{numeric:!0}},showAxisTitle:{displayName:e.data.createDisplayNameGetter("Visual_Axis_Title"),type:{bool:!0}},axisStyle:{displayName:e.data.createDisplayNameGetter("Visual_Axis_Style"),type:{formatting:{axisStyle:!0}}},secAxisLabel:{displayName:e.data.createDisplayNameGetter("Visual_YAxis_LineTitle"),type:{none:!0}},secPosition:{displayName:e.data.createDisplayNameGetter("Visual_YAxis_Position"),type:{formatting:{yAxisPosition:!0}}},secStart:{displayName:e.data.createDisplayNameGetter("Visual_Axis_Start"),type:{numeric:!0}},secEnd:{displayName:e.data.createDisplayNameGetter("Visual_Axis_End"),type:{numeric:!0}},secShowAxisTitle:{displayName:e.data.createDisplayNameGetter("Visual_Axis_Title"),type:{bool:!0}},secAxisStyle:{displayName:e.data.createDisplayNameGetter("Visual_Axis_Style"),type:{formatting:{axisStyle:!0}}}}},dataPoint:{displayName:e.data.createDisplayNameGetter("Visual_DataPoint"),properties:{defaultColor:{displayName:e.data.createDisplayNameGetter("Visual_DefaultColor"),type:{fill:{solid:{color:!0}}}},showAllDataPoints:{displayName:e.data.createDisplayNameGetter("Visual_DataPoint_Show_All"),type:{bool:!0}},fill:{displayName:e.data.createDisplayNameGetter("Visual_Fill"),type:{fill:{solid:{color:!0}}}},fillRule:{displayName:e.data.createDisplayNameGetter("Visual_Gradient"),type:{fillRule:{}},rule:{inputRole:"Gradient",output:{property:"fill",selector:["Category"]}}}}},labels:{displayName:e.data.createDisplayNameGetter("Visual_DataPointsLabels"),properties:{show:{displayName:e.data.createDisplayNameGetter("Visual_Show"),type:{bool:!0}},color:{displayName:e.data.createDisplayNameGetter("Visual_LabelsFill"),type:{fill:{solid:{color:!0}}}},labelDisplayUnits:{displayName:e.data.createDisplayNameGetter("Visual_DisplayUnits"),type:{formatting:{labelDisplayUnits:!0}}},labelPrecision:{displayName:e.data.createDisplayNameGetter("Visual_Precision"),type:{numeric:!0}}}}},dataViewMappings:[{conditions:[{Category:{max:1},Series:{max:0}},{Category:{max:1},Series:{min:1,max:1},Y:{max:1}}],categorical:{categories:{"for":{"in":"Category"},dataReductionAlgorithm:{top:{}}},values:{group:{by:"Series",select:[{"for":{"in":"Y"}}],dataReductionAlgorithm:{top:{}}}},rowCount:{preferred:{min:2},supported:{min:0}}}},{conditions:[{Category:{max:1},Series:{max:0},Y2:{min:1}},{Category:{max:1},Series:{min:1,max:1},Y:{max:1},Y2:{min:1}}],categorical:{categories:{"for":{"in":"Category"},dataReductionAlgorithm:{top:{}}},values:{select:[{"for":{"in":"Y2"}}],dataReductionAlgorithm:{top:{}}},rowCount:{preferred:{min:2},supported:{min:0}}}}],supportsHighlight:!0,sorting:{"default":{}}}}(i=t.ComboChart||(t.ComboChart={})),t.comboChartProps={general:{formatString:{objectName:"general",propertyName:"formatString"}}}}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){t.donutChartCapabilities={dataRoles:[{name:"Category",kind:0,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Legend")},{name:"Series",kind:0,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Details")},{name:"Y",kind:1,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Values")}],objects:{general:{displayName:e.data.createDisplayNameGetter("Visual_General"),properties:{formatString:{type:{formatting:{formatString:!0}}}}},legend:{displayName:e.data.createDisplayNameGetter("Visual_Legend"),properties:{show:{displayName:e.data.createDisplayNameGetter("Visual_Show"),type:{bool:!0}},position:{displayName:e.data.createDisplayNameGetter("Visual_LegendPosition"),type:{formatting:{legendPosition:!0}}},showTitle:{displayName:e.data.createDisplayNameGetter("Visual_LegendShowTitle"),type:{bool:!0}},titleText:{displayName:e.data.createDisplayNameGetter("Visual_LegendTitleText"),type:{text:!0}}}},dataPoint:{displayName:e.data.createDisplayNameGetter("Visual_DataPoint"),
properties:{fill:{displayName:e.data.createDisplayNameGetter("Visual_Fill"),type:{fill:{solid:{color:!0}}}}}},labels:{displayName:e.data.createDisplayNameGetter("Visual_DataPointsLabels"),properties:{show:{type:{bool:!0}},color:{displayName:e.data.createDisplayNameGetter("Visual_LabelsFill"),type:{fill:{solid:{color:!0}}}},labelDisplayUnits:{displayName:e.data.createDisplayNameGetter("Visual_DisplayUnits"),type:{formatting:{labelDisplayUnits:!0}}},labelPrecision:{displayName:e.data.createDisplayNameGetter("Visual_Precision"),type:{numeric:!0}}}},categoryLabels:{displayName:e.data.createDisplayNameGetter("Visual_CategoryLabels"),properties:{show:{type:{bool:!0}}}}},dataViewMappings:[{conditions:[{Category:{max:1},Series:{max:0}},{Category:{max:1},Series:{min:1,max:1},Y:{max:1}}],categorical:{categories:{"for":{"in":"Category"},dataReductionAlgorithm:{top:{}}},values:{group:{by:"Series",select:[{bind:{to:"Y"}}],dataReductionAlgorithm:{top:{}}}},rowCount:{preferred:{min:2},supported:{min:1}}}}],sorting:{"default":{}},supportsHighlight:!0},t.donutChartProps={general:{formatString:{objectName:"general",propertyName:"formatString"}},dataPoint:{fill:{objectName:"dataPoint",propertyName:"fill"}},legend:{show:{objectName:"legend",propertyName:"show"},position:{objectName:"legend",propertyName:"position"},showTitle:{objectName:"legend",propertyName:"showTitle"},titleText:{objectName:"legend",propertyName:"titleText"}}}}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var i=function(){function i(e){this.isScrollable=e.isScrollable,this.interactivityService=e.interactivityService}return i.prototype.init=function(e){this.options=e,this.svg=e.svg,this.clearCatcher=this.svg.select(".clearCatcher"),this.mainGraphicsG=this.svg.append("g").classed("dataDotChartMainGraphicsContext",!0),this.mainGraphicsContext=this.mainGraphicsG.append("svg"),this.currentViewport=e.viewport,this.hostService=e.host,this.cartesianVisualHost=e.cartesianHost,this.style=e.style,this.colors=this.style.colorPalette.dataColors,this.interactivity=e.interactivity;var t=this.element=e.element;t.addClass(i.ClassName),t.css("overflow","visible")},i.prototype.setData=function(a){if(this.data={series:{data:[]},hasHighlights:!1,hasDynamicSeries:!1},a.length>0){var r=a[0];if(r&&r.categorical){var n=this.dataViewCategorical=r.categorical,o=n.categories,s=e.ValueType.fromDescriptor({text:!0});o&&o.length>0&&o[0].source&&o[0].source.type&&(s=o[0].source.type),this.data=i.converter(r,t.valueFormatter.format(null)),this.interactivityService&&this.interactivityService.applySelectionStateToData(this.data.series.data)}}},i.prototype.setFilteredData=function(t,i){var a=this.clippedData=e.Prototype.inherit(this.data);return a&&a.series&&a.series.data&&(a.series={data:a.series.data.slice(t,i),xCol:a.series.xCol,yCol:a.series.yCol}),a},i.prototype.calculateAxesProperties=function(a){var r=this;this.currentViewport=a.viewport,this.margin=a.margin;var n=this.clippedData=this.data,o=this.currentViewport,s=this.margin,l=n?n.series:null,u=l&&l.data&&l.data.length>0?[l]:[],c=l&&l.data?l.data.length:0;n.hasHighlights&&(c/=2);var h,d,p=o.width-(s.left+s.right),g=o.height-(s.top+s.bottom);i.hasDataPoint(l)&&(h=l.xCol,d=l.yCol);var f=t.CartesianChart.getLayout(null,{availableWidth:p,categoryCount:c,domain:null,isScalar:!1,isScrollable:this.isScrollable}),m=f.categoryThickness*t.CartesianChart.OuterPaddingRatio;this.isScrollable||(this.clippedData=i.createClippedDataIfOverflowed(n,f.categoryCount));var y=t.AxisHelper.createValueDomain(u,!0)||t.fallBackDomain,v=t.AxisHelper.combineDomain(a.forcedYDomain,y);this.yAxisProperties=t.AxisHelper.createAxis({pixelSpan:g,dataDomain:v,metaDataColumn:d,formatStringProp:i.formatStringProp,outerPadding:0,isScalar:!0,isVertical:!0,forcedTickCount:a.forcedTickCount,useTickIntervalForDisplayUnits:!0,isCategoryAxis:!0});var C=this.xAxisProperties?this.xAxisProperties.axisType:e.ValueType.fromDescriptor({text:!0}),b=t.AxisHelper.createDomain(u,C,!1,a.forcedXDomain);return this.xAxisProperties=t.AxisHelper.createAxis({pixelSpan:p,dataDomain:b,metaDataColumn:h,formatStringProp:i.formatStringProp,outerPadding:m,isScalar:!1,isVertical:!1,forcedTickCount:a.forcedTickCount,useTickIntervalForDisplayUnits:!0,categoryThickness:f.categoryThickness,getValueFn:function(e,t){return r.lookupXValue(e,t)},isCategoryAxis:!1}),[this.xAxisProperties,this.yAxisProperties]},i.createClippedDataIfOverflowed=function(t,i){var a=t.hasHighlights?Math.min(t.series.data.length,2*i):Math.min(t.series.data.length,i);if(a>=t.series.data.length)return t;var r=e.Prototype.inherit(t);return r.series=e.Prototype.inherit(t.series),r.series.data=r.series.data.slice(0,a),r},i.hasDataPoint=function(e){return e&&e.data&&e.data.length>0},i.prototype.lookupXValue=function(e,i){var a=this.data,r=t.AxisHelper.isDateTime(i);if(r)return new Date(e);if(a&&a.series){var n=a.series.data;if(n){var o=n[e];if(o)return o.categoryValue}}return e},i.prototype.overrideXScale=function(e){this.xAxisProperties=e},i.prototype.render=function(a){var r=this;if(this.clippedData){var n=this.clippedData,o=n.series.data,s=n.hasHighlights,l=this.margin,u=this.currentViewport,c=u.width-(l.left+l.right),h=u.height-(l.top+l.bottom),d=this.xAxisProperties.scale,p=this.yAxisProperties.scale,g=this.xAxisProperties.categoryThickness*(1-t.CartesianChart.InnerPaddingRatio),f=g/2,m=this.cartesianVisualHost.getSharedColors().getNewColorScale().getColor(i.DotColorKey),y=t.dataHasSelection(o);this.mainGraphicsContext.attr("width",c).attr("height",h);var v=this.mainGraphicsContext.selectAll(i.DotClassSelector).data(o,function(e){return e.identity.getKey()});v.enter().append("circle").classed(i.DotClassName,!0),v.style({fill:m.value}).style("fill-opacity",function(e){return t.ColumnUtil.getFillOpacity(e.selected,e.highlight,y,s)}).classed("null-value",function(e){return null===e.value}).attr({r:function(e){return f},cx:function(e){return d(e.categoryIndex)+f},cy:function(e){return p(e.value)}}),v.exit().remove();var C=this.mainGraphicsContext.selectAll(i.DotLabelClassSelector).data(o,function(e){return e.identity.getKey()});C.enter().append("text").classed(i.DotLabelClassName,!0).attr({"text-anchor":i.DotLabelTextAnchor,dy:i.DotLabelVerticalOffset}),C.classed("null-value",function(e){return null===e.value}).classed("overflowed",!1).attr({x:function(e){return d(e.categoryIndex)+f},y:function(e){return p(e.value)}}).text(function(e){return r.yAxisProperties.formatter.format(e.value)});var b=!1;if(C.each(function(){if(!b&&!$("<div>").addClass($(this).attr("class")).hasClass("null-value")){var t=e.TextMeasurementService.measureSvgTextElementWidth(this);t>g&&(C.classed("overflowed",!0),b=!0)}}),C.exit().remove(),this.interactivityService){var x={dots:v,datapoints:o,clearCatcher:this.clearCatcher};this.interactivityService.apply(this,x)}t.SVGUtil.flushAllD3TransitionsIfNeeded(this.options)}},i.prototype.calculateLegend=function(){return this.createLegendDataPoints(0)},i.prototype.hasLegend=function(){return this.data&&this.data.hasDynamicSeries},i.prototype.createLegendDataPoints=function(a){var r=this.data;if(!r)return null;var n,o=r.series,s=o.data,l=[],u=this.xAxisProperties?this.xAxisProperties.axisType:e.ValueType.fromDescriptor({text:!0});if(r.series&&r.series.data){var c=r.series.data[0];n=c&&this.lookupXValue(c.categoryValue,u)}if(o.yCol){var h=i.formatStringProp,d=s[a],p=d&&d.value,g=t.converterHelper.getFormattedLegendLabel(o.yCol,this.dataViewCategorical.values,h),f=this.cartesianVisualHost.getSharedColors().getNewColorScale().getColor(i.DotColorKey),m=this.dataViewCategorical.values,y=m&&m.length>a?m[a].identity:null;l.push({color:f.value,icon:t.LegendIcon.Line,label:g,category:t.valueFormatter.format(n,t.valueFormatter.getFormatString(o.xCol,h)),measure:t.valueFormatter.format(p,t.valueFormatter.getFormatString(o.yCol,h)),identity:y?t.SelectionId.createWithId(y):t.SelectionId.createNull(),selected:!1})}return{dataPoints:l}},i.prototype.onClearSelection=function(){this.interactivityService&&this.interactivityService.clearSelection()},i.converter=function(e,i){var a=e.categorical,r=a.categories&&a.categories.length>0?a.categories[0]:{source:void 0,values:[i],identity:void 0},n=t.AxisHelper.getCategoryValueType(r.source),o=t.AxisHelper.isDateTime(n),s=r.values;if(a.values){for(var l=a.values[0],u=!!l.highlights,c=[],h=0,d=l.values.length;d>h;h++){var p=r.identity?t.SelectionId.createWithId(r.identity[h]):t.SelectionId.createWithMeasure(l.source.queryName),g=s[h];if(c.push({categoryValue:o&&g?g.getTime():g,value:l.values[h],categoryIndex:h,seriesIndex:0,selected:!1,identity:p,highlight:!1}),u){var f=t.SelectionId.createWithHighlight(p),m=l.highlights[h];c.push({categoryValue:o&&g?g.getTime():g,value:m,categoryIndex:h,seriesIndex:0,selected:!1,identity:f,highlight:!0})}}return{series:{xCol:r.source,yCol:l.source,data:c},hasHighlights:u,hasDynamicSeries:!0}}return{series:{data:[]},hasHighlights:!1,hasDynamicSeries:!1}},i.prototype.accept=function(e,t){e.visitDataDotChart(t)},i.formatStringProp={objectName:"general",propertyName:"formatString"},i.ClassName="dataDotChart",i.DotClassName="dot",i.DotClassSelector=".dot",i.DotColorKey="dataDot",i.DotLabelClassName="label",i.DotLabelClassSelector=".label",i.DotLabelVerticalOffset="0.4em",i.DotLabelTextAnchor="middle",i.capabilities={dataRoles:[{name:"Category",kind:0},{name:"Y",kind:1}],objects:{general:{displayName:e.data.createDisplayNameGetter("Visual_General"),properties:{formatString:{type:{formatting:{formatString:!0}}}}}},dataViewMappings:[{conditions:[{Category:{max:1},Y:{max:1}}],categorical:{categories:{"for":{"in":"Category"},dataReductionAlgorithm:{top:{}}},values:{select:[{"for":{"in":"Y"},dataReductionAlgorithm:{top:{}}}]}}}]},i}();t.DataDotChart=i}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){t.filledMapCapabilities={dataRoles:[{name:"Category",kind:0,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Location"),preferredTypes:[{geography:{address:!0}},{geography:{city:!0}},{geography:{continent:!0}},{geography:{country:!0}},{geography:{county:!0}},{geography:{place:!0}},{geography:{postalCode:!0}},{geography:{region:!0}},{geography:{stateOrProvince:!0}}]},{name:"Series",kind:0,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Legend")},{name:"X",kind:1,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Longitude"),preferredTypes:[{geography:{longitude:!0}}]},{name:"Y",kind:1,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Latitude"),preferredTypes:[{geography:{latitude:!0}}]},{name:"Size",kind:1,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Values")}],objects:{general:{displayName:e.data.createDisplayNameGetter("Visual_General"),properties:{formatString:{type:{formatting:{formatString:!0}}}}},legend:{displayName:e.data.createDisplayNameGetter("Visual_Legend"),properties:{show:{displayName:e.data.createDisplayNameGetter("Visual_Show"),type:{bool:!0}},position:{displayName:e.data.createDisplayNameGetter("Visual_LegendPosition"),type:{formatting:{legendPosition:!0}}},showTitle:{displayName:e.data.createDisplayNameGetter("Visual_LegendShowTitle"),type:{bool:!0}},titleText:{displayName:e.data.createDisplayNameGetter("Visual_LegendTitleText"),type:{text:!0}}}},dataPoint:{displayName:e.data.createDisplayNameGetter("Visual_DataPoint"),properties:{defaultColor:{displayName:e.data.createDisplayNameGetter("Visual_DefaultColor"),type:{fill:{solid:{color:!0}}}},showAllDataPoints:{displayName:e.data.createDisplayNameGetter("Visual_DataPoint_Show_All"),type:{bool:!0}},fill:{displayName:e.data.createDisplayNameGetter("Visual_Fill"),type:{fill:{solid:{color:!0}}}},fillRule:{displayName:e.data.createDisplayNameGetter("Role_DisplayName_Values"),type:{fillRule:{}},rule:{inputRole:"Size",output:{property:"fill",selector:["Category"]}}}}}},dataViewMappings:[{conditions:[{Category:{max:1},Series:{max:1},X:{max:1},Y:{max:1},Size:{max:1}},{Category:{max:1},Series:{max:0},X:{max:1},Y:{max:1},Size:{max:1}}],categorical:{categories:{"for":{"in":"Category"},dataReductionAlgorithm:{top:{}}},values:{group:{by:"Series",select:[{bind:{to:"X"}},{bind:{to:"Y"}},{bind:{to:"Size"}}],dataReductionAlgorithm:{top:{}}}},rowCount:{preferred:{min:2}}}}],sorting:{custom:{}}}}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){t.funnelChartCapabilities={dataRoles:[{name:"Category",kind:0,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Group")},{name:"Y",kind:1,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Values")},{name:"Gradient",kind:1,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Gradient")}],dataViewMappings:[{conditions:[{Category:{max:0},Gradient:{max:0}},{Category:{max:0},Y:{max:1},Gradient:{max:0}},{Category:{max:1},Y:{max:1},Gradient:{max:1}}],categorical:{categories:{"for":{"in":"Category"},dataReductionAlgorithm:{top:{}}},values:{group:{by:"Series",select:[{bind:{to:"Y"}},{bind:{to:"Gradient"}}],dataReductionAlgorithm:{top:{}}}},rowCount:{preferred:{min:1}}}}],objects:{general:{displayName:e.data.createDisplayNameGetter("Visual_General"),properties:{formatString:{type:{formatting:{formatString:!0}}}}},dataPoint:{displayName:e.data.createDisplayNameGetter("Visual_DataPoint"),properties:{defaultColor:{displayName:e.data.createDisplayNameGetter("Visual_DefaultColor"),type:{fill:{solid:{color:!0}}}},fill:{displayName:e.data.createDisplayNameGetter("Visual_Fill"),type:{fill:{solid:{color:!0}}}},fillRule:{displayName:e.data.createDisplayNameGetter("Visual_Gradient"),type:{fillRule:{}},rule:{inputRole:"Gradient",output:{property:"fill",selector:["Category"]}}}}},labels:{displayName:e.data.createDisplayNameGetter("Visual_DataPointsLabels"),properties:{show:{displayName:e.data.createDisplayNameGetter("Visual_Show"),type:{bool:!0}},color:{displayName:e.data.createDisplayNameGetter("Visual_LabelsFill"),type:{fill:{solid:{color:!0}}}},labelPosition:{displayName:e.data.createDisplayNameGetter("Visual_Position"),type:{formatting:{labelPosition:!0}}},labelDisplayUnits:{displayName:e.data.createDisplayNameGetter("Visual_DisplayUnits"),type:{formatting:{labelDisplayUnits:!0}}},labelPrecision:{displayName:e.data.createDisplayNameGetter("Visual_Precision"),type:{numeric:!0}}}}},supportsHighlight:!0,sorting:{"default":{}}},t.funnelChartProps={general:{formatString:{objectName:"general",propertyName:"formatString"}},dataPoint:{defaultColor:{objectName:"dataPoint",propertyName:"defaultColor"},fill:{objectName:"dataPoint",propertyName:"fill"}}}}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var i=function(){function i(t){this.labelPositionObjects=[e.labelPosition.outsideEnd,e.labelPosition.insideCenter],t&&(t.funnelSmallViewPortProperties&&(this.funnelSmallViewPortProperties=t.funnelSmallViewPortProperties),t.animator&&(this.animator=t.animator))}return i.converter=function(e,i,a){var r=[],n=t.funnelChartProps.general.formatString,o=e.metadata?e.metadata.columns.filter(function(e){return e.isMeasure}):[],s=e.categorical.categories||[],l=e.categorical.values,u=l&&l[0]&&!!l[0].highlights,c=!1,h=e.categorical,d=t.dataLabelUtils.getDefaultFunnelLabelSettings(),p=new t.ColorHelper(i,t.funnelChartProps.dataPoint.fill,a);if(e&&e.metadata&&e.metadata.objects){var g=e.metadata.objects.labels;g&&(d.show=void 0!==g.show?g.show:d.show,d.position=void 0!==g.labelPosition?g.labelPosition:d.position,void 0!==g.color&&(d.labelColor=g.color.solid.color),void 0!==g.labelDisplayUnits&&(d.displayUnits=g.labelDisplayUnits),void 0!==g.labelPrecision&&(d.precision=g.labelPrecision>=0?g.labelPrecision:0))}if(1===s.length&&l)for(var f=s[0],m=f.values,y=t.valueFormatter.getFormatString(f.source,n),v=0,C=m.length;C>v;v++){var b=l[0].source.queryName,x=f.identity?t.SelectionId.createWithIdAndMeasure(f.identity[v],b):t.SelectionId.createWithMeasure(b),S=d3.sum(l.map(function(e){return e.values[v]})),w=t.valueFormatter.format(m[v],y),_=t.TooltipBuilder.createTooltipInfo(n,h.categories,w,h.values,S,null,0);if(u){var T=d3.sum(l.map(function(e){return e.highlights[v]}));0!==T&&(_=t.TooltipBuilder.createTooltipInfo(n,h.categories,w,h.values,S,null,0,T))}var D=p.getColorForMeasure(f.objects&&f.objects[v],"");if(r.push({label:w,value:S,categoryOrMeasureIndex:v,identity:x,selected:!1,key:x.getKey(),tooltipInfo:_,color:D,labelFill:d.labelColor}),u){var P=t.SelectionId.createWithHighlight(x),T=d3.sum(l.map(function(e){return e.highlights[v]}));T>S&&(c=!0);var M=0!==T?T:void 0,_=t.TooltipBuilder.createTooltipInfo(n,h.categories,w,h.values,S,null,0,M);r.push({label:w,value:S,categoryOrMeasureIndex:v,identity:P,selected:!1,key:P.getKey(),highlight:!0,highlightValue:T,tooltipInfo:_,color:D})}}else if(o.length>0&&l)for(var v=0,L=l.length;L>v;v++){var A=l[v],S=d3.sum(A.values),x=t.SelectionId.createWithMeasure(A.source.queryName),N=o[v].displayName,V=h.categories?null:v,_=t.TooltipBuilder.createTooltipInfo(n,h.categories,N,h.values,S,null,V),D=p.getColorForMeasure(A.source.objects,"");if(u){var T=d3.sum(l.map(function(e){return e.highlights[v]}));0!==T&&(_=t.TooltipBuilder.createTooltipInfo(n,h.categories,N,h.values,S,null,0,T))}if(r.push({label:o[v].displayName,value:S,categoryOrMeasureIndex:v,identity:x,selected:!1,key:x.getKey(),tooltipInfo:_,color:D,labelFill:d.labelColor}),u){var P=t.SelectionId.createWithHighlight(x),T=d3.sum(l[v].highlights);T>S&&(c=!0);var M=0!==T?T:void 0,_=t.TooltipBuilder.createTooltipInfo(n,h.categories,N,h.values,S,null,0,M);r.push({label:o[v].displayName,value:S,categoryOrMeasureIndex:v,identity:P,key:P.getKey(),selected:!1,highlight:!0,highlightValue:T,tooltipInfo:_,color:D})}}for(var I=[],v=0;v<r.length;v+=u?2:1){var R=r[v];I.push(R.label)}return{slices:r,categoryLabels:I,valuesMetadata:o,hasHighlights:u,highlightsOverflow:c,canShowDataLabels:!0,dataLabelsSettings:d}},i.prototype.enumerateObjectInstances=function(e){switch(e.objectName){case"dataPoint":var i=this.dataViews&&this.dataViews.length>0&&this.dataViews[0]&&this.dataViews[0].categorical,a=t.GradientUtils.hasGradientRole(i);if(!a)return this.enumerateDataPoints();break;case"labels":return t.dataLabelUtils.enumerateDataLabels(this.data.dataLabelsSettings,!0,!0,!0,this.labelPositionObjects)}},i.prototype.enumerateDataPoints=function(){var e=this.data;if(e){var i=[],a=e.slices;i.push({objectName:"dataPoint",selector:null,properties:{defaultColor:{solid:{color:this.defaultDataPointColor||this.colors.getColorByIndex(0).value}}}});for(var r=0;r<a.length;r++){var n=a[r];if(!n.highlight){var o=n.color,s=n.identity.getSelector(),l=!!s.data,u={objectName:"dataPoint",displayName:n.label,selector:t.ColorHelper.normalizeSelector(s,l),properties:{fill:{solid:{color:o}}}};i.push(u)}}return i}},i.prototype.init=function(e){this.options=e;var a=e.element,r=this.svg=d3.select(a.get(0)).append("svg").classed(i.VisualClassName,!0);this.clearCatcher=t.appendClearCatcher(this.svg),this.currentViewport=e.viewport,this.margin={left:5,right:5,top:0,bottom:0};var n=e.style;this.colors=n.colorPalette.dataColors,this.hostServices=e.host,this.interactivityService=t.VisualInteractivityFactory.buildInteractivityService(e),this.percentGraphicsContext=r.append("g").classed(i.Selectors.percentBar.root["class"],!0),this.funnelGraphicsContext=r.append("g"),this.axisGraphicsContext=r.append("g"),this.updateViewportProperties()},i.prototype.updateViewportProperties=function(){var e=this.currentViewport;this.svg.attr("width",e.width).attr("height",e.height)},i.prototype.update=function(a){this.data={slices:[],categoryLabels:[],valuesMetadata:[],hasHighlights:!1,highlightsOverflow:!1,canShowDataLabels:!0,dataLabelsSettings:t.dataLabelUtils.getDefaultFunnelLabelSettings()};var r=this.dataViews=a.dataViews;if(this.currentViewport=a.viewport,r&&r.length>0){var n=r[0];if(n.metadata&&n.metadata.objects){var o=e.DataViewObjects.getFillColor(n.metadata.objects,t.funnelChartProps.dataPoint.defaultColor);o&&(this.defaultDataPointColor=o)}n.categorical&&(this.data=i.converter(n,this.colors,this.defaultDataPointColor),this.interactivityService&&this.interactivityService.applySelectionStateToData(this.data.slices));var s=t.getInvalidValueWarnings(r,!1,!1,!1);s&&s.length>0&&this.hostServices.setWarnings(s)}this.updateViewportProperties(),this.updateInternal(a.suppressAnimations)},i.prototype.onDataChanged=function(e){this.update({dataViews:e.dataViews,suppressAnimations:e.suppressAnimations,viewport:this.currentViewport})},i.prototype.onResizing=function(e){this.currentViewport=e,this.update({dataViews:this.dataViews,suppressAnimations:!0,viewport:this.currentViewport})},i.prototype.getMaxLeftMargin=function(t,a){for(var r=0,n=e.TextMeasurementService.measureSvgTextWidth,o=0,s=t.length;s>o;o++)a.text=t[o],r=Math.max(r,n(a));return r+i.LabelFunnelPadding},i.prototype.updateInternal=function(e){if(null!=this.data){var a=this.data,r=a.slices,n=r.filter(function(e){return!e.highlight}),o=this.isHidingPercentBars(),s=this.setUpAxis(),l=s.margin,u=s.verticalRange,c=this.funnelGraphicsContext.attr("transform",t.SVGUtil.translateAndRotate(l.left,l.top,u/2,u/2,90));this.percentGraphicsContext.attr("transform",t.SVGUtil.translate(l.left,l.top)),this.svg.style("font-size",i.StandardTextProperties.fontSize),this.svg.style("font-weight",i.StandardTextProperties.fontWeight),this.svg.style("font-family",i.StandardTextProperties.fontFamily);var h,d,p,g=i.getLayout(a,s),f=t.dataLabelUtils.getFunnelChartLabelLayout(a,s,i.InnerTextHeightDelta,i.InnerTextMinimumPadding,a.dataLabelsSettings,this.currentViewport);if(this.animator&&!e){var m={viewModel:a,interactivityService:this.interactivityService,layout:g,axisGraphicsContext:this.axisGraphicsContext,shapeGraphicsContext:c,percentGraphicsContext:this.percentGraphicsContext,labelGraphicsContext:this.svg,axisOptions:s,slicesWithoutHighlights:n,colors:this.colors,labelLayout:f,isHidingPercentBars:o,visualInitOptions:this.options};h=this.animator.animate(m),d=h.shapes,p=h.dataLabels}if((!this.animator||e||h.failed)&&(i.drawDefaultAxis(this.axisGraphicsContext,s,o),d=i.drawDefaultShapes(a,r,c,g),i.drawPercentBars(a,this.percentGraphicsContext,g,o),a.dataLabelsSettings.show&&a.canShowDataLabels?t.dataLabelUtils.drawDefaultLabelsForFunnelChart(n,this.svg,f):t.dataLabelUtils.cleanDataLabels(this.svg)),this.interactivityService){var y={datapoints:r,bars:d,labels:p,clearCatcher:this.clearCatcher,hasHighlights:a.hasHighlights};this.interactivityService.apply(this,y)}t.TooltipManager.addTooltip(d,function(e){return e.data.tooltipInfo}),t.SVGUtil.flushAllD3TransitionsIfNeeded(this.options)}},i.prototype.getUsableVerticalSpace=function(){var e=this.data.categoryLabels,t=this.margin,a=this.currentViewport.height-(t.top+t.bottom);return a-i.MinBarThickness*e.length},i.prototype.isHidingPercentBars=function(){var e=this.getUsableVerticalSpace()-2*i.MinBarThickness*i.PercentBarToBarRatio;return 0>=e},i.prototype.isSparklines=function(){return this.getUsableVerticalSpace()<=0},i.prototype.setUpAxis=function(){var e=this.data,t=e.slices,a=e.categoryLabels,r=this.currentViewport,n=this.margin,o=r.height-(n.top+n.bottom),s=this.isSparklines(),l=this.isHidingPercentBars();if(a.length>0&&s)a=[],e.canShowDataLabels=!1;else if(this.showCategoryLabels()){var u=i.StandardTextProperties;n.left=this.getMaxLeftMargin(a,u)}else a=[];var c,h=r.width-(n.left+n.right),d=i.BarToSpaceRatio,p=d3.max(t.map(function(e){return e.value})),g=0,f=0,m=o;c=l?o-a.length*i.MaxBarWidth:o-a.length*i.MaxBarWidth-2*i.MaxBarWidth*i.PercentBarToBarRatio,a.length>0&&c>0&&(f=Math.ceil(c/2),m=Math.ceil(o-c/2));var y=d3.scale.linear().domain([g,p]).range([h,0]),v=d3.scale.ordinal().domain(d3.range(0,e.categoryLabels.length)).rangeBands([f,m],d,l?d:i.PercentBarToBarRatio);return{margin:n,xScale:v,yScale:y,maxScore:p,verticalRange:h,rangeStart:f,rangeEnd:m,barToSpaceRatio:d,categoryLabels:a}},i.prototype.accept=function(e,t){e.visitFunnel(t)},i.prototype.onClearSelection=function(){this.interactivityService&&this.interactivityService.clearSelection()},i.getLayout=function(e,a){var r=e.highlightsOverflow,n=a.yScale,o=a.xScale,s=a.maxScore,l=o.rangeBand(),u=Math.ceil(l/2),c=u,h=l*i.OverflowingHighlightWidthRatio,d=h/2,p=a.categoryLabels.length-1,g=Math.abs(n(s)-n(0)),f=function(e){return(g-Math.abs(n(e)-n(0)))/2};return{percentBarLayout:{mainLine:{x2:function(e){return Math.abs(n(e.value)-n(0))},transform:function(e){var i=n(e.value)-f(e.value),a=e.isTop?o(0)-u:o(p)+l+u;return t.SVGUtil.translate(i,a)}},leftTick:{y2:function(e){return c},transform:function(e){var i=n(e.value)-f(e.value),a=e.isTop?o(0)-u-c/2:o(p)+l+u-c/2;return t.SVGUtil.translate(i,a)}},rightTick:{y2:function(e){return c},transform:function(e){var i=n(e.value)-f(e.value),a=Math.abs(n(e.value)-n(0)),r=i+a,s=e.isTop?o(0)-u-c/2:o(p)+l+u-c/2;return t.SVGUtil.translate(r,s)}},text:{x:function(e){return Math.ceil(Math.abs(n(s)-n(0))/2)},y:function(e){return e.isTop?-(4+c/2):+parseInt(i.StandardTextProperties.fontSize,10)+c/2},style:function(){return"font-size: "+i.StandardTextProperties.fontSize},transform:function(e){var i=e.isTop?o(0)-u:o(p)+l+u;return t.SVGUtil.translate(0,i)}}},shapeLayout:{width:function(e){return e.highlight&&r?h:l},height:function(e){return Math.abs(n(i.getFunnelSliceValue(e))-n(0))},x:function(e){return o(e.categoryOrMeasureIndex)+(e.highlight&&r?d:0)},y:function(e){var t=i.getFunnelSliceValue(e);return n(t)-f(t)}},shapeLayoutWithoutHighlights:{width:function(e){return l},height:function(e){return Math.abs(n(e.value)-n(0))},x:function(e){return o(e.categoryOrMeasureIndex)+0},y:function(e){return n(e.value)-f(e.value)}},zeroShapeLayout:{width:function(e){return e.highlight&&r?h:l},height:function(e){return 0},x:function(e){return o(e.categoryOrMeasureIndex)+(e.highlight&&r?d:0)},y:function(e){return n((n.domain()[0]+n.domain()[1])/2)}}}},i.drawDefaultAxis=function(e,a,r){var n=d3.scale.ordinal().domain(a.categoryLabels).rangeBands([a.rangeStart,a.rangeEnd],a.barToSpaceRatio,r?a.barToSpaceRatio:i.PercentBarToBarRatio),o=d3.svg.axis().scale(n).orient("right").tickPadding(i.TickPadding).innerTickSize(i.InnerTickSize);e.classed("axis",!0).attr("transform",t.SVGUtil.translate(0,a.margin.top)).call(o)},i.drawDefaultShapes=function(e,i,a,r){var n=e.hasHighlights,o=a.selectAll(".funnelBar").data(i,function(e){return e.key});return o.enter().append("rect").attr("class",function(e){return e.highlight?"funnelBar highlight":"funnelBar"}),o.style("fill",function(e){return e.color}).style("fill-opacity",function(e){return function(e){return t.ColumnUtil.getFillOpacity(e.selected,e.highlight,!1,n)}}).attr(r.shapeLayout),o.exit().remove(),o},i.getFunnelSliceValue=function(e){return e.highlight?e.highlightValue:e.value},i.drawPercentBarComponents=function(a,r,n){var o=a.selectAll(i.Selectors.percentBar.mainLine.selector).data(r);o.exit().remove(),o.enter().append("line").classed(i.Selectors.percentBar.mainLine["class"],!0),o.attr(n.percentBarLayout.mainLine);var s=a.selectAll(i.Selectors.percentBar.leftTick.selector).data(r);s.exit().remove(),s.enter().append("line").classed(i.Selectors.percentBar.leftTick["class"],!0),s.attr(n.percentBarLayout.leftTick);var l=a.selectAll(i.Selectors.percentBar.rightTick.selector).data(r);l.exit().remove(),l.enter().append("line").classed(i.Selectors.percentBar.rightTick["class"],!0),l.attr(n.percentBarLayout.rightTick);var u=a.selectAll(i.Selectors.percentBar.text.selector).data(r);u.exit().remove(),u.enter().append("text").classed(i.Selectors.percentBar.text["class"],!0),u.attr(n.percentBarLayout.text).text(function(i){return e.formattingService.formatValue(i.percent,t.valueFormatter.getLocalizedString("Percentage1"))})},i.drawPercentBars=function(e,t,a,r){if(r||!e.slices||(e.hasHighlights?e.slices.length/2:e.slices.length)<2)return void i.drawPercentBarComponents(t,[],a);var n=[e.slices[e.hasHighlights?1:0],e.slices[e.slices.length-1]],o=i.getFunnelSliceValue(n[0]);if(0>=o)return void i.drawPercentBarComponents(t,[],a);var s=[{value:i.getFunnelSliceValue(n[0]),percent:1,isTop:!0},{value:i.getFunnelSliceValue(n[1]),percent:i.getFunnelSliceValue(n[1])/o,isTop:!1}];i.drawPercentBarComponents(t,s,a)},i.prototype.showCategoryLabels=function(){return this.funnelSmallViewPortProperties&&this.funnelSmallViewPortProperties.hideFunnelCategoryLabelsOnSmallViewPort&&this.currentViewport.height<this.funnelSmallViewPortProperties.minHeightFunnelCategoryLabelsVisible?!1:!0},i.DefaultBarOpacity=1,i.DimmedBarOpacity=.4,i.PercentBarToBarRatio=2,i.TickPadding=0,i.InnerTickSize=0,i.InnerTextClassName="labelSeries",i.CreateSelector=function(e){return{"class":e,selector:"."+e}},i.Selectors={percentBar:{root:i.CreateSelector("percentBars"),mainLine:i.CreateSelector("mainLine"),leftTick:i.CreateSelector("leftTick"),rightTick:i.CreateSelector("rightTick"),text:i.CreateSelector("value")}},i.VisualClassName="funnelChart",i.BarToSpaceRatio=.1,i.MaxBarWidth=40,i.MinBarThickness=12,i.LabelFunnelPadding=6,i.InnerTextMinimumPadding=10,i.InnerTextHeightDelta=4,i.StandardTextProperties={fontFamily:"wf_segoe-ui_normal",fontSize:"12px"},i.OverflowingHighlightWidthRatio=.5,i}();t.FunnelChart=i}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var i={y:"Y",minValue:"MinValue",maxValue:"MaxValue",targetValue:"TargetValue"},a=function(){function a(e){this.lastAngle=-Math.PI/2,e&&(e.gaugeSmallViewPortProperties&&(this.gaugeSmallViewPortProperties=e.gaugeSmallViewPortProperties),this.animator=e.animator)}return a.prototype.init=function(e){this.element=e.element,this.currentViewport=e.viewport,this.style=e.style,this.options=e,this.settings=a.DefaultStyleProperties,this.targetSettings=a.DefaultTargetSettings,this.setMargins(),this.color=d3.scale.ordinal().range(this.style.colorPalette.dataColors.getSentimentColors().map(function(e){return e.value})),this.hostService=e.host;var i=this.svg=d3.select(this.element.get(0)).append("svg");i.classed(a.VisualClassName,!0);var r=this.mainGraphicsContext=i.append("g");r.attr("class",a.MainGaugeGroupElementName),this.initKpiBands();var n=this.backgroundArc=d3.svg.arc().innerRadius(0).outerRadius(0).startAngle(-Math.PI/2).endAngle(Math.PI/2),o=this.foregroundArc=d3.svg.arc().innerRadius(0).outerRadius(0).startAngle(-Math.PI/2);this.backgroundArcPath=r.append("path").classed("backgroundArc",!0).attr("d",n),this.foregroundArcPath=r.append("path").datum({endAngle:-Math.PI/2}).classed("foregroundArc",!0).attr("d",o);var s=this.animatedNumberGrapicsContext=i.append("g");this.animatedNumber=new t.AnimatedNumber(s),this.animatedNumber.init(e);var l=this.gaugeVisualProperties=this.getGaugeVisualProperties(),u=this.getAnimatedNumberProperties(l.radius,l.innerRadiusFactor,l.top,l.left);this.animatedNumber.svg.attr("transform",u.transformString),this.animatedNumber.onResizing(u.viewport)},a.prototype.update=function(e){this.currentViewport=e.viewport;var i=this.dataViews=e.dataViews;if(i&&i[0]){this.data=a.converter(i[0]),this.targetSettings=this.data.targetSettings,i[0]&&(i[0].single={value:this.data.total}),this.showTargetLabel=null!=this.targetSettings.target&&(this.currentViewport.width>a.MinWidthForTargetLabel||!this.showMinMaxLabelsOnBottom())&&this.showSideNumbersLabelText(),this.setMargins();var r=this.gaugeVisualProperties=this.getGaugeVisualProperties(),n=this.getAnimatedNumberProperties(r.radius,r.innerRadiusFactor,r.top,r.left);this.drawViewPort(this.gaugeVisualProperties),this.updateInternal(e.suppressAnimations),this.animatedNumber.svg.attr("transform",n.transformString),this.animatedNumber.update({viewport:n.viewport,dataViews:e.dataViews,suppressAnimations:e.suppressAnimations});var o=t.getInvalidValueWarnings(i,!1,!1,!1);o&&o.length>0&&this.hostService.setWarnings(o)}},a.prototype.onDataChanged=function(e){this.update({dataViews:e.dataViews,suppressAnimations:e.suppressAnimations,viewport:this.currentViewport
})},a.prototype.onResizing=function(e){this.update({dataViews:this.dataViews,suppressAnimations:!0,viewMode:0,viewport:e})},a.prototype.onStyleChanged=function(e){this.style=e,this.color=d3.scale.ordinal().range(e.colorPalette.dataColors.getSentimentColors().map(function(e){return e.value})),this.updateInternal(!0)},a.getValidSettings=function(e){var t=e.max===a.MAX_VALUE?a.DEFAULT_MAX:e.max,i=e.min===a.MIN_VALUE?a.DEFAULT_MIN:e.min,r=e.target;return{min:i,max:t,target:r}},a.getGaugeData=function(e){var t={max:a.MAX_VALUE,min:a.MIN_VALUE,target:void 0,total:0,tooltipItems:[]};if(e&&e.categorical&&e.categorical.values&&e.metadata&&e.metadata.columns)for(var r=e.categorical.values,n=e.metadata.columns,o=0;o<r.length;o++){var s=n[o],l=r[o].values[0]||0;s&&s.roles&&(s.roles[i.y]?(t.total=l,l&&t.tooltipItems.push({value:l,metadata:r[o]})):s.roles[i.minValue]?t.min=l:s.roles[i.maxValue]?t.max=l:s.roles[i.targetValue]&&(t.target=l,l&&t.tooltipItems.push({value:l,metadata:r[o]})))}return t},a.converter=function(e){var i=a.getGaugeData(e),r=i.total;if(r>0&&i.max===a.MAX_VALUE){var n=!1,o=e.metadata.columns;if(!_.isEmpty(o)){var s=t.valueFormatter.getFormatString(e.metadata.columns[0],a.formatStringProp,!0);n=t.valueFormatter.getFormatMetadata(s).hasPercent}i.max=n?a.DEFAULT_MAX:2*r}var l=a.getValidSettings(i),u=Math.max(r,l.min);u=Math.min(u,l.max);var c,h=l.min!==l.max?(u-l.min)/(l.max-l.min):0;if(e)if(i.tooltipItems.length>0)c=t.TooltipBuilder.createTooltipInfo(a.formatStringProp,null,null,null,null,i.tooltipItems,null,null);else{var d=e.categorical;if(d&&d.values&&d.values.length>0){var p=d.values[0],g=p.values[0];c=t.TooltipBuilder.createTooltipInfo(a.formatStringProp,null,null,d.values,g,null,null,null)}}return{percent:h,adjustedTotal:u,total:r,metadataColumn:a.getMetaDataColumn(e),targetSettings:l,tooltipInfo:c}},a.getMetaDataColumn=function(e){if(e&&e.metadata&&e.metadata.columns)for(var t=0,i=e.metadata.columns.length;i>t;t++){var a=e.metadata.columns[t];if(a.isMeasure)return a}return null},a.prototype.initKpiBands=function(){if(this.settings.kpiBands.show)for(var e=this.kpiArcs=[],t=this.kpiArcPaths=[],i=this.mainGraphicsContext,a=0;3>a;a++){var r=d3.svg.arc().innerRadius(0).outerRadius(0).startAngle(0).endAngle(0);e.push(r);var n=i.append("path").attr("d",r);t.push(n)}},a.prototype.updateKpiBands=function(e,t,i,r){if(this.settings.kpiBands.show)for(var n=0;n<r.length;n++)this.kpiArcs[n].innerRadius(e*t-(a.KpiBandDistanceFromMainArc+this.settings.kpiBands.thickness)).outerRadius(e*t-a.KpiBandDistanceFromMainArc).startAngle(r[n].start).endAngle(r[n].end),this.kpiArcPaths[n].attr("fill",r[n].fill).attr("d",this.kpiArcs[n]).attr("transform",i)},a.prototype.removeTargetElements=function(){this.targetLine&&(this.targetLine.remove(),this.targetText.remove(),this.targetConnector.remove(),this.targetLine=this.targetConnector=this.targetText=null)},a.prototype.updateTargetLine=function(e,t,i,a){var r=this.targetSettings;this.targetLine||(this.targetLine=this.mainGraphicsContext.append("line"));var n=(r.target-r.min)/(r.max-r.min)*Math.PI,o=a-e*Math.sin(n),s=i-e*Math.cos(n),l=a-t*Math.sin(n),u=i-t*Math.cos(n);this.targetLine.attr({x1:u,y1:l,x2:s,y2:o})},a.prototype.getAnimatedNumberProperties=function(e,i,r,n){var o=Math.PI/4,s=1,l=e*i,u=l-(this.settings.kpiBands.show?a.KpiBandDistanceFromMainArc+this.settings.kpiBands.thickness:0),c=u*Math.cos(o),h=u*Math.sin(o),d=r-h,p=n-c,d=d*s,p=p*s,g=2*c,f={transformString:t.SVGUtil.translate(p,d),viewport:{height:h,width:g}};return f},a.prototype.getGaugeVisualProperties=function(){var e=this.currentViewport,i=this.margin,r=e.width-i.right-i.left,n=r/2,o=e.height-i.top-i.bottom,s=Math.min(n,o),l=a.InnerRadiusFactor,u=i.left+n,c=s+(o-s)/2+i.top,h=t.SVGUtil.translate(u,c),d=s*l,p={radius:s,innerRadiusOfArc:d,left:u,top:c,height:o,width:r,margin:i,transformString:h,innerRadiusFactor:l};return p},a.prototype.drawViewPort=function(e){var t=this.settings.kpiBands.separationRadians,i=a.InnerRadiusFactor,r=this.backgroundArc,n=this.color,o=[{fill:n(0),start:-Math.PI/2,end:-Math.PI/2+Math.PI/4-t},{fill:n(1),start:-Math.PI/2+1*Math.PI/4+t,end:-Math.PI/2+3*Math.PI/4-t},{fill:n(2),start:-Math.PI/2+3*Math.PI/4+t,end:Math.PI/2}],s=e.radius,l=e.transformString;this.updateKpiBands(s,i,l,o),r.innerRadius(s*i).outerRadius(s).startAngle(-Math.PI/2).endAngle(Math.PI/2),this.backgroundArcPath.attr("d",r).attr("transform",l);var u=this.foregroundArc;u.innerRadius(s*i).outerRadius(s).startAngle(-Math.PI/2),this.foregroundArcPath.datum({endAngle:this.lastAngle}).attr("transform",l).attr("d",u);var c=e.innerRadiusOfArc,h=e.left,d=e.top,p=e.margin,g=e.height,f=this.targetSettings;this.settings.targetLine.show&&null!=f.target?f.min>f.target||f.max<f.target?this.removeTargetElements():(this.updateTargetLine(s,c,h,d),this.appendTargetTextAlongArc(s,g,e.width,p)):this.removeTargetElements(),this.svg.attr("height",this.currentViewport.height).attr("width",this.currentViewport.width)},a.prototype.createTicks=function(e){for(var i=this.settings,r=this.targetSettings,e=r.max-r.min,n=i.labels.count,o=e/n,s=[],l=this.data,u=t.valueFormatter.create({format:t.valueFormatter.getFormatString(l.metadataColumn,a.formatStringProp),value:r.min,value2:r.max,formatSingleValues:!0,allowFormatBeautification:!0,columnType:l&&l.metadataColumn?l.metadataColumn.type:void 0}),c=0;n+1>c;c++)s.push(u.format(r.min+c*o));return s},a.prototype.updateInternal=function(e){var i=this.gaugeVisualProperties.height,a=this.gaugeVisualProperties.width,r=this.gaugeVisualProperties.radius,n=this.margin,o=t.AnimatorCommon.GetAnimationDuration(this.animator,e),s=this.data,l=this.lastAngle=-Math.PI/2+Math.PI*s.percent,u=this.createTicks(s.adjustedTotal);this.foregroundArcPath.transition().ease(this.settings.transition.ease).duration(o).call(this.arcTween,[l,this.foregroundArc]),this.appendTextAlongArc(u,r,i,a,n),this.updateVisualConfigurations(),this.updateVisualStyles(),t.TooltipManager.addTooltip(this.foregroundArcPath,function(e){return s.tooltipInfo})},a.prototype.updateVisualStyles=function(){this.mainGraphicsContext.selectAll("text").style({fill:this.style.labelText.color.value})},a.prototype.updateVisualConfigurations=function(){var e=this.settings;this.mainGraphicsContext.select("line").attr({stroke:e.targetLine.color,"stroke-width":e.targetLine.thickness}),this.backgroundArcPath.style("fill",e.arcColors.background),this.foregroundArcPath.style("fill",e.arcColors.foreground)},a.prototype.appendTextAlongArc=function(e,t,i,r,n){this.svg.selectAll(a.LabelText.selector).remove();for(var o=e.length,s=o-1,l=t+(i-t)/2+n.top,u=this.showMinMaxLabelsOnBottom(),c=this.style.labelText.fontSize,h=this.settings.labels.padding,d=0;o>d;d++)if(Math.floor(o/2)!==d&&this.showSideNumbersLabelText()){var p,g=n.left+r/2-t*Math.cos(Math.PI*d/s),f=l-t*Math.sin(Math.PI*d/s),m=2*d>o,y=!1;!u||0!==d&&d!==o-1?(p=m?"start":"end",g+=h*(m?1:-1)):(y=!0,f+=h/2,p=m?"end":"start");var v=this.mainGraphicsContext.append("text").attr({x:g,y:f,dy:y?c:0,"class":a.LabelText["class"]}).style({"text-anchor":p,"font-size":c}).text(e[d]);y||this.truncateTextIfNeeded(v,g,m)}},a.prototype.truncateTextIfNeeded=function(i,a,r){var n=r?this.currentViewport.width-a:a;i.call(t.AxisHelper.LabelLayoutStrategy.clip,n,e.TextMeasurementService.svgEllipsis)},a.prototype.appendTargetTextAlongArc=function(e,i,r,n){var o=this.targetSettings,s=o.target,l=(s-o.min)/(o.max-o.min),u=e+(i-e)/2+n.top,c=l>.5,h=this.settings.labels.padding,d=c?"start":"end",p=t.valueFormatter.create({format:t.valueFormatter.getFormatString(this.data.metadataColumn,a.formatStringProp),value:o.min,value2:o.max,formatSingleValues:!0,allowFormatBeautification:!0}),g=Math.asin(a.MinDistanceFromBottom/e)/Math.PI,f=g>l||l>1-g?c?1-g:g:l,m=n.left+r/2-(e+h)*Math.cos(Math.PI*f),y=u-(e+h)*Math.sin(Math.PI*f);this.targetText||(this.targetText=this.mainGraphicsContext.append("text").classed(a.TargetText["class"],!0)),this.targetText.attr({x:m,y:y}).style({"text-anchor":d,display:this.showTargetLabel?"":"none","font-size":this.style.labelText.fontSize}).text(p.format(s)),this.truncateTextIfNeeded(this.targetText,m,c),this.targetConnector||(this.targetConnector=this.mainGraphicsContext.append("line").classed(a.TargetConnector["class"],!0)),l===f?this.targetConnector.style("display","none"):this.targetConnector.attr({x1:n.left+r/2-e*Math.cos(Math.PI*l),y1:u-e*Math.sin(Math.PI*l),x2:m,y2:y}).style({"stroke-width":this.settings.targetLine.thickness,stroke:this.settings.targetLine.color,display:""})},a.prototype.arcTween=function(e,t){e.attrTween("d",function(e){var i=d3.interpolate(e.endAngle,t[0]);return function(a){return e.endAngle=i(a),t[1](e)}})},a.prototype.showMinMaxLabelsOnBottom=function(){return this.currentViewport.height>this.currentViewport.width&&this.settings.labels.count<=3},a.prototype.setMargins=function(){if(this.gaugeSmallViewPortProperties&&this.gaugeSmallViewPortProperties.smallGaugeMarginsOnSmallViewPort&&this.currentViewport.height<this.gaugeSmallViewPortProperties.MinHeightGaugeSideNumbersVisible){var e=this.gaugeSmallViewPortProperties.GaugeMarginsOnSmallViewPort;return void(this.margin={top:e,bottom:e,left:e,right:e})}if(this.margin={top:a.DefaultTopBottomMargin,bottom:a.DefaultTopBottomMargin,left:a.DefaultLeftRightMargin,right:a.DefaultLeftRightMargin},!this.showSideNumbersLabelText()||this.showMinMaxLabelsOnBottom()){var t=this.targetSettings;if(this.showTargetLabel){var i=(t.target-t.min)/(t.max-t.min);i>.5?this.margin.left=a.ReducedLeftRightMargin:this.margin.right=a.ReducedLeftRightMargin}else this.margin.left=this.margin.right=a.ReducedLeftRightMargin}},a.prototype.showSideNumbersLabelText=function(){return this.gaugeSmallViewPortProperties&&this.gaugeSmallViewPortProperties.hideGaugeSideNumbersOnSmallViewPort&&this.currentViewport.height<this.gaugeSmallViewPortProperties.MinHeightGaugeSideNumbersVisible?!1:!0},a.MIN_VALUE=-(1/0),a.MAX_VALUE=+(1/0),a.MinDistanceFromBottom=10,a.MinWidthForTargetLabel=150,a.DefaultTopBottomMargin=20,a.DefaultLeftRightMargin=45,a.ReducedLeftRightMargin=15,a.DEFAULT_MAX=1,a.DEFAULT_MIN=0,a.VisualClassName="gauge",a.DefaultStyleProperties={transition:{ease:"bounce"},arcColors:{background:"#e9e9e9",foreground:"#00B8AA"},targetLine:{show:!0,color:"#666666",thickness:2},labels:{count:2,padding:5},kpiBands:{show:!1,separationRadians:Math.PI/128,thickness:5}},a.DefaultTargetSettings={min:0,max:1,target:void 0},a.InnerRadiusFactor=.7,a.KpiBandDistanceFromMainArc=2,a.MainGaugeGroupElementName="mainGroup",a.LabelText={"class":"labelText",selector:".labelText"},a.TargetConnector={"class":"targetConnector",selector:".targetConnector"},a.TargetText={"class":"targetText",selector:".targetText"},a.formatStringProp={objectName:"general",propertyName:"formatString"},a.capabilities={dataRoles:[{name:i.y,kind:1,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Value")},{name:i.minValue,kind:1,displayName:e.data.createDisplayNameGetter("Role_DisplayName_MinValue")},{name:i.maxValue,kind:1,displayName:e.data.createDisplayNameGetter("Role_DisplayName_MaxValue")},{name:i.targetValue,kind:1,displayName:e.data.createDisplayNameGetter("Role_DisplayName_TargetValue")}],objects:{general:{properties:{formatString:{type:{formatting:{formatString:!0}}}}}},dataViewMappings:[{conditions:[{Y:{max:1},MinValue:{max:1},MaxValue:{max:1},TargetValue:{max:1}}],categorical:{values:{select:[{bind:{to:"Y"}},{bind:{to:"MinValue"}},{bind:{to:"MaxValue"}},{bind:{to:"TargetValue"}}]}}}]},a}();t.Gauge=a}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t=jsCommon.Utility,i=function(){function e(){}return e.prototype.init=function(e){this.element=e.element},e.prototype.onDataChanged=function(e){this.element.empty();var i=e.dataViews;if(i&&0!==i.length){var a=i[0].metadata.objects;if(a&&a.general){var r=$("<div class='imageBackground' />"),n=a.general.imageUrl;t.isValidImageDataUrl(n)&&r.css("backgroundImage","url("+n+")"),r.appendTo(this.element)}}},e.prototype.onResizing=function(e){},e.capabilities={objects:{general:{properties:{imageUrl:{type:{misc:{imageUrl:!0}}}}}}},e}();e.ImageVisual=i}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){function i(){return{dataRoles:[{name:"Category",kind:0},{name:"Y",kind:1}],dataViewMappings:[{categorical:{categories:{"for":{"in":"Category"}}}}],dataPoint:{displayName:e.data.createDisplayNameGetter("Visual_DataPoint"),properties:{fill:{displayName:e.data.createDisplayNameGetter("Visual_Fill"),type:{fill:{solid:{color:!0}}}}}}}}t.getConsoleWriterCapabilities=i}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t=function(){function e(){}return e.converter=function(e){return window.console.log("converter"),window.console.log(e),{}},e.prototype.init=function(e){var t=d3.select(e.element.get(0)).append("a");t.attr("href","http://microsoft.github.io/PowerBI-visuals/modules/powerbi.html").text("online help"),window.console.log("init"),window.console.log(e)},e.prototype.onResizing=function(e){},e.prototype.onDataChanged=function(e){},e.prototype.update=function(e){window.console.log("options"),window.console.log(e)},e}();e.ConsoleWriter=t}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){t.lineChartCapabilities={dataRoles:[{name:"Category",kind:0,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Axis")},{name:"Series",kind:0,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Legend")},{name:"Y",kind:1,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Values")}],objects:{general:{displayName:e.data.createDisplayNameGetter("Visual_General"),properties:{formatString:{type:{formatting:{formatString:!0}}}}},legend:{displayName:e.data.createDisplayNameGetter("Visual_Legend"),properties:{show:{displayName:e.data.createDisplayNameGetter("Visual_Show"),type:{bool:!0}},position:{displayName:e.data.createDisplayNameGetter("Visual_LegendPosition"),type:{formatting:{legendPosition:!0}}},showTitle:{displayName:e.data.createDisplayNameGetter("Visual_LegendShowTitle"),type:{bool:!0}},titleText:{displayName:e.data.createDisplayNameGetter("Visual_LegendTitleText"),type:{text:!0}}}},dataPoint:{displayName:e.data.createDisplayNameGetter("Visual_DataPoint"),properties:{fill:{displayName:e.data.createDisplayNameGetter("Visual_Fill"),type:{fill:{solid:{color:!0}}}}}},categoryAxis:{displayName:e.data.createDisplayNameGetter("Visual_XAxis"),properties:{show:{displayName:e.data.createDisplayNameGetter("Visual_Show"),type:{bool:!0}},start:{displayName:e.data.createDisplayNameGetter("Visual_Axis_Start"),type:{numeric:!0}},end:{displayName:e.data.createDisplayNameGetter("Visual_Axis_End"),type:{numeric:!0}},axisType:{displayName:e.data.createDisplayNameGetter("Visual_Axis_Type"),type:{formatting:{axisType:!0}}},showAxisTitle:{displayName:e.data.createDisplayNameGetter("Visual_Axis_Title"),type:{bool:!0}},axisStyle:{displayName:e.data.createDisplayNameGetter("Visual_Axis_Style"),type:{formatting:{axisStyle:!0}}}}},valueAxis:{displayName:e.data.createDisplayNameGetter("Visual_YAxis"),properties:{show:{displayName:e.data.createDisplayNameGetter("Visual_Show"),type:{bool:!0}},position:{displayName:e.data.createDisplayNameGetter("Visual_YAxis_Position"),type:{formatting:{yAxisPosition:!0}}},start:{displayName:e.data.createDisplayNameGetter("Visual_Axis_Start"),type:{numeric:!0}},end:{displayName:e.data.createDisplayNameGetter("Visual_Axis_End"),type:{numeric:!0}},showAxisTitle:{displayName:e.data.createDisplayNameGetter("Visual_Axis_Title"),type:{bool:!0}},axisStyle:{displayName:e.data.createDisplayNameGetter("Visual_Axis_Style"),type:{formatting:{axisStyle:!0}}}}},labels:{displayName:e.data.createDisplayNameGetter("Visual_DataPointsLabels"),properties:{show:{displayName:e.data.createDisplayNameGetter("Visual_Show"),type:{bool:!0}},color:{displayName:e.data.createDisplayNameGetter("Visual_LabelsFill"),type:{fill:{solid:{color:!0}}}},labelDisplayUnits:{displayName:e.data.createDisplayNameGetter("Visual_DisplayUnits"),type:{formatting:{labelDisplayUnits:!0}}},labelPrecision:{displayName:e.data.createDisplayNameGetter("Visual_Precision"),type:{numeric:!0}}}}},dataViewMappings:[{conditions:[{Category:{max:1},Series:{max:0}},{Category:{max:1},Series:{min:1,max:1},Y:{max:1}}],categorical:{categories:{"for":{"in":"Category"},dataReductionAlgorithm:{top:{}}},values:{group:{by:"Series",select:[{"for":{"in":"Y"}}],dataReductionAlgorithm:{top:{}}}}}}],sorting:{"default":{}}},t.lineChartProps={general:{formatString:{objectName:"general",propertyName:"formatString"}},dataPoint:{fill:{objectName:"dataPoint",propertyName:"fill"}},categoryAxis:{axisType:{objectName:"categoryAxis",propertyName:"axisType"}}}}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var i=jsCommon.EnumExtensions,a=function(){function a(e){this.isScrollable=e.isScrollable?e.isScrollable:!1,this.lineType=e.chartType?e.chartType:1,this.interactivityService=e.interactivityService,this.animator=e.animator}return a.customizeQuery=function(e){var i=e.dataViewMappings[0];if(i&&i.categorical&&i.categorical.categories){var a=i.categorical.categories,r=a["for"]["in"].items;if(!jsCommon.ArrayExtensions.isUndefinedOrEmpty(r)){var n,o=r[0].type;i.metadata&&(n=i.metadata.objects),t.CartesianChart.getIsScalar(n,t.lineChartProps.categoryAxis.axisType,o)&&(a.dataReductionAlgorithm={sample:{}})}}},a.getSortableRoles=function(e){var i=e.dataViewMappings[0];if(!i||!i.categorical||!i.categorical.categories)return null;var a=i.categorical.categories,r=a["for"]["in"].items;if(!jsCommon.ArrayExtensions.isUndefinedOrEmpty(r)){var n,o=r[0].type;if(i.metadata&&(n=i.metadata.objects),!t.CartesianChart.getIsScalar(n,t.lineChartProps.categoryAxis.axisType,o))return["Category"]}return null},a.converter=function(e,i,a,r,n){var o=e.categorical,s=o.categories&&o.categories.length>0?o.categories[0]:{source:void 0,values:[i],identity:void 0},l=t.CartesianHelper.getCategoryAxisProperties(e.metadata);r=t.CartesianHelper.isScalar(r,l),o=t.ColumnUtil.applyUserMinMax(r,o,l);var u=t.lineChartProps.general.formatString,c=t.AxisHelper.getCategoryValueType(s.source,r),h=t.AxisHelper.isDateTime(c),d=s.values,p=[],g=o.values?o.values.length:0,f=!(!o.values||!o.values.source),m=o.values,y=t.dataLabelUtils.getDefaultPointLabelSettings();if(e.metadata&&e.metadata.objects){var v=e.metadata.objects,C=v.labels;C&&(void 0!==C.show&&(y.show=C.show),void 0!==C.color&&(y.labelColor=C.color.solid.color),void 0!==C.labelDisplayUnits&&(y.displayUnits=C.labelDisplayUnits),void 0!==C.labelPrecision&&(y.precision=C.labelPrecision>=0?C.labelPrecision:0))}var b,x=new t.ColorHelper(a,t.lineChartProps.dataPoint.fill);e.categorical.values&&(b=e.categorical.values.grouped());for(var S=0;g>S;S++){for(var w=o.values[S],_=w.source,T=[],D=b[S],P=f&&D?t.SelectionId.createWithIdAndMeasure(D.identity,w.source.queryName):t.SelectionId.createWithMeasure(w.source.queryName),M=P.getKey(),L=this.getColor(x,f,m,b,S,D),A=0,N=w.values.length;N>A;A++){var V=d[A],I=t.AxisHelper.normalizeNonFiniteNumber(w.values[A]);if(!r||null!=V&&null!=I){var o=e.categorical,R=t.TooltipBuilder.createTooltipInfo(u,o.categories,V,o.values,I,null,S);T.push({categoryValue:h&&V?V.getTime():V,value:I,categoryIndex:A,seriesIndex:S,tooltipInfo:R,selected:!1,identity:P,key:JSON.stringify({ser:M,catIdx:A}),labelFill:y.labelColor,labelFormatString:_.format})}}n&&n.applySelectionStateToData(T),T.length>0&&p.push({key:M,lineIndex:S,color:L,xCol:s.source,yCol:w.source,data:T,identity:P,selected:!1})}var l=t.CartesianHelper.getCategoryAxisProperties(e.metadata),H=t.CartesianHelper.getValueAxisProperties(e.metadata),E=[];if(m)for(var O=0;O<m.length;O++)m[O]&&m[O].source&&m[O].source.displayName&&E.push({displayName:m[O].source.displayName});var F=t.converterHelper.createAxesLabels(l,H,s.source,E),G=!1;return n&&n.applySelectionStateToData(p)&&(G=!0),{series:p,isScalar:r,dataLabelsSettings:y,axesLabels:{x:F.xAxisLabel,y:F.yAxisLabel},hasDynamicSeries:f,hasSelection:G,categoryMetadata:s.source,categories:d}},a.getInteractiveLegendDomElement=function(e){return e.children(".interactive-legend").get(0)},a.getColor=function(e,t,i,a,r,n){var o;return t?a&&a[r]&&(o=a[r].objects):i[r]&&(o=i[r].source.objects),t&&n?e.getColorForSeriesValue(o,i.identityFields,n.name):e.getColorForMeasure(o,i[r].source.queryName)},a.prototype.init=function(e){this.options=e;var i=this.element=e.element;this.host=e.host,this.currentViewport=e.viewport,this.colors=e.style.colorPalette.dataColors,this.isInteractiveChart=e.interactivity&&e.interactivity.isInteractiveLegend,this.cartesianVisualHost=e.cartesianHost,i.addClass(a.ClassName);var r=e.svg;this.clearCatcher=r.select(".clearCatcher"),this.mainGraphicsSVG=r.append("svg").classed("lineChartSVG",!0).style("overflow","visible"),this.mainGraphicsContext=this.mainGraphicsSVG.append("svg").style("overflow","hidden").append("g").classed(a.MainGraphicsContextClassName,!0),this.toolTipContext=r.append("g").classed("hover-line",!0),this.toolTipContext.append(a.LineElementName).attr("x1",0).attr("x2",0).attr("y1",0).attr("y2",0);var n=this.hoverLine=this.toolTipContext.select(a.LineElementName);this.isInteractiveChart&&n.classed("interactive",!0),this.selectionCircles=[];var o=t.AxisHelper.ToolTip.createCallout();this.element.append(o),n.style("opacity",t.SVGUtil.AlmostZero),o.css("opacity",t.SVGUtil.AlmostZero);var s=this;this.xAxisProperties={axis:null,scale:null,axisType:null,formatter:null,graphicsContext:null,values:null,axisLabel:null,isCategoryAxis:!0};var l=function(){var e=d3.mouse(this)[0],t=s.findIndex(e);s.selectColumn(t)};if(this.isInteractiveChart){var u=a.getInteractiveLegendDomElement(this.element),c=d3.behavior.drag().origin(Object).on("drag",l);r.call(c),d3.select(u).call(c),r.on("click",l),d3.select(u).on("click",l)}},a.prototype.setData=function(i){if(this.data={series:[],dataLabelsSettings:t.dataLabelUtils.getDefaultPointLabelSettings(),axesLabels:{x:null,y:null},hasDynamicSeries:!1,hasSelection:!1,categories:[],categoryMetadata:void 0},i.length>0){var r=i[0];if(r&&r.categorical){var n=this.dataViewCat=r.categorical,o=n.categories,s=e.ValueType.fromDescriptor({text:!0});o&&o.length>0&&o[0].source&&o[0].source.type&&(s=o[0].source.type);var l=a.converter(r,t.valueFormatter.format(null),this.cartesianVisualHost.getSharedColors(),t.CartesianChart.getIsScalar(r.metadata?r.metadata.objects:null,t.lineChartProps.categoryAxis.axisType,s),this.interactivityService);this.data=l}}},a.prototype.calculateLegend=function(){return this.createLegendDataPoints(0)},a.prototype.hasLegend=function(){return this.data&&(this.data.hasDynamicSeries||this.data.series&&this.data.series.length>1)},a.prototype.setFilteredData=function(t,i){var r=i-t,n=this.clippedData=e.Prototype.inherit(this.data);return n.series=a.sliceSeries(n.series,r,t),n.categories=n.categories.slice(t,i),n},a.prototype.calculateAxesProperties=function(i){var r=this,n=this.data,o=i.viewport,s=i.margin;this.currentViewport=o,this.margin=s;var l=n.series&&n.series.length>0?n.series[0].data.length:0,u=t.CartesianChart.MinOrdinalRectThickness,c=this.data.isScalar,h=this.getPreferredPlotArea(c,l,u);if(h.width===this.currentViewport.width&&(h.width-=s.left+s.right),h.height-=s.top+s.bottom,this.clippedData=void 0,n&&!c&&!this.isScrollable){var d=this.getCategoryCount(l),p=Math.min(l,d);p!==l&&(n=this.clippedData=e.Prototype.inherit(n),this.clippedData.series=a.sliceSeries(n.series,p))}var g,f;n.series&&n.series.length>0&&(g=n.series[0].xCol,f=n.series[0].yCol);var m=t.AxisHelper.createValueDomain(n.series,!1),y=t.AxisHelper.combineDomain(i.forcedYDomain,m);this.yAxisProperties=t.AxisHelper.createAxis({pixelSpan:h.height,dataDomain:y,metaDataColumn:f,formatStringProp:t.lineChartProps.general.formatString,outerPadding:0,isScalar:!0,isVertical:!0,forcedTickCount:i.forcedTickCount,useTickIntervalForDisplayUnits:!0,isCategoryAxis:!1,shouldClamp:t.AxisHelper.scaleShouldClamp(y,m)});var v=t.AxisHelper.createDomain(n.series,this.xAxisProperties.axisType,this.data.isScalar,i.forcedXDomain);return this.xAxisProperties=t.AxisHelper.createAxis({pixelSpan:h.width,dataDomain:v,metaDataColumn:g,formatStringProp:t.lineChartProps.general.formatString,outerPadding:0,isScalar:this.data.isScalar,isVertical:!1,forcedTickCount:i.forcedTickCount,useTickIntervalForDisplayUnits:!0,getValueFn:function(e,t){return r.lookupXValue(e,t)},categoryThickness:t.CartesianChart.getCategoryThickness(n.series,l,this.getAvailableWidth(),v,c),isCategoryAxis:!0}),this.xAxisProperties.axisLabel=i.showCategoryAxisLabel?n.axesLabels.x:null,this.yAxisProperties.axisLabel=i.showValueAxisLabel?n.axesLabels.y:null,[this.xAxisProperties,this.yAxisProperties]},a.prototype.enumerateObjectInstances=function(e){switch(e.objectName){case"dataPoint":return this.enumerateDataPoints();case"labels":return t.dataLabelUtils.enumerateDataLabels(this.data.dataLabelsSettings,!1,!0,!0)}},a.prototype.enumerateDataPoints=function(){var e=this.data;if(e&&e.series&&0!==e.series.length){for(var i=[],a=t.lineChartProps.general.formatString,r=e.series,n=r.length,o=0;n>o;o++){var s=t.ColorHelper.normalizeSelector(r[o].identity.getSelector()),l=t.converterHelper.getFormattedLegendLabel(r[o].yCol,this.dataViewCat.values,a);i.push({objectName:"dataPoint",displayName:l,selector:s,properties:{fill:{solid:{color:r[o].color}}}})}return i}},a.prototype.overrideXScale=function(e){this.xAxisProperties=e},a.prototype.onClearSelection=function(){this.interactivityService&&this.interactivityService.clearSelection()},a.prototype.render=function(e){var i=t.AnimatorCommon.GetAnimationDuration(this.animator,e);this.isInteractiveChart?this.renderOld(i):this.renderNew(i),t.SVGUtil.flushAllD3TransitionsIfNeeded(this.options)},a.prototype.renderNew=function(e){var r=this,n=this.clippedData?this.clippedData:this.data;if(n){var o,s=this.margin,l=this.currentViewport,u=l.height-(s.top+s.bottom),c=this.xAxisProperties.scale,h=this.yAxisProperties.scale,d=n.hasSelection,p=i.hasFlag(this.lineType,2);p&&(o=d3.svg.area().x(function(e){return c(r.getXValue(e))}).y0(u).y1(function(e){return h(e.value)}).defined(function(e){return null!==e.value}));var g=d3.svg.line().x(function(e){return c(r.getXValue(e))}).y(function(e){return h(e.value)}).defined(function(e){return null!==e.value});i.hasFlag(this.lineType,4)&&(g.interpolate("basis"),o&&o.interpolate("basis"));var f=this.extraLineShift();if(this.mainGraphicsContext.attr("transform",t.SVGUtil.translate(a.HorizontalShift+f,0)),this.mainGraphicsContext.attr("height",this.getAvailableHeight()).attr("width",this.getAvailableWidth()),this.toolTipContext.attr("transform",t.SVGUtil.translate(a.HorizontalShift+f,0)),p){var m=this.mainGraphicsContext.selectAll(a.CategoryAreaClassSelector).data(n.series,function(e){return e.identity.getKey()});m.enter().append(a.PathElementName).classed(a.CategoryAreaClassName,!0),m.style("fill",function(e){return e.color}).style("fill-opacity",function(e){return d&&!e.selected?a.DimmedAreaFillOpacity:a.AreaFillOpacity}).transition().ease("linear").duration(e).attr("d",function(e){return o(e.data)}),m.exit().remove()}var y=this.mainGraphicsContext.selectAll(".line").data(n.series,function(e){return e.identity.getKey()});y.enter().append(a.PathElementName).classed("line",!0),y.style("stroke",function(e){return e.color}).style("stroke-opacity",function(e){return t.ColumnUtil.getFillOpacity(e.selected,!1,d,!1)}).transition().ease("linear").duration(e).attr("d",function(e){return g(e.data)}),y.exit().remove();var v=this.mainGraphicsContext.selectAll(".interactivity-line").data(n.series,function(e){return e.identity.getKey()});v.enter().append(a.PathElementName).classed("interactivity-line",!0),v.attr("d",function(e){return g(e.data)}),v.exit().remove();var C=this.mainGraphicsContext.selectAll(a.CategoryClassSelector).data(n.series,function(e){return e.identity.getKey()});C.enter().append("g").classed(a.CategoryClassName,!0),C.exit().remove();var b=C.selectAll(a.CategoryValuePoint.selector).data(function(e){return e.data.filter(function(t,i){return r.shouldDrawCircle(e,i)})},function(e){return e.key});if(b.enter().append(a.CircleElementName).classed(a.CategoryValuePoint["class"],!0),b.style("fill",function(){var e=d3.select(this.parentNode).datum();return e.color}).style("fill-opacity",function(){var e=d3.select(this.parentNode).datum();return t.ColumnUtil.getFillOpacity(e.selected,!1,d,!1)}).transition().duration(e).attr({cx:function(e,t){return c(r.getXValue(e))},cy:function(e,t){return h(e.value)},r:a.CircleRadius}),b.exit().remove(),n.dataLabelsSettings.show){for(var x=t.dataLabelUtils.getLineChartLabelLayout(c,h,n.dataLabelsSettings,n.isScalar,this.yAxisProperties.formatter),S=[],w=0,_=n.series.length;_>w;w++)Array.prototype.push.apply(S,n.series[w].data);t.dataLabelUtils.drawDefaultLabelsForDataPointChart(S,this.mainGraphicsSVG,x,this.currentViewport),this.mainGraphicsSVG.select(".labels").attr("transform",t.SVGUtil.translate(a.HorizontalShift+f,0))}else t.dataLabelUtils.cleanDataLabels(this.mainGraphicsSVG);var T=function(e){var t=e.elementCoordinates[0];return a.getTooltipInfoByPointX(r,e.data,t)};if(t.TooltipManager.addTooltip(v,T,!0),p&&t.TooltipManager.addTooltip(m,T,!0),t.TooltipManager.addTooltip(b,function(e){return e.data.tooltipInfo},!0),this.interactivityService){for(var D=n.series.slice(),w=0,_=n.series.length;_>w;w++)D=D.concat(n.series[w].data);var P={dataPoints:D,lines:y,interactivityLines:v,dots:b,areas:m,background:d3.selectAll(this.element.toArray()),clearCatcher:this.clearCatcher};this.interactivityService.apply(this,P)}}},a.prototype.renderOld=function(e){var r=this,n=this.clippedData?this.clippedData:this.data;if(n){var o,s=this.margin,l=this.currentViewport,u=l.height-(s.top+s.bottom),c=this.xAxisProperties.scale,h=this.yAxisProperties.scale,d=this.data.hasSelection;i.hasFlag(this.lineType,2)&&(o=d3.svg.area().x(function(e){return c(r.getXValue(e))}).y0(u).y1(function(e){return h(e.value)}).defined(function(e){return null!==e.value}));var p=d3.svg.line().x(function(e){return c(r.getXValue(e))}).y(function(e){return h(e.value)}).defined(function(e){return null!==e.value});i.hasFlag(this.lineType,4)&&(p.interpolate("basis"),o&&o.interpolate("basis"));var g=this.extraLineShift();if(this.mainGraphicsContext.attr("transform",t.SVGUtil.translate(a.HorizontalShift+g,0)),this.mainGraphicsContext.attr("height",this.getAvailableHeight()).attr("width",this.getAvailableWidth()),this.toolTipContext.attr("transform",t.SVGUtil.translate(a.HorizontalShift+g,0)),i.hasFlag(this.lineType,2)){var f=this.mainGraphicsContext.selectAll(a.CategoryAreaClassSelector).data(n.series,function(e){return e.identity.getKey()}),m=f.enter().append("g").classed(a.CategoryAreaClassName,!0);m.append(a.PathElementName);var y=this.mainGraphicsContext.selectAll(a.CategoryAreaClassSelector);y.select(a.PathElementName).transition().ease("linear").duration(e).attr("d",function(e){return o(e.data)}).style("fill",function(e){return e.color}).style("fill-opacity",function(e){return d&&!e.selected?a.DimmedAreaFillOpacity:a.AreaFillOpacity}),f.exit().remove()}var v=this.mainGraphicsContext.selectAll(a.CategoryClassSelector).data(n.series,function(e){return e.identity.getKey()}),C=v.enter().append("g").classed(a.CategoryClassName,!0);if(C.append(a.PathElementName),C.selectAll(a.CategoryValuePoint.selector).data(function(e){return e.data}).enter().append(a.CircleElementName).classed(a.CategoryValuePoint["class"],!0),v.exit().remove(),this.isInteractiveChart&&!this.dragHandle){var b=this.getAvailableHeight();this.dragHandle=this.toolTipContext.append("circle").attr("cx",0).attr("cy",b).attr("r","6px").classed("drag-handle",!0)}for(var x=v.data().length;this.selectionCircles.length<x;){var S=this.toolTipContext.append(a.CircleElementName).classed(a.CircleClassName,!0).attr("r",a.CircleRadius).style("opacity",0);
this.selectionCircles.push(S)}for(;this.selectionCircles.length>x;)this.selectionCircles.pop().remove();var w=this.mainGraphicsContext.selectAll(a.CategoryClassSelector),_=w.select(a.PathElementName).classed("line",!0).style("stroke",function(e){return e.color}).style("stroke-opacity",function(e){return t.ColumnUtil.getFillOpacity(e.selected,!1,d,!1)});_.transition().ease("linear").duration(e).attr("d",function(e){return p(e.data)});var T=this,D=w.selectAll(a.CategoryValuePoint.selector),P=D.style("fill",function(){var e=d3.select(this.parentNode).datum();return e.color}).style("fill-opacity",function(){var e=d3.select(this.parentNode).datum();return t.ColumnUtil.getFillOpacity(e.selected,!1,d,!1)}).transition().duration(e).attr({cx:function(e,t){var i=d3.select(this.parentNode).datum(),a=T.shouldDrawCircle(i,t);return a?c(T.getXValue(e)):0},cy:function(e,t){var i=d3.select(this.parentNode).datum(),a=T.shouldDrawCircle(i,t);return a?h(e.value):0},r:function(e,t){var i=d3.select(this.parentNode).datum(),r=T.shouldDrawCircle(i,t);return r?a.CircleRadius:0}});if(this.isInteractiveChart&&this.hasDataPoint(n.series)){var M=D.size(),L=0;P.each("end",function(){L++,L===M&&r.selectColumn(0,!0)})}if(n.dataLabelsSettings.show){for(var A=t.dataLabelUtils.getLineChartLabelLayout(c,h,n.dataLabelsSettings,n.isScalar,this.yAxisProperties.formatter),N=[],V=0,I=n.series.length;I>V;V++)Array.prototype.push.apply(N,n.series[V].data);t.dataLabelUtils.drawDefaultLabelsForDataPointChart(N,this.mainGraphicsSVG,A,this.currentViewport),this.mainGraphicsSVG.select(".labels").attr("transform",t.SVGUtil.translate(a.HorizontalShift+g,0))}else t.dataLabelUtils.cleanDataLabels(this.mainGraphicsSVG);if(t.TooltipManager.addTooltip(v,function(e){var t=e.elementCoordinates[0];return a.getTooltipInfoByPointX(T,e.data,t)},!0),v.exit().remove(),this.interactivityService){for(var R=n.series.slice(),V=0,I=n.series.length;I>V;V++)R=R.concat(n.series[V].data);var H={dataPoints:R,lines:_,interactivityLines:_,dots:this.mainGraphicsContext.selectAll(".cat .dot"),areas:y,clearCatcher:this.clearCatcher};this.interactivityService.apply(this,H)}}},a.getTooltipInfoByPointX=function(i,a,r){var n=0;if(i.data.isScalar){var o=e.visuals.AxisHelper.invertScale(i.xAxisProperties.scale,r);n=i.findClosestXAxisIndex(o,a.data)}else{var s=i.xAxisProperties.scale;n=t.AxisHelper.getOrdinalScaleClosestDataPointIndex(s,r)}return a.data[n].tooltipInfo},a.prototype.getVisualCategoryAxisIsScalar=function(){return this.data?this.data.isScalar:!1},a.prototype.getSupportedCategoryAxisType=function(){var i=this.dataViewCat?this.dataViewCat.categories:void 0,a=e.ValueType.fromDescriptor({text:!0});i&&i.length>0&&i[0].source&&i[0].source.type&&(a=i[0].source.type);var r=t.AxisHelper.isOrdinal(a);return r?e.axisType.categorical:e.axisType.both},a.prototype.getPreferredPlotArea=function(e,i,a){return t.CartesianChart.getPreferredPlotArea(i,a,this.currentViewport,this.isScrollable,e)},a.prototype.getCategoryCount=function(e){var i=this.getAvailableWidth(),a=t.CartesianChart.MinOrdinalRectThickness;return Math.min(Math.round((i-a*t.CartesianChart.OuterPaddingRatio*2)/a),e)},a.prototype.getAvailableWidth=function(){return this.currentViewport.width-(this.margin.left+this.margin.right)},a.prototype.getAvailableHeight=function(){return this.currentViewport.height-(this.margin.top+this.margin.bottom)},a.sliceSeries=function(t,i,a){void 0===a&&(a=0);var r=[];if(t&&t.length>0)for(var n=0,o=t.length;o>n;n++)r[n]=e.Prototype.inherit(t[n]),r[n].data=t[n].data.slice(a,a+i);return r},a.prototype.extraLineShift=function(){if(!this.data.isScalar){var e=this.xAxisProperties.scale;if(e.rangeBand)return e.rangeBand()/2}return 0},a.prototype.hasDataPoint=function(e){if(0===e.length)return!1;for(var t=0,i=e.length;i>t;t++)if(e[t].data.length>0)return!0;return!1},a.prototype.lookupXValue=function(e,i){var a=t.AxisHelper.isDateTime(i);if(a&&this.data.isScalar)return new Date(e);if(this.data&&this.data.series&&this.data.series.length>0){var r=this.data.series[0];if(r){var n=r.data;if(n){var o=n[e];if(o)return a?new Date(o.categoryValue):o.categoryValue}}}return e},a.prototype.getXValue=function(e){return this.data.isScalar?e.categoryValue:e.categoryIndex},a.prototype.shouldDrawCircle=function(e,t){var i=e.data.length,a=t===i-1,r=0===t;return t>i-1||null===e.data[t]||null===e.data[t].value?!1:r&&a?!0:r&&i>1&&null===e.data[t+1].value?!0:!r&&a&&null===e.data[t-1].value?!0:r||a||null!==e.data[t-1].value||null!==e.data[t+1].value?!1:!0},a.prototype.selectColumn=function(e,t){if(void 0===t&&(t=!1),t||this.lastInteractiveSelectedColumnIndex!==e){this.lastInteractiveSelectedColumnIndex=e;var i=this.getChartX(e);this.setHoverLine(i);var a=this.createLegendDataPoints(e);this.options.cartesianHost.updateLegend(a)}},a.prototype.setHoverLine=function(e){this.hoverLine.attr("x1",e).attr("x2",e).attr("y1",0).attr("y2",this.getAvailableHeight()).style("opacity",1);var t=this;this.mainGraphicsContext.selectAll(a.CategoryClassSelector).selectAll(a.PathElementName).each(function(i){var a=this,r=i.color,n=t.selectionCircles[i.lineIndex];n.attr({cx:e,cy:function(){var i=d3.select(a).node(),r=t.getPosition(e,i);return r.y}}).style({opacity:1,fill:r}),t.dragHandle&&t.dragHandle.attr("cx",e)})},a.prototype.getChartX=function(t){var i;i=this.data.isScalar?Math.max(0,this.xAxisProperties.scale(this.data.series[0].data[t].categoryValue)):Math.max(0,this.xAxisProperties.scale(t));var a=e.visuals.AxisHelper.extent(this.xAxisProperties.scale)[1];return i=Math.min(i,a),isNaN(i)?void 0:i},a.prototype.findIndex=function(t){t-=this.margin.left+e.visuals.LineChart.HorizontalShift;var i=e.visuals.AxisHelper.invertScale(this.xAxisProperties.scale,t),a=i;return this.data.isScalar&&(a=this.findClosestXAxisIndex(i,this.data.series[0].data)),a},a.prototype.findClosestXAxisIndex=function(e,t){var i=-1,a=Number.MAX_VALUE;for(var r in t){var n=Math.abs(e-t[r].categoryValue);a>n&&(a=n,i=r)}return i},a.prototype.getPosition=function(e,i){for(var a,r,n=i.getTotalLength(),o=0,s=n;;){if(r=Math.floor((o+s)/2),a=i.getPointAtLength(r),t.SVGUtil.ensureValidSVGPoint(a),(r===s||r===o)&&a.x!==e)break;if(a.x>e)s=r;else{if(!(a.x<e))break;o=r}}return a},a.prototype.createLegendDataPoints=function(e){var i=this.data;if(!i)return null;var a,r=[];if(i.series.length>0){var n=i.series[0].data[e],o=t.AxisHelper.isDateTime(this.xAxisProperties.axisType),s=o&&this.data.isScalar&&n?n.categoryValue:e;a=n&&this.lookupXValue(s,this.xAxisProperties.axisType)}for(var l=t.lineChartProps.general.formatString,u=null,c=0,h=i.series.length;h>c;c++){var d=i.series[c],p=d.data,g=p[e],f=g&&g.value,m=t.converterHelper.getFormattedLegendLabel(d.yCol,this.dataViewCat.values,l);u=d.yCol,r.push({color:d.color,icon:t.LegendIcon.Line,label:m,category:t.valueFormatter.format(a,t.valueFormatter.getFormatString(d.xCol,l)),measure:t.valueFormatter.format(f,t.valueFormatter.getFormatString(d.yCol,l)),identity:d.identity,selected:!1})}var y=this.dataViewCat?this.dataViewCat.values:null,v=y&&y.source?y.source.displayName:"";return{title:v,dataPoints:r}},a.prototype.accept=function(e,t){e.visitLineChart(t)},a.ClassName="lineChart",a.MainGraphicsContextClassName="mainGraphicsContext",a.CategoryClassName="cat",a.CategoryClassSelector=".cat",a.CategoryValuePoint={"class":"dot",selector:".dot"},a.CategoryAreaClassName="catArea",a.CategoryAreaClassSelector=".catArea",a.HorizontalShift=0,a.CircleRadius=4,a.PathElementName="path",a.CircleElementName="circle",a.CircleClassName="selection-circle",a.LineElementName="line",a.AreaFillOpacity=.4,a.DimmedAreaFillOpacity=.2,a}();t.LineChart=a}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){function i(e,t){return{m00:1,m01:0,m02:e,m10:0,m11:1,m12:t}}function a(e,t){return{m00:e,m01:0,m02:0,m10:0,m11:t,m12:0}}function r(e){var t=e,i=Math.sin(t),a=Math.cos(t);return{m00:a,m01:-i,m02:0,m10:i,m11:a,m12:0}}function n(e){var t=e.m00*e.m11-e.m01*e.m10,i=1/t;return{m00:e.m11*i,m01:-e.m01*i,m02:(e.m01*e.m12-e.m02*e.m11)*i,m10:-e.m10*i,m11:e.m00*i,m12:-(e.m00*e.m12-e.m10*e.m02)*i}}function o(e,t){return{m00:e.m00*t.m00+e.m01*t.m10,m01:e.m00*t.m01+e.m01*t.m11,m02:e.m00*t.m02+e.m01*t.m12+e.m02,m10:e.m10*t.m00+e.m11*t.m10,m11:e.m10*t.m01+e.m11*t.m11,m12:e.m10*t.m02+e.m11*t.m12+e.m12}}var s=function(){function e(e,t){void 0===e&&(e=0),void 0===t&&(t=0),this.x=e||0,this.y=t||0}return e}();t.Point=s;var l=function(){function e(e,t,i,a){void 0===e&&(e=0),void 0===t&&(t=0),void 0===i&&(i=0),void 0===a&&(a=0),this.left=e||0,this.top=t||0,this.width=i||0,this.height=a||0}return e}();t.Rect=l;var u=function(){function e(e){this.matrix=e||{m00:1,m01:0,m02:0,m10:0,m11:1,m12:0}}return e.prototype.applyToPoint=function(e){if(!e)return e;var t=this.matrix;return{x:t.m00*e.x+t.m01*e.y+t.m02,y:t.m10*e.x+t.m11*e.y+t.m12}},e.prototype.applyToRect=function(e){if(!e)return e;var t=e.left,i=e.top,a=this.matrix,r=1!==a.m00||1!==a.m11,n=0!==a.m01||0!==a.m10;if(!n&&!r)return{left:t+a.m02,top:i+a.m12,width:e.width,height:e.height};var o,s,l,u,c=e.left+e.width,h=e.top+e.height;if(n){var d=a.m00*t+a.m01*i+a.m02,p=a.m10*t+a.m11*i+a.m12,g=a.m00*t+a.m01*h+a.m02,f=a.m10*t+a.m11*h+a.m12,m=a.m00*c+a.m01*i+a.m02,y=a.m10*c+a.m11*i+a.m12,v=a.m00*c+a.m01*h+a.m02,C=a.m10*c+a.m11*h+a.m12;o=Math.min(d,g,m,v),s=Math.max(d,g,m,v),l=Math.min(p,f,y,C),u=Math.max(p,f,y,C)}else{var d=a.m00*t+a.m02,p=a.m11*i+a.m12,v=a.m00*c+a.m02,C=a.m11*h+a.m12;o=Math.min(d,v),s=Math.max(d,v),l=Math.min(p,C),u=Math.max(p,C)}return{left:o,top:l,width:s-o,height:u-l}},e.prototype.translate=function(e,t){if(0!==e||0!==t){var a=i(e,t);this.matrix=o(this.matrix,a),this._inverse=null}},e.prototype.scale=function(e,t){if(1!==e||1!==t){var i=a(e,t);this.matrix=o(this.matrix,i),this._inverse=null}},e.prototype.rotate=function(e){if(0!==e){var t=r(e);this.matrix=o(this.matrix,t),this._inverse=null}},e.prototype.add=function(e){e&&(this.matrix=o(this.matrix,e.matrix),this._inverse=null)},e.prototype.getInverse=function(){return this._inverse||(this._inverse=new e(n(this.matrix))),this._inverse},e}();t.Transform=u,t.createTranslateMatrix=i,t.createScaleMatrix=a,t.createRotationMatrix=r,t.createInverseMatrix=n;var c=11,h=function(){function t(){this._locationRect=new Microsoft.Maps.LocationRect(new Microsoft.Maps.Location(30,-30),60,60)}return t.prototype.reCalc=function(t,i,a){var r=[this._locationRect.getNorthwest(),this._locationRect.getSoutheast()],i=i/2,a=a/2;if(!this._baseRect){var n=e.visuals.BI.Services.MapServices.locationToPixelXY(this._locationRect.getNorthwest(),c),o=e.visuals.BI.Services.MapServices.locationToPixelXY(this._locationRect.getSoutheast(),c);this._baseRect=new l(n.x,n.y,o.x-n.x,o.y-n.y)}var s=t.tryLocationToPixel(r);this._currentRect=new l(s[0].x+i,s[0].y+a,s[1].x-s[0].x,s[1].y-s[0].y)},Object.defineProperty(t.prototype,"scale",{get:function(){return this._baseRect?this._currentRect.width/this._baseRect.width:1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"transform",{get:function(){var e=this._baseRect,t=this._currentRect,i=new u;return i.translate(t.left,t.top),i.scale(t.width/e.width,t.height/e.height),i.translate(-e.left,-e.top),i},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"outherTransform",{get:function(){var e=this._baseRect,t=this._currentRect,i=new u;i.translate(t.left,t.top);var a=Math.sqrt(t.width/e.width);return i.scale(a,a),i},enumerable:!0,configurable:!0}),t.prototype.setViewBox=function(e){var t=e.getBoundingClientRect(),i=this._currentRect;e.setAttribute("viewBox",[-i.left,-i.top,t.width,t.height].join(" "))},Object.defineProperty(t.prototype,"innerTransform",{get:function(){var e=this._baseRect,t=this._currentRect,i=new u,a=t.width/e.width;return i.scale(a,a),i.translate(-e.left,-e.top),i},enumerable:!0,configurable:!0}),t.prototype.transformToString=function(e){var t=e.matrix;return"matrix("+t.m00+" "+t.m10+" "+t.m01+" "+t.m11+" "+t.m02+" "+t.m12+")"},t}();t.MapPolygonInfo=h}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t;!function(t){"use strict";function i(e){return t.CategoryTypeArray.indexOf(e)>-1}function a(e){var t=f?f.getCoordinates(e):void 0,i=$.Deferred();return t?i.resolve(t):(h.push({query:e,deferred:i}),o()),i}function r(e,t){return void 0===t&&(t=""),a(new m(e,t))}function n(e,t,i,r,n){return void 0===i&&(i=""),void 0===r&&(r=2),void 0===n&&(n=3),a(new y(e,t,i,r,n))}function o(e){for(void 0===e&&(e=0),d-=e;d<t.Settings.MaxBingRequest&&0!==h.length;)d++,s(h.shift())}function s(e){var i=f?f.getCoordinates(e.query):void 0;if(i)return setTimeout(function(){return o(1)}),void e.deferred.resolve(i);var a={type:"GET",dataType:"jsonp",jsonp:"jsonp"},r=e.query.getUrl();r||l(e,new Error("Unsupported query. "+e.query.query)),t.BingAjaxCall(r,a).then(function(t){try{if(e.query instanceof y){var i=t;if(i&&i.d&&Array.isArray(i.d.results)&&i.d.results.length>0){var a=i.d.results[0],r=a.Primitives;if(r&&r.length>0){var n={latitude:e.query.latitude,longitude:e.query.longitude,locations:[]};r.sort(function(e,t){return e.Shape.length<t.Shape.length?1:e.Shape.length>t.Shape.length?-1:0});for(var o=Math.min(r.length,e.query.maxGeoData),s=0;o>s;s++)for(var c=r[s].Shape,h=c.split(","),d=1;d<h.length;d++)n.locations.push({nativeBing:h[d]});l(e,null,n)}else l(e,new Error("Geocode result is empty."))}else l(e,new Error("Geocode result is empty."))}else{var p=t.resourceSets[0].resources;if(Array.isArray(p)&&p.length>0){var g=u(p,e.query),f=p[g].point.coordinates,n={latitude:parseFloat(f[0]),longitude:parseFloat(f[1])};l(e,null,n)}else l(e,new Error("Geocode result is empty."))}}catch(m){l(e,m)}},function(t){l(e,t)})}function l(e,i,a){void 0===a&&(a=null),v=setTimeout(function(){return o(1)},t.Settings.UseDoubleArrayGeodataResult?t.Settings.UseDoubleArrayDequeueTimeout:0),i?e.deferred.reject(i):(f&&f.registerCoordinates(e.query,a),e.deferred.resolve(a))}function u(e,t){for(var i=t.getBingEntity().toLowerCase(),a=0;a<e.length;a++){var r=(e[a].entityType||"").toLowerCase();if(r===i)return a}return 0}function c(){h=[],d=0,p=null,clearTimeout(v)}t.Settings={MaxBingRequest:6,MaxCacheSize:3e3,MaxCacheSizeOverflow:100,BingKey:"insert your key",BingUrl:"https://dev.virtualearth.net/REST/v1/Locations?",BingUrlGeodata:"https://platform.bing.com/geo/spatial/v1/public/Geodata?",UseDoubleArrayGeodataResult:!0,UseDoubleArrayDequeueTimeout:0},t.safeCharacters="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789_-",t.BingAjaxCall=$.ajax,t.CategoryTypes={Address:"Address",City:"City",Continent:"Continent",CountryRegion:"Country",County:"County",Longitude:"Longitude",Latitude:"Latitude",Place:"Place",PostalCode:"PostalCode",StateOrProvince:"StateOrProvince"},t.CategoryTypeArray=["Address","City","Continent","Country","County","Longitude","Latitude","Place","PostalCode","StateOrProvince"],t.isCategoryType=i,t.BingEntities={Continent:"Continent",Sovereign:"Sovereign",CountryRegion:"CountryRegion",AdminDivision1:"AdminDivision1",AdminDivision2:"AdminDivision2",PopulatedPlace:"PopulatedPlace",Postcode:"Postcode",Postcode1:"Postcode1",Neighborhood:"Neighborhood",Address:"Address"};var h,d,p,g,f,m=function(){function i(i,a){void 0===i&&(i=""),void 0===a&&(a=""),this.query=i,this.category=a,this.key=(this.query+"/"+this.category).toLowerCase(),this._cacheHits=0,f||(f=e.createGeocodingCache(t.Settings.MaxCacheSize,t.Settings.MaxCacheSizeOverflow))}return i.prototype.incrementCacheHit=function(){this._cacheHits++},i.prototype.getCacheHits=function(){return this._cacheHits},i.prototype.getBingEntity=function(){var e=this.category.toLowerCase();return p||(p={},p[t.CategoryTypes.Continent.toLowerCase()]=t.BingEntities.Continent,p[t.CategoryTypes.CountryRegion.toLowerCase()]=t.BingEntities.Sovereign,p[t.CategoryTypes.StateOrProvince.toLowerCase()]=t.BingEntities.AdminDivision1,p[t.CategoryTypes.County.toLowerCase()]=t.BingEntities.AdminDivision2,p[t.CategoryTypes.City.toLowerCase()]=t.BingEntities.PopulatedPlace,p[t.CategoryTypes.PostalCode.toLowerCase()]=t.BingEntities.Postcode,p[t.CategoryTypes.Address.toLowerCase()]=t.BingEntities.Address),p[e]||""},i.prototype.getUrl=function(){var e=t.Settings.BingUrl+"key="+t.Settings.BingKey,i=this.getBingEntity(),a=!1;if(i)if(i===t.BingEntities.Postcode)e+="&includeEntityTypes=Postcode,Postcode1,Postcode2,Postcode3,Postcode4";else if(-1!==this.query.indexOf(",")||i!==t.BingEntities.AdminDivision1&&i!==t.BingEntities.AdminDivision2)e+="&includeEntityTypes="+i;else{a=!0;try{e+="&adminDistrict="+decodeURIComponent(this.query)}catch(r){return null}}if(!a)try{e+="&q="+decodeURIComponent(this.query)}catch(r){return null}var n=navigator.userLanguage||navigator.language;return n&&(e+="&c="+n),e+="&maxRes=20"},i}();t.GeocodeQuery=m;var y=function(e){function i(t,i,a,r,n){void 0===n&&(n=3),e.call(this,[t,i,r,n].join(","),a),this.latitude=t,this.longitude=i,this.levelOfDetail=r,this.maxGeoData=n}return __extends(i,e),i.prototype.getBingEntity=function(){var e=this.category.toLowerCase();return g||(g={},g[t.CategoryTypes.CountryRegion.toLowerCase()]=t.BingEntities.CountryRegion,g[t.CategoryTypes.StateOrProvince.toLowerCase()]=t.BingEntities.AdminDivision1,g[t.CategoryTypes.County.toLowerCase()]=t.BingEntities.AdminDivision2,g[t.CategoryTypes.City.toLowerCase()]=t.BingEntities.PopulatedPlace,g[t.CategoryTypes.PostalCode.toLowerCase()]=t.BingEntities.Postcode1),g[e]||""},i.prototype.getUrl=function(){var e=t.Settings.BingUrlGeodata+"key="+t.Settings.BingKey+"&$format=json",i=this.getBingEntity();if(!i)return null;var a=navigator.userLanguage||navigator.language,r=a.split("-"),n=[this.latitude,this.longitude,this.levelOfDetail,"'"+i+"'",1,0,"'"+a+"'"];return r.length>1&&n.push("'"+r[1]+"'"),e+"&SpatialFilter=GetBoundary("+n.join(", ")+")"},i}(m);t.GeocodeBoundaryQuery=y,t.geocodeCore=a,t.geocode=r,t.geocodeBoundary=n;var v;t.reset=c,c()}(t=e.GeocodingManager||(e.GeocodingManager={}))}(t=e.Services||(e.Services={}))}(t=e.BI||(e.BI={}))}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var i;!function(t){var i;!function(t){var i;!function(t){"use strict";function i(e,t,i){return Math.min(Math.max(e,t),i)}function a(e){return 23===e?2147483648:Math.floor(e)===e?256<<e:256*Math.pow(2,e)}function r(e,r){for(var n=new Float64Array(e.length),o=0;o<e.length;o+=2){var s=i(e[o],t.MinAllowedLatitude,t.MaxAllowedLatitude),l=i(e[o+1],t.MinAllowedLongitude,t.MaxAllowedLongitude),u=(l+180)/360,c=Math.sin(s*Math.PI/180),h=.5-Math.log((1+c)/(1-c))/(4*Math.PI),d=a(r);n[o]=i(u*d+.5,0,d-1),n[o+1]=i(h*d+.5,0,d-1)}return n}function n(e){var t=8e4;if(e.length>t){for(var i="",a=0;a<e.length;a+=t){var r=Array.apply([],e.subarray(a,a+t));i+=r.join(" ")+" "}return i}return Array.apply([],e).join(" ")}function o(e){var t=8e4,i=[];if(e.length>t){for(var a=0;a<e.length;a+=t){var r=Array.apply([],e.subarray(a,a+t));i.concat(r)}return i}return Array.apply([],e)}function s(e){for(var t={latitude:-90,longitude:180},a={latitude:90,longitude:-180},r=0;r<e.length;r+=2)t.latitude=Math.max(e[r],t.latitude),t.longitude=Math.min(e[r+1],t.longitude),a.latitude=Math.min(e[r],a.latitude),a.longitude=Math.max(e[r+1],a.longitude);return t.longitude=i(t.longitude,-180,180),a.longitude=i(a.longitude,-180,180),Microsoft.Maps.LocationRect.fromCorners(new Microsoft.Maps.Location(t.latitude,t.longitude),new Microsoft.Maps.Location(a.latitude,a.longitude))}function l(e){for(var t=[],i=0,a=0,r=0,n=4294967296;i<e.length;){for(var o=0,s=0;;){if(i>=e.length)return null;var l=g.indexOf(e.charAt(i++));if(-1===l)return null;var u=(31&l)*Math.pow(2,s),c=u/n,h=u%n,d=o/n,p=o%n,f=(h|p)>>>0;if(o=(c|d)*n+f,s+=5,32>l)break}var m=Math.floor((Math.sqrt(8*o+5)-1)/2);o-=m*(m+1)/2;var y=Math.floor(o),v=m-y;v=v>>1^-(1&v),y=y>>1^-(1&y),a+=v,r+=y;var C=1e-5*r,b=1e-5*a;t.push(C),t.push(b)}return new Float64Array(t)}function u(e){for(var i=e.locations,a=0;a<i.length;a++){var r=i[a];r.geographic||(r.geographic=t.parseEncodedSpatialValueArray(r.nativeBing));var n=r.geographic;n&&(r.absolute||(r.absolute=t.latLongToPixelXYArray(n,t.DefaultLevelOfDetail),r.absoluteString=t.pointArrayToString(r.absolute),r.geographicBounds=t.getLocationBoundaries(n),r.absoluteBounds=t.locationRectToRectXY(r.geographicBounds,t.DefaultLevelOfDetail)))}}function c(t,i,a){var n=r(new Float64Array([t,i]),a);return new e.visuals.Point(n[0],n[1])}function h(e,t){return c(e.latitude,e.longitude,t)}function d(t,i){var a=h(t.getNorthwest(),i),r=h(t.getSoutheast(),i);return new e.visuals.Rect(a.x,a.y,r.x-a.x,r.y-a.y)}function p(e,t,r){var n=a(r),o=i(e,0,n-1)/n-.5,s=.5-i(t,0,n-1)/n,l=90-360*Math.atan(Math.exp(2*-s*Math.PI))/Math.PI,u=360*o;return new Microsoft.Maps.Location(l,u)}t.MinAllowedLatitude=-85.05112878,t.MaxAllowedLatitude=85.05112878,t.MinAllowedLongitude=-180,t.MaxAllowedLongitude=180,t.TileSize=256,t.MaxLevelOfDetail=23,t.MinLevelOfDetail=1,t.MaxAutoZoomLevel=5,t.DefaultLevelOfDetail=11,t.WorkerErrorName="___error___";var g="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789_-";t.clip=i,t.getMapSize=a,t.latLongToPixelXYArray=r,t.pointArrayToString=n,t.pointArrayToArray=o,t.getLocationBoundaries=s,t.parseEncodedSpatialValueArray=l,t.calcGeoData=u,t.latLongToPixelXY=c,t.locationToPixelXY=h,t.locationRectToRectXY=d,t.pixelXYToLocation=p}(i=t.MapServices||(t.MapServices={}))}(i=t.Services||(t.Services={}))}(i=t.BI||(t.BI={}))}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){function i(e,t,i,a,r){return void 0===a&&(a=!1),void 0===r&&(r=o.Top),t?new c(e):new u(e,r,i,a)}function a(e){switch(e){case n.Circle:return"icon circle";case n.Box:return"icon tall";case n.Line:return"icon short"}}function r(e,t,i){var a,r=e.width,n=250,o=490,s=750,l=20,u=28;return 1>t?"48px":n>=r?(a=i?4:3,Math.floor((n-l-u*a)/Math.min(t,a))+"px"):o>=r?(a=i?6:5,Math.floor((o-l-u*a)/Math.min(t,a))+"px"):s>=r?(a=i?8:7,Math.floor((s-l-u*a)/Math.min(t,a))+"px"):(a=i?10:9,Math.floor((r-l-u*a)/Math.min(t,a))+"px")}!function(e){e[e.Box=0]="Box",e[e.Circle=1]="Circle",e[e.Line=2]="Line"}(t.LegendIcon||(t.LegendIcon={}));var n=t.LegendIcon;!function(e){e[e.Top=0]="Top",e[e.Bottom=1]="Bottom",e[e.Right=2]="Right",e[e.Left=3]="Left",e[e.None=4]="None"}(t.LegendPosition||(t.LegendPosition={}));var o=t.LegendPosition;t.legendProps={show:"show",position:"position",titleText:"titleText",showTitle:"showTitle"},t.createLegend=i,t.getIconClass=a,t.getLabelMaxSize=r;var s;!function(e){e[e.Increase=0]="Increase",e[e.Decrease=1]="Decrease"}(s||(s={}));var l,u=function(){function i(e,i,a,r){this.legendDataStartIndex=0,this.arrowPosWindow=1,this.lastCalculatedWidth=0,this.svg=d3.select(e.get(0)).insert("svg",":first-child"),this.svg.style("display","inherit"),this.svg.classed("legend",!0),this.clearCatcher=t.appendClearCatcher(this.svg),this.interactivityService=a,this.isScrollable=r,this.element=e,this.changeOrientation(i),this.parentViewport={height:0,width:0},this.calculateViewport(),this.updateLayout()}return i.prototype.updateLayout=function(){var e=this.viewport,t=this.orientation;this.svg.attr({height:e.height||(t===o.None?0:this.parentViewport.height),width:e.width||(t===o.None?0:this.parentViewport.width)}).style("max-width","100%"),this.svg.style({"float":this.getFloat(),position:t===o.Bottom?"absolute":"",bottom:t===o.Bottom?"0px":""})},i.prototype.calculateViewport=function(){switch(this.orientation){case o.Top:case o.Bottom:return void(this.viewport={height:i.TopLegendHeight,width:0});case o.Right:case o.Left:var e=this.lastCalculatedWidth?this.lastCalculatedWidth:this.parentViewport.width*i.LegendMaxWidthFactor;return void(this.viewport={height:0,width:e});case o.None:this.viewport={height:0,width:0}}},i.prototype.getFloat=function(){switch(this.orientation){case o.Right:return"right";case o.Left:return"left";default:return""}},i.prototype.accept=function(e,t){e.visitLegend(t)},i.prototype.getMargins=function(){return this.viewport},i.prototype.isVisible=function(){return this.orientation!==o.None},i.prototype.changeOrientation=function(e){e?this.orientation=e:this.orientation=o.Top,this.svg.attr("orientation",e)},i.prototype.getOrientation=function(){return this.orientation},i.prototype.drawLegend=function(e,t){this.drawLegendInternal(e,t,!0)},i.prototype.drawLegendInternal=function(e,t,a){this.parentViewport=t,this.data=e,0===e.dataPoints.length&&this.changeOrientation(o.None),this.getOrientation()===o.None&&(e.dataPoints=[]);var r=this.element.children(".mapControl");r.length>0&&!this.isTopOrBottom(this.orientation)&&r.css("display","inline-block"),this.calculateViewport();var n=this.calculateLayout(e,a),s=n.title,l=s?[s]:[],u=this.svg.selectAll(i.LegendTitle.selector).data(l);u.enter().append("text").style({"font-size":i.LegendTitleTextProperties.fontSize,"font-family":i.LegendTitleTextProperties.fontFamily}).classed(i.LegendTitle["class"],!0),u.text(function(e){return e.text}).attr({x:function(e){return e.x},y:function(e){return e.y}}),u.exit().remove();var c=n.dataPoints,h=this.svg.selectAll(i.LegendItem.selector).data(c,function(e){return e.label+e.color}),d=h.enter().append("g").classed(i.LegendItem["class"],!0);if(d.append("circle").classed(i.LegendIcon["class"],!0),d.append("title"),d.append("text").classed(i.LegendText["class"],!0).style({"font-size":i.LegendTextProperties.fontSize,"font-family":i.LegendTextProperties.fontFamily}),h.select(i.LegendIcon.selector).attr({cx:function(e,t){return e.glyphPosition.x},cy:function(e){return e.glyphPosition.y},r:i.LegendIconRadius}).style("fill",function(e){return e.color}),h.select("title").text(function(e){return e.tooltip}),h.select(i.LegendText.selector).attr({x:function(e){return e.textPosition.x},y:function(e){return e.textPosition.y}}).text(function(e){return e.label}),this.interactivityService){var p=h.select(i.LegendIcon.selector),g={datapoints:c,legendItems:h,legendIcons:p,clearCatcher:this.clearCatcher};this.interactivityService.apply(this,g)}h.exit().remove(),this.drawNavigationArrows(n.navigationArrows),this.updateLayout()},i.prototype.normalizePosition=function(e){this.legendDataStartIndex>=e.length&&(this.legendDataStartIndex=e.length-1),this.legendDataStartIndex<0&&(this.legendDataStartIndex=0)},i.prototype.calculateTitleLayout=function(t){var a=0,r=!jsCommon.StringExtensions.isNullOrEmpty(t);if(r){var n=i.LegendTextProperties,o=n.text=t,s=this.isTopOrBottom(this.orientation),l=i.TextAndIconPadding+i.LegendIconRadius,u=i.LegendIconRadius+i.TextAndIconPadding+l,c=this.parentViewport.width*i.LegendMaxWidthFactor-u-i.LegendEdgeMariginWidth,h=s?i.MaxTitleLength:c,a=e.TextMeasurementService.measureSvgTextWidth(n);return a>h&&(o=e.TextMeasurementService.getTailoredTextOrDefault(n,h),a=h),s&&(a+=i.TitlePadding),{x:0,y:0,text:o,width:a}}return null},i.prototype.calculateLayout=function(t,i){if(0===t.dataPoints.length)return{dataPoints:[],title:null,navigationArrows:[]};var a=e.Prototype.inherit(t.dataPoints);this.normalizePosition(a),this.legendDataStartIndex<a.length&&(a=a.splice(this.legendDataStartIndex));var r=this.calculateTitleLayout(t.title),n=$.extend(!0,[],a);if(this.isTopOrBottom(this.orientation)){var o=this.isScrollable?this.calculateHorizontalNavigationArrowsLayout(r):[];return{dataPoints:this.calculateHorizontalLayout(n,r,o),title:r,navigationArrows:o}}var o=this.isScrollable?this.calculateVerticalNavigationArrowsLayout(r):[];return{dataPoints:this.calculateVerticalLayout(n,r,o,i),title:r,navigationArrows:o}},i.prototype.updateNavigationArrowLayout=function(e,t,i){0===this.legendDataStartIndex&&e.shift();var a=this.arrowPosWindow;this.arrowPosWindow=i,e&&e.length>0&&this.arrowPosWindow===t&&(this.arrowPosWindow=a,e.length=e.length-1)},i.prototype.calculateHorizontalNavigationArrowsLayout=function(e){var a=i.LegendArrowHeight,r=i.LegendArrowWidth,n=i.LegendArrowTranslateY,o=[],l=e?e.x+e.width:0,u=t.SVGUtil.createArrow(r,a,180),c=t.SVGUtil.createArrow(r,a,0);return o.push({x:l,y:n,path:u.path,rotateTransform:u.transform,type:s.Decrease}),o.push({x:this.parentViewport.width-r,y:n,path:c.path,rotateTransform:c.transform,type:s.Increase}),o},i.prototype.calculateVerticalNavigationArrowsLayout=function(e){var a=i.LegendArrowHeight,r=i.LegendArrowWidth,n=[],o=40,l=t.SVGUtil.createArrow(r,a,270),u=t.SVGUtil.createArrow(r,a,90);return n.push({x:o,y:a+i.LegendArrowOffset/2,path:l.path,rotateTransform:l.transform,type:s.Decrease}),n.push({x:o,y:this.parentViewport.height-a,path:u.path,rotateTransform:u.transform,type:s.Increase}),n},i.prototype.calculateHorizontalLayout=function(t,a,r){var n=i.LegendIconRadius+i.TextAndIconPadding,o=11,n=o+4,s=0,l=2*i.LegendIconRadius+3*i.TextAndIconPadding;a&&(s=a.width,a.y=n),this.legendDataStartIndex>0&&(s+=i.LegendArrowOffset);var u=t.length,c=this.parentViewport.width,h=u>0?(c-s-l*u)/u|0:0;h=h>i.MaxTextLength?h:i.MaxTextLength;for(var d=0;u>d;d++){var p=t[d];p.glyphPosition={x:s+i.LegendIconRadius,y:o},p.textPosition={x:s+n,y:n};var g=i.LegendTextProperties;g.text=p.label,p.tooltip=p.label;var f=e.TextMeasurementService.measureSvgTextWidth(g),m=0;if(h>f)m=l+f;else{var y=e.TextMeasurementService.getTailoredTextOrDefault(g,h);p.label=y,m=l+h}if(s+=m,s>c){t.length=d;break}}return this.updateNavigationArrowLayout(r,u,t.length),t},i.prototype.calculateVerticalLayout=function(t,a,r,n){var o=this,s=20,l=15,u=s,c=4,h=i.TextAndIconPadding+i.LegendIconRadius,d=i.LegendIconRadius+i.TextAndIconPadding+h,p=n?this.parentViewport.width*i.LegendMaxWidthFactor-d-i.LegendEdgeMariginWidth:this.lastCalculatedWidth-d-i.LegendEdgeMariginWidth,g=0,f=this.parentViewport.height;a&&(u+=l,a.x=i.TextAndIconPadding,a.y=l,g=a.width||0),this.legendDataStartIndex>0&&(u+=i.LegendArrowOffset);for(var m=t.length,y=0;m>y;y++){var v=t[y];v.glyphPosition={x:h,y:u},v.textPosition={x:d,y:u+c};var C=i.LegendTextProperties;C.text=v.label,v.tooltip=v.label;var b=e.TextMeasurementService.measureSvgTextWidth(C);if(b>g&&(g=b),b>p){var x=e.TextMeasurementService.getTailoredTextOrDefault(C,p);v.label=x}if(u+=s,u>f){t.length=y;break}}return n?p>g?this.lastCalculatedWidth=this.viewport.width=Math.ceil(g+d+i.LegendEdgeMariginWidth):this.lastCalculatedWidth=this.viewport.width=Math.ceil(this.parentViewport.width*i.LegendMaxWidthFactor):this.viewport.width=this.lastCalculatedWidth,r.forEach(function(e){return e.x=o.lastCalculatedWidth/2}),this.updateNavigationArrowLayout(r,m,t.length),t},i.prototype.drawNavigationArrows=function(e){var a=this,r=this.svg.selectAll(i.NavigationArrow.selector).data(e);r.enter().append("g").on("click",function(e){var t=a.legendDataStartIndex;a.legendDataStartIndex=e.type===s.Increase?t+a.arrowPosWindow:t-a.arrowPosWindow,a.drawLegendInternal(a.data,a.parentViewport,!1)}).classed(i.NavigationArrow["class"],!0).append("path"),r.attr("transform",function(e){return t.SVGUtil.translate(e.x,e.y)}).select("path").attr({d:function(e){return e.path},transform:function(e){return e.rotateTransform}}),r.exit().remove()},i.prototype.isTopOrBottom=function(e){switch(e){case o.Top:case o.Bottom:return!0;default:return!1}},i.prototype.reset=function(){},i.LegendIconRadius=5,i.MaxTextLength=60,i.MaxTitleLength=80,i.TextAndIconPadding=5,i.TitlePadding=15,i.LegendEdgeMariginWidth=10,i.LegendMaxWidthFactor=.3,i.TopLegendHeight=24,i.LegendArrowOffset=10,i.LegendArrowHeight=15,i.LegendArrowWidth=7.5,i.LegendArrowTranslateY=3.5,i.LegendTextProperties={fontFamily:"wf_segoe-ui_normal",fontSize:"11px"},i.LegendTitleTextProperties={fontFamily:"wf_segoe-ui_Semibold",fontSize:"11px"},i.LegendItem={"class":"legendItem",selector:".legendItem"},i.LegendText={"class":"legendText",selector:".legendText"},i.LegendIcon={"class":"legendIcon",selector:".legendIcon"},i.LegendTitle={"class":"legendTitle",selector:".legendTitle"},i.NavigationArrow={"class":"navArrow",selector:".navArrow"},i}(),c=function(){function i(e){this.element=e}return i.getIconClass=function(e){switch(e){case n.Circle:case n.Box:
case n.Line:return"icon"}},i.prototype.getMargins=function(){return{height:i.LegendHeight,width:0}},i.prototype.drawLegend=function(e){var t=e.dataPoints;if(!(t.length<1)){var a=this.legendContainerDiv;if(!a){if(!t.length)return;var r=$("<div></div>").height(this.getMargins().height).addClass(i.LegendContainerClass);this.element.prepend(r),this.legendContainerDiv=a=d3.select(r.get(0))}this.drawTitle(t),this.drawLegendItems(t)}},i.prototype.reset=function(){this.legendContainerDiv&&(this.legendContainerDiv.remove(),this.legendContainerDiv=null)},i.prototype.isVisible=function(){return!0},i.prototype.changeOrientation=function(e){},i.prototype.getOrientation=function(){return o.Top},i.prototype.drawTitle=function(e){var t=this.legendContainerDiv.selectAll("div."+i.LegendTitleClass),a=t.data([e[0]]),r=a.enter(),n=r.append("div").attr("class",i.LegendTitleClass);n.filter(function(e){return e.iconOnlyOnLabel}).append("span").attr("class",i.legendIconClass).html(i.legendPlaceSelector),n.append("span"),a.filter(function(e){return e.iconOnlyOnLabel}).select("span."+i.legendIconClass).style(i.legendColorCss,function(e){return e.color}),a.select("span:last-child").text(function(e){return e.category})},i.prototype.drawLegendItems=function(t){this.ensureLegendTableCreated();var a=i.splitArrayToOddEven(t),r=this.legendContainerDiv.select("tbody").selectAll("tr").data(a),n=r.enter(),o=n.append("tr"),s=o.selectAll("td").data(function(e){return e},function(e){return e.label}).enter().append("td").attr("class",i.LegendItem),l=s.append("span");l.filter(function(e){return!e.iconOnlyOnLabel}).append("span").html(i.legendPlaceSelector).attr("class",i.legendIconClass).style("color",function(e){return e.color}).attr("white-space","nowrap"),l.append("span").attr("class",i.legendItemNameClass),l.append("span").attr("class",i.legendItemMeasureClass);var u=r.selectAll("td").data(function(e){return e},function(e){return e.label});u.select("span."+i.legendItemNameClass).html(function(t){return e.visuals.TextUtil.removeBreakingSpaces(t.label)}),u.select("span."+i.legendItemMeasureClass).html(function(e){return"&nbsp;"+e.measure}),u.exit().remove()},i.prototype.ensureLegendTableCreated=function(){if(this.legendContainerDiv.select("div table").empty()){var e=this.legendContainerDiv.append("div").append("table");e.style("table-layout","fixed").append("tbody"),this.setPanGestureOnLegend(e)}},i.prototype.setPanGestureOnLegend=function(e){var i=$(this.legendContainerDiv.select("div:nth-child(2)")[0]).width(),a=d3.scale.linear().domain([0,i]).range([0,i]),r=d3.behavior.zoom().scaleExtent([1,1]).x(a).on("zoom",function(){if($(e[0]).width()>i){var a=r.translate(),n=a[0],o=a[1];n=Math.min(n,0),n=Math.max(n,i-$(e[0]).width()),r.translate([n,o]),e.style("-ms-transform",function(){return t.SVGUtil.translateXWithPixels(n)}),e.style("-webkit-transform",function(){return t.SVGUtil.translateXWithPixels(n)}),e.style("transform",function(){return t.SVGUtil.translateXWithPixels(n)})}});this.legendContainerDiv?this.legendContainerDiv.call(r):e.call(r)},i.splitArrayToOddEven=function(e){for(var t=[],i=[],a=0;a<e.length;++a)a%2===0?i.push(e[a]):t.push(e[a]);return[i,t]},i.LegendHeight=65,i.LegendContainerClass="interactive-legend",i.LegendTitleClass="title",i.LegendItem="item",i.legendPlaceSelector="",i.legendIconClass="icon",i.legendColorCss="color",i.legendItemNameClass="itemName",i.legendItemMeasureClass="itemMeasure",i}();!function(i){function a(i,a){null==a[t.legendProps.show]&&(a[t.legendProps.show]=!0),a[t.legendProps.show]===!1&&(i.dataPoints=[]),a[t.legendProps.show]===!0&&null==a[t.legendProps.position]&&(a[t.legendProps.position]=e.legendPosition.top),a[t.legendProps.showTitle]===!1?i.title="":void 0!==a[t.legendProps.titleText]&&(i.title=a[t.legendProps.titleText])}i.update=a}(l=t.LegendData||(t.LegendData={}))}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){t.mapCapabilities={dataRoles:[{name:"Category",kind:0,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Location"),preferredTypes:[{geography:{address:!0}},{geography:{city:!0}},{geography:{continent:!0}},{geography:{country:!0}},{geography:{county:!0}},{geography:{place:!0}},{geography:{postalCode:!0}},{geography:{region:!0}},{geography:{stateOrProvince:!0}}]},{name:"Series",kind:0,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Legend")},{name:"X",kind:1,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Longitude"),preferredTypes:[{geography:{longitude:!0}}]},{name:"Y",kind:1,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Latitude"),preferredTypes:[{geography:{latitude:!0}}]},{name:"Size",kind:1,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Values")},{name:"Gradient",kind:1,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Gradient")}],objects:{general:{displayName:e.data.createDisplayNameGetter("Visual_General"),properties:{formatString:{type:{formatting:{formatString:!0}}}}},legend:{displayName:e.data.createDisplayNameGetter("Visual_Legend"),properties:{show:{displayName:e.data.createDisplayNameGetter("Visual_Show"),type:{bool:!0}},position:{displayName:e.data.createDisplayNameGetter("Visual_LegendPosition"),type:{formatting:{legendPosition:!0}}},showTitle:{displayName:e.data.createDisplayNameGetter("Visual_LegendShowTitle"),type:{bool:!0}},titleText:{displayName:e.data.createDisplayNameGetter("Visual_LegendTitleText"),type:{text:!0}}}},dataPoint:{displayName:e.data.createDisplayNameGetter("Visual_DataPoint"),properties:{defaultColor:{displayName:e.data.createDisplayNameGetter("Visual_DefaultColor"),type:{fill:{solid:{color:!0}}}},showAllDataPoints:{displayName:e.data.createDisplayNameGetter("Visual_DataPoint_Show_All"),type:{bool:!0}},fill:{displayName:e.data.createDisplayNameGetter("Visual_Fill"),type:{fill:{solid:{color:!0}}}},fillRule:{displayName:e.data.createDisplayNameGetter("Visual_Gradient"),type:{fillRule:{}},rule:{inputRole:"Gradient",output:{property:"fill",selector:["Category"]}}}}},categoryLabels:{displayName:e.data.createDisplayNameGetter("Visual_CategoryLabels"),properties:{show:{displayName:e.data.createDisplayNameGetter("Visual_Show"),type:{bool:!0}},color:{displayName:e.data.createDisplayNameGetter("Visual_LabelsFill"),type:{fill:{solid:{color:!0}}}}}}},dataViewMappings:[{conditions:[{Category:{max:1},Series:{max:1},X:{max:1},Y:{max:1},Size:{max:1},Gradient:{max:0}},{Category:{max:1},Series:{max:0},X:{max:1},Y:{max:1},Size:{max:1},Gradient:{max:1}}],categorical:{categories:{"for":{"in":"Category"},dataReductionAlgorithm:{top:{}}},values:{group:{by:"Series",select:[{bind:{to:"X"}},{bind:{to:"Y"}},{bind:{to:"Size"}},{bind:{to:"Gradient"}}],dataReductionAlgorithm:{top:{}}}},rowCount:{preferred:{min:2}}}}],sorting:{custom:{}}},t.mapProps={general:{formatString:{objectName:"general",propertyName:"formatString"}},dataPoint:{defaultColor:{objectName:"dataPoint",propertyName:"defaultColor"},fill:{objectName:"dataPoint",propertyName:"fill"},showAllDataPoints:{objectName:"dataPoint",propertyName:"showAllDataPoints"}},legend:{show:{objectName:"legend",propertyName:"show"},position:{objectName:"legend",propertyName:"position"},showTitle:{objectName:"legend",propertyName:"showTitle"},titleText:{objectName:"legend",propertyName:"titleText"}}}}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var i=t.BI.Services.MapServices,a=jsCommon.ArrayExtensions,r=function(){function e(){this.values=[]}return e.prototype.init=function(e,i){this.mapControl=e;var a=i[0];a.setAttribute("drag-resize-disabled","true");var r=this.svg=d3.select(a).append("svg").style("position","absolute").style("pointer-events","none"),n=this.clearSvg=d3.select(this.mapControl.getRootElement()).append("svg").style("position","absolute");this.clearCatcher=t.appendClearCatcher(n),this.bubbleGraphicsContext=r.append("g").classed("mapBubbles",!0),this.sliceGraphicsContext=r.append("g").classed("mapSlices",!0),this.sliceLayout=d3.layout.pie().sort(null).value(function(e){return e.value}),this.arc=d3.svg.arc(),this.clearMaxDataPointRadius(),this.dataLabelsSettings=t.dataLabelUtils.getDefaultPointLabelSettings()},e.prototype.addDataPoint=function(e){this.values.push(e)},e.prototype.clearDataPoints=function(){this.values=[]},e.prototype.getDataPointCount=function(){return _.filter(this.values,function(e){return!!e.cachedLocation}).length},e.prototype.getDataPointPadding=function(){return 2*this.maxDataPointRadius},e.prototype.clearMaxDataPointRadius=function(){this.maxDataPointRadius=0},e.prototype.setMaxDataPointRadius=function(e){this.maxDataPointRadius=Math.max(e,this.maxDataPointRadius)},e.prototype.beginDataPointUpdate=function(e,t){this.values.length=0},e.prototype.getDefaultMap=function(e,t){this.values.length=0},e.prototype.converter=function(e,i,a,r){var n=this.mapControl,o=e.width/2,s=e.height/2,l=1;this.dataLabelsSettings?(this.dataLabelsSettings.show=r.show,this.dataLabelsSettings.labelColor=r.labelColor):this.dataLabelsSettings=t.dataLabelUtils.getDefaultPointLabelSettings();var u=Math.min(e.width,e.height)/384;this.clearMaxDataPointRadius();for(var c=[],h=[],d=t.mapProps.general.formatString,p=0,g=this.values.length;g>p;p++){var f=i?i.categorical:null,m=this.values[p],y=m.categoryValue,v=m.cachedLocation;if(v){var C=n.tryLocationToPixel(v),b=C.x+o,x=C.y+s,S=m.radius*u;this.setMaxDataPointRadius(S);var w=m.seriesInfo.sizeValuesForGroup,_=w?w.length:1;if(1===_){var T=w[0],D=T.value,P=T.index,M=t.TooltipBuilder.createTooltipInfo(d,f.categories,y,f.values,D,null,P),L=w[0];c.push({x:b,y:x,labeltext:y,radius:S,fill:L.fill,stroke:L.stroke,strokeWidth:l,tooltipInfo:M,identity:t.SelectionId.createWithId(m.categoryIdentity),selected:!1,labelFill:r.labelColor})}else{for(var A=[],N=0;_>N;++N){var T=w[N],D=T.value,P=T.index,M=t.TooltipBuilder.createTooltipInfo(d,f.categories,y,f.values,D,null,P),V=w[N];A.push({x:b,y:x,labeltext:y,radius:S,fill:V.fill,stroke:V.stroke,strokeWidth:l,value:D,tooltipInfo:M,identity:t.SelectionId.createWithIds(m.categoryIdentity,V.seriesId),selected:!1,labelFill:r.labelColor})}a&&a.applySelectionStateToData(A),h.push(A)}}}return a&&a.applySelectionStateToData(c),{bubbleData:c,sliceData:h}},e.prototype.updateInternal=function(e,i,a){this.svg&&this.svg.style("width",i.width.toString()+"px").style("height",i.height.toString()+"px"),this.clearSvg&&this.clearSvg.style("width",i.width.toString()+"px").style("height",i.height.toString()+"px");var r=this.arc,n=!1;if(t.dataHasSelection(e.bubbleData)&&(n=!0),!n)for(var o=0,s=e.sliceData.length;s>o;o++)t.dataHasSelection(e.sliceData[o])&&(n=!0);var l=this.bubbleGraphicsContext.selectAll(".bubble").data(e.bubbleData,function(e){return e.identity.getKey()});l.enter().append("circle").classed("bubble",!0),l.attr("cx",function(e){return e.x}).attr("cy",function(e){return e.y}).attr("r",function(e){return e.radius}).style("fill",function(e){return e.fill}).style("stroke",function(e){return e.stroke}).style("fill-opacity",function(e){return t.ColumnUtil.getFillOpacity(e.selected,!1,n,!1)}).style("strokeWidth",function(e){return e.strokeWidth}).style("stroke-opacity",function(e){return t.ColumnUtil.getFillOpacity(e.selected,!1,n,!1)}).style("cursor","default"),l.exit().remove(),t.TooltipManager.addTooltip(l,function(e){return e.data.tooltipInfo});var u=e.sliceData,c=this.sliceGraphicsContext.selectAll(".sliceContainer").data(u);c.enter().append("g").classed("sliceContainer",!0),c.exit().remove();var h=this.sliceLayout,d=c.selectAll(".slice").data(function(e){return h(e)},function(e){return e.data.identity.getKey()});if(d.enter().append("path").classed("slice",!0),d.style("fill",function(e){return e.data.fill}).style("fill-opacity",function(e){return t.ColumnUtil.getFillOpacity(e.data.selected,!1,n,!1)}).style("stroke",function(e){return e.data.stroke}).style("strokeWidth",function(e){return e.data.strokeWidth}).style("stroke-opacity",function(e){return t.ColumnUtil.getFillOpacity(e.data.selected,!1,n,!1)}).style("cursor","default").attr("transform",function(e){return t.SVGUtil.translate(e.data.x,e.data.y)}).attr("d",function(e){return r.innerRadius(0).outerRadius(function(e){return e.data.radius})(e)}),d.exit().remove(),this.dataLabelsSettings.show){for(var p=t.dataLabelUtils.getMapLabelLayout(this.dataLabelsSettings),g=[],o=0,s=u.length;s>o;o++)g.push(u[o][0]);for(var f=0,m=e.bubbleData.length;m>f;f++)g.push(e.bubbleData[f]);var y={height:this.mapControl.getHeight(),width:this.mapControl.getWidth()};t.dataLabelUtils.drawDefaultLabelsForDataPointChart(g,this.bubbleGraphicsContext,p,y)}else t.dataLabelUtils.cleanDataLabels(this.bubbleGraphicsContext);t.TooltipManager.addTooltip(d,function(e){return e.data.data.tooltipInfo});for(var v=e.bubbleData.slice(),o=0,s=u.length;s>o;o++)v.push.apply(v,u[o]);var C={bubbles:l,slices:this.sliceGraphicsContext.selectAll("path"),clearCatcher:this.clearCatcher,dataPoints:v};return C},e}();t.MapBubbleDataPointRenderer=r;var n=function(){function i(){this.values=[]}return i.getFilledMapParams=function(e,i){switch(e){case t.BI.Services.GeocodingManager.CategoryTypes.Continent:case t.BI.Services.GeocodingManager.CategoryTypes.CountryRegion:return 10>i?{level:2,maxPolygons:50,strokeWidth:0}:30>i?{level:2,maxPolygons:20,strokeWidth:0}:{level:1,maxPolygons:3,strokeWidth:0};default:return 100>i?{level:1,maxPolygons:5,strokeWidth:6}:200>i?{level:0,maxPolygons:5,strokeWidth:6}:{level:0,maxPolygons:5,strokeWidth:0}}},i.buildPaths=function(e){for(var t=[],i=0;i<e.length;i++){var a=e[i],r=a.geographic;r.length>2&&t.push(a)}return t},i.prototype.init=function(i,a){this.mapControl=i,this.polygonInfo=new e.visuals.MapPolygonInfo;var r=a[0];r.setAttribute("drag-resize-disabled","true");var n=this.svg=d3.select(r).append("svg").style("position","absolute").style("pointer-events","none"),o=this.clearSvg=d3.select(this.mapControl.getRootElement()).append("svg").style("position","absolute");this.clearCatcher=t.appendClearCatcher(o),this.shapeGraphicsContext=n.append("g").classed("mapShapes",!0),this.clearMaxShapeDimension()},i.prototype.beginDataPointUpdate=function(e,t){this.geocodingCategory=e,this.values=[]},i.prototype.addDataPoint=function(e){this.values.push(e)},i.prototype.clearDataPoints=function(){this.values=[]},i.prototype.getDataPointCount=function(){return _.filter(this.values,function(e){return!!e.paths}).length},i.prototype.converter=function(e,i,a){this.clearMaxShapeDimension();for(var r=1,n=[],o=t.mapProps.general.formatString,s=0,l=this.values.length;l>s;s++){var u=i?i.categorical:null,c=this.values[s],h=c.categoryValue,d=c.paths,p=c.seriesInfo.sizeValuesForGroup;if(d)for(var g=p[0],f=g.value,m=g.index,y=t.TooltipBuilder.createTooltipInfo(o,u.categories,h,u.values,f,null,m),v=t.SelectionId.createWithId(c.categoryIdentity),C=v.getKey(),b=0,x=d.length;x>b;b++){var S=d[b];this.setMaxShapeDimension(S.absoluteBounds.width,S.absoluteBounds.height),n.push({path:S.absoluteString,fill:g.fill,stroke:g.stroke,strokeWidth:r,tooltipInfo:y,identity:v,selected:!1,key:JSON.stringify({id:C,pIdx:b})})}}return a&&a.applySelectionStateToData(n),{shapeData:n}},i.prototype.updateInternal=function(e,i,a){this.svg&&this.svg.style("width",i.width.toString()+"px").style("height",i.height.toString()+"px"),this.clearSvg&&this.clearSvg.style("width",i.width.toString()+"px").style("height",i.height.toString()+"px"),this.polygonInfo.reCalc(this.mapControl,i.width,i.height),this.shapeGraphicsContext.attr("transform",this.polygonInfo.transformToString(this.polygonInfo.transform));var r=t.dataHasSelection(e.shapeData),n=this.shapeGraphicsContext.selectAll("polygon").data(e.shapeData,function(e){return e.key});n.enter().append("polygon").classed("shape",!0).attr("points",function(e){return e.path}),n.style("fill",function(e){return e.fill}).style("fill-opacity",function(e){return t.ColumnUtil.getFillOpacity(e.selected,!1,r,!1)}).style("cursor","default"),a&&n.attr("points",function(e){return e.path}),n.exit().remove(),t.TooltipManager.addTooltip(n,function(e){return e.data.tooltipInfo});var o={shapes:n,clearCatcher:this.clearCatcher,dataPoints:e.shapeData};return o},i.prototype.clearMaxShapeDimension=function(){this.maxShapeDimension=0},i.prototype.setMaxShapeDimension=function(e,t){this.maxShapeDimension=Math.max(e,this.maxShapeDimension),this.maxShapeDimension=Math.max(t,this.maxShapeDimension)},i.prototype.getDataPointPadding=function(){return 12},i}();t.MapShapeDataPointRenderer=n;var o=function(){function o(e){this.receivedExternalViewChange=!1,this.executingInternalViewChange=!1,e.filledMap?(this.dataPointRenderer=new n,this.enableGeoShaping=!0):(this.dataPointRenderer=new r,this.enableGeoShaping=!1)}return o.prototype.init=function(i){var a=this,r=this.element=i.element;this.pendingGeocodingRender=!1,this.currentViewport=i.viewport,this.style=i.style,this.colors=this.style.colorPalette.dataColors,this.interactivityService=t.VisualInteractivityFactory.buildInteractivityService(i),this.dataLabelsSettings=t.dataLabelUtils.getDefaultPointLabelSettings(),this.legend=e.visuals.createLegend(r,i.interactivity&&i.interactivity.isInteractiveLegend,this.interactivityService),this.legendHeight=0,this.legendData={dataPoints:[]},this.geoTaggingAnalyzerService=e.createGeoTaggingAnalyzerService(i.host.getLocalizedString),this.host=i.host,this.resetBounds(),jsCommon.ensureMap(function(){Microsoft.Maps.loadModule("Microsoft.Maps.Overlays.Style",{callback:function(){a.initialize(r[0])}})})},o.prototype.addDataPoint=function(e){var t=e.cachedLocation;this.updateBounds(t.latitude,t.longitude),this.scheduleRedraw()},o.prototype.scheduleRedraw=function(){var e=this;!this.pendingGeocodingRender&&this.mapControl&&(this.pendingGeocodingRender=!0,setTimeout(function(){e.updateInternal(!0),e.pendingGeocodingRender=!1},3e3))},o.prototype.enqueueGeoCode=function(e){var i=this;t.BI.Services.GeocodingManager.geocode(e.geocodingQuery,this.geocodingCategory).then(function(t){t&&(e.cachedLocation=t,i.addDataPoint(e))})},o.prototype.enqueueGeoCodeAndGeoShape=function(e,i){var a=this;t.BI.Services.GeocodingManager.geocode(e.geocodingQuery,this.geocodingCategory).then(function(t){t&&(e.cachedLocation=t,a.enqueueGeoShape(e,i))})},o.prototype.enqueueGeoShape=function(e,i){var a=this;t.BI.Services.GeocodingManager.geocodeBoundary(e.cachedLocation.latitude,e.cachedLocation.longitude,this.geocodingCategory,i.level,i.maxPolygons).then(function(i){var r;0===i.locations.length||i.locations[0].geographic?r=n.buildPaths(i.locations):(t.BI.Services.MapServices.calcGeoData(i),r=n.buildPaths(i.locations)),e.paths=r,a.addDataPoint(e)})},o.prototype.getOptimumLevelOfDetail=function(e,t){var a=this.dataPointRenderer.getDataPointCount();if(0===a)return i.MinLevelOfDetail;for(var r=this.dataPointRenderer.getDataPointPadding(),n=i.MaxLevelOfDetail;n>=i.MinLevelOfDetail;n--){var o=i.latLongToPixelXY(this.minLatitude,this.minLongitude,n),s=i.latLongToPixelXY(this.maxLatitude,this.maxLongitude,n);if(s.x-o.x+r<=e&&o.y-s.y+r<=t)return 2>a&&(n=Math.min(i.MaxAutoZoomLevel,n)),n}return i.MinLevelOfDetail},o.prototype.getViewCenter=function(e){var t=i.latLongToPixelXY(this.minLatitude,this.minLongitude,e),a=i.latLongToPixelXY(this.maxLatitude,this.maxLongitude,e);return i.pixelXYToLocation((t.x+a.x)/2,(a.y+t.y)/2,e)},o.prototype.resetBounds=function(){this.minLongitude=i.MaxAllowedLongitude,this.maxLongitude=i.MinAllowedLongitude,this.minLatitude=i.MaxAllowedLatitude,this.maxLatitude=i.MinAllowedLatitude},o.prototype.updateBounds=function(e,t){t<this.minLongitude&&(this.minLongitude=t),t>this.maxLongitude&&(this.maxLongitude=t),e<this.minLatitude&&(this.minLatitude=e),e>this.maxLatitude&&(this.maxLatitude=e)},o.legendObject=function(e){return e&&e.metadata&&e.metadata.objects&&e.metadata.objects.legend},o.isLegendHidden=function(e){var i=o.legendObject(e);return null!=i&&i[t.legendProps.show]===!1},o.legendPosition=function(e){var i=o.legendObject(e);return i&&t.LegendPosition[i[t.legendProps.position]]},o.isShowLegendTitle=function(e){var i=o.legendObject(e);return i&&i[t.legendProps.showTitle]},o.prototype.legendTitle=function(){var e=o.legendObject(this.dataView);return e&&e[t.legendProps.titleText]||this.legendData.title},o.prototype.renderLegend=function(e){var i=o.isLegendHidden(this.dataView),a=o.isShowLegendTitle(this.dataView),r=this.legendTitle(),n={dataPoints:i?[]:e.dataPoints,grouped:e.grouped,title:a?r:""},s=o.legendPosition(this.dataView);void 0!==s?this.legend.changeOrientation(s):this.legend.changeOrientation(t.LegendPosition.Top),this.legend.drawLegend(n,this.currentViewport)},o.calculateGroupSizes=function(e,t,i,a,r){for(var n=e.values[0].values.length,o=t.length,s=0,l=n;l>s;++s){var u=null;if(a>=0)for(var c=0;o>c;++c){var h=t[c].values[a].values[s];h&&(null===u?u=h:u+=h)}i.push(u),u&&(r?(r.min=Math.min(r.min,u),r.max=Math.max(r.max,u)):r={min:u,max:u})}return r},o.createMapDataPoint=function(e,t,i,a,r,n){if(i){var o=i.latitude,s=i.longitude,l={geocodingQuery:e,location:null!==o&&null!==s?new Microsoft.Maps.Location(o,s):null,value:t,radius:a,seriesInfo:i,categoryIdentity:n,categoryValue:e};return null===l.geocodingQuery&&null===l.location?null:(l.cachedLocation=l.location,l)}return null},o.calculateSeriesLegend=function(e,i,a,r,n,o){for(var s=e?e.length:0,l=[],u=new t.ColorHelper(r,t.mapProps.dataPoint.fill,n),c=0;s>c;++c){var h,d,p=e[c];if(a>=0){var g=p.values[a];h=g.values[i],d=g.source.queryName}else h=null,d="";if(null!==h||0>a){var f=p.identity?t.SelectionId.createWithId(p.identity):t.SelectionId.createNull(),m=void 0!==o?u.getColorForSeriesValue(p.objects,o,p.name):u.getColorForMeasure(p.objects,d);l.push({color:m,label:t.valueFormatter.format(p.name),icon:t.LegendIcon.Circle,identity:f,selected:!1})}}return l},o.calculateSeriesInfo=function(e,i,a,r,n,s,l,u,c){var h=null,d=null,p=[],g=e?e.length:0,f=new t.ColorHelper(s,t.mapProps.dataPoint.fill,l);if(g>0)for(var m=0;g>m;++m){var y,v,C=e[m];if(a>=0){var b=C.values[a];y=b.values[i],v=b.source.queryName}else y=null,v="";var x=u&&u[i]||C&&C.objects;if(null!==y||0>a){var S=e[m].identity,w=void 0!==c?f.getColorForSeriesValue(x,c,C.name):f.getColorForMeasure(x,v),_=jsCommon.color.parseRgb(w),T=jsCommon.color.rgbToHexString(jsCommon.color.darken(_,o.StrokeDarkenColorValue)),D=jsCommon.color.rgbWithAlphaString(_,.6);p.push({value:y,index:m,fill:D,stroke:T,seriesId:S})}h=o.getOptionalMeasure(C,n,i,h),d=o.getOptionalMeasure(C,r,i,d)}else{var x=u&&u[i],w=f.getColorForMeasure(x,""),_=jsCommon.color.parseRgb(w),T=jsCommon.color.rgbToHexString(jsCommon.color.darken(_,o.StrokeDarkenColorValue)),D=jsCommon.color.rgbWithAlphaString(_,.6);p=[{value:null,index:0,fill:D,stroke:T,seriesId:null}]}return{sizeValuesForGroup:p,latitude:h,longitude:d}},o.getOptionalMeasure=function(e,t,i,a){if(t>=0){var r=e.values[t].values[i];if(null!=r)return r}return a},o.calculateRadius=function(e,t,i){var a=6;return null!=e&&0!==t&&(a=14*((i-e.min)/t)+6),a},o.getGeocodingCategory=function(e,t){if(e&&e.categories&&e.categories.length>0&&e.categories[0].source){var i=e.categories[0].source.type;if(i&&i.categoryString)return t.getFieldType(i.categoryString);var a=e.categories[0].source.displayName,r=t.getFieldType(a);if(r)return r;var n=e.categories[0].source.roles;if(n)for(var o=Object.keys(n),s=0,l=o.length;l>s;++s){var u=t.getFieldType(o[s]);if(u)return u}}return void 0},o.hasSizeField=function(e,t){if(a.isUndefinedOrEmpty(e))return!1;for(var i=0,r=e.length;r>i;i++){var n=e[i].source.roles;if(!n&&i===t&&e[i].source.type.numeric)return!0;if(n)for(var o=Object.keys(n),s=0,l=o.length;l>s;s++){var u=o[s];if("Size"===u)return!0}}return!1},o.shouldEnumerateDataPoints=function(e,i){var a=t.DataRoleHelper.hasRoleInDataView(e,"Series"),r=i?"Size":"Gradient",n=t.DataRoleHelper.hasRoleInDataView(e,r);return a||!n},o.prototype.enumerateObjectInstances=function(e){switch(e.objectName){case"dataPoint":if(o.shouldEnumerateDataPoints(this.dataView,this.enableGeoShaping)){var i=[],a=this.hasDynamicSeries;if(!a){var r=this.dataPointRenderer.converter(this.getMapViewPort(),this.dataView,this.interactivityService,this.dataLabelsSettings);i=r.bubbleData}return o.enumerateDataPoints(this.dataPointsToEnumerate,this.colors,a,this.defaultDataPointColor,this.showAllDataPoints,i)}break;case"categoryLabels":return t.dataLabelUtils.enumerateCategoryLabels(this.dataLabelsSettings,!0);case"legend":if(this.hasDynamicSeries)return o.enumerateLegend(this.dataView,this.legend,this.legendTitle())}},o.enumerateDataPoints=function(e,t,i,a,r,n){var o=[],s=e&&e.length;if(i)for(var l=0;s>l;l++){var u=e[l];o.push({objectName:"dataPoint",displayName:u.label,selector:u.identity.getSelector(),properties:{fill:{solid:{color:u.color}}}})}else if(o.push({objectName:"dataPoint",selector:null,properties:{defaultColor:{solid:{color:a||t.getColorByIndex(0).value}}}},{objectName:"dataPoint",selector:null,properties:{showAllDataPoints:!!r}}),n)for(var l=0;l<n.length;l++){var c=n[l];o.push({objectName:"dataPoint",displayName:c.labeltext,selector:c.identity.getSelector(),properties:{fill:{solid:{color:jsCommon.color.rgbaStringToHexString(c.fill)}}}})}return o},o.enumerateLegend=function(e,i,a){return[{selector:null,properties:{show:!o.isLegendHidden(e),position:t.LegendPosition[i.getOrientation()],showTitle:o.isShowLegendTitle(e),titleText:a},objectName:"legend"}]},o.prototype.onDataChanged=function(i){var a=this;this.receivedExternalViewChange=!1;var r=i.dataViews[0];this.dataView=r;var s=this.enableGeoShaping;if(this.dataLabelsSettings=t.dataLabelUtils.getDefaultPointLabelSettings(),this.defaultDataPointColor=null,this.showAllDataPoints=null,r){if(r.metadata&&r.metadata.objects){var l=r.metadata.objects;this.defaultDataPointColor=e.DataViewObjects.getFillColor(l,t.mapProps.dataPoint.defaultColor),this.showAllDataPoints=e.DataViewObjects.getValue(l,t.mapProps.dataPoint.showAllDataPoints);var u=l.categoryLabels;u&&(this.dataLabelsSettings.show=void 0!==u.show?u.show:this.dataLabelsSettings.show,void 0!==u.color&&(this.dataLabelsSettings.labelColor=u.color.solid.color))}var c=o.showLocationMissingWarningIfNecessary(r),h=r.categorical;if(h&&h.categories&&h.categories.length>0){this.resetBounds();var d;h.values&&(d=h.values.grouped());var p=d&&!!h.values.source;this.hasDynamicSeries=p;var g;p?g=h.values.identityFields:h.values&&h.values.length>0&&(g=h.categories[0].identityFields);var f=t.DataRoleHelper.getMeasureIndexOfRole(d,"Size"),m=t.DataRoleHelper.getMeasureIndexOfRole(d,"X"),y=t.DataRoleHelper.getMeasureIndexOfRole(d,"Y"),v=[];this.valueScale=null,-1!==f&&(this.valueScale=o.calculateGroupSizes(h,d,v,f,this.valueScale)),this.geocodingCategory=o.getGeocodingCategory(h,this.geoTaggingAnalyzerService);var C=this.valueScale?this.valueScale.max-this.valueScale.min:0;s&&!this.geocodingCategory&&c.push(new t.FilledMapWithoutValidGeotagCategoryWarning),jsCommon.ensureMap(function(){var e=h.categories[0].values,t=r.categorical.categories[0].identity;a.dataPointRenderer.beginDataPointUpdate(a.geocodingCategory,e.length);for(var i=r.categorical.categories[0].objects,l=0,u=e.length;u>l;l++){var c,p=e[l],b=v[l],x=o.calculateSeriesInfo(d,l,f,m,y,a.colors,a.defaultDataPointColor,i,g),S=o.calculateRadius(a.valueScale,C,b);s&&(c=n.getFilledMapParams(a.geocodingCategory,e.length));var w=o.createMapDataPoint(p,b,x,S,a.colors,t?t[l]:void 0);w&&(a.dataPointRenderer.addDataPoint(w),w.location?s&&!w.paths?a.enqueueGeoShape(w,c):a.addDataPoint(w):s?a.enqueueGeoCodeAndGeoShape(w,c):a.enqueueGeoCode(w))}var _=o.calculateSeriesLegend(d,l,f,a.colors,a.defaultDataPointColor,g);1===_.length&&(_=[]);var T=h.values,D=T&&T.source?T.source.displayName:"";a.legendData={title:D,dataPoints:_},a.dataPointsToEnumerate=_,a.renderLegend(a.legendData)})}else this.clearDataPoints()}else this.clearDataPoints();c&&c.length>0&&this.host.setWarnings(c),this.updateInternal(!0)},o.showLocationMissingWarningIfNecessary=function(e){var i=e.metadata;if(i&&i.columns){for(var a=i.columns,r=!1,n=0;n<a.length;n++)t.DataRoleHelper.hasRole(a[n],"Category")&&(r=!0);if(!r)return[new t.NoMapLocationWarning]}return[]},o.prototype.onResizing=function(e){(this.currentViewport.width!==e.width||this.currentViewport.height!==e.height)&&(this.currentViewport=e,this.renderLegend(this.legendData),this.updateInternal(!1))},o.prototype.initialize=function(e){var i=this,a={credentials:t.BI.Services.GeocodingManager.Settings.BingKey,showMapTypeSelector:!1,enableClickableLogo:!1,enableSearchLogo:!1,mapTypeId:Microsoft.Maps.MapTypeId.road,customizeOverlays:!0,showDashboard:!1,showScalebar:!1,disableKeyboardInput:!0},r=InJs.DomFactory.div().addClass(o.MapContainer.cssClass).appendTo(e);this.mapControl=new Microsoft.Maps.Map(r[0],a),Microsoft.Maps.Events.addHandler(this.mapControl,"viewchange",function(){i.onViewChanged()}),this.dataPointRenderer.init(this.mapControl,r),this.pendingGeocodingRender||this.updateInternal(!0)},o.prototype.onViewChanged=function(){this.executingInternalViewChange?this.executingInternalViewChange=!1:this.receivedExternalViewChange=!0,this.updateOffsets(!1)},o.prototype.getMapViewPort=function(){var e=this.currentViewport,t=this.legend.getMargins(),i={width:e.width-t.width,height:e.height-t.height};return i},o.prototype.updateInternal=function(e){if(this.mapControl){var t=this.legend.isVisible();t||(this.legendData={dataPoints:[]});var i=this.element.children(o.MapContainer.selector),a=this.getMapViewPort();i.height(a.height),i.width(a.width),this.updateOffsets(e);var r=this.getOptimumLevelOfDetail(a.width,a.height),n=this.getViewCenter(r);this.receivedExternalViewChange&&this.interactivityService||(this.executingInternalViewChange=!0,this.mapControl.setView({center:n,zoom:r,animate:!0}))}},o.prototype.updateOffsets=function(e){var t,i=this.dataView,a=this.getMapViewPort();t=i&&i.categorical?this.dataPointRenderer.converter(a,this.dataView,this.interactivityService,this.dataLabelsSettings):{bubbleData:[],shapeData:[],sliceData:[]};var r=this.dataPointRenderer.updateInternal(t,a,e);this.interactivityService&&r&&this.interactivityService.apply(this,r)},o.prototype.accept=function(e,t){e.visitMap(t)},o.prototype.onClearSelection=function(){this.interactivityService.clearSelection(),this.updateOffsets(!1)},o.prototype.clearDataPoints=function(){this.dataPointRenderer.clearDataPoints()},o.MapContainer={cssClass:"visual mapControl",selector:".visual.mapControl"},o.StrokeDarkenColorValue=63.75,o}();t.Map=o}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var i=function(){function i(){this.isCardWrapped=!1,this.isInteractivityOverflowHidden=!1}return i.prototype.init=function(e){this.options=e,this.style=e.style;var t=this.currentViewport=e.viewport,a=this.interactivity=e.interactivity;a&&"hidden"===a.overflow&&(this.isInteractivityOverflowHidden=!0),this.settings=i.DefaultStyle;var r=$("<div/>").addClass(i.multiRowCardClass);e.element.append(r);var n=this.element=r;n.css("height",this.getPixelString(t.height)),this.initializeCardRowSelection()},i.prototype.onDataChanged=function(e){var t=e.dataViews;t&&t.length>0&&(this.dataView=t[0]);var i=1!==e.operationKind;this.updateInternal(i),this.waitingForData=!1},i.prototype.onResizing=function(e){var e=this.currentViewport=e;this.element.css("height",this.getPixelString(e.height)),this.updateInternal()},i.converter=function(e,a,r,n){void 0===n&&(n=!1);for(var o=[],s=e.table.rows,l=e.table.columns,u=0,c=r;c>u;u++){for(var h=s[u],d=void 0,p=void 0,g=!1,f=[],m=0;a>m;m++){var y=l[m],v=t.valueFormatter.format(h[m],t.valueFormatter.getFormatString(y,i.formatStringProp)),C=l[m].displayName;n||y.type.numeric||(void 0===d?(d=!0,p=v,g=t.UrlHelper.isValidUrl(y,p)):d&&(d=!1)),f.push({caption:v,details:C,showURL:t.UrlHelper.isValidUrl(y,v)})}o.push({title:d?p:void 0,showTitleAsURL:g,cardItemsData:d?f.filter(function(e){return e.caption!==p}):f})}return o},i.prototype.updateInternal=function(e){void 0===e&&(e=!1);var t=this.dataView;
if(!(t&&t.metadata&&t.table&&t.table.rows&&t.table.rows.length>0&&t.table.columns&&t.table.columns.length>0))return void this.listView.empty();this.setCardDimensions();var i=this.cardHeightTotal,a=this.dataModel;this.listView.viewport(this.currentViewport).rowHeight(i).data(a,function(e){return a.indexOf(e)}).render(!0,e)},i.prototype.initializeCardRowSelection=function(){var e=this,a=this.settings,r=this.cardHeightTotal,n=this.cardHeight,o=this.isInteractivityOverflowHidden,s=function(t){var r=t.append("div").style({color:a.card.color,"overflow-y":"hidden","box-sizing":"border-box"}).classed(i.Card["class"],!0);o?r.style("padding-top",e.isCardWrapped?"0px":e.getPixelString(a.card.topPadding)):(r.style({"border-left":e.getPixelString(a.card.leftBorderWidth)+" "+a.card.borderStyle,"border-left-color":a.card.leftBorderColor,"padding-left":e.getPixelString(a.card.leftPadding)}),e.cardHasTitle&&r.append("div").classed(i.Title["class"],!0).style({height:e.getPixelString(a.title.height),"margin-bottom":e.isCardWrapped?"0px":e.getPixelString(a.title.marginBottom)}).each(function(e){e.showTitleAsURL&&d3.select(this).append("a")}));var n=r.selectAll(i.CardItemContainer.selector).data(function(e){return e.cardItemsData}).enter().append("div").classed(i.CardItemContainer["class"],!0).style({"box-sizing":"border-box",height:e.getPixelString(e.cardItemContainerHeight),"margin-right":e.isSingleValueCard?"0px":e.getPixelString(a.cardItemContainer.marginRight),"float":"left","padding-top":e.isCardWrapped?o?e.getPixelString(a.cardItemContainer.topPadding):e.getPixelString(a.cardItemContainer.topPaddingCanvas):"0px"});n.append("div").classed(i.Caption["class"],!0).style({height:e.getPixelString(a.caption.height),"font-size":e.getPixelString(a.caption.fontSize),color:a.caption.color,"text-align":"left","white-space":"nowrap","text-overflow":"ellipsis",overflow:"hidden"}).each(function(e){e.showURL&&d3.select(this).append("a")}),n.append("div").classed(i.Details["class"],!0).style({height:e.getPixelString(a.details.height),"font-size":e.getPixelString(a.details.fontSize),color:a.details.color,"text-align":"left","white-space":"nowrap","text-overflow":"ellipsis",overflow:"hidden"})},l=function(t){n=e.cardHeight,!o&&e.cardHasTitle&&(t.selectAll(i.Title.selector).filter(function(e){return!e.showTitleAsURL}).text(function(e){return e.title}),t.selectAll(i.TitleUrlSelector).attr("href",function(e){return e.title}).attr("target","_blank").text(function(e){return e.title}));var r=t.selectAll(i.Card.selector).style({height:e.getPixelString(n),width:e.getPixelString(e.cardWidth)}),s=e.isSingleValueCard?e.columnWidth:e.columnWidth-a.cardItemContainer.marginRight;if(r.selectAll(i.CardItemContainer.selector).style("width",e.getPixelString(s)),r.selectAll(i.Caption.selector).filter(function(e){return!e.showURL}).text(function(e){return e.caption}),r.selectAll(i.CaptionUrlSelector).attr("href",function(e){return e.caption}).attr("target","_blank").text(function(e){return e.caption}),r.selectAll(i.Details.selector).text(function(e){return e.details}),o){var l=e.dataModel;l&&l.length>0&&(r=r.filter(function(e){return e!==l[l.length-1]})),r.style({"border-bottom-style":a.card.borderStyle,"border-bottom-width":e.getPixelString(a.card.bottomBorderWidth),"border-bottom-color":a.card.borderColor,"padding-bottom":e.getPixelString(a.card.bottomPadding)})}r.style("margin-bottom",o?"0px":e.isSingleRowCard?"0px":e.getPixelString(a.card.marginBottom))},u=function(e){e.remove()},c={rowHeight:r,enter:s,exit:u,update:l,loadMoreData:function(){return e.onLoadMoreData()},viewport:this.currentViewport,baseContainer:d3.select(this.element.get(0))};this.listView=t.ListViewFactory.createHTMLListView(c)},i.prototype.setCardDimensions=function(){var e=this.dataView,t=e.table.columns,a=e.table.rows,r=this.currentViewport,n=this.settings,o=0,s=o=t.length,l=r.width;if(this.cardHasTitle=!1,this.isInteractivityOverflowHidden)l<=i.SmallTileWidth?(o=Math.min(n.cardRowColumns.maxRowColumnsSmallTile,o),s=Math.min(n.cardItems.maxItemsSmallTile,s)):l<=i.MediumTileWidth?(o=Math.min(n.cardRowColumns.maxRowColumnsMediumTile,o),s=Math.min(n.cardItems.maxItemsMediumTile,s)):l<=i.LargeTileWidth&&(o=Math.min(n.cardRowColumns.maxRowColumnsLargeTile,o),s=Math.min(n.cardItems.maxItemsLargeTile,s)),this.calculateCardDimensions(r,o,s,a.length),this.dataModel=i.converter(e,s,this.maxCardsDisplayed,this.isInteractivityOverflowHidden);else{var u=this.dataModel=i.converter(e,s,a.length);if(s=0,u&&u.length>0&&(s=u[0].cardItemsData?u[0].cardItemsData.length:0,this.cardHasTitle=void 0!==u[0].title,this.isSingleRowCard=1===u.length?!0:!1),this.calculateCardDimensions(r,s,s,u.length),this.cardHasTitle){var c=this.cardHeight+=n.title.height+(this.isCardWrapped?0:n.title.marginBottom);this.cardHeightTotal=this.getTotalCardHeight(c)}}},i.prototype.calculateCardDimensions=function(e,t,i,a){var r=this.settings,n=this.isInteractivityOverflowHidden,o=e.width-r.scrollbar.padding,s=t,l=r.caption.height+r.details.height,u=!1;n||(o-=r.card.leftBorderWidth+r.card.leftPadding);var c=o/t;t===i&&(c=Math.max(c,r.cardItemContainer.maxWidth),c=Math.min(c,o),s=Math.floor(o/c)),this.isSingleValueCard=1===s;var h=Math.ceil(i/s);h>1&&(l+=n?r.cardItemContainer.topPadding:r.cardItemContainer.topPaddingCanvas,c=o/s,u=!0);var d=Math.ceil(h*l);n&&(d+=r.card.bottomBorderWidth+r.card.bottomPadding+r.card.topPadding);var p=d;n?a=Math.min(Math.floor(e.height/d),a):(p=this.getTotalCardHeight(d),o+=r.card.leftBorderWidth+r.card.leftPadding),this.cardHeight=d,this.columnWidth=c,this.cardWidth=o,this.cardHeightTotal=p,this.maxCardsDisplayed=a,this.cardItemContainerHeight=l,this.isCardWrapped=u},i.prototype.getPixelString=function(e){return e+"px"},i.prototype.onLoadMoreData=function(){!this.waitingForData&&this.dataView.metadata&&this.dataView.metadata.segment&&(this.options.host.loadMoreData(),this.waitingForData=!0)},i.prototype.getTotalCardHeight=function(e){return e+(this.isSingleRowCard?0:this.settings.card.marginBottom)},i.formatStringProp={objectName:"general",propertyName:"formatString"},i.multiRowCardClass="multiRowCard",i.Card={"class":"card",selector:".card"},i.Title={"class":"title",selector:".title"},i.CardItemContainer={"class":"cardItemContainer",selector:".cardItemContainer"},i.Caption={"class":"caption",selector:".caption"},i.Details={"class":"details",selector:".details"},i.TitleUrlSelector=i.Title.selector+" a",i.CaptionUrlSelector=i.Caption.selector+" a",i.SmallTileWidth=250,i.MediumTileWidth=490,i.LargeTileWidth=750,i.DefaultStyle={card:{bottomBorderWidth:1,leftBorderWidth:3,borderStyle:"solid",leftBorderColor:"#A6A6A6",borderColor:"#C8C8C8",bottomPadding:5,leftPadding:10,topPadding:5,color:"#767676",marginBottom:20},title:{height:24,marginBottom:5},cardItemContainer:{marginRight:20,maxWidth:100,topPadding:5,topPaddingCanvas:7},caption:{height:20,fontSize:14,color:"#333333"},details:{height:16,fontSize:12,color:"#A6A6A6"},scrollbar:{padding:8},cardItems:{maxItemsSmallTile:4,maxItemsMediumTile:6,maxItemsLargeTile:6},cardRowColumns:{maxRowColumnsSmallTile:2,maxRowColumnsMediumTile:3,maxRowColumnsLargeTile:6},cards:{maxCardsSmallTile:1,maxCardsMediumTile:3,maxCardsLargeTile:8}},i.capabilities={dataRoles:[{name:"Values",kind:2,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Fields")}],objects:{general:{properties:{formatString:{type:{formatting:{formatString:!0}}}}}},dataViewMappings:[{table:{rows:{"for":{"in":"Values"},dataReductionAlgorithm:{window:{}}},rowCount:{preferred:{min:1}}}}],suppressDefaultTitle:!0},i}();t.MultiRowCard=i}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var i=function(){function e(){}return e.prototype.init=function(e){this.element=e.element,this.host=e.host,this.viewport=e.viewport,this.element.addClass("richtextbox"),this.element.css({"font-family":a.defaultFont,"font-size":a.defaultFontSize}),this.readOnly=0===this.host.getViewMode(),this.paragraphs=[],this.refreshView(),this.editor&&this.editor.focusWhenLoaded()},e.prototype.onResizing=function(e){this.viewport=e,this.updateSize()},e.prototype.onDataChanged=function(e){var t=e.dataViews;if(this.paragraphs=[],t&&t.length>0){var i=t[0].metadata.objects;i&&i.general&&(this.paragraphs=i.general.paragraphs)}this.refreshView()},e.prototype.destroy=function(){},e.prototype.onViewModeChanged=function(e){this.readOnly=0===e,this.refreshView()},e.prototype.setSelection=function(e,t){this.editor&&this.editor.setSelection(e,t)},e.prototype.refreshView=function(){var t=this;this.readOnly?(this.editor&&(this.editor.formatUrls(),this.saveContents(),this.editor.destroy(),this.editor=null),this.element.empty(),this.element.append(e.convertParagraphsToHtml(this.paragraphs))):(this.editor||(this.editor=new a.QuillWrapper(this.readOnly,this.host),this.editor.textChanged=function(e,i){return t.saveContents()},this.element.empty(),this.element.append(this.editor.getElement())),this.editor.setContents(e.convertParagraphsToOps(this.paragraphs))),this.updateSize()},e.prototype.saveContents=function(){if(this.editor){var t=this.editor.getContents();this.paragraphs=e.convertDeltaToParagraphs(t);var i=[{objectName:"general",properties:{paragraphs:this.paragraphs},selector:null}];this.host.persistProperties(i)}},e.prototype.updateSize=function(){this.editor&&this.editor.resize(this.viewport)},e.convertDeltaToParagraphs=function(t){for(var i=[],a={textRuns:[]},r=0,n=t.ops.length;n>r;r++){var o=t.ops[r];if("string"==typeof o.insert){var s=o.insert,l=o.attributes;l&&l.align&&(a.horizontalTextAlignment=l.align);var u,c=0,h=0;do{if(h=s.indexOf("\n",c),0>h?(u=!1,h=s.length):u=!0,h-c>0){var d=s.substring(c,h),p={value:d};if(l){void 0!==l.link&&(p.url=l.link);var g=e.convertFormatAttributesToTextStyle(l);g&&(p.textStyle=g)}a.textRuns.push(p)}u&&(0===a.textRuns.length&&a.textRuns.push({value:""}),i.push(a),a={textRuns:[]}),c=h+1}while(c<s.length)}}return a.textRuns.length>0&&a.textRuns[0].value.length>0&&i.push(a),i},e.convertParagraphsToHtml=function(e){for(var t=$(),i=0,r=e.length;r>i;++i){var n=e[i],o=!0,s=$("<div>");n.horizontalTextAlignment&&s.css("text-align",n.horizontalTextAlignment);for(var l=0,u=n.textRuns.length;u>l;++l){var c=n.textRuns[l],h=$("<span>"),d=c.textStyle;if(d){var p={};d.fontFamily&&(p["font-family"]=a.getFontFamily(d.fontFamily)),d.fontSize&&(p["font-size"]=d.fontSize),d.fontStyle&&(p["font-style"]=d.fontStyle),d.fontWeight&&(p["font-weight"]=d.fontWeight),d.textDecoration&&(p["text-decoration"]=d.textDecoration),h.css(p)}var g=c.value;if(jsCommon.StringExtensions.isNullOrEmpty(g)||(o=!1),void 0!==c.url){var f=$("<a>").attr("href",c.url).attr("target","_blank").text(g);h.append(f)}else h.text(g);s.append(h)}o&&s.append($("<br>")),t=t.add(s)}return t},e.convertParagraphsToOps=function(e){for(var t=[],i=0,r=e.length;r>i;++i)for(var n=e[i],o=0,s=n.textRuns.length;s>o;++o){var l=n.textRuns[o],u={};n.horizontalTextAlignment&&(u.align=n.horizontalTextAlignment);var c=l.textStyle;c&&(c.fontFamily&&(u.font=a.getFontFamily(c.fontFamily)),c.fontSize&&(u.size=c.fontSize),u.italic="italic"===c.fontStyle,u.bold="bold"===c.fontWeight,u.underline="underline"===c.textDecoration);var h=l.value,d={insert:h,attributes:u};t.push(d),o!==s-1||jsCommon.StringExtensions.endsWith(h,"\n")||t.push({insert:"\n",attributes:u})}return t},e.convertFormatAttributesToTextStyle=function(e){var t={};return e.bold&&(t.fontWeight="bold"),e.font&&(t.fontFamily=e.font),e.italic&&(t.fontStyle="italic"),e.size&&(t.fontSize=e.size),e.underline&&(t.textDecoration="underline"),t},e.capabilities={objects:{general:{properties:{paragraphs:{type:{}}}}},suppressDefaultTitle:!0},e}();t.RichTextbox=i;var a;!function(t){function i(e){var t=a[e];return void 0!==t?t:e}var a={"Segoe (Bold)":"wf_segoe-ui_bold","Segoe UI":"wf_segoe-ui_normal","Segoe UI Light":"wf_segoe-ui_light",Heading:"wf_segoe-ui_light",Body:"wf_segoe-ui_normal"},r=["Arial","Arial Black","Arial Unicode MS","Calibri","Cambria","Cambria Math","Candara","Comic Sans MS","Consolas","Constantia","Corbel","Courier New","Georgia","Lucida Sans Unicode","Segoe (Bold)","Segoe UI","Segoe UI Light","Symbol","Tahoma","Times New Roman","Trebuchet MS","Verdana","Wingdings","Wingdings 2","Wingdings 3"].map(function(e){return{label:e,value:i(e)}});t.defaultFont=i("Segoe UI Light");var n=["8","9","10","10.5","11","12","14","16","18","20","24","28","32","36","40","42","44","54","60","66","72","80","88","96"].map(function(e){return{label:e,value:e+"px"}});t.defaultFontSize="14px";var o=["Left","Center","Right"].map(function(e){return{label:e,value:e.toLowerCase()}});t.getFontFamily=i;var s=function(){function i(e,t){var a=this;this.QuillPackage={javaScriptFiles:i.quillJsFiles,cssFiles:i.quillCssFiles},this.textChanged=function(e,t){},this.host=t,this.$container=$("<div>"),this.readOnly=e,this.localizationProvider={get:function(e){return a.host.getLocalizedString(e)}},this.dependenciesLoaded=$.Deferred(),i.loadQuillResources?(this.initialized=!1,this.dependenciesLoaded.done(function(){a.rebuildQuillEditor(),a.initialized=!0}),jsCommon.requires(this.QuillPackage,function(){return a.dependenciesLoaded.resolve()})):(this.rebuildQuillEditor(),this.initialized=!0,this.dependenciesLoaded.resolve())}return i.prototype.getElement=function(){return this.$container},i.prototype.getContents=function(){return this.initialized?this.editor.getContents():void 0},i.prototype.setContents=function(e){var t=this;return this.initialized?(this.editor.setHTML("","api"),e&&this.editor.setContents(e,"api"),void this.formatUrls()):void this.dependenciesLoaded.done(function(){return t.setContents(e)})},i.prototype.resize=function(e){this.$container.width(e.width),this.$container.height(e.height)},i.prototype.setReadOnly=function(e){var t=e!==this.readOnly;this.readOnly=e,this.initialized&&t&&this.rebuildQuillEditor()},i.prototype.formatUrls=function(){if(null!=this.editor){var e=this.editor.getText(),t=/http[s]?:\/\/(\S)+/gi;this.editor.formatText(0,e.length,"link",!1,"api");for(var i;null!==(i=t.exec(e));){var a=i[0],r=i.index,n=t.lastIndex;this.editor.formatText(r,n,"link",a,"api")}}},i.prototype.setSelection=function(e,t){this.editor&&this.editor.setSelection(e,t,"api")},i.prototype.getSelection=function(){return this.editor?this.editor.getSelection():void 0},i.prototype.focusWhenLoaded=function(){var e=this;this.dependenciesLoaded.done(function(){e.editor&&e.editor.focus()})},i.prototype.destroy=function(){this.host.setToolbar(null),this.$container.remove(),this.$container=null,this.$toolbarDiv=null,this.$editorDiv=null,this.editor=null},i.prototype.rebuildQuillEditor=function(){var e=this,a=null;this.editor&&(this.editor.removeAllListeners(),a=this.editor.getContents()),this.$container.empty(),this.$container.keydown(function(e){e.ctrlKey&&_.contains(i.preventDefaultKeys,e.which)&&e.stopPropagation()});var r=this.$editorDiv=$("<div>");r.css("font-family",t.defaultFont),r.css("font-size",t.defaultFontSize);var n={readOnly:this.readOnly,formats:["bold","italic","underline","font","size","link","align"],styles:!1};if(this.editor=new Quill(r.get(0),n),!this.readOnly){var o=this.$toolbarDiv;if(!o){var s=new l.Toolbar(this.editor,this.localizationProvider);this.$toolbarDiv=o=s.$container}o.addClass("unselectable"),this.host.setToolbar(o),this.editor.addModule("toolbar",{container:o.get(0)}),r.attr("drag-resize-disabled","true")}this.$container.append(r),a&&this.setContents(a);var u=new jsCommon.ThrottleUtility(i.textChangeThrottle);this.editor.on("text-change",function(t,i){"api"!==i&&u.run(function(){return e.onTextChanged(t,i)})});var c=new jsCommon.ThrottleUtility(i.formatUrlThrottle);this.editor.on("text-change",function(t,i){"api"!==i&&c.run(function(){return e.formatUrls()})}),this.editor.root.addEventListener("blur",function(t){var i=t.relatedTarget||document.activeElement;i&&"SELECT"===i.tagName||e.setSelection(null,null)},!1);try{this.editor.focus()}catch(h){}},i.prototype.onTextChanged=function(e,t){this.textChanged(e,t)},i.textChangeThrottle=200,i.formatUrlThrottle=1e3,i.preventDefaultKeys=[jsCommon.DOMConstants.aKeyCode,jsCommon.DOMConstants.cKeyCode,jsCommon.DOMConstants.xKeyCode,jsCommon.DOMConstants.vKeyCode],i.loadQuillResources=!0,i.quillJsFiles=[e.build+"/externals/quill.min.js"],i.quillCssFiles=[e.build+"/externals/quill.base.css"],i}();t.QuillWrapper=s;var l;!function(e){function i(e,t){e.val(t);var i=document.createEvent("UIEvent");i.initUIEvent("change",!1,!1,null,0),e.get(0).dispatchEvent(i)}function a(){return u().addClass("ql-format-group").attr("drag-resize-disabled","true")}function s(e){return $("<label>").text(e)}function l(){return $("<div>")}function u(){return $("<span>")}e.setSelectValue=i;var c=function(){function e(e,i){this.localizationProvider=i;var u=this.picker("Font",r,"font",t.defaultFont,function(e,t){return e.css("font-family",t.value),e});this.$container=l().addClass("toolbar ql-toolbar").append(a().append(s(i.get("RichTextbox_Font_Label"))).append(u).append(this.picker("Size",n,"size",t.defaultFontSize))).append(a().append(this.formatButton(this.getLocalizationString("Bold"),"bold")).append(this.formatButton(this.getLocalizationString("Italic"),"italic")).append(this.formatButton(this.getLocalizationString("Underline"),"underline"))).append(a().append(this.toggleGroup("Text Alignment",o,"align","Left"))),this.$container.on("mousedown",function(e){var t=e.target||document.activeElement;"SELECT"!==t.tagName&&e.preventDefault()})}return e.prototype.toggleGroup=function(e,t,a,r){var n=this,o=u().attr("localize-tooltip",this.getLocalizationString(e)).addClass("ql-toggle-group"),s=this.selector(e,t,r).addClass("ql-picker ql-"+a).css("display","none"),l=t.map(function(e){var t=n.formatButton(n.getLocalizationString(e.label)).attr("data-value",e.value).click(function(t){return i(s,e.value)});return t});return s.change(function(e){for(var t=s.val(),i=0;i<l.length;i++)l[i].toggleClass("ql-active",l[i].attr("data-value")===t)}),o.append(s),o.append(l),o},e.prototype.picker=function(e,t,i,a,r){var n=this.selector(e,t,a,r).addClass("ql-picker ql-"+i);return n},e.prototype.selector=function(e,t,i,a){for(var r=$("<select>").attr("localize-tooltip",this.getLocalizationString(e)),n=0;n<t.length;n++){var o=t[n],s=$("<option>").attr("value",o.value).text(o.label);o.value===i&&s.attr("selected","selected"),void 0!==a&&(s=a(s,o)),r.append(s)}return r},e.prototype.formatButton=function(e,t){var i=u().addClass("ql-format-button");return null!=e&&i.attr("localize-tooltip",e),null!=t&&i.addClass("ql-"+t),i},e.prototype.getLocalizationString=function(e){return"RichTextbox_"+e+"_ToolTip"},e}();e.Toolbar=c}(l||(l={}))}(a=t.RichText||(t.RichText={}))}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){t.cheerMeterProps={dataPoint:{defaultColor:{objectName:"dataPoint",propertyName:"defaultColor"},fill:{objectName:"dataPoint",propertyName:"fill"}}};var i=function(){function i(){this.isFirstTime=!0}return i.converter=function(a){var r=a.categorical.categories[0].values,n=a.categorical.values[0].values,o=a.categorical.categories[0].objects,s=e.DataViewObjects.getFillColor(o[0],t.cheerMeterProps.dataPoint.fill,i.DefaultFontColor),l=e.DataViewObjects.getFillColor(o[1],t.cheerMeterProps.dataPoint.fill,i.DefaultFontColor),u={teamA:{name:r[0],value:n[0],color:s},teamB:{name:r[1],value:n[1],color:l}};return u},i.prototype.init=function(e){var t=this.svg=d3.select(e.element.get(0)).append("svg");this.textOne=t.append("text").style("font-family",i.DefaultFontFamily),this.textTwo=t.append("text").style("font-family",i.DefaultFontFamily)},i.prototype.onResizing=function(e){},i.prototype.onDataChanged=function(e){},i.prototype.update=function(e){var a=i.converter(e.dataViews[0]),r=e.suppressAnimations?0:t.AnimatorCommon.MinervaAnimationDuration;this.draw(a,r,e.viewport)},i.prototype.getRecomendedFontProperties=function(t,a,r){for(var n,o={fontSize:"",fontFamily:i.DefaultFontFamily,text:t+a},s=1,l=1e3,u=r.width,c=0;l>=s;)if(n=(s+l)/2|0,o.fontSize=n+"px",c=e.TextMeasurementService.measureSvgTextWidth(o),u>c)s=n+1;else{if(!(c>u))break;l=n-1}return o.fontSize=n+"px",c=e.TextMeasurementService.measureSvgTextWidth(o),c>u&&(n--,o.fontSize=n+"px"),o},i.prototype.calculateLayout=function(t,a){var r=t.teamA.name,n=t.teamB.name,o={height:a.height,width:a.width-i.PaddingBetweenText},s=this.getRecomendedFontProperties(r,n,o);s.text=r;var l=0|e.TextMeasurementService.measureSvgTextWidth(s);s.text=n;var u=0|e.TextMeasurementService.measureSvgTextWidth(s),c=(a.width-l-u-i.PaddingBetweenText)/2|0;s.text=r+n;var h=0|e.TextMeasurementService.measureSvgTextHeight(s),d=100,p=a.height-h,g=(d-t.teamA.value)/d*p+h/2|0,f=(d-t.teamB.value)/d*p+h/2|0;return{x1:c,x2:c+l+i.PaddingBetweenText,y1:g,y2:f,fontSize:s.fontSize}},i.prototype.ensureStartState=function(e,t){if(this.isFirstTime){this.isFirstTime=!1;var i=t.height/2;this.textOne.attr({x:e.x1,y:i}),this.textTwo.attr({x:e.x2,y:i})}},i.prototype.draw=function(e,t,a){var r="back",n=this.textOne,o=this.textTwo;this.svg.attr({height:a.height,width:a.width}).style("background-color",i.DefaultBackgroundColor);var s=this.calculateLayout(e,a);this.ensureStartState(s,a),n.style("font-size",s.fontSize).style("fill",e.teamA.color).text(e.teamA.name),o.style("fill",e.teamB.color).style("font-size",s.fontSize).text(e.teamB.name),n.transition().duration(t).ease(r).attr({y:s.y1,x:s.x1}),o.transition().duration(t).ease(r).attr({y:s.y2,x:s.x2})},i.prototype.destroy=function(){this.svg=null,this.textOne=this.textTwo=null},i.capabilities={dataRoles:[{name:"Category",kind:0},{name:"Y",kind:1}],dataViewMappings:[{categorical:{categories:{"for":{"in":"Category"}}}}],dataPoint:{displayName:e.data.createDisplayNameGetter("Visual_DataPoint"),properties:{fill:{displayName:e.data.createDisplayNameGetter("Visual_Fill"),type:{fill:{solid:{color:!0}}}}}}},i.DefaultFontFamily="cursive",i.DefaultFontColor="rgb(165, 172, 175)",i.DefaultBackgroundColor="#243C18",i.PaddingBetweenText=15,i}();t.CheerMeter=i}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){t.scatterChartCapabilities={dataRoles:[{name:"Category",kind:0,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Details")},{name:"Series",kind:0,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Legend")},{name:"X",kind:1,displayName:e.data.createDisplayNameGetter("Role_DisplayName_X")},{name:"Y",kind:1,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Y")},{name:"Size",kind:1,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Size")},{name:"Gradient",kind:1,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Gradient")}],objects:{dataPoint:{displayName:e.data.createDisplayNameGetter("Visual_DataPoint"),properties:{defaultColor:{displayName:e.data.createDisplayNameGetter("Visual_DefaultColor"),type:{fill:{solid:{color:!0}}}},showAllDataPoints:{displayName:e.data.createDisplayNameGetter("Visual_DataPoint_Show_All"),type:{bool:!0}},fill:{displayName:e.data.createDisplayNameGetter("Visual_Fill"),type:{fill:{solid:{color:!0}}}},fillRule:{displayName:e.data.createDisplayNameGetter("Visual_Gradient"),type:{fillRule:{}},rule:{inputRole:"Gradient",output:{property:"fill",selector:["Category"]}}}}},general:{displayName:e.data.createDisplayNameGetter("Visual_General"),properties:{formatString:{type:{formatting:{formatString:!0}}}}},categoryAxis:{displayName:e.data.createDisplayNameGetter("Visual_XAxis"),properties:{show:{displayName:e.data.createDisplayNameGetter("Visual_Show"),type:{bool:!0}},start:{displayName:e.data.createDisplayNameGetter("Visual_Axis_Start"),type:{numeric:!0}},end:{displayName:e.data.createDisplayNameGetter("Visual_Axis_End"),type:{numeric:!0}},showAxisTitle:{displayName:e.data.createDisplayNameGetter("Visual_Axis_Title"),type:{bool:!0}},axisStyle:{displayName:e.data.createDisplayNameGetter("Visual_Axis_Style"),type:{formatting:{axisStyle:!0}}}}},valueAxis:{displayName:e.data.createDisplayNameGetter("Visual_YAxis"),properties:{show:{displayName:e.data.createDisplayNameGetter("Visual_Show"),type:{bool:!0}},position:{displayName:e.data.createDisplayNameGetter("Visual_YAxis_Position"),type:{formatting:{yAxisPosition:!0}}},start:{displayName:e.data.createDisplayNameGetter("Visual_Axis_Start"),type:{numeric:!0}},end:{displayName:e.data.createDisplayNameGetter("Visual_Axis_End"),type:{numeric:!0}},showAxisTitle:{displayName:e.data.createDisplayNameGetter("Visual_Axis_Title"),type:{bool:!0}},axisStyle:{displayName:e.data.createDisplayNameGetter("Visual_Axis_Style"),type:{formatting:{axisStyle:!0}}}}},legend:{displayName:e.data.createDisplayNameGetter("Visual_Legend"),properties:{show:{displayName:e.data.createDisplayNameGetter("Visual_Show"),type:{bool:!0}},position:{displayName:e.data.createDisplayNameGetter("Visual_LegendPosition"),type:{formatting:{legendPosition:!0}}},showTitle:{displayName:e.data.createDisplayNameGetter("Visual_LegendShowTitle"),type:{bool:!0}},titleText:{displayName:e.data.createDisplayNameGetter("Visual_LegendTitleText"),type:{text:!0}}}},categoryLabels:{displayName:e.data.createDisplayNameGetter("Visual_CategoryLabels"),properties:{show:{displayName:e.data.createDisplayNameGetter("Visual_Show"),type:{bool:!0}},color:{displayName:e.data.createDisplayNameGetter("Visual_LabelsFill"),type:{fill:{solid:{color:!0}}}}}}},dataViewMappings:[{conditions:[{Category:{max:1},Series:{max:1},X:{max:1},Y:{max:1},Size:{max:1},Gradient:{max:0}},{Category:{max:1},Series:{max:0},X:{max:1},Y:{max:1},Size:{max:1},Gradient:{max:1}}],categorical:{categories:{"for":{"in":"Category"},dataReductionAlgorithm:{sample:{}}},values:{group:{by:"Series",select:[{bind:{to:"X"}},{bind:{to:"Y"}},{bind:{to:"Size"}},{bind:{to:"Gradient"}}],dataReductionAlgorithm:{top:{}}}},rowCount:{preferred:{min:2}}}}],sorting:{custom:{}}},t.scatterChartProps={general:{formatString:{objectName:"general",propertyName:"formatString"}},dataPoint:{defaultColor:{objectName:"dataPoint",propertyName:"defaultColor"},fill:{objectName:"dataPoint",propertyName:"fill"}}}}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var i=function(){function i(e){e&&(this.interactivityService=e.interactivityService,this.animator=e.animator)}return i.prototype.init=function(e){this.options=e;var t=this.element=e.element;this.currentViewport=e.viewport,this.style=e.style,this.host=e.host,this.colors=this.style.colorPalette.dataColors,this.interactivity=e.interactivity,this.cartesianVisualHost=e.cartesianHost,this.isInteractiveChart=e.interactivity&&e.interactivity.isInteractiveLegend,t.addClass(i.ClassName);var a=this.svg=e.svg;this.clearCatcher=this.svg.select(".clearCatcher"),this.mainGraphicsG=a.append("g").classed(i.MainGraphicsContextClassName,!0),this.mainGraphicsContext=this.mainGraphicsG.append("svg")},i.converter=function(a,r,n,o,s,l){var u,c,h,d,p=a.categorical,g=a.metadata;p.categories&&p.categories.length>0?(u=p.categories[0].values,c=t.valueFormatter.create({format:t.valueFormatter.getFormatString(p.categories[0].source,t.scatterChartProps.general.formatString),value:u[0],value2:u[u.length-1]}),d=p.categories[0].identity,h=p.categories[0].objects):(u=[null],c=t.valueFormatter.createDefaultFormatter(null));var f=p.categories,m=p.values,y=!!m.source,v=m.grouped(),C=m.source,b=i.getMetadata(v,C),x=t.dataLabelUtils.getDefaultPointLabelSettings();if(g&&g.objects){var S=g.objects,w=e.DataViewObjects.getFillColor(S,t.columnChartProps.dataPoint.defaultColor),_=e.DataViewObjects.getValue(S,t.columnChartProps.dataPoint.showAllDataPoints),T=S.categoryLabels;T&&(x.show=void 0!==T.show?T.show:x.show,x.precision=void 0!==T.labelsPrecision?+T.labelsPrecision:x.precision,void 0!==T.color&&(x.labelColor=T.color.solid.color))}var D=i.createDataPoints(m,b,f,u,c,d,h,n,r,y,x,w);o&&o.applySelectionStateToData(D);var P=y?i.createSeriesLegend(m,n,m,t.valueFormatter.getFormatString(C,t.scatterChartProps.general.formatString),w):[],M=m&&C?C.displayName:"";M||(M=f&&f[0].source.displayName?f[0].source.displayName:"");var L={title:M,dataPoints:P},A=i.getSizeRangeForGroups(v,b.idx.size);return s&&null!==s.showAxisTitle&&s.showAxisTitle===!1&&(b.axesLabels.x=null),l&&null!==l.showAxisTitle&&l.showAxisTitle===!1&&(b.axesLabels.y=null),{xCol:b.cols.x,yCol:b.cols.y,dataPoints:D,legendData:L,axesLabels:b.axesLabels,hasSelection:!1,selectedIds:[],size:b.cols.size,sizeRange:A,dataLabelsSettings:x,defaultDataPointColor:w,hasDynamicSeries:y,showAllDataPoints:_}},i.getSizeRangeForGroups=function(e,a){var r={};return e&&e.forEach(function(e){var n=i.getMeasureValue(a,e.values),o=t.AxisHelper.getRangeForColumn(n);(null==r.min||r.min>o.min)&&(r.min=o.min),(null==r.max||r.max<o.max)&&(r.max=o.max)}),r},i.createDataPoints=function(e,a,r,n,o,s,l,u,c,h,d,p){for(var g=[],f=a.idx,m=t.scatterChartProps.general.formatString,y=e.source,v=e.grouped(),C=new t.ColorHelper(u,t.scatterChartProps.dataPoint.fill,p),b=0,x=n.length;x>b;b++)for(var S=n[b],w=0,_=v.length;_>w;w++){var T=v[w],D=T.values,P=i.getMeasureValue(f.x,D),M=i.getMeasureValue(f.y,D),L=i.getMeasureValue(f.size,D),A=P&&P.values?P.values[b]:null,N=M&&M.values?M.values[b]:0,V=L&&L.values?L.values[b]:null,I=null==A||null==N;if(!I){var R;if(h)R=C.getColorForSeriesValue(T.objects,e.identityFields,T.name);else{var H=null!=L?L.source.queryName:"";R=C.getColorForMeasure(l&&l[b],H)}var E=t.SelectionId.createWithIds(s?s[b]:void 0,h?T.identity:void 0),O=[];y&&O.push({value:T.name,metadata:{source:y,values:[]}}),P&&O.push({value:A,metadata:P}),M&&O.push({value:N,metadata:M}),L&&L.values&&L.values.length>0&&O.push({value:L.values[b],metadata:L});var F=t.TooltipBuilder.createTooltipInfo(m,r,S,null,null,O),G={x:A,y:N,size:V,radius:{sizeMeasure:L,index:b},fill:R,category:o.format(S),selected:!1,identity:E,tooltipInfo:F,labelFill:d.labelColor};g.push(G)}}return g},i.createSeriesLegend=function(e,i,a,r,n){for(var o=e.grouped(),s=new t.ColorHelper(i,t.scatterChartProps.dataPoint.fill,n),l=[],u=0,c=o.length;c>u;u++){var h=o[u],d=s.getColorForSeriesValue(h.objects,e.identityFields,h.name);l.push({color:d,icon:t.LegendIcon.Circle,label:t.valueFormatter.format(h.name,r),identity:h.identity?t.SelectionId.createWithId(h.identity):t.SelectionId.createNull(),selected:!1})}return l},i.getBubbleRadius=function(e,t,a){var r=null,n=null,o=e.sizeMeasure;if(!o)return i.BubbleRadius;var s=t.min?t.min:0,l=t.max?t.max:0,u=Math.min(s,0),c=Math.max(l,0);if(r={minRange:u,maxRange:c,delta:c-u},n=i.getBubblePixelAreaSizeRange(a,i.MinSizeRange,i.MaxSizeRange),o.values){var h=o.values[e.index];if(null!=h)return i.projectSizeToPixels(h,r,n)/2}return i.BubbleRadius},i.getMeasureValue=function(e,t){return e>=0?t[e]:null},i.getMetadata=function(e,a){var r,n,o,s=t.DataRoleHelper.getMeasureIndexOfRole(e,"X"),l=t.DataRoleHelper.getMeasureIndexOfRole(e,"Y"),u=t.DataRoleHelper.getMeasureIndexOfRole(e,"Size"),c="",h="";if(e&&e.length){var d=e[0],p=d.values.length;s>=0||(s=i.getDefaultMeasureIndex(p,l,u)),l>=0||(l=i.getDefaultMeasureIndex(p,s,u)),u>=0||(u=i.getDefaultMeasureIndex(p,s,l)),s>=0&&(r=d.values[s].source,c=d.values[s].source.displayName),l>=0&&(n=d.values[l].source,h=d.values[l].source.displayName),u>=0&&(o=d.values[u].source)}return{idx:{x:s,y:l,size:u},cols:{x:r,y:n,size:o},axesLabels:{x:c,y:h}}},i.getDefaultMeasureIndex=function(e,t,i){for(var a=0;e>a;a++)if(a!==t&&a!==i)return a},i.prototype.setData=function(e){if(this.data={xCol:void 0,yCol:void 0,dataPoints:[],legendData:{dataPoints:[]},axesLabels:{x:"",y:""},selectedIds:[],sizeRange:[],dataLabelsSettings:t.dataLabelUtils.getDefaultPointLabelSettings(),defaultDataPointColor:null,hasDynamicSeries:!1},e.length>0){var a=e[0];a&&(this.categoryAxisProperties=t.CartesianHelper.getCategoryAxisProperties(a.metadata,!0),this.valueAxisProperties=t.CartesianHelper.getValueAxisProperties(a.metadata,!0),this.dataView=a,a.categorical&&a.categorical.values&&(this.data=i.converter(a,this.currentViewport,this.colors,this.interactivityService,this.categoryAxisProperties,this.valueAxisProperties)));
}},i.prototype.calculateLegend=function(){return this.data.legendData},i.prototype.hasLegend=function(){return this.data&&this.data.hasDynamicSeries},i.prototype.enumerateObjectInstances=function(e){switch(e.objectName){case"dataPoint":var i=this.dataView&&this.dataView.categorical?this.dataView.categorical:null;if(!t.GradientUtils.hasGradientRole(i))return this.enumerateDataPoints();case"categoryAxis":return[{selector:null,properties:{showAxisTitle:this.categoryAxisProperties&&null!=this.categoryAxisProperties.showAxisTitle?this.categoryAxisProperties.showAxisTitle:!0},objectName:"categoryAxis"}];case"valueAxis":return[{selector:null,properties:{showAxisTitle:this.valueAxisProperties&&null!=this.valueAxisProperties.showAxisTitle?this.valueAxisProperties.showAxisTitle:!0},objectName:"valueAxis"}];case"categoryLabels":return this.data?t.dataLabelUtils.enumerateCategoryLabels(this.data.dataLabelsSettings,!0):t.dataLabelUtils.enumerateCategoryLabels(null,!0)}},i.prototype.enumerateDataPoints=function(){var e=this.data;if(e){var i=[],a=e.dataPoints.length;if(e.hasDynamicSeries)for(var r=e.legendData.dataPoints.length,n=0;r>n;n++){var o=e.legendData.dataPoints[n];i.push({objectName:"dataPoint",displayName:o.label,selector:t.ColorHelper.normalizeSelector(o.identity.getSelector()),properties:{fill:{solid:{color:o.color}}}})}else{i.push({objectName:"dataPoint",selector:null,properties:{defaultColor:{solid:{color:e.defaultDataPointColor||this.colors.getColorByIndex(0).value}}}},{objectName:"dataPoint",selector:null,properties:{showAllDataPoints:!!e.showAllDataPoints}});for(var n=0;a>n;n++){var s=e.dataPoints[n];i.push({objectName:"dataPoint",displayName:s.category,selector:t.ColorHelper.normalizeSelector(s.identity.getSelector(),!0),properties:{fill:{solid:{color:s.fill}}}})}}return i}},i.prototype.calculateAxesProperties=function(e){var i=this.data,a=i.dataPoints,r=this.currentViewport=e.viewport,n=e.margin;this.currentViewport=r,this.margin=n;var o=r.width-(n.left+n.right),s=r.height-(n.top+n.bottom),l=0,u=10,c=0,h=10;a.length>0&&(l=d3.min(a,function(e){return e.y}),u=d3.max(a,function(e){return e.y}),c=d3.min(a,function(e){return e.x}),h=d3.max(a,function(e){return e.x}));var d=[c,h],p=t.AxisHelper.combineDomain(e.forcedXDomain,d);this.xAxisProperties=t.AxisHelper.createAxis({pixelSpan:o,dataDomain:p,metaDataColumn:i.xCol,formatStringProp:t.scatterChartProps.general.formatString,outerPadding:0,isScalar:!0,isVertical:!1,forcedTickCount:e.forcedTickCount,useTickIntervalForDisplayUnits:!0,isCategoryAxis:!0}),this.xAxisProperties.axis.tickSize(-s,0),this.xAxisProperties.axisLabel=this.data.axesLabels.x;var g=t.AxisHelper.combineDomain(e.forcedYDomain,[l,u]);return this.yAxisProperties=t.AxisHelper.createAxis({pixelSpan:s,dataDomain:g,metaDataColumn:i.yCol,formatStringProp:t.scatterChartProps.general.formatString,outerPadding:0,isScalar:!0,isVertical:!0,forcedTickCount:e.forcedTickCount,useTickIntervalForDisplayUnits:!0,isCategoryAxis:!1}),this.yAxisProperties.axisLabel=this.data.axesLabels.y,[this.xAxisProperties,this.yAxisProperties]},i.prototype.overrideXScale=function(e){this.xAxisProperties=e},i.prototype.render=function(e){if(this.data){var i=this.data,a=this.data.dataPoints,r=this.margin,n=this.currentViewport,o=n.width-(r.left+r.right),s=n.height-(r.top+r.bottom),l=this.xAxisProperties.scale,u=this.yAxisProperties.scale,c=t.dataHasSelection(a);this.mainGraphicsContext.attr("width",o).attr("height",s);var h=a.sort(function(e,t){return t.radius.sizeMeasure?t.radius.sizeMeasure.values[t.radius.index]-e.radius.sizeMeasure.values[e.radius.index]:0}),d=this.drawScatterMarkers(h,c,i.sizeRange,e);if(this.data.dataLabelsSettings.show){var p=t.dataLabelUtils.getScatterChartLabelLayout(l,u,this.data.dataLabelsSettings,n,i.sizeRange);t.dataLabelUtils.drawDefaultLabelsForDataPointChart(a,this.mainGraphicsG,p,this.currentViewport)}else t.dataLabelUtils.cleanDataLabels(this.mainGraphicsG);if(this.interactivityService){var g={host:this.cartesianVisualHost,root:this.svg,dataPointsSelection:d,mainContext:this.mainGraphicsContext,data:this.data,visualInitOptions:this.options,xAxisProperties:this.xAxisProperties,yAxisProperties:this.yAxisProperties,background:d3.select(this.element.get(0)),clearCatcher:this.clearCatcher};this.interactivityService.apply(this,g)}t.TooltipManager.addTooltip(d,function(e){return e.data.tooltipInfo}),t.SVGUtil.flushAllD3TransitionsIfNeeded(this.options)}},i.prototype.drawScatterMarkers=function(e,a,r,n){var o=this,s=t.AnimatorCommon.GetAnimationDuration(this.animator,n),l=this.xAxisProperties.scale,u=this.yAxisProperties.scale,c=this.mainGraphicsContext.selectAll(i.DotClasses.selector).data(e,function(e){return e.identity.getKey()});return c.enter().append(i.ScatterChartCircleTagName).classed(i.DotClasses["class"],!0),c.style({"stroke-opacity":function(e){return i.getBubbleOpacity(e,a)},"stroke-width":"1px",stroke:function(e){return e.fill},fill:function(e){return e.fill},"fill-opacity":function(e){return null!=e.size?i.getBubbleOpacity(e,a):0}}).transition().duration(s).attr({r:function(e){return i.getBubbleRadius(e.radius,r,o.currentViewport)},cx:function(e){return l(e.x)},cy:function(e){return u(e.y)}}),c.exit().remove(),c},i.getBubblePixelAreaSizeRange=function(e,t,a){var r=1;if(e.height>0&&e.width>0){var n=Math.min(e.height,e.width);r=n*n/i.AreaOf300By300Chart}var o=Math.round(t*r),s=Math.round(a*r);return{minRange:o,maxRange:s,delta:s-o}},i.project=function(e,t,a){if(0===t.delta||0===a.delta)return i.rangeContains(t,e)?a.minRange:null;var r=(e-t.minRange)/t.delta;return a.minRange+r*a.delta},i.projectSizeToPixels=function(e,t,a){var r=0;if(t){if(r=a.maxRange,0!==t.delta){var n=Math.min(Math.max(e,t.minRange),t.maxRange);r=i.project(n,t,a)}r=2*Math.sqrt(r/Math.PI)}return Math.round(r)},i.rangeContains=function(e,t){return e.minRange<=t&&t<=e.maxRange},i.getBubbleOpacity=function(e,t){return t&&!e.selected?i.DimmedBubbleOpacity:i.DefaultBubbleOpacity},i.prototype.accept=function(e,t){e.visitScatterChart(t)},i.prototype.onClearSelection=function(){this.interactivityService&&this.interactivityService.clearSelection()},i.prototype.getSupportedCategoryAxisType=function(){return e.axisType.scalar},i.ScatterChartCircleTagName="circle",i.BubbleRadius=6,i.DefaultBubbleOpacity=.85,i.DimmedBubbleOpacity=.4,i.AreaOf300By300Chart=9e4,i.MinSizeRange=200,i.MaxSizeRange=3e3,i.ClassName="scatterChart",i.MainGraphicsContextClassName="mainGraphicsContext",i.DotClasses={"class":"dot",selector:".dot"},i}();t.ScatterChart=i}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){t.slicerCapabilities={dataRoles:[{name:"Values",kind:0,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Field")}],dataViewMappings:[{conditions:[{Values:{max:1}}],categorical:{categories:{"for":{"in":"Values"},dataReductionAlgorithm:{window:{}}},includeEmptyGroups:!0}}],objects:{general:{properties:{selected:{type:{bool:!0}},filter:{type:{filter:{}},rule:{output:{property:"selected",selector:["Values"]}}},formatString:{type:{formatting:{formatString:!0}}}}}},sorting:{"default":{}},suppressDefaultTitle:!0},t.slicerProps={selectedPropertyIdentifier:{objectName:"general",propertyName:"selected"},filterPropertyIdentifier:{objectName:"general",propertyName:"filter"},formatString:{objectName:"general",propertyName:"formatString"}}}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var i=function(){function i(){}return i.converter=function(e){var i;if(e){var a=e.categorical;if(a&&a.categories&&a.categories.length>0){for(var r=a.categories[0],n=r&&r.values?r.values.length:0,o=[],s=void 0,l=0;n>l;l++){var u=t.WebInteractivityService.isSelected(t.slicerProps.selectedPropertyIdentifier,r,l);if(void 0!==u){s=u;break}}for(var l=0;n>l;l++){var c=r.identity?r.identity[l]:null,h=t.WebInteractivityService.isSelected(t.slicerProps.selectedPropertyIdentifier,r,l);void 0===h&&void 0!==s&&(h=!s),o.push({value:r.values[l],mouseOver:!1,mouseOut:!0,identity:t.SelectionId.createWithId(c),selected:h})}i={categorySourceName:r.source.displayName,formatString:t.valueFormatter.getFormatString(r.source,t.slicerProps.formatString),slicerDataPoints:o}}}return i},i.prototype.init=function(e){this.element=e.element,this.currentViewport=e.viewport,this.interactivityService=t.VisualInteractivityFactory.buildInteractivityService(e),this.hostServices=e.host,this.settings=i.DefaultStyleProperties,this.initContainer()},i.prototype.onDataChanged=function(t){var i=t.dataViews,a=this.dataView;i&&i.length>0&&(this.dataView=i[0]);var r=!1;null!=t.operationKind&&(r=1!==t.operationKind&&!e.DataViewAnalysis.hasSameCategoryIdentity(a,this.dataView)),this.updateInternal(r),this.waitingForData=!1},i.prototype.onResizing=function(e){this.currentViewport=e;var i=this.getSlicerBodyViewport(this.currentViewport);this.slicerBody.style({height:t.SVGUtil.convertToPixelString(i.height),width:t.SVGUtil.convertToPixelString(i.width)}),this.updateInternal()},i.prototype.accept=function(e,t){e.visitSlicer(t)},i.prototype.updateInternal=function(e){void 0===e&&(e=!1);var t=this.slicerData=i.converter(this.dataView);return t?void this.listView.viewport(this.getSlicerBodyViewport(this.currentViewport)).rowHeight(this.getRowHeight()).data(t.slicerDataPoints,function(e){return $.inArray(e,t.slicerDataPoints)}).render(!0,e):void this.listView.empty()},i.prototype.initContainer=function(){var e=this,a=this.settings,r=this.getSlicerBodyViewport(this.currentViewport);this.slicerContainer=d3.select(this.element.get(0)).classed(i.Container["class"],!0),this.slicerHeader=this.slicerContainer.append("div").classed(i.Header["class"],!0).style("height",t.SVGUtil.convertToPixelString(a.header.height)),this.slicerHeader.append("span").classed(i.Clear["class"],!0).attr("title",this.hostServices.getLocalizedString(i.clearTextKey)),this.slicerHeader.append("div").classed(i.HeaderText["class"],!0).style({"margin-left":t.SVGUtil.convertToPixelString(a.headerText.marginLeft),"margin-top":t.SVGUtil.convertToPixelString(a.headerText.marginTop)}),this.slicerBody=this.slicerContainer.append("div").classed(i.Body["class"],!0).style({height:t.SVGUtil.convertToPixelString(r.height),width:t.SVGUtil.convertToPixelString(r.width)});var n=function(r){var n=t.SVGUtil.convertToPixelString(e.currentViewport.width-(a.slicerItemContainer.marginLeft+a.slicerText.marginLeft)),o=r.append("li").classed(i.ItemContainer["class"],!0).style({height:t.SVGUtil.convertToPixelString(a.slicerItemContainer.height),"margin-left":t.SVGUtil.convertToPixelString(a.slicerItemContainer.marginLeft)}),s=o.append("label").classed(i.Input["class"],!0);s.append("input").attr("type","checkbox"),s.append("span").classed(i.LabelText["class"],!0).style("width",n)},o=function(a){var r;e.slicerData&&(e.slicerHeader.select(i.HeaderText.selector).text(e.slicerData.categorySourceName),r=e.slicerData.formatString);var n=a.selectAll(i.LabelText.selector);if(n.text(function(e){return t.valueFormatter.format(e.value,r)}),e.interactivityService&&e.slicerData&&e.slicerBody){var o=e.slicerBody.attr("width",e.currentViewport.width),s=o.selectAll(i.ItemContainer.selector),l=o.selectAll(i.LabelText.selector),u=o.selectAll(i.Input.selector),c=e.slicerHeader.select(i.Clear.selector),h={datapoints:e.slicerData.slicerDataPoints,slicerItemContainers:s,slicerItemLabels:l,slicerItemInputs:u,slicerClear:c};e.interactivityService.apply(e,h)}a.select(i.Input.selector).select("input").property("checked",function(e){return e.selected})},s=function(e){e.remove()},l={rowHeight:this.getRowHeight(),enter:n,exit:s,update:o,loadMoreData:function(){return e.onLoadMoreData()},viewport:this.getSlicerBodyViewport(this.currentViewport),baseContainer:this.slicerBody};this.listView=t.ListViewFactory.createHTMLListView(l)},i.prototype.onLoadMoreData=function(){!this.waitingForData&&this.dataView.metadata&&this.dataView.metadata.segment&&(this.hostServices.loadMoreData(),this.waitingForData=!0)},i.prototype.getSlicerBodyViewport=function(e){var t=this.settings,i=e.height-(t.header.height+t.header.borderBottomWidth);return{height:i,width:e.width}},i.prototype.getRowHeight=function(){var e=this.settings.slicerItemContainer;return e.height},i.clearTextKey="Slicer_Clear",i.Container={"class":"slicerContainer",selector:".slicerContainer"},i.Header={"class":"slicerHeader",selector:".slicerHeader"},i.HeaderText={"class":"headerText",selector:".headerText"},i.Body={"class":"slicerBody",selector:".slicerBody"},i.ItemContainer={"class":"slicerItemContainer",selector:".slicerItemContainer"},i.LabelText={"class":"slicerText",selector:".slicerText"},i.Input={"class":"slicerCheckbox",selector:".slicerCheckbox"},i.Clear={"class":"clear",selector:".clear"},i.DefaultStyleProperties={header:{height:22,borderBottomWidth:1},headerText:{marginLeft:8,marginTop:0},slicerText:{color:"#666666",hoverColor:"#212121",selectionColor:"#212121",marginLeft:8},slicerItemContainer:{height:24,marginTop:5,marginLeft:8}},i}();t.Slicer=i}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var i=function(){function i(e,t){this.tableDataView=e,this.formatter=t}return i.prototype.getDepth=function(e){return 1},i.prototype.getLeafCount=function(e){return e.length},i.prototype.getLeafAt=function(e,t){return e[t]},i.prototype.getParent=function(e){return null},i.prototype.getIndex=function(e){return e?this.isRow(e)?e.index:this.getColumnIndex(e):-1},i.prototype.isRow=function(e){if(!e)return!1;var t=e;return void 0!==t.index&&void 0!==t.values},i.prototype.getColumnIndex=function(e){return i.getIndex(this.tableDataView.columns,e)},i.prototype.isLeaf=function(e){return!0},i.prototype.isRowHierarchyLeaf=function(e){return!1},i.prototype.isColumnHierarchyLeaf=function(e){return!0},i.prototype.isLastItem=function(e,t){return!1},i.prototype.getChildren=function(e){return null},i.prototype.getCount=function(e){return e.length},i.prototype.getAt=function(e,t){return e[t]},i.prototype.getLevel=function(e){return 0},i.prototype.getIntersection=function(e,a){var n,o=!1,s=!1,l=i.getIndex(this.tableDataView.columns,a),u=e;if(null!=u.totalCells)o=!0,n=u.totalCells[l];else{var c=this.tableDataView.visualRows[this.tableDataView.visualRows.length-1];s=c===e,n=e.values[l]}var h=this.formatter(n,t.valueFormatter.getFormatString(a,r.formatStringProp));return{value:h,isMeasure:a.isMeasure,isTotal:o,isBottomMost:s,showUrl:t.UrlHelper.isValidUrl(a,h)}},i.prototype.getCorner=function(e,t){return null},i.prototype.headerItemEquals=function(t,i){if(t===i)return!0;if(t.displayName&&i.displayName){var a=t,r=i;return e.DataViewAnalysis.areMetadataColumnsEquivalent(a,r)}return this.isRow(t)&&this.isRow(i)?t.index===i.index:!1},i.prototype.bodyCellItemEquals=function(e,t){return e===t},i.prototype.cornerCellItemEquals=function(e,t){return!0},i.prototype.update=function(e){this.tableDataView=e},i.getIndex=function(e,t){for(var i=0,a=e.length;a>i;i++){var r=e[i];if(null!=r.index&&null!=t.index&&r.index===t.index)return i;if(t===e[i])return i}return-1},i}();t.TableHierarchyNavigator=i;var a=function(){function e(e){this.options=e}return e.prototype.onStartRenderingSession=function(){},e.prototype.onEndRenderingSession=function(){},e.prototype.bindRowHeader=function(e,t){this.ensureHeight(e,t),this.options.onBindRowHeader&&this.options.onBindRowHeader(e)},e.prototype.unbindRowHeader=function(e,t){},e.prototype.bindColumnHeader=function(t,i){var a=this,r=e.columnHeaderClassName;if(t.isMeasure&&(r+=" "+e.numericCellClassName),i.extension.setContainerStyle(r),i.extension.disableDragResize(),i.extension.contentHost.textContent=t.displayName,this.options.onColumnHeaderClick){var n=function(e){a.options.onColumnHeaderClick(t.queryName?t.queryName:t.displayName)};i.extension.registerClickHandler(n)}},e.prototype.unbindColumnHeader=function(e,t){t.extension.clearContainerStyle(),t.extension.contentHost.textContent="",this.options.onColumnHeaderClick&&t.extension.unregisterClickHandler()},e.prototype.bindBodyCell=function(i,a){i.showUrl?t.controls.internal.TablixUtils.appendATagToBodyCell(i.value,a):a.extension.contentHost.textContent=i.value;var r=i.isTotal?e.footerClassName:i.isBottomMost?e.lastRowClassName:e.rowClassName;i.isMeasure&&(r+=" "+e.numericCellClassName),a.extension.setContainerStyle(r)},e.prototype.unbindBodyCell=function(e,t){t.extension.clearContainerStyle(),t.extension.contentHost.textContent=""},e.prototype.bindCornerCell=function(e,t){},e.prototype.unbindCornerCell=function(e,t){},e.prototype.bindEmptySpaceHeaderCell=function(e){},e.prototype.unbindEmptySpaceHeaderCell=function(e){},e.prototype.bindEmptySpaceFooterCell=function(e){},e.prototype.unbindEmptySpaceFooterCell=function(e){},e.prototype.getHeaderLabel=function(e){return e.displayName},e.prototype.getCellContent=function(e){return e},e.prototype.hasRowGroups=function(){return!1},e.prototype.ensureHeight=function(t,i){if(t.values){var a=t.values.length;if(0!==a){for(var r=!0,n=0;a>n;n++)if(t.values[n]){r=!1;break}r&&(i.extension.contentHost.innerHTML=e.nonBreakingSpace)}}},e.columnHeaderClassName="bi-table-column-header",e.rowClassName="bi-table-row",e.lastRowClassName="bi-table-last-row",e.footerClassName="bi-table-footer",e.numericCellClassName="bi-table-cell-numeric",e.nonBreakingSpace="&nbsp;",e}();t.TableBinder=a;var r=function(){function r(){}return r.customizeQuery=function(t){var i=t.dataViewMappings[0];if(i&&i.table&&i.metadata){var a=i.table.rows,n=i.metadata.objects;a["for"]["in"].subtotalType=r.shouldShowTotals(n)?e.data.CompiledSubtotalType.Before:e.data.CompiledSubtotalType.None}},r.getSortableRoles=function(){return["Values"]},r.prototype.init=function(e){this.element=e.element,this.style=e.style,this.updateViewport(e.viewport),this.formatter=t.valueFormatter.formatRaw,this.isInteractive=e.interactivity&&null!=e.interactivity.selection,this.getLocalizedString=e.host.getLocalizedString,this.hostServices=e.host,this.waitingForData=!1,this.lastAllowHeaderResize=!0,this.waitingForSort=!1},r.converter=function(t){var i=e.Prototype.inherit(t);i.visualRows=[];for(var a=0;a<t.rows.length;a++){var r={index:a,values:t.rows[a]};i.visualRows.push(r)}return i},r.prototype.onResizing=function(e){this.updateViewport(e)},r.prototype.onDataChanged=function(e){var t=this.dataView,i=e.dataViews;if(i&&i.length>0)if(this.dataView=i[0],1===e.operationKind){var a=r.converter(this.dataView.table);this.hierarchyNavigator.update(a),this.tablixControl.updateModels(!1,a.visualRows),this.refreshControl(!1)}else this.updateInternal(this.dataView,t);this.waitingForData=!1,this.waitingForSort=!1},r.prototype.updateViewport=function(e){this.currentViewport=e,this.tablixControl&&(this.tablixControl.viewport=this.currentViewport,this.verifyHeaderResize(),this.refreshControl(!1))},r.prototype.refreshControl=function(e){(this.element.visible()||this.getLayoutKind()===t.controls.TablixLayoutKind.DashboardTile)&&this.tablixControl.refresh(e)},r.prototype.getLayoutKind=function(){return this.isInteractive?t.controls.TablixLayoutKind.Canvas:t.controls.TablixLayoutKind.DashboardTile},r.prototype.createControl=function(e){var i=this,r=this.getLayoutKind(),n={onBindRowHeader:function(e){return i.onBindRowHeader(e)},onColumnHeaderClick:function(e){return i.onColumnHeaderClick(e)}},o=new a(n),s=r===t.controls.TablixLayoutKind.DashboardTile?t.controls.internal.DashboardTablixLayoutManager.createLayoutManager(o):t.controls.internal.CanvasTablixLayoutManager.createLayoutManager(o),l=document.createElement("div");l.className="tablixContainer",this.element.append(l);var u={interactive:this.isInteractive,enableTouchSupport:!1,layoutKind:r};return new t.controls.TablixControl(e,s,o,l,u)},r.prototype.updateInternal=function(e,t){var a=this,n=r.converter(e.table);if(this.tablixControl)this.hierarchyNavigator.update(n);else{var o=new i(n,this.formatter);this.hierarchyNavigator=o,this.tablixControl=this.createControl(o)}this.verifyHeaderResize(),this.tablixControl.updateModels(!0,n.visualRows,n.columns);var s=this.createTotalsRow(e);this.tablixControl.rowDimension.setFooter(s),this.tablixControl.viewport=this.currentViewport;var l=this.shouldClearControl(t,e);setTimeout(function(){a.refreshControl(l)},0)},r.prototype.shouldClearControl=function(t,i){return this.waitingForSort&&t&&i?!e.DataViewAnalysis.isMetadataEquivalent(t.metadata,i.metadata):!0},r.prototype.createTotalsRow=function(e){if(!this.shouldShowTotals(e))return null;var t=e.table.totals;if(!t||0===t.length)return null;for(var i=[],a=e.table.columns,r=0,n=a.length;n>r;++r){var o=a[r],s=t[o.index];null!=s?i.push(s):i.push(0===r?this.getLocalizedString("TableTotalLabel"):"")}return{totalCells:i}},r.prototype.shouldShowTotals=function(e){var t=e.metadata.objects;return r.shouldShowTotals(t)},r.shouldShowTotals=function(e){return e&&e.general?e.general.totals!==!1:!0},r.prototype.onBindRowHeader=function(e){this.needsMoreData(e)&&(this.hostServices.loadMoreData(),this.waitingForData=!0)},r.prototype.onColumnHeaderClick=function(e){var t=[{queryName:e}],i={sortDescriptors:t};this.waitingForSort=!0,this.hostServices.onCustomSort(i)},r.prototype.needsMoreData=function(e){if(this.waitingForData||!this.dataView.metadata||!this.dataView.metadata.segment)return!1;var t=this.tablixControl.rowDimension.getItemsCount(),i=t*r.preferredLoadMoreThreshold;return this.hierarchyNavigator.getIndex(e)>=i},r.prototype.enumerateObjectInstances=function(e){var t=[];return this.dataView&&"general"===e.objectName&&t.push({selector:null,properties:{totals:this.shouldShowTotals(this.dataView)},objectName:e.objectName}),t},r.prototype.shouldAllowHeaderResize=function(){return 1===this.hostServices.getViewMode()},r.prototype.verifyHeaderResize=function(){var e=this.shouldAllowHeaderResize();e!==this.lastAllowHeaderResize&&(this.lastAllowHeaderResize=e,this.tablixControl.layoutManager.setAllowHeaderResize(e))},r.formatStringProp={objectName:"general",propertyName:"formatString"},r.preferredLoadMoreThreshold=.8,r.capabilities={dataRoles:[{name:"Values",kind:2}],objects:{general:{displayName:e.data.createDisplayNameGetter("Visual_General"),properties:{formatString:{type:{formatting:{formatString:!0}}},totals:{type:{bool:!0},displayName:e.data.createDisplayNameGetter("Visual_Totals")}}}},dataViewMappings:[{table:{rows:{"for":{"in":"Values"},dataReductionAlgorithm:{window:{count:100}}},rowCount:{preferred:{min:1}}}}],sorting:{custom:{}},suppressDefaultTitle:!0},r}();t.Table=r}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){function i(e,t){return new r(e,t)}var a={rows:"Rows",columns:"Columns",values:"Values"};t.createMatrixHierarchyNavigator=i;var r=function(){function i(e,t){this.matrix=e,this.rowHierarchy=i.wrapMatrixHierarchy(e.rows),this.columnHierarchy=i.wrapMatrixHierarchy(e.columns),this.formatter=t,this.update()}return i.prototype.getDataViewMatrix=function(){return this.matrix},i.prototype.getDepth=function(e){var t=this.getMatrixHierarchy(e);return t?Math.max(t.levels.length,1):0},i.prototype.getLeafCount=function(e){var t=this.getMatrixHierarchy(e);return t?t.leafNodes.length:0},i.prototype.getLeafAt=function(e,t){var i=this.getMatrixHierarchy(e);return i?i.leafNodes[t]:null},i.prototype.getLeafIndex=function(e){return e.leafIndex},i.prototype.getParent=function(e){return 0===e.level?null:e.parent},i.prototype.getIndex=function(e){return e.index},i.prototype.isLeaf=function(e){return!e.children||0===e.children.length},i.prototype.isRowHierarchyLeaf=function(e){return!0},i.prototype.isColumnHierarchyLeaf=function(e){return!1},i.prototype.isLastItem=function(e,t){return t[t.length-1]===e},i.prototype.getChildren=function(e){return e.children},i.prototype.getCount=function(e){return e.length},i.prototype.getAt=function(e,t){return e[t]},i.prototype.getLevel=function(e){return e.level},i.prototype.getIntersection=function(e,i){var a=e.isSubtotal===!0||i.isSubtotal===!0;if(!e.values)return{content:"",isSubtotal:a};var r=e.values[i.leafIndex];if(!r)return{content:"",isSubtotal:a};var n=t.valueFormatter.getFormatString(this.matrix.valueSources[r.valueSourceIndex?r.valueSourceIndex:0],o.formatStringProp),s=this.formatter(r.value,n);return{content:s,isSubtotal:a}},i.prototype.getCorner=function(e,t){var i=this.columnHierarchy.levels,a=this.rowHierarchy.levels;if(t===i.length-1||0===i.length){var r=a[e];if(r)return{metadata:r.sources[0],isColumnHeaderLeaf:!0,isRowHeaderLeaf:e===a.length-1}}if(e===a.length-1){var r=i[t];if(r)return{metadata:r.sources[0],isColumnHeaderLeaf:!1,isRowHeaderLeaf:!0}}return{metadata:null,isColumnHeaderLeaf:!1,isRowHeaderLeaf:!1}},i.prototype.headerItemEquals=function(e,t){return e===t},i.prototype.bodyCellItemEquals=function(e,t){return e===t},i.prototype.cornerCellItemEquals=function(e,t){return e===t},i.prototype.update=function(e){e&&(this.matrix=e,this.rowHierarchy=i.wrapMatrixHierarchy(e.rows),this.columnHierarchy=i.wrapMatrixHierarchy(e.columns)),this.updateHierarchy(this.rowHierarchy),this.updateHierarchy(this.columnHierarchy),i.updateStaticColumnHeaders(this.columnHierarchy)},i.prototype.updateRows=function(){this.updateHierarchy(this.rowHierarchy)},i.wrapMatrixHierarchy=function(t){var i=e.Prototype.inherit(t);return i.leafNodes=[],i},i.prototype.updateHierarchy=function(e){e.leafNodes.length>0&&(e.leafNodes.length=0),e.root.children&&this.updateRecursive(e,e.root.children,null,e.leafNodes)},i.prototype.updateRecursive=function(e,i,a,r){for(var n,s=0,l=i.length;l>s;s++){var u=i[s];if(a&&(u.parent=a),n||(n=e.levels[u.level]),n){var c=n.sources[u.levelSourceIndex?u.levelSourceIndex:0],h=t.valueFormatter.getFormatString(c,o.formatStringProp);h&&(u.name=this.formatter(u.value,h))}u.index=s,u.children&&u.children.length>0?this.updateRecursive(e,u.children,u,r):(u.leafIndex=r.length,r.push(u))}},i.updateStaticColumnHeaders=function(e){var t=e.leafNodes;if(t&&t.length>0)for(var i=e.levels[t[0].level].sources,a=0,r=t.length;r>a;a++){var n=t[a];if(!n.identity&&void 0===n.value){var o=i[n.levelSourceIndex?n.levelSourceIndex:0];o&&(n.name=o.displayName)}}},i.prototype.getMatrixHierarchy=function(e){var t=this.rowHierarchy.root.children;if(t&&e===t)return this.rowHierarchy;var i=this.columnHierarchy.root.children;return i&&e===i?this.columnHierarchy:null},i}(),n=function(){function e(e,t){this.hierarchyNavigator=e,this.options=t}return e.prototype.onStartRenderingSession=function(){},e.prototype.onEndRenderingSession=function(){},e.prototype.bindRowHeader=function(t,i){var a,r=this.hierarchyNavigator&&this.hierarchyNavigator.isLeaf(t);a=r?t.identity?e.rowHeaderLeafClassName:0===t.level?e.rowHeaderTopLevelStaticLeafClassName:e.rowHeaderStaticLeafClassName:e.headerClassName,t.isSubtotal&&(a+=" "+e.totalClassName),i.extension.setContainerStyle(a),this.bindHeader(t,i,this.getRowHeaderMetadata(t)),this.options.onBindRowHeader&&this.options.onBindRowHeader(t)},e.prototype.unbindRowHeader=function(e,i){i.extension.clearContainerStyle(),t.controls.HTMLElementUtils.clearChildren(i.extension.contentHost)},e.prototype.bindColumnHeader=function(t,i){var a,r=!1,n=this.hierarchyNavigator&&this.hierarchyNavigator.isLeaf(t);if(n){a=e.columnHeaderLeafClassName;var o=this.getSortableHeaderColumnMetadata(t);o&&this.registerColumnHeaderClickHandler(o,i),t.isSubtotal&&t.parent&&t.parent.children.length>1&&t.parent.children[0].isSubtotal&&(r=!0)}else a=e.headerClassName;t.isSubtotal&&(a+=" "+e.totalClassName),a+=" "+e.numericCellClassName,i.extension.setContainerStyle(a),i.extension.disableDragResize(),this.bindHeader(t,i,this.getColumnHeaderMetadata(t),r)},e.prototype.unbindColumnHeader=function(e,t){t.extension.clearContainerStyle(),t.extension.contentHost.textContent="";var i=this.getSortableHeaderColumnMetadata(e);i&&this.unregisterColumnHeaderClickHandler(t)},e.prototype.bindBodyCell=function(t,i){var a=e.bodyCellClassName;t.isSubtotal&&(a+=" "+e.totalClassName),i.extension.setContainerStyle(a),i.extension.contentHost.textContent=t.content},e.prototype.unbindBodyCell=function(e,t){t.extension.clearContainerStyle(),t.extension.contentHost.textContent=""},e.prototype.registerColumnHeaderClickHandler=function(e,t){var i=this;if(this.options.onColumnHeaderClick){var a=function(t){i.options.onColumnHeaderClick(e.queryName?e.queryName:e.displayName)};t.extension.registerClickHandler(a)}},e.prototype.unregisterColumnHeaderClickHandler=function(e){this.options.onColumnHeaderClick&&e.extension.unregisterClickHandler()},e.prototype.bindCornerCell=function(t,i){var a;if(t.isColumnHeaderLeaf){a=e.columnHeaderLeafClassName;var r=this.getSortableCornerColumnMetadata(t);r&&this.registerColumnHeaderClickHandler(r,i)}t.isRowHeaderLeaf&&(a?a+=" ":a="",a+=e.rowHeaderLeafClassName),a?i.extension.setContainerStyle(a):i.extension.setContainerStyle(e.headerClassName),i.extension.disableDragResize(),i.extension.contentHost.textContent=t.metadata?t.metadata.displayName:""},e.prototype.unbindCornerCell=function(e,t){t.extension.clearContainerStyle(),t.extension.contentHost.textContent="",e.isColumnHeaderLeaf&&this.unregisterColumnHeaderClickHandler(t)},e.prototype.bindEmptySpaceHeaderCell=function(e){},e.prototype.unbindEmptySpaceHeaderCell=function(e){},e.prototype.bindEmptySpaceFooterCell=function(e){},e.prototype.unbindEmptySpaceFooterCell=function(e){},e.prototype.getHeaderLabel=function(t){return e.getNodeLabel(t)},e.prototype.getCellContent=function(e){return e.content},e.prototype.hasRowGroups=function(){var e=this.hierarchyNavigator.getDataViewMatrix();return e&&e.rows&&e.rows.levels&&0!==e.rows.levels.length?!0:!1},e.getNodeLabel=function(e){return e.name?e.name:null!=e.value?e.value.toString():""},e.prototype.bindHeader=function(i,a,r,n){if(i.isSubtotal&&!n)return void(a.extension.contentHost.textContent=this.options.totalLabel);var o=e.getNodeLabel(i);return o?void(r&&t.UrlHelper.isValidUrl(r,o)?t.controls.internal.TablixUtils.appendATagToBodyCell(i.value,a):a.extension.contentHost.textContent=o):void(a.extension.contentHost.innerHTML=e.nonBreakingSpace)},e.prototype.getSortableCornerColumnMetadata=function(e){return e.isColumnHeaderLeaf?e.metadata:null},e.prototype.getRowHeaderMetadata=function(e){if(this.hierarchyNavigator&&e){var t=this.hierarchyNavigator.getDataViewMatrix();if(t&&t.rows)return this.getHierarchyMetadata(t.rows,e.level)}},e.prototype.getColumnHeaderMetadata=function(e){if(this.hierarchyNavigator&&e){var t=this.hierarchyNavigator.getDataViewMatrix();if(t&&t.columns)return this.getHierarchyMetadata(t.columns,e.level)}},e.prototype.getHierarchyMetadata=function(e,t){if(e&&e.levels&&!(e.levels.length<t)){var i=e.levels[t];if(i&&i.sources&&0!==i.sources.length)return i.sources[0]}},e.prototype.getSortableHeaderColumnMetadata=function(e){var t=this.hierarchyNavigator.getDataViewMatrix();if(!t.rows||!t.rows.levels||0===t.rows.levels.length)return null;var i=t.columns?t.columns.levels.length-1:0,a=-1;if(0===i)a=e.levelSourceIndex;else if(e.isSubtotal){var r=t.valueSources&&t.valueSources.length>1;r?e.parent&&0===e.parent.level&&(a=e.levelSourceIndex):0===e.level&&(a=e.levelSourceIndex)}return-1!==a?(a=a?a:0,t.valueSources[a]):null},e.headerClassName="bi-tablix-header",e.numericCellClassName="bi-table-cell-numeric",e.columnHeaderLeafClassName="bi-tablix-column-header-leaf",e.rowHeaderLeafClassName="bi-tablix-row-header-leaf",e.rowHeaderStaticLeafClassName="bi-tablix-row-header-static-leaf",e.rowHeaderTopLevelStaticLeafClassName="bi-tablix-row-header-toplevel-static-leaf",e.bodyCellClassName="bi-matrix-body-cell",e.totalClassName="total",e.nonBreakingSpace="&nbsp;",e}();t.MatrixBinder=n;var o=function(){function r(){}return r.customizeQuery=function(t){var i=t.dataViewMappings[0];if(i&&i.matrix&&i.metadata){var a=i.matrix,n=i.metadata.objects;a.rows["for"]["in"].subtotalType=r.shouldShowRowSubtotals(n)?e.data.CompiledSubtotalType.After:e.data.CompiledSubtotalType.None,a.columns["for"]["in"].subtotalType=r.shouldShowColumnSubtotals(n)?e.data.CompiledSubtotalType.After:e.data.CompiledSubtotalType.None;
}},r.getSortableRoles=function(){return["Rows","Values"]},r.prototype.init=function(e){this.element=e.element,this.style=e.style,this.updateViewport(e.viewport),this.formatter=t.valueFormatter.formatRaw,this.isInteractive=e.interactivity&&null!=e.interactivity.selection,this.hostServices=e.host,this.waitingForData=!1,this.lastAllowHeaderResize=!0,this.waitingForSort=!1},r.prototype.onResizing=function(e){this.updateViewport(e)},r.prototype.onDataChanged=function(e){var t=this.dataView;e.dataViews&&e.dataViews.length>0&&(this.dataView=e.dataViews[0],1===e.operationKind?(this.hierarchyNavigator.updateRows(),this.refreshControl(!1)):this.updateInternal(this.dataView,t)),this.waitingForData=!1,this.waitingForSort=!1},r.prototype.updateViewport=function(e){this.currentViewport=e,this.tablixControl&&(this.tablixControl.viewport=this.currentViewport,this.verifyHeaderResize(),this.refreshControl(!1))},r.prototype.refreshControl=function(e){(this.element.visible()||this.getLayoutKind()===t.controls.TablixLayoutKind.DashboardTile)&&this.tablixControl.refresh(e)},r.prototype.getLayoutKind=function(){return this.isInteractive?t.controls.TablixLayoutKind.Canvas:t.controls.TablixLayoutKind.DashboardTile},r.prototype.createControl=function(e){var i=this,a=this.getLayoutKind(),o={onBindRowHeader:function(e){i.onBindRowHeader(e)},totalLabel:this.hostServices.getLocalizedString(r.TotalLabel),onColumnHeaderClick:function(e){return i.onColumnHeaderClick(e)}},s=new n(this.hierarchyNavigator,o),l=a===t.controls.TablixLayoutKind.DashboardTile?t.controls.internal.DashboardTablixLayoutManager.createLayoutManager(s):t.controls.internal.CanvasTablixLayoutManager.createLayoutManager(s),u=document.createElement("div");u.className="tablixContainer",this.element.append(u);var c={interactive:this.isInteractive,enableTouchSupport:!1};return new t.controls.TablixControl(e,l,s,u,c)},r.prototype.updateInternal=function(e,t){var a=this;if(this.tablixControl)this.hierarchyNavigator.update(e.matrix);else{var r=i(e.matrix,this.formatter);this.hierarchyNavigator=r,this.tablixControl=this.createControl(r)}this.verifyHeaderResize(),this.tablixControl.updateModels(!0,e.matrix.rows.root.children,e.matrix.columns.root.children),this.tablixControl.viewport=this.currentViewport;var n=this.shouldClearControl(t,e);setTimeout(function(){a.refreshControl(n)},0)},r.prototype.shouldClearControl=function(t,i){return this.waitingForSort&&t&&i?!e.DataViewAnalysis.isMetadataEquivalent(t.metadata,i.metadata):!0},r.prototype.onBindRowHeader=function(e){this.needsMoreData(e)&&(this.hostServices.loadMoreData(),this.waitingForData=!0)},r.prototype.onColumnHeaderClick=function(e){var t=[{queryName:e}],i={sortDescriptors:t};this.waitingForSort=!0,this.hostServices.onCustomSort(i)},r.prototype.needsMoreData=function(e){if(this.waitingForData||!this.hierarchyNavigator.isLeaf(e)||!this.dataView.metadata||!this.dataView.metadata.segment)return!1;var t=this.tablixControl.rowDimension.getItemsCount(),i=t*r.preferredLoadMoreThreshold;return this.hierarchyNavigator.getLeafIndex(e)>=i},r.shouldShowRowSubtotals=function(e){return e&&e.general?e.general.rowSubtotals!==!1:!0},r.shouldShowColumnSubtotals=function(e){return e&&e.general?e.general.columnSubtotals!==!1:!0},r.prototype.getMatrixDataViewObjects=function(){return this.dataView&&this.dataView.metadata&&this.dataView.metadata.objects?this.dataView.metadata.objects:void 0},r.prototype.enumerateObjectInstances=function(e){var t=[];if("general"===e.objectName){var i=this.getMatrixDataViewObjects();t.push({selector:null,properties:{rowSubtotals:r.shouldShowRowSubtotals(i),columnSubtotals:r.shouldShowColumnSubtotals(i)},objectName:e.objectName})}return t},r.prototype.shouldAllowHeaderResize=function(){return 1===this.hostServices.getViewMode()},r.prototype.verifyHeaderResize=function(){var e=this.shouldAllowHeaderResize();e!==this.lastAllowHeaderResize&&(this.lastAllowHeaderResize=e,this.tablixControl.layoutManager.setAllowHeaderResize(e))},r.formatStringProp={objectName:"general",propertyName:"formatString"},r.preferredLoadMoreThreshold=.8,r.TotalLabel="TableTotalLabel",r.capabilities={dataRoles:[{name:a.rows,kind:0},{name:a.columns,kind:0},{name:a.values,kind:1}],objects:{general:{displayName:e.data.createDisplayNameGetter("Visual_General"),properties:{formatString:{type:{formatting:{formatString:!0}}},rowSubtotals:{type:{bool:!0},displayName:e.data.createDisplayNameGetter("Visual_RowTotals")},columnSubtotals:{type:{bool:!0},displayName:e.data.createDisplayNameGetter("Visual_ColumnTotals")}}}},dataViewMappings:[{conditions:[{Rows:{max:0},Columns:{max:0},Values:{min:1}},{Rows:{min:1},Columns:{min:0},Values:{min:0}},{Rows:{min:0},Columns:{min:1},Values:{min:0}}],matrix:{rows:{"for":{"in":"Rows"},dataReductionAlgorithm:{window:{count:100}}},columns:{"for":{"in":"Columns"},dataReductionAlgorithm:{top:{count:100}}},values:{"for":{"in":"Values"}}}}],filterMappings:{measureFilter:{targetRoles:[a.rows]}},sorting:{custom:{}},suppressDefaultTitle:!0},r}();t.Matrix=o}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){t.treemapCapabilities={dataRoles:[{name:"Group",kind:0,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Group")},{name:"Details",kind:0,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Details")},{name:"Values",kind:1,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Values")},{name:"Gradient",kind:1,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Gradient")}],objects:{general:{displayName:e.data.createDisplayNameGetter("Visual_General"),properties:{formatString:{type:{formatting:{formatString:!0}}}}},legend:{displayName:e.data.createDisplayNameGetter("Visual_Legend"),properties:{show:{displayName:e.data.createDisplayNameGetter("Visual_Show"),type:{bool:!0}},position:{displayName:e.data.createDisplayNameGetter("Visual_LegendPosition"),type:{formatting:{legendPosition:!0}}},showTitle:{displayName:e.data.createDisplayNameGetter("Visual_LegendShowTitle"),type:{bool:!0}},titleText:{displayName:e.data.createDisplayNameGetter("Visual_LegendTitleText"),type:{text:!0}}}},dataPoint:{displayName:e.data.createDisplayNameGetter("Visual_DataPoint"),properties:{fill:{type:{fill:{solid:{color:!0}}}},fillRule:{displayName:e.data.createDisplayNameGetter("Visual_Gradient"),type:{fillRule:{}},rule:{inputRole:"Gradient",output:{property:"fill",selector:["Group"]}}}}},labels:{displayName:e.data.createDisplayNameGetter("Visual_DataPointsLabels"),properties:{show:{displayName:e.data.createDisplayNameGetter("Visual_Show"),type:{bool:!0,mainShow:!0}},color:{displayName:e.data.createDisplayNameGetter("Visual_LabelsFill"),type:{fill:{solid:{color:!0}}}}}},categoryLabels:{displayName:e.data.createDisplayNameGetter("Visual_CategoryLabels"),properties:{show:{type:{bool:!0}}}}},dataViewMappings:[{conditions:[{Group:{max:1},Details:{max:0},Gradient:{max:1}},{Group:{max:1},Details:{min:1,max:1},Values:{max:1},Gradient:{max:0}}],categorical:{categories:{"for":{"in":"Group"},dataReductionAlgorithm:{top:{}}},values:{group:{by:"Details",select:[{bind:{to:"Values"}},{bind:{to:"Gradient"}}],dataReductionAlgorithm:{top:{}}}},rowCount:{preferred:{min:2}}}}],supportsHighlight:!0,sorting:{custom:{},implicit:{clauses:[{role:"Values",direction:e.data.QuerySortDirection.Descending}]}}},t.treemapProps={general:{formatString:{objectName:"general",propertyName:"formatString"}},dataPoint:{fill:{objectName:"dataPoint",propertyName:"fill"}},legend:{show:{objectName:"legend",propertyName:"show"},position:{objectName:"legend",propertyName:"position"},showTitle:{objectName:"legend",propertyName:"showTitle"},titleText:{objectName:"legend",propertyName:"titleText"}},categoryLabels:{show:{objectName:"categoryLabels",propertyName:"show"}}}}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var i=jsCommon.CssConstants,a=jsCommon.StringExtensions,r=function(){function r(e){e&&e.animator&&(this.animator=e.animator,this.isScrollable=e.isScrollable?e.isScrollable:!1)}return r.prototype.init=function(e){this.options=e;var i=e.element;i.empty(),this.svg=d3.select(i.get(0)).append("svg").style("position","absolute").classed(r.ClassName,!0),this.shapeGraphicsContext=this.svg.append("g").classed(r.ShapesClassName,!0),this.labelGraphicsContext=this.svg.append("g").classed(r.LabelsClassName,!0),this.element=i,this.currentViewport={height:e.viewport.height,width:e.viewport.width},this.style=e.style,this.treemap=d3.layout.treemap().sticky(!1).sort(function(e,t){return e.size-t.size}).value(function(e){return e.size}).round(!1),this.interactivityService=t.VisualInteractivityFactory.buildInteractivityService(e),this.legend=t.createLegend(i,e.interactivity&&e.interactivity.isInteractiveLegend,this.interactivityService,this.isScrollable),this.colors=this.style.colorPalette.dataColors,this.hostService=e.host},r.converter=function(i,a,n,o,s,l){var u,c={key:"root",name:"root",children:[],selected:!1,highlightMultiplier:0,identity:t.SelectionId.createNull(),color:void 0},h=[],d=[],p="",g={title:p,dataPoints:d},f=new t.ColorHelper(a,t.treemapProps.dataPoint.fill);if(i&&i.metadata&&i.metadata.objects){var m=i.metadata.objects.labels;m&&(n.show=void 0!==m.show?m.show:n.show,n.labelColor=void 0!==m.color?m.color.solid.color:n.labelColor),n.showCategory=e.DataViewObjects.getValue(i.metadata.objects,t.treemapProps.categoryLabels.show,n.showCategory)}if(i&&i.categorical&&i.categorical.values){var y=i.categorical,v=y.values;u=!!(v.length>0&&v[0].highlights);var C=t.treemapProps.general.formatString,b=r.getValuesFromCategoricalDataView(y,u),x=b.values,S=b.highlights,w=b.totalValue;b.highlightsOverflow&&(u=!1,x=S);var _=r.getCullableValue(w,s),T=v.grouped(),D=T&&T.length>0&&T[0].values&&T[0].values.length>1,P=!!v.source,M=!1;if(null==y.categories&&x)for(var L=0,A=x[0].length;A>L;L++){var N=x[0][L];if(r.checkValueForShape(N))if(_>N)M=M||te;else{var V,I=v[L],R=t.converterHelper.getFormattedLegendLabel(I.source,v,C),H=P?t.SelectionId.createWithId(v[L].identity):t.SelectionId.createWithMeasure(v[L].source.queryName),E=H.getKey(),O=P?f.getColorForSeriesValue(I.objects&&I.objects[0],y.values.identityFields,t.converterHelper.getSeriesName(I.source)):f.getColorForMeasure(I.source.objects,I.source.queryName),F=u&&0!==ee?ee:void 0,G=i.categorical,z=L,W=t.TooltipBuilder.createTooltipInfo(C,G.categories,R,G.values,N,null,z);void 0!==F&&(V=t.TooltipBuilder.createTooltipInfo(C,G.categories,R,G.values,N,null,z,F));var U={key:E,name:R,size:N,color:O,selected:!1,identity:H,tooltipInfo:W,highlightedTooltipInfo:V};u&&S&&(U.highlightMultiplier=N?S[0][L]/N:0),c.children.push(U),h.push(U),d.push({label:R,color:O,icon:t.LegendIcon.Box,identity:H,selected:!1})}}else if(y.categories&&y.categories.length>0){var B=y.categories[0],k=v.length;p=B.source?B.source.displayName:"";for(var L=0,A=x.length;A>L;L++){var V,j=B.identity?B.identity[L]:void 0,H=j?t.SelectionId.createWithId(j):t.SelectionId.createNull(),E=H.getKey(),q=B.objects&&B.objects[L],O=f.getColorForSeriesValue(q,B.identityFields,B.values[L]),Y=t.valueFormatter.format(B.values[L],t.valueFormatter.getFormatString(B.values[L],C)),N=x[L][0],F=u&&S?S[L][0]:void 0,G=i.categorical,W=t.TooltipBuilder.createTooltipInfo(C,G.categories,Y,G.values,N);void 0!==F&&(V=t.TooltipBuilder.createTooltipInfo(C,G.categories,Y,G.values,N,null,0,F));var U={key:E,name:Y,color:O,selected:!1,identity:H,tooltipInfo:W,highlightedTooltipInfo:V};d.push({label:Y,color:O,icon:t.LegendIcon.Box,identity:H,selected:!1});for(var Q=0,X=0,K=1===k&&null==v[0].source.groupName,$=x[L],Z=0,J=$.length;J>Z;Z++){var ee,I=v[Z],N=$[Z],te=_>N;if(r.checkValueForShape(N)&&!te){if(Q+=N,u&&(ee=S[L][Z],X+=ee),!K){var ie=null,ae={parentId:U.key,nodeId:void 0};D?(ae.nodeId={name:ie,index:Z},ie=I.source.displayName):(ae.nodeId=I.identity.key,ie=I.source.groupName);var V,re=t.SelectionId.createWithIdsAndMeasure(j,P?I.identity:void 0,D?I.source.queryName:void 0),F=u&&0!==ee?ee:void 0,G=i.categorical,W=t.TooltipBuilder.createTooltipInfo(C,G.categories,Y,G.values,N,null,Z);void 0!==F&&(V=t.TooltipBuilder.createTooltipInfo(C,G.categories,Y,G.values,N,null,Z,F));var ne={key:re.getKey(),name:ie,size:N,color:O,selected:!1,identity:re,tooltipInfo:W,highlightedTooltipInfo:V};u&&(ne.highlightMultiplier=N?ee/N:0),null==U.children&&(U.children=[]),U.children.push(ne),h.push(ne)}}else M=M||te}r.checkValueForShape(Q)&&(U.size=Q,c.children.push(U),h.push(U)),u&&(U.highlightMultiplier=Q?X/Q:0)}}}return o&&o.applySelectionStateToData(h),g={title:p,dataPoints:d},{root:c,hasHighlights:u,legendData:g,dataLabelsSettings:n,legendObjectProperties:l,dataWasCulled:M}},r.getValuesFromCategoricalDataView=function(e,t){var i,a=e.values;a&&null==e.categories?i=1:a&&e.categories&&e.categories.length>0&&(i=e.categories[0].values.length);for(var r=[],n=[],o=0,s=0;i>s;s++)r.push([]),t&&n.push([]);for(var l,u=0;u<a.length;u++)for(var c=a[u],s=0;i>s;s++){var h=c.values[s];if(r[s].push(h),o+=isNaN(h)?0:h,t){var d=c.highlights[s];d||(d=0),n[s].push(d),d>h&&(l=!0)}}return{values:r,highlights:t?n:void 0,highlightsOverflow:t?l:void 0,totalValue:o}},r.getCullableValue=function(e,t){var i=t.width*t.height,a=r.CullableArea/i;return a*e},r.prototype.update=function(e){var i=this.dataViews=e.dataViews;this.currentViewport=e.viewport;var a=t.dataLabelUtils.getDefaultTreemapLabelSettings(),n=null;if(i&&i.length>0&&i[0].categorical){var o,s=i[0],l=s.metadata;l&&(o=l.objects),o&&(n=o.legend),this.data=r.converter(s,this.colors,a,this.interactivityService,this.currentViewport,n)}else{var u={key:"root",name:"root",children:[],selected:!1,highlightMultiplier:0,identity:t.SelectionId.createNull(),color:void 0},c={title:"",dataPoints:[]},h={root:u,hasHighlights:!1,legendData:c,dataLabelsSettings:a,dataWasCulled:!1};this.data=h}if(this.updateInternal(e.suppressAnimations),i){var d=t.getInvalidValueWarnings(i,!1,!1,!1);if(this.data.dataWasCulled){var p=new t.GeometryCulledWarning;d?d.unshift(p):d=[p]}d&&d.length>0&&this.hostService.setWarnings(d)}},r.prototype.onDataChanged=function(e){this.update({suppressAnimations:e.suppressAnimations,dataViews:e.dataViews,viewport:this.currentViewport})},r.prototype.onResizing=function(e){this.update({suppressAnimations:!0,dataViews:this.dataViews,viewport:e})},r.prototype.onClearSelection=function(){this.interactivityService&&this.interactivityService.clearSelection()},r.prototype.enumerateObjectInstances=function(e){var i=this.data;if(i){var a=e.objectName;switch(a){case"dataPoint":var r=this.dataViews&&this.dataViews.length>0&&this.dataViews[0]&&this.dataViews[0].categorical,n=t.GradientUtils.hasGradientRole(r);if(!n)return this.enumerateDataPoints(i);break;case"legend":return this.enumerateLegend(i);case"labels":return t.dataLabelUtils.enumerateDataLabels(this.data.dataLabelsSettings,!1);case"categoryLabels":return this.data?t.dataLabelUtils.enumerateCategoryLabels(this.data.dataLabelsSettings,!1,!1,!0):t.dataLabelUtils.enumerateCategoryLabels(null,!1,!1,!0)}}},r.prototype.enumerateDataPoints=function(e){var t=e.root.children;if(!_.isEmpty(t)){for(var i=[],a=0;a<t.length;a++){var r=t[a];i.push({displayName:r.name,selector:r.identity.getSelector(),properties:{fill:{solid:{color:r.color}}},objectName:"dataPoint"})}return i}},r.prototype.enumerateLegend=function(i){var a={legend:i.legendObjectProperties},r=e.DataViewObjects.getValue(a,t.treemapProps.legend.show,this.legend.isVisible()),n=e.DataViewObjects.getValue(a,t.treemapProps.legend.showTitle,!0),o=e.DataViewObjects.getValue(a,t.treemapProps.legend.titleText,this.data.legendData.title);return[{selector:null,objectName:"legend",properties:{show:r,position:t.LegendPosition[this.legend.getOrientation()],showTitle:n,titleText:o}}]},r.checkValueForShape=function(e){return e?e>0:!1},r.prototype.calculateTreemapSize=function(){var e=this.legend.getMargins();return{height:this.currentViewport.height-e.height,width:this.currentViewport.width-e.width}},r.prototype.initViewportDependantProperties=function(e){void 0===e&&(e=0);var i=this.calculateTreemapSize();this.svg.attr({width:i.width,height:i.height}),t.SVGUtil.flushAllD3TransitionsIfNeeded(this.options)},r.isMajorLabel=function(e){return 1===e.depth},r.hasChildrenWithIdentity=function(e){var t=e.children;if(!t)return!1;var i=t.length;if(0===i)return!1;for(var a=i-1;a>=0;a--)if(t[a].identity.hasIdentity())return!0;return!1},r.canDisplayLabel=function(e,t){if(e.depth<1||e.depth>2)return!1;if(a.isNullOrEmpty(e.name))return!1;var i=r.isMajorLabel(e);if(i&&!t.show)return!1;if(!i&&!t.showCategory)return!1;var n=e.dx-2*r.TextMargin,o=i?r.MinTextWidthForMajorLabel:r.MinTextWidthForMinorLabel;if(o>n)return!1;var s=i?r.MajorLabelTextSize:r.MinorLabelTextSize,l=s+2*r.TextMargin;if(e.dy<l)return!1;if(2===e.depth){var u=e.parent,c=Math.max(u.y+r.MajorLabelTextSize+2*r.TextMargin,e.y);if(e.y+e.dy-c<l)return!1}return!0},r.createLabelForShape=function(t){var i=r.isMajorLabel(t)?r.MajorLabelTextProperties:r.MinorLabelTextProperties,a={text:t.name,fontFamily:i.fontFamily,fontSize:i.fontSize};return e.TextMeasurementService.getTailoredTextOrDefault(a,t.dx-2*r.TextMargin)},r.getFill=function(e,t){return e.depth>1&&!e.identity.hasIdentity()&&!t?i.noneValue:r.hasChildrenWithIdentity(e)?i.noneValue:e.color},r.getFillOpacity=function(e,t,i,a){return i?a?null:r.DimmedShapeOpacity.toString():!t||e.selected?null:e.depth>1&&e.parent.selected?null:r.hasChildrenWithIdentity(e)?null:r.DimmedShapeOpacity.toString()},r.prototype.updateInternal=function(e){var i=this.data,a=i&&i.hasHighlights,n=i?i.dataLabelsSettings:null,o=t.AnimatorCommon.GetAnimationDuration(this.animator,e);this.options.interactivity&&this.options.interactivity.isInteractiveLegend||!this.data||this.renderLegend(),this.initViewportDependantProperties(o);var s=this.calculateTreemapSize();this.treemap.size([s.width,s.height]);var l,u,c,h,d=i&&i.root?this.treemap.nodes(i.root):[],p=d.filter(function(e){return null!=e.highlightMultiplier&&(!e.children||0===e.children.length)}),g=n.show||n.showCategory?d.filter(function(e){return r.canDisplayLabel(e,n)}):[];if(this.animator&&!e){var f={viewModel:i,nodes:d,highlightNodes:p,labeledNodes:g,shapeGraphicsContext:this.shapeGraphicsContext,labelGraphicsContext:this.labelGraphicsContext,interactivityService:this.interactivityService};h=this.animator.animate(f),l=h.shapes,u=h.highlightShapes,c=h.labels}if(!this.animator||e||h.failed){var m=d.some(function(e){return e.selected}),y=this.shapeGraphicsContext;l=r.drawDefaultShapes(y,d,m,a),u=r.drawDefaultHighlightShapes(y,p,m,a),c=r.drawDefaultLabels(this.labelGraphicsContext,g,n)}if(this.interactivityService){var v={labels:c,shapes:l,highlightShapes:u,nodes:d,hasHighlights:i.hasHighlights};this.interactivityService.apply(this,v)}t.TooltipManager.addTooltip(l,function(e){return e.data.tooltipInfo}),t.TooltipManager.addTooltip(u,function(e){return e.data.highlightedTooltipInfo}),t.SVGUtil.flushAllD3TransitionsIfNeeded(this.options)},r.prototype.renderLegend=function(){var e=this.data.legendObjectProperties;if(e){var i=this.data.legendData;t.LegendData.update(i,e);var a=e[t.legendProps.position];a&&this.legend.changeOrientation(t.LegendPosition[a]),this.legend.drawLegend(i,this.currentViewport)}else this.legend.changeOrientation(t.LegendPosition.Top),this.legend.drawLegend({dataPoints:[]},this.currentViewport)},r.prototype.accept=function(e,t){e.visitTreemap(t)},r.getNodeClass=function(e,t){var i;switch(e.depth){case 1:i=r.ParentGroupClassName;break;case 2:i=r.NodeGroupClassName;break;case 0:i=r.RootNodeClassName}return i+=" "+(t?r.HighlightNodeClassName:r.TreemapNodeClassName)},r.createTreemapShapeLayout=function(e){return void 0===e&&(e=!1),{x:function(e){return e.x},y:function(t){return t.y+(e?t.dy*(1-t.highlightMultiplier):0)},width:function(e){return Math.max(0,e.dx)},height:function(t){return Math.max(0,t.dy*(e?t.highlightMultiplier:1))}}},r.createTreemapZeroShapeLayout=function(){return{x:function(e){return e.x},y:function(e){return e.y+e.dy},width:function(e){return Math.max(0,e.dx)},height:function(e){return 0}}},r.drawDefaultShapes=function(e,t,i,a){var n=!1,o=e.selectAll("."+r.TreemapNodeClassName).data(t,function(e){return e.key});return o.enter().append("rect").attr("class",r.layout.shapeClass),o.style("fill",function(e){return r.getFill(e,n)}).style("fill-opacity",function(e){return r.getFillOpacity(e,i,a,n)}).attr(r.layout.shapeLayout),o.exit().remove(),o},r.drawDefaultHighlightShapes=function(e,t,i,a){var n=!0,o=e.selectAll("."+r.HighlightNodeClassName).data(t,function(e){return e.key+"highlight"});return o.enter().append("rect").attr("class",r.layout.highlightShapeClass),o.style("fill",function(e){return r.getFill(e,n)}).style("fill-opacity",function(e){return r.getFillOpacity(e,i,a,n)}).attr(r.layout.highlightShapeLayout),o.exit().remove(),o},r.drawDefaultLabels=function(e,t,i){var a=e.selectAll("text").data(t,function(e){return e.key});return a.enter().append("text").attr("class",r.layout.labelClass),a.attr(r.layout.labelLayout).text(r.layout.labelText).style("fill",function(){return i.labelColor}),a.exit().remove(),a},r.DimmedShapeOpacity=.4,r.ClassName="treemap",r.LabelsClassName="labels",r.MajorLabelClassName="majorLabel",r.MinorLabelClassName="minorLabel",r.ShapesClassName="shapes",r.TreemapNodeClassName="treemapNode",r.RootNodeClassName="rootNode",r.ParentGroupClassName="parentGroup",r.NodeGroupClassName="nodeGroup",r.HighlightNodeClassName="treemapNodeHighlight",r.TextMargin=5,r.MinorLabelTextSize=10,r.MinTextWidthForMinorLabel=18,r.MinorLabelTextProperties={fontFamily:"wf_segoe-ui_normal",fontSize:r.MinorLabelTextSize+"px"},r.MajorLabelTextSize=12,r.MinTextWidthForMajorLabel=22,r.MajorLabelTextProperties={fontFamily:"wf_segoe-ui_normal",fontSize:r.MajorLabelTextSize+"px"},r.CullableArea=9,r.layout={shapeClass:function(e){return r.getNodeClass(e,!1)},shapeLayout:r.createTreemapShapeLayout(!1),highlightShapeClass:function(e){return r.getNodeClass(e,!0)},highlightShapeLayout:r.createTreemapShapeLayout(!0),zeroShapeLayout:r.createTreemapZeroShapeLayout(),labelClass:function(e){return r.isMajorLabel(e)?r.MajorLabelClassName:r.MinorLabelClassName},labelLayout:{x:function(e){return e.x+r.TextMargin},y:function(e){return r.isMajorLabel(e)?e.y+r.TextMargin+r.MajorLabelTextSize:e.y+e.dy-r.TextMargin}},labelText:function(e){return r.createLabelForShape(e)}},r}();t.Treemap=r}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var i=function(i){function a(t){i.call(this,a.cardClassName),this.isScrollable=!1,this.displayUnitSystemType=e.DisplayUnitSystemType.WholeUnits,t&&(this.isScrollable=!!t.isScrollable,t.animator&&(this.animator=t.animator),null!=t.displayUnitSystemType&&(this.displayUnitSystemType=t.displayUnitSystemType))}return __extends(a,i),a.prototype.init=function(e){this.animationOptions=e.animation;var t=e.element,i=this.svg=d3.select(t.get(0)).append("svg");this.graphicsContext=i.append("g"),this.currentViewport=e.viewport,this.hostServices=e.host,this.style=e.style,this.updateViewportProperties(),this.isScrollable&&(i.attr("class",a.cardClassName),this.labelContext=i.append("g"))},a.prototype.onDataChanged=function(e){var t,i=e.dataViews[0];i&&(this.getMetaDataColumn(i),i.single&&(t=i.single.value)),this.updateInternal(t,!0,!0)},a.prototype.onResizing=function(e){this.currentViewport=e,this.updateViewportProperties(),this.updateInternal(this.value,!0,!0)},a.prototype.updateViewportProperties=function(){var e=this.currentViewport;this.svg.attr("width",e.width).attr("height",e.height)},a.prototype.getAdjustedFontHeight=function(e,t,r){var n=i.prototype.getAdjustedFontHeight.call(this,e,t,r);return Math.min(n,a.DefaultStyle.card.maxFontSize)},a.prototype.clear=function(e){void 0===e&&(e=!1),this.svg.select(a.Value.selector).text(""),e||this.svg.select(a.Label.selector).text(""),i.prototype.clear.call(this)},a.prototype.updateInternal=function(i,r,n){void 0===n&&(n=!1);var o=this.value,s=t.AnimatorCommon.GetAnimationDuration(this.animator,r);if(o!==i||void 0!==i){if(o!==i&&void 0===i)return void this.clear();if(this.isScrollable){if(!n&&o===i)return;var l,u=this.metaDataColumn,c=a.DefaultStyle.label,h=a.DefaultStyle.value,d=t.valueFormatter.create({format:this.getFormatString(u),value:i,displayUnitSystemType:this.displayUnitSystemType,formatSingleValues:!0,allowFormatBeautification:!0,columnType:u?u.type:void 0});u&&(l=u.displayName),i=d.format(i);var p=this.getTranslateX(this.currentViewport.width),g=(this.currentViewport.height-c.height-h.fontSize)/2,f=this.graphicsContext.attr("transform",t.SVGUtil.translate(p,this.getTranslateY(h.fontSize+g))).selectAll("text").data([i]);f.enter().append("text").attr("class",a.Value["class"]),f.text(function(e){return e}).style({"font-size":h.fontSize+"px",fill:h.color,"font-family":h.fontFamily,"text-anchor":this.getTextAnchor()}),f.call(t.AxisHelper.LabelLayoutStrategy.clip,this.currentViewport.width,e.TextMeasurementService.svgEllipsis),f.exit().remove();var m=this.labelContext.attr("transform",t.SVGUtil.translate(p,this.getTranslateY(h.fontSize+c.height+g))).selectAll("text").data([l]);m.enter().append("text").attr("class",a.Label["class"]),m.text(function(e){return e}).style({"font-size":c.fontSize+"px",fill:c.color,"text-anchor":this.getTextAnchor()}),m.call(t.AxisHelper.LabelLayoutStrategy.clip,this.currentViewport.width,e.TextMeasurementService.svgEllipsis),m.exit().remove()}else this.doValueTransition(o,i,this.displayUnitSystemType,this.animationOptions,s,n);this.updateTooltip(i),this.value=i}},a.prototype.updateTooltip=function(e){this.toolTip||(this.toolTip=this.graphicsContext.append("svg:title")),this.toolTip.text(e)},a.cardClassName="card",a.Label={"class":"label",selector:".label"},a.Value={"class":"value",selector:".value"},a.DefaultStyle={card:{maxFontSize:200},label:{fontSize:16,color:"#a6a6a6",height:26},value:{fontSize:37,color:"#333333",fontFamily:"wf_segoe-ui_Semibold"}},a.capabilities={dataRoles:[{name:"Values",kind:1,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Fields")}],objects:t.AnimatedText.objectDescs,dataViewMappings:[{conditions:[{Values:{max:1}}],single:{role:"Values"}}],suppressDefaultTitle:!0},a}(t.AnimatedText);t.Card=i}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t=function(){function e(){}return Object.defineProperty(e.prototype,"code",{get:function(){return"NoMapLocation"},enumerable:!0,configurable:!0}),e.prototype.getMessages=function(e){var t="NoMapLocationMessage",i="NoMapLocationKey",a="NoMapLocationValue",r={message:e.get(t),title:e.get(i),detail:e.get(a)};return r},e}();e.NoMapLocationWarning=t;var i=function(){function e(){}return Object.defineProperty(e.prototype,"code",{get:function(){return"NoValidGeotaggedCategory"},enumerable:!0,configurable:!0}),e.prototype.getMessages=function(e){var t="NoValidGeotaggedCategoryMessage",i="NoValidGeotaggedCategoryKey",a="NoValidGeotaggedCategoryValue",r={message:e.get(t),title:e.get(i),detail:e.get(a)};return r},e}();e.FilledMapWithoutValidGeotagCategoryWarning=i;var a=function(){function e(){}return Object.defineProperty(e.prototype,"code",{get:function(){return"GeometryCulledWarning"},enumerable:!0,configurable:!0}),e.prototype.getMessages=function(e){var t="DsrLimitWarning_TooMuchDataMessage",i="",a="",r={message:e.get(t),title:e.get(i),detail:e.get(a)};return r},e}();e.GeometryCulledWarning=a;var r=function(){function e(){}return Object.defineProperty(e.prototype,"code",{get:function(){return"NaNNotSupported"},enumerable:!0,configurable:!0}),e.prototype.getMessages=function(e){var t="VisualWarning_InfinityValues",i={message:e.get(t),title:"",detail:""};return i},e}();e.NaNNotSupportedWarning=r;var n=function(){function e(){}return Object.defineProperty(e.prototype,"code",{get:function(){return"InfinityValuesNotSupported"},enumerable:!0,configurable:!0}),e.prototype.getMessages=function(e){var t="VisualWarning_InfinityValues",i={message:e.get(t),title:"",detail:""};return i},e}();e.InfinityValuesNotSupportedWarning=n;var o=function(){function e(){}return Object.defineProperty(e.prototype,"code",{get:function(){return"ValuesOutOfRange"},enumerable:!0,configurable:!0}),e.prototype.getMessages=function(e){var t="VisualWarning_VisualizationOutOfRange",i={message:e.get(t),title:"",detail:""};return i},e}();e.ValuesOutOfRangeWarning=o}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){t.waterfallChartCapabilities={dataRoles:[{name:"Category",kind:0},{name:"Y",kind:1}],objects:{general:{displayName:e.data.createDisplayNameGetter("Visual_General"),properties:{formatString:{type:{formatting:{formatString:!0}}}}},legend:{displayName:e.data.createDisplayNameGetter("Visual_Legend"),properties:{show:{displayName:e.data.createDisplayNameGetter("Visual_Show"),type:{bool:!0}},position:{displayName:e.data.createDisplayNameGetter("Visual_LegendPosition"),type:{formatting:{legendPosition:!0}}},showTitle:{displayName:e.data.createDisplayNameGetter("Visual_LegendShowTitle"),type:{bool:!0}},titleText:{displayName:e.data.createDisplayNameGetter("Visual_LegendTitleText"),type:{text:!0}}}},labels:{displayName:e.data.createDisplayNameGetter("Visual_DataPointsLabels"),properties:{show:{displayName:e.data.createDisplayNameGetter("Visual_Show"),type:{bool:!0}},color:{displayName:e.data.createDisplayNameGetter("Visual_LabelsFill"),type:{fill:{solid:{color:!0}}}},labelDisplayUnits:{displayName:e.data.createDisplayNameGetter("Visual_DisplayUnits"),type:{formatting:{labelDisplayUnits:!0}}},labelPrecision:{displayName:e.data.createDisplayNameGetter("Visual_Precision"),type:{numeric:!0}}}},sentimentColors:{displayName:e.data.createDisplayNameGetter("Waterfall_SentimentColors"),properties:{increaseFill:{displayName:e.data.createDisplayNameGetter("Waterfall_IncreaseLabel"),type:{fill:{solid:{color:!0}}}},decreaseFill:{displayName:e.data.createDisplayNameGetter("Waterfall_DecreaseLabel"),type:{fill:{solid:{color:!0}}}},totalFill:{displayName:e.data.createDisplayNameGetter("Waterfall_TotalLabel"),type:{fill:{solid:{color:!0}}}}}},categoryAxis:{displayName:e.data.createDisplayNameGetter("Visual_XAxis"),properties:{show:{displayName:e.data.createDisplayNameGetter("Visual_Show"),type:{bool:!0}},showAxisTitle:{displayName:e.data.createDisplayNameGetter("Visual_Axis_Title"),type:{bool:!0}},axisStyle:{displayName:e.data.createDisplayNameGetter("Visual_Axis_Style"),type:{formatting:{axisStyle:!0}}}}},valueAxis:{displayName:e.data.createDisplayNameGetter("Visual_YAxis"),properties:{show:{displayName:e.data.createDisplayNameGetter("Visual_Show"),type:{bool:!0}},position:{displayName:e.data.createDisplayNameGetter("Visual_YAxis_Position"),type:{formatting:{yAxisPosition:!0}}},start:{displayName:e.data.createDisplayNameGetter("Visual_Axis_Start"),type:{numeric:!0}},end:{displayName:e.data.createDisplayNameGetter("Visual_Axis_End"),type:{numeric:!0}},showAxisTitle:{displayName:e.data.createDisplayNameGetter("Visual_Axis_Title"),type:{bool:!0}},axisStyle:{displayName:e.data.createDisplayNameGetter("Visual_Axis_Style"),type:{formatting:{axisStyle:!0}}}}}},dataViewMappings:[{conditions:[{Category:{max:1},Y:{max:1}}],categorical:{categories:{"for":{"in":"Category"},dataReductionAlgorithm:{top:{}}},values:{select:[{bind:{to:"Y"}}]}}}]},t.waterfallChartProps={sentimentColors:{increaseFill:{objectName:"sentimentColors",propertyName:"increaseFill"},decreaseFill:{objectName:"sentimentColors",propertyName:"decreaseFill"},totalFill:{objectName:"sentimentColors",propertyName:"totalFill"}}}}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var i=function(){function i(e){this.isScrollable=e.isScrollable,this.interactivityService=e.interactivityService}return i.prototype.init=function(e){this.svg=e.svg,this.clearCatcher=this.svg.select(".clearCatcher"),this.style=e.style,this.currentViewport=e.viewport,
this.hostServices=e.host,this.interactivity=e.interactivity,this.cartesianVisualHost=e.cartesianHost,this.options=e,this.element=e.element,this.colors=this.style.colorPalette.dataColors,this.element.addClass(i.WaterfallClassName),this.mainGraphicsSVG=this.svg.append("svg"),this.mainGraphicsContext=this.mainGraphicsSVG.append("g").classed(i.MainGraphicsContextClassName,!0)},i.converter=function(e,a,r,n,o,s){var l,u=i.formatStringProp,c=e.categorical.categories||[],h=o.increaseFill.solid.color,d=o.decreaseFill.solid.color,p=o.totalFill.solid.color,g=r.getLocalizedString(i.TotalLabel),f=r.getLocalizedString(i.IncreaseLabel),m=r.getLocalizedString(i.DecreaseLabel),y=[{label:f,color:h,icon:t.LegendIcon.Box,identity:t.SelectionId.createNull(),selected:!1},{label:m,color:d,icon:t.LegendIcon.Box,identity:t.SelectionId.createNull(),selected:!1},{label:g,color:p,icon:t.LegendIcon.Box,identity:t.SelectionId.createNull(),selected:!1}],v=0,C=0,b=0,x=[],S=[],w=e.categorical.values;if(!_.isEmpty(w)){var T=w[0],D=T.source,P=D.format;if(_.isEmpty(c))v=b=T.values[0],C=0;else{var M=c[0].identity;l=c[0].source,S=c[0].values.slice(),S.push(g);for(var L=0,A=T.values.length;A>L;L++){var N=S[L],V=T.values[L]||0,I=M?t.SelectionId.createWithId(M[L],!1):t.SelectionId.createNull(),R=t.TooltipBuilder.createTooltipInfo(u,c,N,w,V),H=V>0?h:d;x.push({value:V,position:v,color:H,categoryValue:N,categoryIndex:L,seriesIndex:0,selected:!1,identity:I,highlight:!1,key:I.getKey(),tooltipInfo:R,labelFill:n.labelColor,labelFormatString:P}),v+=V,v>b&&(b=v),C>v&&(C=v)}}var E=t.SelectionId.createNull();x.push({value:v,position:0,color:p,categoryValue:g,categoryIndex:L,identity:E,seriesIndex:0,selected:!1,highlight:!1,key:E.getKey(),tooltipInfo:t.TooltipBuilder.createTooltipInfo(u,c,g,w,v),labelFill:n.labelColor,labelFormatString:P})}var O=!1;s&&s.applySelectionStateToData(x)&&(O=!0);var F=t.CartesianHelper.getCategoryAxisProperties(e.metadata),G=t.CartesianHelper.getValueAxisProperties(e.metadata),z=t.converterHelper.createAxesLabels(F,G,l,[D]);return{series:[{data:x}],categories:S,categoryMetadata:l,valuesMetadata:D,legend:{dataPoints:y},hasHighlights:!1,positionMin:C,positionMax:b,dataLabelsSettings:n,sentimentColors:o,axesLabels:{x:z.xAxisLabel,y:z.yAxisLabel},hasSelection:O}},i.prototype.setData=function(e){var a=this.getSentimentColorsFromObjects(null);if(this.data={series:[{data:[]}],categories:[],valuesMetadata:null,legend:{dataPoints:[]},hasHighlights:!1,categoryMetadata:null,scalarCategoryAxis:!1,positionMax:0,positionMin:0,dataLabelsSettings:t.dataLabelUtils.getDefaultLabelSettings(),sentimentColors:a,axesLabels:{x:null,y:null},hasSelection:!1},e.length>0){var r=e[0];if(r){if(r.metadata&&r.metadata.objects){var n=r.metadata.objects,o=n.labels;o&&(void 0!==o.show&&(this.data.dataLabelsSettings.show=o.show),void 0!==o.color&&(this.data.dataLabelsSettings.labelColor=o.color.solid.color),void 0!==o.labelDisplayUnits&&(this.data.dataLabelsSettings.displayUnits=o.labelDisplayUnits),void 0!==o.labelPrecision&&(this.data.dataLabelsSettings.precision=o.labelPrecision>=0?o.labelPrecision:0)),a=this.getSentimentColorsFromObjects(n)}r.categorical&&(this.data=i.converter(r,this.colors,this.hostServices,this.data.dataLabelsSettings,a,this.interactivityService))}}},i.prototype.enumerateObjectInstances=function(e){switch(e.objectName){case"sentimentColors":return this.enumerateSentimentColors();case"labels":return t.dataLabelUtils.enumerateDataLabels(this.data.dataLabelsSettings,!1,!0,!0)}},i.prototype.enumerateSentimentColors=function(){var e=[],t=this.data.sentimentColors;return e.push({selector:null,properties:{increaseFill:t.increaseFill,decreaseFill:t.decreaseFill,totalFill:t.totalFill},objectName:"sentimentColors"}),e},i.prototype.calculateLegend=function(){return this.data.legend},i.prototype.hasLegend=function(){return!0},i.createClippedDataIfOverflowed=function(t,i){var a=t,r=t.series[0].data;return t&&i<r.length&&(a=e.Prototype.inherit(t),a.series=[{data:r.slice(0,i)}],a.categories=t.categories.slice(0,i)),a},i.prototype.calculateAxesProperties=function(e){var a=this;this.currentViewport=e.viewport;var r=this.margin=e.margin,n=this.clippedData=this.data,o=n.categories.length,s=this.getPreferredPlotArea(!1,o,t.CartesianChart.MinOrdinalRectThickness);s.width===this.currentViewport.width&&(s.width-=r.left+r.right),s.height-=r.top+r.bottom;var l=t.CartesianChart.getLayout(null,{availableWidth:s.width,categoryCount:o,domain:null,isScalar:!1,isScrollable:this.isScrollable});this.isScrollable||(n=this.clippedData=i.createClippedDataIfOverflowed(n,l.categoryCount));var u=i.getXAxisCreationOptions(n,s.width,l,e),c=i.getYAxisCreationOptions(n,s.height,e),h=this.xAxisProperties=t.AxisHelper.createAxis(u),d=this.yAxisProperties=t.AxisHelper.createAxis(c),p=this.xAxisProperties.categoryThickness*(1-t.CartesianChart.InnerPaddingRatio),g=t.dataLabelUtils.createColumnFormatterCacheManager(),f=n.dataLabelsSettings,m=i.getDisplayUnitValueFromAxisFormatter(d,f);return this.layout={categoryCount:l.categoryCount,categoryThickness:l.categoryThickness,isScalar:l.isScalar,outerPaddingRatio:l.outerPaddingRatio,categoryWidth:p,labelText:function(e){var i=g.getOrCreate(e.labelFormatString,f,m);return t.dataLabelUtils.getLabelFormattedText(i.format(e.value))},labelLayout:t.dataLabelUtils.getLabelLayoutXYForWaterfall(h,p,d,c.dataDomain),filter:function(e){return t.dataLabelUtils.doesDataLabelFitInShape(e,d,a.layout)},style:{fill:function(e){return e.isLabelInside?t.dataLabelUtils.defaultInsideLabelColor:e.labelFill}}},this.xAxisProperties.axisLabel=e.showCategoryAxisLabel?n.axesLabels.x:null,this.yAxisProperties.axisLabel=e.showValueAxisLabel?n.axesLabels.y:null,[h,d]},i.getDisplayUnitValueFromAxisFormatter=function(e,t){return e.formatter&&e.formatter.displayUnit&&0===t.displayUnits?e.formatter.displayUnit.value:null},i.lookupXValue=function(e,i,a){var r=e.series[0].data,n=r[i];return n&&n.categoryValue?i===r.length-1?n.categoryValue:t.AxisHelper.isDateTime(a)?new Date(n.categoryValue):n.categoryValue:i},i.getXAxisCreationOptions=function(e,a,r,n){var o=t.AxisHelper.getCategoryValueType(e.categoryMetadata),s=t.AxisHelper.createDomain(e.series,o,!1,n.forcedXDomain),l=r.categoryThickness,u=l*r.outerPaddingRatio;return{pixelSpan:a,dataDomain:s,metaDataColumn:e.categoryMetadata,formatStringProp:i.formatStringProp,isScalar:!1,outerPadding:u,categoryThickness:l,getValueFn:function(t,a){return i.lookupXValue(e,t,a)},forcedTickCount:n.forcedTickCount,isCategoryAxis:!0}},i.getYAxisCreationOptions=function(e,a,r){var n=t.AxisHelper.combineDomain(r.forcedYDomain,[e.positionMin,e.positionMax]);return{pixelSpan:a,dataDomain:n,isScalar:!0,isVertical:!0,metaDataColumn:e.valuesMetadata,formatStringProp:i.formatStringProp,outerPadding:0,forcedTickCount:r.forcedTickCount,useTickIntervalForDisplayUnits:!0,isCategoryAxis:!1}},i.prototype.getPreferredPlotArea=function(e,i,a){return t.CartesianChart.getPreferredPlotArea(i,a,this.currentViewport,this.isScrollable,e)},i.prototype.getVisualCategoryAxisIsScalar=function(){return!1},i.prototype.overrideXScale=function(e){this.xAxisProperties=e},i.prototype.setFilteredData=function(t,i){var a=this.clippedData=e.Prototype.inherit(this.data);return a.series=[{data:a.series[0].data.slice(t,i)}],a.categories=a.categories.slice(t,i),a},i.prototype.createRects=function(e){var t=this.mainGraphicsContext,a=t.selectAll(i.CategoryValueClasses.selector),r=a.data(e,function(e){return e.key});return r.enter().append("rect").attr("class",function(e){return i.CategoryValueClasses["class"].concat(e.highlight?"highlight":"")}),r.exit().remove(),r},i.prototype.createConnectors=function(e){var t=this.mainGraphicsContext,a=t.selectAll(i.WaterfallConnectorClasses.selector),r=a.data(e.slice(0,e.length-1),function(e){return e.key});return r.enter().append("line").classed(i.WaterfallConnectorClasses["class"],!0),r.exit().remove(),r},i.prototype.render=function(e){var a=this,r=this.clippedData.series[0].data,n=this.createRects(r),o=this.createConnectors(r);t.TooltipManager.addTooltip(n,function(e){return e.data.tooltipInfo});var s=this.data.hasSelection,l=this.xAxisProperties.scale,u=this.yAxisProperties.scale,c=u(0);if(this.mainGraphicsSVG.attr("height",this.getAvailableHeight()).attr("width",this.getAvailableWidth()),n.style("fill",function(e){return e.color}).style("fill-opacity",function(e){return t.ColumnUtil.getFillOpacity(e.selected,e.highlight,s,a.data.hasHighlights)}).attr("width",this.layout.categoryWidth).attr("x",function(e){return l(e.categoryIndex)}).attr("y",function(e){return i.getRectTop(u,e.position,e.value)}).attr("height",function(e){return c-u(Math.abs(e.value))}),o.attr({x1:function(e){return l(e.categoryIndex)},y1:function(e){return u(e.position+e.value)},x2:function(e){return l(e.categoryIndex+1)+a.layout.categoryWidth},y2:function(e){return u(e.position+e.value)}}),this.data.dataLabelsSettings.show?t.dataLabelUtils.drawDefaultLabelsForDataPointChart(r,this.svg,this.layout,this.currentViewport):t.dataLabelUtils.cleanDataLabels(this.svg),this.interactivityService){var h={bars:n,datapoints:r,clearCatcher:this.clearCatcher};this.interactivityService.apply(this,h)}t.SVGUtil.flushAllD3TransitionsIfNeeded(this.options)},i.prototype.onClearSelection=function(){this.interactivityService&&this.interactivityService.clearSelection()},i.prototype.accept=function(e,t){e.visitWaterfallChart(t)},i.prototype.getSupportedCategoryAxisType=function(){return e.axisType.categorical},i.getRectTop=function(e,t,i){return 0>i?e(t):e(t)-(e(0)-e(i))},i.prototype.getAvailableWidth=function(){return this.currentViewport.width-(this.margin.left+this.margin.right)},i.prototype.getAvailableHeight=function(){return this.currentViewport.height-(this.margin.top+this.margin.bottom)},i.prototype.getSentimentColorsFromObjects=function(a){var r=this.colors.getSentimentColors(),n=e.DataViewObjects.getFillColor(a,t.waterfallChartProps.sentimentColors.increaseFill,r[2].value),o=e.DataViewObjects.getFillColor(a,t.waterfallChartProps.sentimentColors.decreaseFill,r[0].value),s=e.DataViewObjects.getFillColor(a,t.waterfallChartProps.sentimentColors.totalFill,i.defaultTotalColor);return{increaseFill:{solid:{color:n}},decreaseFill:{solid:{color:o}},totalFill:{solid:{color:s}}}},i.formatStringProp={objectName:"general",propertyName:"formatString"},i.WaterfallClassName="waterfallChart",i.MainGraphicsContextClassName="mainGraphicsContext",i.IncreaseLabel="Waterfall_IncreaseLabel",i.DecreaseLabel="Waterfall_DecreaseLabel",i.TotalLabel="Waterfall_TotalLabel",i.CategoryValueClasses={"class":"column",selector:".column"},i.WaterfallConnectorClasses={"class":"waterfall-connector",selector:".waterfall-connector"},i.defaultTotalColor="#00b8aa",i}();t.WaterfallChart=i}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t;!function(t){t.animatedNumber={name:"animatedNumber",capabilities:e.AnimatedNumber.capabilities,create:function(){return new e.AnimatedNumber}},t.areaChart={name:"areaChart",watermarkKey:"area",capabilities:e.lineChartCapabilities,create:function(){return new e.CartesianChart({chartType:1})},customizeQuery:e.LineChart.customizeQuery,getSortableRoles:function(t){return e.ColumnChart.getSortableRoles(t)}},t.barChart={name:"barChart",watermarkKey:"bar",capabilities:e.getColumnChartCapabilities(!0),create:function(){return new e.CartesianChart({chartType:5})},customizeQuery:e.ColumnChart.customizeQuery,getSortableRoles:function(t){return e.ColumnChart.getSortableRoles(t)}},t.card={name:"card",watermarkKey:"card",capabilities:e.Card.capabilities,create:function(){return new e.Card}},t.multiRowCard={name:"multiRowCard",watermarkKey:"multiRowCard",capabilities:e.MultiRowCard.capabilities,create:function(){return new e.MultiRowCard}},t.clusteredBarChart={name:"clusteredBarChart",watermarkKey:"clusteredBar",capabilities:e.getColumnChartCapabilities(!0),create:function(){return new e.CartesianChart({chartType:4})},customizeQuery:e.ColumnChart.customizeQuery,getSortableRoles:function(t){return e.ColumnChart.getSortableRoles(t)}},t.clusteredColumnChart={name:"clusteredColumnChart",watermarkKey:"clusteredColumn",capabilities:e.getColumnChartCapabilities(),create:function(){return new e.CartesianChart({chartType:2})},customizeQuery:e.ColumnChart.customizeQuery,getSortableRoles:function(t){return e.ColumnChart.getSortableRoles(t)}},t.columnChart={name:"columnChart",watermarkKey:"column",capabilities:e.getColumnChartCapabilities(),create:function(){return new e.CartesianChart({chartType:3})},customizeQuery:e.ColumnChart.customizeQuery,getSortableRoles:function(t){return e.ColumnChart.getSortableRoles(t)}},t.comboChart={name:"comboChart",watermarkKey:"combo",capabilities:e.ComboChart.capabilities,create:function(){return new e.CartesianChart({chartType:9})}},t.dataDotChart={name:"dataDotChart",capabilities:e.DataDotChart.capabilities,create:function(){return new e.CartesianChart({chartType:10})}},t.dataDotClusteredColumnComboChart={name:"dataDotClusteredColumnComboChart",watermarkKey:"combo",capabilities:e.ComboChart.capabilities,create:function(){return new e.CartesianChart({chartType:14})}},t.dataDotStackedColumnComboChart={name:"dataDotStackedColumnComboChart",watermarkKey:"combo",capabilities:e.ComboChart.capabilities,create:function(){return new e.CartesianChart({chartType:15})}},t.donutChart={name:"donutChart",watermarkKey:"donut",capabilities:e.donutChartCapabilities,create:function(){return new e.DonutChart}},t.funnel={name:"funnel",watermarkKey:"funnel",capabilities:e.funnelChartCapabilities,create:function(){return new e.FunnelChart}},t.gauge={name:"gauge",watermarkKey:"gauge",capabilities:e.Gauge.capabilities,create:function(){return new e.Gauge}},t.hundredPercentStackedBarChart={name:"hundredPercentStackedBarChart",watermarkKey:"100stackedbar",capabilities:e.getColumnChartCapabilities(!0),create:function(){return new e.CartesianChart({chartType:6})},customizeQuery:e.ColumnChart.customizeQuery,getSortableRoles:function(t){return e.ColumnChart.getSortableRoles(t)}},t.hundredPercentStackedColumnChart={name:"hundredPercentStackedColumnChart",watermarkKey:"100stackedcolumn",capabilities:e.getColumnChartCapabilities(),create:function(){return new e.CartesianChart({chartType:7})},customizeQuery:e.ColumnChart.customizeQuery,getSortableRoles:function(t){return e.ColumnChart.getSortableRoles(t)}},t.image={name:"image",capabilities:e.ImageVisual.capabilities,create:function(){return new e.ImageVisual}},t.lineChart={name:"lineChart",watermarkKey:"line",capabilities:e.lineChartCapabilities,create:function(){return new e.CartesianChart({chartType:0})},customizeQuery:e.LineChart.customizeQuery,getSortableRoles:function(t){return e.LineChart.getSortableRoles(t)}},t.lineStackedColumnComboChart={name:"lineStackedColumnComboChart",watermarkKey:"combo",capabilities:e.ComboChart.capabilities,create:function(){return new e.CartesianChart({chartType:13})},getSortableRoles:function(t){return e.ColumnChart.getSortableRoles(t)}},t.lineClusteredColumnComboChart={name:"lineClusteredColumnComboChart",watermarkKey:"combo",capabilities:e.ComboChart.capabilities,create:function(){return new e.CartesianChart({chartType:12})},getSortableRoles:function(t){return e.ColumnChart.getSortableRoles(t)}},t.map={name:"map",watermarkKey:"map",capabilities:e.mapCapabilities,create:function(){return new e.Map({filledMap:!1})}},t.filledMap={name:"filledMap",watermarkKey:"filledMap",capabilities:e.filledMapCapabilities,create:function(){return new e.Map({filledMap:!0})}},t.treemap={name:"treemap",watermarkKey:"tree",capabilities:e.treemapCapabilities,create:function(){return new e.Treemap}},t.pieChart={name:"pieChart",watermarkKey:"pie",capabilities:e.donutChartCapabilities,create:function(){return new e.DonutChart({sliceWidthRatio:0})}},t.scatterChart={name:"scatterChart",watermarkKey:"scatterplot",capabilities:e.scatterChartCapabilities,create:function(){return new e.CartesianChart({chartType:8})}},t.table={name:"table",watermarkKey:"table",capabilities:e.Table.capabilities,create:function(){return new e.Table},customizeQuery:e.Table.customizeQuery,getSortableRoles:function(t){return e.Table.getSortableRoles()}},t.matrix={name:"matrix",watermarkKey:"matrix",capabilities:e.Matrix.capabilities,create:function(){return new e.Matrix},customizeQuery:e.Matrix.customizeQuery,getSortableRoles:function(t){return e.Matrix.getSortableRoles()}},t.slicer={name:"slicer",watermarkKey:"slicer",capabilities:e.slicerCapabilities,create:function(){return new e.Slicer}},t.textbox={name:"textbox",capabilities:e.RichTextbox.capabilities,create:function(){return new e.RichTextbox}},t.waterfallChart={name:"waterfallChart",watermarkKey:"waterfall",capabilities:e.waterfallChartCapabilities,create:function(){return new e.CartesianChart({chartType:11})}},t.cheerMeter={name:"cheerMeter",capabilities:e.CheerMeter.capabilities,create:function(){return new e.CheerMeter}},t.consoleWriter={name:"consoleWriter",capabilities:e.getConsoleWriterCapabilities(),create:function(){return new e.ConsoleWriter}}}(t=e.plugins||(e.plugins={}))}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var i=e.visuals.controls.TouchUtils,a=function(){function e(t){this.tooltipOptions=t,this.isTooltipVisible=!1,t||(this.tooltipOptions=e.DefaultTooltipOptions)}return e.prototype.isTooltipComponentVisible=function(){return this.isTooltipVisible},e.prototype.setTestScreenSize=function(e,t){this.customScreenWidth=e,this.customScreenHeight=t},e.prototype.show=function(e,t){this.isTooltipVisible=!0,this.tooltipContainer||(this.tooltipContainer=this.createTooltipContainer()),this.setTooltipContent(e),this.tooltipContainer.style("visibility","visible").transition().duration(0).style("opacity",this.tooltipOptions.opacity),this.setPosition(t)},e.prototype.move=function(e,t){this.isTooltipVisible&&(e&&this.setTooltipContent(e),this.setPosition(t))},e.prototype.hide=function(){this.isTooltipVisible&&(this.isTooltipVisible=!1,this.tooltipContainer.transition().duration(this.tooltipOptions.animationDuration).style("opacity",0).each("end",function(){this.style.visibility="hidden"}))},e.prototype.createTooltipContainer=function(){var t=d3.select(e.parentContainerSelector).append("div").attr("class",e.containerClassName);return t.append("div").attr("class",e.arrowClassName),t.append("div").attr("class",e.contentContainerClassName),t},e.prototype.setTooltipContent=function(t){var i="."+e.tooltipRowClassName,a=this.tooltipContainer.select("."+e.contentContainerClassName);a.selectAll(".tooltip-row").remove();var r=a.selectAll(i).data(t),n=r.enter().append("div").attr("class",e.tooltipRowClassName),o=n.append("div").attr("class",e.tooltipTitleCellClassName),s=n.append("div").attr("class",e.tooltipValueCellClassName);o.text(function(e){return e.displayName}),s.text(function(e){return e.value})},e.prototype.getTooltipPosition=function(e,t){var a=this.tooltipContainer.node().getBoundingClientRect(),r=Math.floor(e.width/2),n=0,o=0,s=new i.Point(e.x+r,e.y+r),l=7;return 0===t?(n+=3*l+r,o-=2*l+r):1===t?(n-=2*l+a.width+r,o-=2*l+r):3===t?(n+=3*l+r,o-=a.height-2*l+r):2===t&&(n-=2*l+a.width+r,o-=a.height-2*l+r),s.offset(n,o),s},e.prototype.setPosition=function(e){var t=this.getClickedScreenArea(e),i=this.getTooltipPosition(e,t);this.tooltipContainer.style({left:i.x+"px",top:i.y+"px"}),this.setArrowPosition(e,t)},e.prototype.setArrowPosition=function(e,t){var i,a=this.getArrowElement();0===t?i="top left":1===t?i="top right":3===t?i="bottom left":2===t&&(i="bottom right"),a.attr("class","arrow").classed(i,!0)},e.prototype.getArrowElement=function(){return this.tooltipContainer.select("."+e.arrowClassName)},e.prototype.getClickedScreenArea=function(e){var t=this.customScreenWidth||window.innerWidth,a=this.customScreenHeight||window.innerHeight,r=e.width/2,n=new i.Point(e.x+r,e.y+r),o=t/2,s=a/2;return n.x<o&&n.y<s?0:n.x>=o&&n.y<s?1:n.x<o&&n.y>=s?3:n.x>=o&&n.y>=s?2:void 0},e.DefaultTooltipOptions={opacity:1,animationDuration:250,offsetX:10,offsetY:10},e.containerClassName="tooltip-container",e.contentContainerClassName="tooltip-content-container",e.arrowClassName="arrow",e.tooltipRowClassName="tooltip-row",e.tooltipTitleCellClassName="tooltip-title-cell",e.tooltipValueCellClassName="tooltip-value-cell",e.parentContainerSelector="body",e.highlightedValueDisplayNameResorceKey="Tooltip_HighlightedValueDisplayName",e}();t.ToolTipComponent=a;var r;!function(e){function t(t,i,n){if(e.ShowTooltips){var o=d3.select(a.parentContainerSelector).node(),f=h(),w=d(),_="pointerdown"===f||"MSPointerDown"===f;t.on("mouseover",function(e,t){if(!S&&c(d3.event)){y=p(o,!0);var a=p(this,!0),n={data:e,index:t,coordinates:y,elementCoordinates:a,context:this,isTouchEvent:!1};u(),m=r(n,i,C)}}),t.on("mouseout",function(e,t){S||(u(),l())}),t.on("mousemove",function(e,t){if(!S&&c(d3.event)){y=p(o,!0);var a=p(this,!0),r={data:e,index:t,coordinates:y,elementCoordinates:a,context:this,isTouchEvent:!1};s(r,i,n)}}),v||(g(f),v=!0),t.on(f,function(e,t){y=null,l();var a=p(o,_),n=p(this,_),s={data:e,index:t,coordinates:a,elementCoordinates:n,context:this,isTouchEvent:!0};u(),m=r(s,i,b)}),t.on(w,function(e,t){u(),S&&clearTimeout(S),S=setTimeout(function(){S=0},x)})}}function r(e,t,i){return setTimeout(function(){return o(e,t)},i)}function n(e){a.localizationOptions=e}function o(t,i){var a=i(t);if(a){var r=y||t.coordinates,n=f(r[0],r[1],t.isTouchEvent);e.ToolTipInstance.show(a,n)}}function s(t,i,a){var r;a&&(r=i(t));var n=f(t.coordinates[0],t.coordinates[1],t.isTouchEvent);e.ToolTipInstance.move(r,n)}function l(){e.ToolTipInstance.hide()}function u(){m&&clearTimeout(m)}function c(e){var t=!0,i=e;if(void 0!==i.buttons){var a=0!==i.buttons;t=!a}return t}function h(){var e="touchstart";return window.PointerEvent?e="pointerdown":window.MSPointerEvent&&(e="MSPointerDown"),e}function d(){var e="touchend";return window.PointerEvent?e="pointerup":window.MSPointerEvent&&(e="MSPointerUp"),e}function p(e,t){var i;if(t)i=d3.mouse(e);else{var a=d3.touches(e);a&&a.length>0&&(i=a[0])}return i}function g(t){d3.select(a.parentContainerSelector).on(t,function(t,i){e.ToolTipInstance.hide()})}function f(e,t,a){var r=0,n=e,o=t;if(a){r=12;var s=r/2;n=Math.max(e-s,0),o=Math.max(t-s,0)}return new i.Rectangle(n,o,r,r)}e.ShowTooltips=!0,e.ToolTipInstance=new a;var m,y,v=!1,C=500,b=500,x=1e3,S=0;e.addTooltip=t,e.showDelayedTooltip=r,e.setLocalizedStrings=n}(r=t.TooltipManager||(t.TooltipManager={}));var n;!function(e){function i(e,t,i,a,n,o,s,l){var u,c=[],h=void 0;if(s=0|s,t&&t.length>0&&(u={value:i,metadata:t[0].source}),a&&(u&&u.metadata===a.source||(h=a.source)),o)for(var d=0,p=o.length;p>d;d++){var g=o[d];u&&u.metadata===g.metadata.source||c.push({value:g.value,metadata:g.metadata})}else if(a&&a.length>0){var f=a[s],m=f&&f.source?f.source:null,y=m&&m.isAutoGeneratedColumn;y||(c=[{value:n,highlightedValue:l,metadata:f}])}var v=r(e,u,h,c);return v}function r(e,t,i,r){var o=[];if(t){var s=n(t.metadata,e,t.value);o.push({displayName:t.metadata.displayName,value:s})}if(i){var l;if(r.length>0){var u=r[0].metadata.source;l=n(u,e,u.groupName)}o.push({displayName:i.displayName,value:l})}for(var c=0;c<r.length;c++){var h=r[c];if(h&&h.metadata){var d=h.metadata.source,p=h.value,g=h.highlightedValue;if(p||0===p){var f=n(d,e,p);o.push({displayName:d.displayName,value:f})}if(g||0===g){var m=n(d,e,g),y=a.localizationOptions.highlightedValueDisplayName;o.push({displayName:y,value:m})}}}return o}function n(e,i,a){var r=o(e,i);return t.valueFormatter.format(a,r)}function o(e,i){if(e){var a=t.valueFormatter.getFormatString(e,i,!0);return a||e.format}return null}e.createTooltipInfo=i}(n=t.TooltipBuilder||(t.TooltipBuilder={}))}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t;!function(t){function i(t){return void 0===t&&(t=new e.DataColorPalette),{titleText:{color:{value:"rgba(51,51,51,1)"}},subTitleText:{color:{value:"rgba(145,145,145,1)"}},colorPalette:{dataColors:t},labelText:{color:{value:"rgba(51,51,51,1)"},fontSize:"11px"},isHighContrast:!1}}t.create=i}(t=e.visualStyles||(e.visualStyles={}))}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var i=function(){function i(e){e&&(this.sliceWidthRatio=e.sliceWidthRatio,this.animator=e.animator,this.isScrollable=e.isScrollable?e.isScrollable:!1),null==this.sliceWidthRatio&&(this.sliceWidthRatio=i.defaultSliceWidthRatio)}return i.converter=function(e,t,r){var n=new a.DonutChartConverter(e,t);n.convert();var o=d3.layout.pie().sort(null).value(function(e){return e.percentage}),s=r?i.cullDataByViewport(n.dataPoints,n.maxValue,r):n.dataPoints,l={dataPointsToDeprecate:s,dataPoints:o(s),unCulledDataPoints:n.dataPoints,dataPointsToEnumerate:n.legendData.dataPoints,legendData:n.legendData,hasHighlights:n.hasHighlights,dataLabelsSettings:n.dataLabelsSettings,legendObjectProperties:n.legendObjectProperties,maxValue:n.maxValue,visibleGeometryCulled:n.dataPoints.length!==s.length};return l},i.prototype.init=function(e){this.options=e;var a=e.element;a.empty(),this.parentViewport=e.viewport,this.currentViewport={height:e.viewport.height,width:e.viewport.width},this.formatter=t.valueFormatter.format,this.data={dataPointsToDeprecate:[],dataPointsToEnumerate:[],dataPoints:[],unCulledDataPoints:[],legendData:{title:"",dataPoints:[]},hasHighlights:!1,dataLabelsSettings:t.dataLabelUtils.getDefaultDonutLabelSettings()},this.drilled=!1,this.allowDrilldown=!1,this.style=e.style,this.colors=this.style.colorPalette.dataColors,this.radius=0,this.isInteractive=e.interactivity&&e.interactivity.isInteractiveLegend;var n=this.settings;if(this.interactivityService=t.VisualInteractivityFactory.buildInteractivityService(e),this.legend=t.createLegend(a,e.interactivity&&e.interactivity.isInteractiveLegend,this.interactivityService,this.isScrollable),this.hostService=e.host,this.isInteractive){this.chartRotationAnimationDuration=n&&n.chartRotationAnimationDuration?n.chartRotationAnimationDuration:0;var o=this.legendContainer=d3.select(a.get(0)).append("div").classed(i.InteractiveLegendClassName,!0);this.interactivityState={interactiveLegend:new r(this,o,this.colors,e,this.settings),valueToAngleFactor:0,sliceAngles:[],currentRotate:0,interactiveChosenSliceFinishedSetting:!1,lastChosenInteractiveSliceIndex:0,totalDragAngleDifference:0,currentIndexDrag:0,previousIndexDrag:0,previousDragAngle:0,donutCenter:{x:0,y:0}}}this.svg=d3.select(a.get(0)).append("svg").style("position","absolute").classed(i.ClassName,!0),this.clearCatcher=t.appendClearCatcher(this.svg),this.mainGraphicsContext=this.svg.append("g"),this.mainGraphicsContext.append("g").classed("slices",!0),this.mainGraphicsContext.append("g").classed("lines",!0),this.pie=d3.layout.pie().sort(null).value(function(e){return e.percentage})},i.prototype.onDataChanged=function(e){var a=e.dataViews;if(a&&a.length>0&&a[0].categorical?(this.data=i.converter(a[0],this.colors,this.currentViewport),this.options.interactivity&&this.options.interactivity.isInteractiveLegend||this.renderLegend(),this.interactivityService&&this.interactivityService.applySelectionStateToData(this.data.dataPoints.map(function(e){return e.data}))):this.data={dataPointsToDeprecate:[],dataPointsToEnumerate:[],dataPoints:[],unCulledDataPoints:[],legendData:{title:"",dataPoints:[]},hasHighlights:!1,dataLabelsSettings:t.dataLabelUtils.getDefaultDonutLabelSettings()},this.initViewportDependantProperties(),this.updateInternal(this.data,e.suppressAnimations),this.hasSetData=!0,a){var r=t.getInvalidValueWarnings(a,!1,!1,!1);if(this.data.visibleGeometryCulled){var n=new t.GeometryCulledWarning;r?r.unshift(n):r=[n]}r&&r.length>0&&this.hostService.setWarnings(r)}},i.prototype.onResizing=function(e){var t=0;if(this.parentViewport=e,!this.currentViewport||this.currentViewport.height!==e.height||this.currentViewport.width!==e.width){this.parentViewport=e,this.hasSetData&&this.renderLegend(),this.initViewportDependantProperties(t);var a=d3.layout.pie().sort(null).value(function(e){return e.percentage});this.data.dataPoints=a(i.cullDataByViewport(this.data.unCulledDataPoints,this.data.maxValue,e)),this.data.dataPoints.length!==this.data.unCulledDataPoints.length?this.data.visibleGeometryCulled=!0:this.data.visibleGeometryCulled=!1,this.updateInternal(this.data,!0,t),this.previousRadius=this.radius}},i.prototype.enumerateObjectInstances=function(e){switch(e.objectName){case"legend":return this.enumerateLegend();case"dataPoint":return this.enumerateDataPoints();case"labels":return this.data?t.dataLabelUtils.enumerateDataLabels(this.data.dataLabelsSettings,!1,!0,!0):t.dataLabelUtils.enumerateDataLabels(t.dataLabelUtils.getDefaultDonutLabelSettings(),!1,!0,!0);case"categoryLabels":return this.data?t.dataLabelUtils.enumerateCategoryLabels(this.data.dataLabelsSettings,!1,!0):t.dataLabelUtils.enumerateCategoryLabels(null,!1,!0)}},i.prototype.enumerateDataPoints=function(){var e=this.data;if(e){for(var i=[],a=e.dataPointsToEnumerate,r=a.length,n=0;r>n;n++){var o=a[n];i.push({objectName:"dataPoint",displayName:o.label,selector:t.ColorHelper.normalizeSelector(o.identity.getSelector()),properties:{fill:{solid:{color:o.color}}}})}return i}},i.prototype.enumerateLegend=function(){var i=this.data;if(i){var a={legend:i.legendObjectProperties},r=e.DataViewObjects.getValue(a,t.donutChartProps.legend.show,this.legend.isVisible()),n=e.DataViewObjects.getValue(a,t.donutChartProps.legend.showTitle,!0),o=e.DataViewObjects.getValue(a,t.donutChartProps.legend.titleText,this.data.legendData.title);return[{selector:null,objectName:"legend",properties:{show:r,position:t.LegendPosition[this.legend.getOrientation()],showTitle:n,titleText:o}}]}},i.prototype.setInteractiveChosenSlice=function(e){var i=this;if(0!==this.interactivityState.sliceAngles.length){this.interactivityState.lastChosenInteractiveSliceIndex=e,this.interactivityState.interactiveChosenSliceFinishedSetting=!1;var a=this.currentViewport,r=e%this.data.dataPoints.length,n=this.interactivityState.sliceAngles[r];this.svg.select("g").transition().duration(this.chartRotationAnimationDuration).ease("elastic").attr("transform",t.SVGUtil.translateAndRotate(a.width/2,a.height/2,0,0,n)).each("end",function(){i.interactivityState.interactiveChosenSliceFinishedSetting=!0}),this.interactivityState.currentRotate=n,this.interactivityState.interactiveLegend.updateLegend(r),this.svg.selectAll(".slice").attr("opacity",function(e,t){return t===r?1:.6}),t.SVGUtil.flushAllD3TransitionsIfNeeded(this.options)}},i.prototype.calculateRadius=function(){var e=this.currentViewport;if(!this.isInteractive&&this.data&&(this.data.dataLabelsSettings.show||this.data.dataLabelsSettings.showCategory)){var t=e.height/e.width,i=2+1/(1+Math.exp(-5*(t-1)));return Math.min(e.height,e.width)/i}return Math.min(e.height,e.width)/2},i.prototype.initViewportDependantProperties=function(e){void 0===e&&(e=0),this.currentViewport.height=this.parentViewport.height,this.currentViewport.width=this.parentViewport.width;var a=this.currentViewport;if(this.isInteractive)a.height-=i.InteractiveLegendContainerHeight;else{var r=this.legend.getMargins();a.height-=r.height,a.width-=r.width}this.svg.attr({width:a.width,height:a.height}),this.isInteractive&&(this.legendContainer.style({width:"100%",height:i.InteractiveLegendContainerHeight+"px",overflow:"hidden",top:0}),this.svg.style("top",i.InteractiveLegendContainerHeight)),this.previousRadius=this.radius;var n=this.radius=this.calculateRadius();this.arc=d3.svg.arc(),this.outerArc=d3.svg.arc().innerRadius(n*i.OuterArcRadiusRatio).outerRadius(n*i.OuterArcRadiusRatio),this.isInteractive?this.mainGraphicsContext.attr("transform",t.SVGUtil.translate(a.width/2,a.height/2)):this.mainGraphicsContext.transition().duration(e).attr("transform",t.SVGUtil.translate(a.width/2,a.height/2)),t.SVGUtil.flushAllD3TransitionsIfNeeded(this.options)},i.prototype.mergeDatasets=function(t,i){
var a=d3.set();i.forEach(function(e){a.add(e.identity?e.identity.getKey():e.data.identity.getKey())});var r=t.filter(function(e){return!a.has(e.identity?e.identity.getKey():e.data.identity.getKey())}).map(function(t){var i=e.Prototype.inherit(t);return void 0===i.percentage?i.data.percentage=0:i.percentage=0,i});return d3.merge([i,r])},i.prototype.updateInternal=function(e,a,r){void 0===r&&(r=0);var n=this.currentViewport;if(r=r||t.AnimatorCommon.GetAnimationDuration(this.animator,a),this.animator){var o,s,l,u=i.getLayout(this.radius,this.sliceWidthRatio,n);if(!a){var c={viewModel:e,colors:this.colors,graphicsContext:this.mainGraphicsContext,interactivityService:this.interactivityService,layout:u,radius:this.radius,sliceWidthRatio:this.sliceWidthRatio,viewport:n};o=this.animator.animate(c),s=o.shapes,l=o.highlightShapes}(a||o.failed)&&(s=i.drawDefaultShapes(this.svg,e,u,this.colors,this.radius),l=i.drawDefaultHighlightShapes(this.svg,e,u,this.colors,this.radius),i.drawDefaultCategoryLabels(this.mainGraphicsContext,e,u,this.sliceWidthRatio,this.radius,this.currentViewport)),this.assignInteractions(s,l,e),t.TooltipManager.addTooltip(s,function(e){return e.data.data.tooltipInfo}),t.TooltipManager.addTooltip(l,function(e){return e.data.data.tooltipInfo})}else this.updateInternalToMove(e,r);t.SVGUtil.flushAllD3TransitionsIfNeeded(this.options)},i.prototype.renderLegend=function(){var e=this.data.legendObjectProperties;if(e){var i=this.data.legendData;t.LegendData.update(i,e);var a=e[t.legendProps.position];a&&this.legend.changeOrientation(t.LegendPosition[a]),this.legend.drawLegend(i,this.parentViewport)}else this.legend.changeOrientation(t.LegendPosition.Top),this.legend.drawLegend({dataPoints:[]},this.parentViewport)},i.prototype.addInteractiveLegendArrow=function(){var e=11,a=16.5;if(!this.interactiveLegendArrow){var r=this.svg.append("g");r.append("path").classed(i.InteractiveLegendArrowClassName,!0).attr("d","M1.5,2.6C0.65,1.15,1.85,0,3,0l27,0c1.65,0,2.35,1.15,1.5,2.6L18,26.45c-0.8,1.45-2.15,1.45-2.95,0L1.95,2.6z"),this.interactiveLegendArrow=r}var n=this.currentViewport,o=(n.height-2*this.radius)/2+e,s=n.width/2-a;this.interactiveLegendArrow.attr("transform",t.SVGUtil.translate(s,o))},i.prototype.calculateSliceAngles=function(){var e=[],t=this.data.dataPoints;if(0===t.length)return this.interactivityState.valueToAngleFactor=0,void(this.interactivityState.sliceAngles=[]);for(var i=0,a=0,r=t.length;r>a;a++)i+=t[a].data.percentage;this.interactivityState.valueToAngleFactor=360/i;for(var n=0,a=0,r=t.length;r>a;a++){var o=t[a].data.percentage*this.interactivityState.valueToAngleFactor;n+=o,e.push(o/2-n)}this.interactivityState.sliceAngles=e},i.prototype.assignInteractions=function(e,t,i){if(this.isInteractive)this.assignInteractiveChartInteractions(e);else if(this.interactivityService){var a={clearCatcher:this.clearCatcher,datapoints:i.dataPoints.map(function(e){return e.data}),slices:e,highlightSlices:t,allowDrilldown:this.allowDrilldown,visual:this,hasHighlights:i.hasHighlights,svg:this.svg};this.interactivityService.apply(this,a)}},i.prototype.setDrilldown=function(e){if(e){var a=d3.layout.pie().sort(null).value(function(e){return e.percentage}),r=[{label:e.label,color:e.color,icon:t.LegendIcon.Box,identity:e.identity,selected:e.selected}],n={title:"",dataPoints:r},o=a(e.internalDataPoints);this.updateInternal({dataPointsToDeprecate:e.internalDataPoints,dataPoints:o,unCulledDataPoints:o.map(function(e){return e.data}),legendData:n,hasHighlights:!1,dataLabelsSettings:this.data.dataLabelsSettings},!1,i.DrillDownAnimationDuration)}else this.updateInternal(this.data,!1,i.DrillDownAnimationDuration)},i.prototype.assignInteractiveChartInteractions=function(e){var t=this,i=this.svg;this.interactivityState.interactiveChosenSliceFinishedSetting=!0;var a=i.node().getBoundingClientRect();this.interactivityState.donutCenter={x:a.left+a.width/2,y:a.top+a.height/2},this.interactivityState.totalDragAngleDifference=0,this.interactivityState.currentRotate=0,this.calculateSliceAngles(),e.on("click",function(e,i){d3.event.defaultPrevented||t.setInteractiveChosenSlice(i)});var r=d3.behavior.drag().origin(Object).on("dragstart",function(){return t.interactiveDragStart()}).on("drag",function(){return t.interactiveDragMove()}).on("dragend",function(){return t.interactiveDragEnd()});i.call(r)},i.prototype.getAngleFromDragEvent=function(){var e,t,i=this.interactivityState,a=d3.event.sourceEvent;if(-1!==a.type.toLowerCase().indexOf("touch")){if(1!==a.touches.length)return null;var r=a.touches[0];e=r.pageX,t=r.pageY}else e=a.pageX,t=a.pageY;var n={x:e-i.donutCenter.x,y:-t+i.donutCenter.y},o=180*Math.atan2(n.y,n.x)/Math.PI;return o},i.prototype.interactiveDragStart=function(){this.interactivityState.totalDragAngleDifference=0,this.interactivityState.previousDragAngle=this.getAngleFromDragEvent()},i.prototype.interactiveDragMove=function(){var e=this.data.dataPoints,a=this.currentViewport,r=this.interactivityState;if(r.interactiveChosenSliceFinishedSetting===!0){var n=this.getAngleFromDragEvent();if(!n)return;var o=r.previousDragAngle-n;r.totalDragAngleDifference+=o,r.previousDragAngle=n,r.currentRotate+=o,this.svg.select("g").attr("transform",t.SVGUtil.translateAndRotate(a.width/2,a.height/2,0,0,this.interactivityState.currentRotate));var s=e[0].data.percentage*r.valueToAngleFactor,l=r.currentRotate<=0?-1*r.currentRotate%360:360-r.currentRotate%360;r.currentIndexDrag=0;for(var u=e.length;r.currentIndexDrag<u&&l>s;)r.currentIndexDrag<u-1&&(s+=e[r.currentIndexDrag+1].data.percentage*r.valueToAngleFactor),r.currentIndexDrag++;r.currentIndexDrag!==r.previousIndexDrag&&(r.interactiveLegend.updateLegend(r.currentIndexDrag),this.svg.selectAll(".slice").attr("opacity",function(e,t){return t===r.currentIndexDrag?i.OpaqueOpacity:i.SemiTransparentOpacity}),r.previousIndexDrag=r.currentIndexDrag)}},i.prototype.interactiveDragEnd=function(){0!==this.interactivityState.totalDragAngleDifference&&(this.setInteractiveChosenSlice(this.interactivityState.currentIndexDrag),d3.event.sourceEvent.stopPropagation())},i.prototype.accept=function(e,t){e.visitDonutChart(t)},i.prototype.updateInternalToMove=function(e,a){void 0===a&&(a=0);var r=this.svg,n=this.pie,o=this.key,s=this.arc,l=this.radius,u=this.previousRadius,c=this.sliceWidthRatio,h=this.svg.select(".slices").selectAll("path"+i.sliceClass.selector).data().map(function(e){return e.data});0===h.length&&(h=e.dataPointsToDeprecate);var d=this.mergeDatasets(h,e.dataPointsToDeprecate),p=r.select(".slices").selectAll("path"+i.sliceClass.selector).data(n(e.dataPointsToDeprecate),o);p.enter().insert("path").classed(i.sliceClass["class"],!0).each(function(e){this._current=e}),p=r.select(".slices").selectAll("path"+i.sliceClass.selector).data(n(d),o);var g=l*c;if(p.style("fill",function(e){return e.data.color}).style("fill-opacity",function(i){return t.ColumnUtil.getFillOpacity(i.data.selected,!1,!1,e.hasHighlights)}).style("stroke","white").transition().duration(a).attrTween("d",function(e){var t=d3.interpolate(this._current,e),a=d3.interpolate(u*i.InnerArcRadiusRatio,l*i.InnerArcRadiusRatio);return this._current=t(0),function(e){return s.innerRadius(g).outerRadius(a(e))(t(e))}}),p=r.select(".slices").selectAll("path"+i.sliceClass.selector).data(n(e.dataPointsToDeprecate),o),p.exit().transition().delay(a).duration(0).remove(),!this.isInteractive){var f=i.getLayout(l,c,this.currentViewport);i.drawDefaultCategoryLabels(this.mainGraphicsContext,e,f,c,l,this.currentViewport)}if(e.hasHighlights){var m=r.select(".slices").selectAll("path"+i.sliceHighlightClass.selector).data(n(e.dataPointsToDeprecate),o);m.enter().insert("path").classed(i.sliceHighlightClass["class"],!0).each(function(e){this._current=e}),m.style("fill",function(e){return e.data.color}).style("fill-opacity",1).style("stroke","white").transition().duration(a).attrTween("d",function(e){var t=d3.interpolate(this._current,e),a=d3.interpolate(u*i.InnerArcRadiusRatio,i.getHighlightRadius(l,c,e.data.highlightRatio));return this._current=t(0),function(e){return s.innerRadius(g).outerRadius(a(e))(t(e))}}),m.exit().transition().delay(a).duration(0).remove()}else r.selectAll("path"+i.sliceHighlightClass.selector).transition().delay(a).duration(0).remove();this.assignInteractions(p,m,e),t.TooltipManager.addTooltip(p,function(e){return e.data.data.tooltipInfo}),e.hasHighlights&&t.TooltipManager.addTooltip(m,function(e){return e.data.data.tooltipInfo}),t.SVGUtil.flushAllD3TransitionsIfNeeded(this.options),this.isInteractive&&(this.addInteractiveLegendArrow(),this.interactivityState.interactiveLegend.drawLegend(this.data.dataPointsToDeprecate),this.setInteractiveChosenSlice(this.interactivityState.lastChosenInteractiveSliceIndex?this.interactivityState.lastChosenInteractiveSliceIndex:0))},i.drawDefaultShapes=function(e,a,r,n,o,s){var l=t.dataHasSelection(a.dataPoints.map(function(e){return e.data})),u=e.select(".slices").selectAll("path"+i.sliceClass.selector).data(a.dataPoints,function(e){return e.data.identity.getKey()});return u.enter().insert("path").classed(i.sliceClass["class"],!0),u.style("fill",function(e){return e.data.color}).style("fill-opacity",function(e){return t.ColumnUtil.getFillOpacity(e.data.selected,!1,l,a.hasHighlights)}).attr(r.shapeLayout),u.exit().remove(),u},i.drawDefaultHighlightShapes=function(e,a,r,n,o){var s=e.select(".slices").selectAll("path"+i.sliceHighlightClass.selector).data(a.dataPoints.filter(function(e){return null!=e.data.highlightRatio}),function(e){return e.data.identity.getKey()});return s.enter().insert("path").classed(i.sliceHighlightClass["class"],!0).each(function(e){this._current=e}),s.style("fill",function(e){return e.data.color}).style("fill-opacity",function(e){return t.ColumnUtil.getFillOpacity(e.data.selected,!0,!1,a.hasHighlights)}).style("stroke","white").attr(r.highlightShapeLayout),s.exit().remove(),s},i.drawDefaultCategoryLabels=function(e,a,r,n,o,s){var l=d3.svg.arc().innerRadius(0).outerRadius(o*i.InnerArcRadiusRatio),u=d3.svg.arc().innerRadius(o*i.OuterArcRadiusRatio).outerRadius(o*i.OuterArcRadiusRatio);if(a.dataLabelsSettings.show||a.dataLabelsSettings.showCategory){var c=null;if(a.dataLabelsSettings.show&&0===a.dataLabelsSettings.displayUnits){var h=d3.min(a.dataPoints,function(e){return e.data.measure}),d=d3.max(a.dataPoints,function(e){return e.data.measure});c=Math.max(Math.abs(h),Math.abs(d))}var p=t.dataLabelUtils.getDonutChartLabelLayout(a.dataLabelsSettings,o,u,s,c);t.dataLabelUtils.drawDefaultLabelsForDonutChart(a.dataPoints,e,p,s,o,l,u)}else t.dataLabelUtils.cleanDataLabels(e,!0)},i.prototype.onClearSelection=function(){this.interactivityService&&this.interactivityService.clearSelection()},i.getLayout=function(e,t,a){var r=e*t,n=d3.svg.arc().innerRadius(r),o=n.outerRadius(e*i.InnerArcRadiusRatio),s=a.height<i.FontsizeThreshold?i.SmallFontSize:i.NormalFontSize;return{fontSize:s,shapeLayout:{d:function(e){return o(e)}},highlightShapeLayout:{d:function(a){var r=n.outerRadius(i.getHighlightRadius(e,t,a.data.highlightRatio));return r(a)}},zeroShapeLayout:{d:function(e){var t=n.outerRadius(r||i.EffectiveZeroValue);return t(e)}}}},i.getHighlightRadius=function(e,t,a){var r=e*t;return r+a*e*(i.InnerArcRadiusRatio-t)},i.cullDataByViewport=function(e,t,a){for(var r=Math.min(a.width,a.height)/2,n=this.invisibleArcLengthInPixels/r/i.twoPi*t,o=[],s=0,l=e.length;l>s;s++){var u=e[s];u.measure>=n&&o.push(u)}return o},i.ClassName="donutChart",i.InteractiveLegendClassName="donutLegend",i.InteractiveLegendArrowClassName="donutLegendArrow",i.DrillDownAnimationDuration=1e3,i.OuterArcRadiusRatio=.9,i.InnerArcRadiusRatio=.8,i.FontsizeThreshold=150,i.SmallFontSize="8px",i.NormalFontSize="11px",i.InteractiveLegendContainerHeight=70,i.OpaqueOpacity=1,i.SemiTransparentOpacity=.6,i.defaultSliceWidthRatio=.48,i.invisibleArcLengthInPixels=3,i.sliceClass={"class":"slice",selector:".slice"},i.sliceHighlightClass={"class":"slice-highlight",selector:".slice-highlight"},i.twoPi=2*Math.PI,i.EffectiveZeroValue=1e-9,i.PolylineOpacity=.5,i}();t.DonutChart=i;var a,r=function(){function e(e,t,i,a,r){this.legendContainerParent=t,this.colors=i,this.donutChart=e,this.visualInitOptions=a,this.legendItemsPositions=[],this.legendTransitionAnimationDuration=r&&r.legendTransitionAnimationDuration?r.legendTransitionAnimationDuration:0}return e.prototype.drawLegend=function(i){var a=this;this.data=i,this.currentNumberOfLegendItems=i.length,this.currentIndex=0,this.leftMostIndex=0,this.rightMostIndex=i.length-1,this.legendContainerParent.select(e.LegendContainerSelector).empty()&&(this.legendContainer=this.legendContainerParent.append("div").classed(e.LegendContainerClassName,!0));var r=this.legendContainer.selectAll(e.LegendItemSelector).data(i),n=this.legendContainerWidth=this.legendContainer.node().getBoundingClientRect().width,o=n/2-.4*n/2+e.ItemMargin,s=o;this.currentXOffset=o;var l=function(i,r){i.attr("data-legend-index",r.index).css({position:"absolute",left:s});var n=t.valueFormatter.format(r.label),o=t.valueFormatter.format(r.measure,r.measureFormat),l=t.valueFormatter.format(r.percentage,"0.00 %;-0.00 %;0.00 %"),u=r.color,c=e.createBasicLegendItemSpan(e.LegendItemValueClassName,o,11),h=e.createBasicLegendItemSpan(e.LegendItemCategoryClassName,n,11),d=e.createBasicLegendItemSpan(e.LegendItemPercentageClassName,l,20),p=e.spanWidth(c),g=e.spanWidth(h),f=e.spanWidth(d),m=e.legendBoxSize(p,g,f);i.css("width",m);var y=function(e){return m-e>0?(m-e)/2:0},v=y(p),C=y(g),b=y(f);e.createLegendItemSpan(h,C),e.createLegendItemSpan(c,v),e.createLegendItemSpan(d,b).css("color",u),i.append(h),i.append(d),i.append(c),a.legendItemsPositions.push({startX:s,boxWidth:m}),s+=m+e.ItemMargin};r.enter().insert("div").classed(e.LegendItemClassName,!0).each(function(e){l($(this),e)}),r.exit().remove(),this.assignInteractions()},e.prototype.updateLegend=function(e){var i=this;if(!(this.currentNumberOfLegendItems<=1)){var a=this.legendContainerWidth;this.currentIndex=e,this.updateLabelBlocks(e);var r=this.legendTransitionAnimationDuration,n=-1*(this.legendItemsPositions[e].startX+this.legendItemsPositions[e].boxWidth/2-a/2);this.legendContainer.transition().styleTween("-webkit-transform",function(e,a,r){return d3.interpolate(t.SVGUtil.translateWithPixels(i.currentXOffset,0),t.SVGUtil.translateWithPixels(n,0))}).styleTween("transform",function(e,a,r){return d3.interpolate(t.SVGUtil.translateWithPixels(i.currentXOffset,0),t.SVGUtil.translateWithPixels(n,0))}).duration(r).ease("bounce").each("end",function(){i.currentXOffset=n}),t.SVGUtil.flushAllD3TransitionsIfNeeded(this.visualInitOptions)}},e.prototype.assignInteractions=function(){var t=this,i=0,a=!1,r=function(){i=0,a=!1},n=function(){if(i+=d3.event.dx,!(a||Math.abs(i)<e.MinimumSwipeDX)){var r=0>i;t.dragLegend(r),a=!0}},o=d3.behavior.drag().origin(Object).on("drag",n).on("dragstart",r);this.legendContainer.call(o)},e.prototype.dragLegend=function(t){this.currentNumberOfLegendItems>e.MinimumItemsInLegendForCycled-1?this.currentIndex=this.getCyclingCurrentIndex(t):this.shouldChangeIndexInNonCycling(t)&&(t?this.currentIndex++:this.currentIndex--),this.donutChart.setInteractiveChosenSlice(this.currentIndex)},e.prototype.shouldChangeIndexInNonCycling=function(e){return 0===this.currentIndex&&!e||this.currentIndex===this.currentNumberOfLegendItems-1&&e?!1:!0},e.prototype.getCyclingCurrentIndex=function(e){var t=this.data.length,i=e?1:-1,a=(this.currentIndex+i)%(t||1);return 0>a?a+t:a},e.prototype.updateLegendItemsBlocks=function(t,i){var a=$(this.legendContainer[0]);if(t){var r=a.find("[data-legend-index="+this.leftMostIndex+"]");r.remove().insertAfter(a.find("[data-legend-index="+this.rightMostIndex+"]"));var n=this.legendItemsPositions[this.rightMostIndex].startX+this.legendItemsPositions[this.rightMostIndex].boxWidth+e.ItemMargin;this.legendItemsPositions[this.leftMostIndex].startX=n,r.css("left",n),this.rightMostIndex=this.leftMostIndex,this.leftMostIndex=(this.leftMostIndex+1)%this.data.length}else{var o=a.find("[data-legend-index="+this.rightMostIndex+"]");o.remove().insertBefore(a.find("[data-legend-index="+this.leftMostIndex+"]"));var n=this.legendItemsPositions[this.leftMostIndex].startX-this.legendItemsPositions[this.rightMostIndex].boxWidth-e.ItemMargin;this.legendItemsPositions[this.rightMostIndex].startX=n,o.css("left",n),this.leftMostIndex=this.rightMostIndex,this.rightMostIndex=this.rightMostIndex-1===-1?this.legendItemsPositions.length-1:this.rightMostIndex-1}i-1!==0&&this.updateLegendItemsBlocks(t,i-1)},e.prototype.updateLabelBlocks=function(t){this.currentNumberOfLegendItems>e.MinimumItemsInLegendForCycled?(this.rightMostIndex===t&&this.updateLegendItemsBlocks(!0,2),this.leftMostIndex===t&&this.updateLegendItemsBlocks(!1,2),(this.rightMostIndex===t+1||0===this.rightMostIndex&&t===this.currentNumberOfLegendItems-1)&&this.updateLegendItemsBlocks(!0,1),(this.leftMostIndex===t-1||this.leftMostIndex===this.currentNumberOfLegendItems-1&&0===t)&&this.updateLegendItemsBlocks(!1,1)):this.currentNumberOfLegendItems===e.MinimumItemsInLegendForCycled&&(this.rightMostIndex===t&&this.updateLegendItemsBlocks(!0,1),this.leftMostIndex===t&&this.updateLegendItemsBlocks(!1,1))},e.createBasicLegendItemSpan=function(e,t,i){return $("<span/>").addClass(e).css({"white-space":"nowrap","font-size":i+"px"}).text(t)},e.createLegendItemSpan=function(e,t){return e.css({overflow:"hidden","text-overflow":"ellipsis",display:"inline-block",width:"100%","margin-left":t}),e},e.legendBoxSize=function(t,i,a){var r=t>i?t:i;return r=r>a?r:a,r=r>e.MaxLegendItemBoxSize?e.MaxLegendItemBoxSize:r+2},e.spanWidth=function(e){return this.FakeElementSpan||(this.FakeElementSpan=$("<span>").hide().appendTo(document.body)),this.FakeElementSpan.empty(),this.FakeElementSpan.append(e),this.FakeElementSpan.width()},e.LegendContainerClassName="legend-container",e.LegendContainerSelector=".legend-container",e.LegendItemClassName="legend-item",e.LegendItemSelector=".legend-item",e.LegendItemCategoryClassName="category",e.LegendItemPercentageClassName="percentage",e.LegendItemValueClassName="value",e.MaxLegendItemBoxSize=160,e.ItemMargin=30,e.MinimumSwipeDX=15,e.MinimumItemsInLegendForCycled=3,e}();!function(e){var a=function(){function e(e,i){var a=e.categorical;if(this.dataViewCategorical=a,this.dataViewMetadata=e.metadata,this.seriesCount=a.values?a.values.length:0,this.colorHelper=new t.ColorHelper(i,t.donutChartProps.dataPoint.fill),this.maxValue=0,a.categories&&a.categories.length>0){var r=a.categories[0];this.categoryIdentities=r.identity,this.categoryValues=r.values,this.allCategoryObjects=r.objects,this.categoryColumnRef=r.identityFields,this.categoryFormatString=t.valueFormatter.getFormatString(r.source,t.donutChartProps.general.formatString)}var n=this.grouped=a&&a.values?a.values.grouped():void 0;this.isMultiMeasure=n&&n.length>0&&n[0].values&&n[0].values.length>1,this.isSingleMeasure=n&&1===n.length&&n[0].values&&1===n[0].values.length,this.hasHighlights=this.seriesCount>0&&!!a.values[0].highlights,this.highlightsOverflow=!1,this.total=0,this.highlightTotal=0,this.dataPoints=[],this.legendDataPoints=[],this.dataLabelsSettings=null;for(var o=0;o<this.seriesCount;o++)for(var s=a.values[o],l=0;l<s.values.length;l++)this.total+=Math.abs(s.values[l]),this.highlightTotal+=this.hasHighlights?Math.abs(s.highlights[l]):0}return e.prototype.convert=function(){var e;e=0!==this.total?this.categoryValues?this.convertCategoricalWithSlicing():this.isSingleMeasure||this.isMultiMeasure?this.convertMeasures():this.convertSeries():[];for(var a=!1,r=0,n=e.length;n>r&&!a;r++){var o=e[r];Math.abs(o.highlight.measure)>Math.abs(o.nonHighlight.measure)&&(a=!0)}this.dataLabelsSettings=this.convertDataLableSettings();var s=this.dataViewMetadata;if(s){var l=s.objects;l&&(this.legendObjectProperties=l.legend)}this.dataPoints=[];for(var u=t.donutChartProps.general.formatString,r=0,n=e.length;n>r;r++){var o=e[r],c=o.nonHighlight.measure,h=this.total>0?o.nonHighlight.value/this.total:0,d=0;o.nonHighlight.value>this.maxValue&&(this.maxValue=o.nonHighlight.value),o.highlight.value>this.maxValue&&(this.maxValue=o.nonHighlight.value),this.hasHighlights&&(a?(c=o.highlight.measure,h=this.highlightTotal>0?o.highlight.value/this.highlightTotal:0,d=1):d=o.highlight.value/o.nonHighlight.value,d||(d=i.EffectiveZeroValue));var p=c,g=o.categoryLabel,f=this.dataViewCategorical,m=f.categories?null:r;m=void 0!==o.seriesIndex?o.seriesIndex:m;var y=f.values[m].source,v=this.hasHighlights&&0!==o.highlight.value?o.highlight.measure:void 0,C=t.TooltipBuilder.createTooltipInfo(u,f.categories,g,f.values,p,null,m,v);this.dataPoints.push({identity:o.identity,measure:c,measureFormat:o.measureFormat,percentage:h,index:o.index,label:o.label,highlightRatio:d,selected:!1,tooltipInfo:C,color:o.color,labelColor:this.dataLabelsSettings.labelColor,labelFormatString:y.format})}this.legendData={title:this.getLegendTitle(),dataPoints:this.legendDataPoints}},e.prototype.getLegendTitle=function(){if(0!==this.total){var e=this.dataViewCategorical.values&&this.dataViewCategorical.values.source?this.dataViewCategorical.values.source.displayName:"",t=this.dataViewCategorical.categories&&this.dataViewCategorical.categories.length>0&&this.dataViewCategorical.categories[0].source?this.dataViewCategorical.categories[0].source.displayName:"";return this.categoryValues?t:e}return""},e.prototype.convertCategoricalWithSlicing=function(){for(var e=this.dataViewCategorical,i=t.donutChartProps.general.formatString,a=[],r=0,n=this.categoryValues.length;n>r;r++){for(var o=this.categoryValues[r],s=this.allCategoryObjects?this.allCategoryObjects[r]:void 0,l=t.SelectionId.createWithId(this.categoryIdentities[r]),u=this.colorHelper.getColorForSeriesValue(s,this.categoryColumnRef,o),c=t.valueFormatter.format(o,this.categoryFormatString),h=0;h<this.seriesCount;h++){var d=e.values[h],p=this.isSingleMeasure?c:t.converterHelper.getFormattedLegendLabel(d.source,e.values,i),g=d.values[r]||0,f=this.hasHighlights?d.highlights[r]||0:0,m=this.isMultiMeasure?t.SelectionId.createWithIdAndMeasure(this.categoryIdentities[r],d.source.queryName):t.SelectionId.createWithIds(this.categoryIdentities[r],d.identity),y={identity:m,measureFormat:t.valueFormatter.getFormatString(d.source,i,!0),nonHighlight:{measure:g,value:Math.abs(g)},highlight:{measure:f,value:Math.abs(f)},index:r,label:p,categoryLabel:c,color:u,seriesIndex:h};a.push(y)}this.legendDataPoints.push({label:c,color:u,icon:t.LegendIcon.Box,identity:l,selected:!1})}return a},e.prototype.convertMeasures=function(){for(var e=this.dataViewCategorical,i=[],a=t.donutChartProps.general.formatString,r=0;r<this.seriesCount;r++){var n=e.values[r],o=t.valueFormatter.getFormatString(n.source,a,!0),s=n.source.displayName,l=t.SelectionId.createWithMeasure(n.source.queryName),u=n.values[0]||0,c=this.hasHighlights?n.highlights[0]||0:0,h=this.colorHelper.getColorForMeasure(n.source.objects,n.source.queryName),d={identity:l,measureFormat:o,nonHighlight:{measure:u,value:Math.abs(u)},highlight:{measure:c,value:Math.abs(c)},index:r,label:s,categoryLabel:s,color:h};i.push(d),this.legendDataPoints.push({label:d.label,color:d.color,icon:t.LegendIcon.Box,identity:d.identity,selected:!1})}return i},e.prototype.convertSeries=function(){for(var e=this.dataViewCategorical,i=[],a=t.donutChartProps.general.formatString,r=0;r<this.seriesCount;r++){var n=e.values[r],o=t.valueFormatter.getFormatString(n.source,a,!0),s=t.converterHelper.getFormattedLegendLabel(n.source,e.values,a),l=t.SelectionId.createWithId(n.identity),u=t.converterHelper.getSeriesName(n.source),c=n.objects&&n.objects[0],h=n.values[0]||0,d=this.hasHighlights?n.highlights[0]||0:0,p=this.colorHelper.getColorForSeriesValue(c,e.values.identityFields,u),g={identity:l,measureFormat:o,nonHighlight:{measure:h,value:Math.abs(h)},highlight:{measure:d,value:Math.abs(d)},index:r,label:s,categoryLabel:s,color:p,seriesIndex:r};i.push(g),this.legendDataPoints.push({label:g.label,color:g.color,icon:t.LegendIcon.Box,identity:g.identity,selected:!1})}return i},e.prototype.convertDataLableSettings=function(){var e=this.dataViewMetadata,i=t.dataLabelUtils.getDefaultDonutLabelSettings();if(e){var a=e.objects;if(a){var r=a.labels;r&&(void 0!==r.show&&(i.show=r.show),void 0!==r.color&&(i.labelColor=r.color.solid.color),void 0!==r.labelDisplayUnits&&(i.displayUnits=r.labelDisplayUnits),void 0!==r.labelPrecision&&(i.precision=r.labelPrecision>=0?r.labelPrecision:0));var n=a.categoryLabels;if(n){var o=n.show;void 0!==o&&(i.showCategory=o)}}}return i},e}();e.DonutChartConverter=a}(a||(a={}))}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t=jsCommon.ArrayExtensions,i=function(){function e(e){this.sentimentColors=[{value:"#C0433A"},{value:"#E8D62E"},{value:"#79C75B"}],this.basePickerColors=[{value:"#FFFFFF"},{value:"#000000"},{value:"#00B8AA"},{value:"#374649"},{value:"#FD625E"},{value:"#F2C811"},{value:"#5F6B6D"},{value:"#8AD4EB"},{value:"#FE9666"},{value:"#A66999"}],this.colors=e||r.getDefaultTheme(),this.scales={}}return e.prototype.getColorScaleByKey=function(e){var t=this.scales[e];return void 0===t&&(t=this.createScale(),this.scales[e]=t),t},e.prototype.getNewColorScale=function(){return this.createScale()},e.prototype.getColorByIndex=function(e){return this.colors[e]},e.prototype.getSentimentColors=function(){return this.sentimentColors},e.prototype.getBasePickerColors=function(){return this.basePickerColors},e.prototype.createScale=function(){return a.createFromColors(this.colors)},e}();e.DataColorPalette=i;var a=function(){function e(e){this.scale=e}return e.prototype.getColor=function(e){return this.scale(e)},e.prototype.clearAndRotateScale=function(){var e=this.scale.domain().length,i=t.rotate(this.scale.range(),e);this.scale=d3.scale.ordinal().range(i)},e.prototype.clone=function(){return new e(this.scale.copy())},e.createFromColors=function(t){return new e(d3.scale.ordinal().range(t))},e}();e.D3ColorScale=a;var r=function(){function e(){}return e.getDefaultTheme=function(){if(!e.defaultTheme){e.defaultTheme=[];for(var t=e.defaultBaseColors,i=0;i<e.colorSectorCount;++i)for(var a=0,r=t.length;r>a;++a)e.defaultTheme.push({value:jsCommon.color.rotate(t[a].value,i/e.colorSectorCount)})}return e.defaultTheme},e.colorSectorCount=12,e.defaultBaseColors=[{value:"#01B8AA"},{value:"#374649"},{value:"#FD625E"},{value:"#F2C80F"},{value:"#5F6B6D"},{value:"#8AD4EB"},{value:"#FE9666"},{value:"#A66999"},{value:"#3599B8"},{value:"#DFBFBF"},{value:"#4AC5BB"},{value:"#5F6B6D"},{value:"#FB8281"},{value:"#F4D25A"},{value:"#7F898A"},{value:"#A4DDEE"},{value:"#FDAB89"},{value:"#B687AC"},{value:"#28738A"},{value:"#A78F8F"},{value:"#168980"},{value:"#293537"},{value:"#BB4A4A"},{value:"#B59525"},{value:"#475052"},{value:"#6A9FB0"},{value:"#BD7150"},{value:"#7B4F71"},{value:"#1B4D5C"},{value:"#706060"},{value:"#0F5C55"},{value:"#1C2325"},{value:"#7D3231"},{value:"#796419"},{value:"#303637"},{value:"#476A75"},{value:"#7E4B36"},{value:"#52354C"},{value:"#0D262E"},{value:"#544848"}],e}()}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t=function(){function t(){}return t.prototype.init=function(e){this.element=e.element,this.currentViewport=e.viewport,this.style=e.style,this.hostService=e.host},t.prototype.onDataChanged=function(t){var i=t.dataViews;if(this.data=this.converter(i[0]),t.dataViews&&t.dataViews.length>0){var a=e.getInvalidValueWarnings(i,!1,!1,!1);a&&a.length>0&&this.hostService.setWarnings(a)}this.updateInternal()},t.prototype.onResizing=function(e){this.currentViewport=e,this.updateInternal()},t.prototype.converter=function(e){for(var t=e.categorical.categories[0].values.length,i=[],a=e.categorical.values[0],r=e.categorical.values[1],n=0;t>n;n++)i.push({name:e.categorical.categories[0].values[n],minValue:a.min,maxValue:a.max,firstInstanceValue:a.values[n],secondInstanceValue:r.values[n]});var o={measureData:i};return o},t.prototype.updateInternal=function(){var e=this,i=this.data,a=this.currentViewport.height,r=this.currentViewport.width,n=this.element,o=.16*a,s=.16*r,l=a-2*o,u=r-2*s,c={x:s+u/2,y:o+l/2},h={x:s+u/2,y:o},d=d3.svg.line().x(function(t,a){return e.translateWebPoint(i,h,c,t,a).x}).y(function(t,a){return e.translateWebPoint(i,h,c,t,a).y}),p=d3.svg.line().x(function(t,i){return 0===i?c.x:e.rotateWebPoint(h,c,t).x}).y(function(t,i){return 0===i?c.y:e.rotateWebPoint(h,c,t).y});this.svg||(this.svg=d3.select(n.get(0)).append("svg"),n.addClass(t.VisualClassName));var g=this.svg;this.axisGraphicsContext&&this.axisGraphicsContext.remove(),this.axisGraphicsContext=g.append("g").classed(t.AxisGraphicsContextClassName,!0),this.mainGraphicsContext&&this.mainGraphicsContext.remove(),this.mainGraphicsContext=g.append("g").classed(t.MainGraphicsContextClassName,!0);var f=i.measureData.map(function(e){return e.maxValue}).concat([i.measureData[0].maxValue]);this.axisGraphicsContext.append("path").attr("d",d(f)).classed("webChartAxis",!0),this.axisGraphicsContext.append("path").attr("d",d(f.map(function(t,a){return e.getInterimValue(i,a,2/3)}))).classed("webChartAxis",!0),this.axisGraphicsContext.append("path").attr("d",d(f.map(function(t,a){return e.getInterimValue(i,a,1/3)}))).classed("webChartAxis",!0);for(var m=0,y=i.measureData.length;y>m;m++)this.axisGraphicsContext.append("path").attr("d",p([0,2*m*Math.PI/y])).classed("webChartAxis",!0),this.axisGraphicsContext.append("svg:text").text(i.measureData[m].name).classed("webChartTitleLabel",!0).attr("x",this.getLabelPosition(h,c,2*m*Math.PI/y).x).attr("y",this.getLabelPosition(h,c,2*m*Math.PI/y).y).attr("text-anchor",this.getLabelAnchor(2*m*Math.PI/y)),this.axisGraphicsContext.append("svg:text").text(i.measureData[m].firstInstanceValue+" vs. "+i.measureData[m].secondInstanceValue).classed("webChartValueLabel",!0).attr("x",this.getLabelPosition(h,c,2*m*Math.PI/y).x).attr("y",this.getLabelPosition(h,c,2*m*Math.PI/y).y+14).attr("text-anchor",this.getLabelAnchor(2*m*Math.PI/y));this.mainGraphicsContext.append("path").attr("d",d(i.measureData.map(function(e){return e.firstInstanceValue}).concat(i.measureData[0].firstInstanceValue))).classed("firstInstance",!0),this.mainGraphicsContext.append("path").attr("d",d(i.measureData.map(function(e){return e.secondInstanceValue}).concat(i.measureData[0].secondInstanceValue))).classed("secondInstance",!0)},t.prototype.getInterimValue=function(e,t,i){t%=e.measureData.length;var a=e.measureData[t].minValue+i*(e.measureData[t].maxValue-e.measureData[t].minValue);return a},t.prototype.getLabelPosition=function(e,t,i){var a=this.rotateWebPoint(e,t,i),r=this.scaleWebPoint(a,t,1.1);return 0===i&&(r.y=r.y-14),r},t.prototype.getLabelAnchor=function(e){return 0===e||e===Math.PI?"middle":e<Math.PI?"start":"end"},t.prototype.translateWebPoint=function(e,t,i,a,r){var n=e.measureData.length;r%=n;var o=e.measureData[r].minValue,s=(a-o)/(e.measureData[r].maxValue-o),l=this.scaleWebPoint(this.rotateWebPoint(t,i,2*r*Math.PI/n),i,s);return l},t.prototype.scaleWebPoint=function(e,t,i){var a=(e.x-t.x)*i+t.x,r=(e.y-t.y)*i+t.y,n={x:a,y:r};return n},t.prototype.rotateWebPoint=function(e,t,i){var a=(e.x-t.x)*Math.cos(i)-(e.y-t.y)*Math.sin(i)+t.x,r=(e.x-t.x)*Math.sin(i)+(e.y-t.y)*Math.cos(i)+t.y,n={x:a,y:r};return n},t.VisualClassName="webChart",t.AxisGraphicsContextClassName="axisGraphicsContext",t.MainGraphicsContextClassName="mainGraphicsContext",t.capabilities={dataRoles:[{name:"Category",kind:0},{name:"Y",kind:1}]},t}();e.WebChart=t}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));